{"meta":{"title":"ç‹è¯›é­”","subtitle":"WangZhuMo's Blog.","description":"ç‹è¯›é­”","author":"wangzhumo","url":"https://www.wangzhumo.com"},"pages":[{"title":"","date":"2019-10-12T04:01:29.574Z","updated":"2018-01-10T16:04:17.000Z","comments":true,"path":"404.html","permalink":"https://www.wangzhumo.com/404.html","excerpt":"","text":""},{"title":"","date":"2019-10-12T04:01:28.697Z","updated":"2018-07-11T07:41:23.000Z","comments":true,"path":"config/package.json","permalink":"https://www.wangzhumo.com/config/package.json","excerpt":"","text":"{\"name\":\"hexo-site\",\"version\":\"0.0.0\",\"private\":true,\"hexo\":{\"version\":\"3.4.4\"},\"dependencies\":{\"hexo\":\"^3.2.0\",\"hexo-deployer-git\":\"^0.3.1\",\"hexo-generator-archive\":\"^0.1.4\",\"hexo-generator-category\":\"^0.1.3\",\"hexo-generator-index\":\"^0.2.0\",\"hexo-generator-json-content\":\"^3.0.1\",\"hexo-generator-search\":\"^2.1.1\",\"hexo-generator-searchdb\":\"^1.0.8\",\"hexo-generator-seo-friendly-sitemap\":\"0.0.21\",\"hexo-generator-tag\":\"^0.2.0\",\"hexo-renderer-ejs\":\"^0.3.0\",\"hexo-renderer-marked\":\"^0.3.0\",\"hexo-renderer-stylus\":\"^0.3.1\",\"hexo-server\":\"^0.2.0\"},\"devDependencies\":{\"hexo-generator-baidu-sitemap\":\"^0.1.2\",\"hexo-generator-sitemap\":\"^1.2.0\"}}"}],"posts":[{"title":"Flutterç¨³å®šç‰ˆå®‰è£…","slug":"release-flutter-setup","date":"2019-12-02T11:35:17.000Z","updated":"2019-12-22T11:40:17.554Z","comments":true,"path":"2019/12/02/release-flutter-setup/","link":"","permalink":"https://www.wangzhumo.com/2019/12/02/release-flutter-setup/","excerpt":"å®‰è£…1.ä¸‹è½½ç¨³å®šç‰ˆåŒ… https://flutter.dev/docs/development/tools/sdk/releases?tab=macos é€‰æ‹©ç³»ç»Ÿï¼Œå¹¶é€‰æ‹©äº†v1.9.1+hotfix.6 ç‰ˆæœ¬","text":"å®‰è£…1.ä¸‹è½½ç¨³å®šç‰ˆåŒ… https://flutter.dev/docs/development/tools/sdk/releases?tab=macos é€‰æ‹©ç³»ç»Ÿï¼Œå¹¶é€‰æ‹©äº†v1.9.1+hotfix.6 ç‰ˆæœ¬ 2.è§£å‹å¹¶é…ç½®ç¯å¢ƒå˜é‡flutter on ğŸŒ± stable âœ pwd /Users/wangzhumo/Develop/flutter flutter on ğŸŒ± stable vim ~/.bash_profile æŠŠè·¯å¾„å†™å…¥.bash_profile ulimit -S -n 1024 export FLUTTER=/Users/wangzhumo/Develop/flutter #PUB_HOSTED_URL FLUTTER_STORAGE_BASE_URL æ˜¯Flutterçš„å›½å†…é•œåƒ export PUB_HOSTED_URL=https://pub.flutter-io.cn export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn export PATH=$PATH:$FLUTTER/bin //é€€å‡ºåˆ°flutterç›®å½• flutter on ğŸŒ± stable âœ source ~/.base_profile å†™å®Œä¹‹åwqè®°å¾—ä¿å­˜ï¼Œç„¶åsourceä¸€ä¸‹ ####3.é¢„å…ˆä¸‹è½½ï¼ˆå¯é€‰ï¼‰ flutter on ğŸŒ± stable âœ flutter precache é…ç½®Run flutter doctorRun the following command to see if there are any dependencies you need to install to complete the setup (for verbose output, add the -v flag): flutter on ğŸŒ± stable âœ flutter doctor è¿è¡Œçš„ç»“æœæ˜¯ï¼š flutter on ğŸŒ± stable took 6s âœ flutter doctor Doctor summary (to see all details, run flutter doctor -v): [âœ“] Flutter (Channel stable, v1.9.1+hotfix.6, on Mac OS X 10.15 19A583, locale zh-Hans-CN) [!] Android toolchain - develop for Android devices (Android SDK version 29.0.2) ! Some Android licenses not accepted. To resolve this, run: flutter doctor --android-licenses [âœ“] Xcode - develop for iOS and macOS (Xcode 11.1) [âœ“] Android Studio (version 3.5) [!] IntelliJ IDEA Ultimate Edition (version 2019.2.3) âœ— Flutter plugin not installed; this adds Flutter specific functionality. âœ— Dart plugin not installed; this adds Dart specific functionality. [âœ“] VS Code [âœ“] Connected device (2 available) ! Doctor found issues in 2 categories. å¯ä»¥çœ‹åˆ°æˆ‘è¿™è¾¹Android toolchainæœ‰ç‚¹é—®é¢˜ï¼ŒæŒ‰ç…§æç¤ºçš„ âœ flutter doctor --android-licenses Warning: File /Users/wangzhumo/.android/repositories.cfg could not be loaded. 1 of 7 SDK package license not accepted.] 100% Computing updates... //ä¸€è·¯ y ä¸‹å»å³å¯ è¿™ä¸€æ­¥ï¼Œå¯èƒ½ä¼šè€—è´¹å¤§é‡çš„æ—¶é—´ï¼Œå†åŠ ä¸Šç½‘ç»œçš„é—®é¢˜ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œè¯·å‚è€ƒ ã€ä½¿ç”¨é•œåƒã€‘ ä½¿ç”¨é•œåƒã€è½¬ã€‘ https://flutterchina.club/setup-macos/ ç”±äºåœ¨å›½å†…è®¿é—®Flutteræœ‰æ—¶å¯èƒ½ä¼šå—åˆ°é™åˆ¶ï¼ŒFlutterå®˜æ–¹ä¸ºä¸­å›½å¼€å‘è€…æ­å»ºäº†ä¸´æ—¶é•œåƒï¼Œå¤§å®¶å¯ä»¥å°†å¦‚ä¸‹ç¯å¢ƒå˜é‡åŠ å…¥åˆ°ç”¨æˆ·ç¯å¢ƒå˜é‡ä¸­ï¼š export PUB_HOSTED_URL=https://pub.flutter-io.cn export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn æ³¨æ„ï¼š æ­¤é•œåƒä¸ºä¸´æ—¶é•œåƒï¼Œå¹¶ä¸èƒ½ä¿è¯ä¸€ç›´å¯ç”¨ï¼Œè¯»è€…å¯ä»¥å‚è€ƒè¯¦æƒ…è¯·å‚è€ƒ Using Flutter in China ä»¥è·å¾—æœ‰å…³é•œåƒæœåŠ¡å™¨çš„æœ€æ–°åŠ¨æ€ã€‚ è¿è¡ŒDemo","categories":[{"name":"Flutter","slug":"Flutter","permalink":"https://www.wangzhumo.com/categories/Flutter/"}],"tags":[{"name":"Flutter","slug":"Flutter","permalink":"https://www.wangzhumo.com/tags/Flutter/"}]},{"title":"OpenGLç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢","slug":"learn-opengl-triangle","date":"2019-11-28T09:25:39.000Z","updated":"2019-11-29T09:33:54.939Z","comments":true,"path":"2019/11/28/learn-opengl-triangle/","link":"","permalink":"https://www.wangzhumo.com/2019/11/28/learn-opengl-triangle/","excerpt":"å‰è¨€è¿™é‡Œæˆ‘ä¼šä½¿ç”¨åˆšåˆšå­¦ä¹ åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå°è¯•ç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢ã€‚ä½¿ç”¨Androidæä¾›çš„GLSurfaceViewé…åˆOpenGL ESå®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚","text":"å‰è¨€è¿™é‡Œæˆ‘ä¼šä½¿ç”¨åˆšåˆšå­¦ä¹ åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå°è¯•ç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢ã€‚ä½¿ç”¨Androidæä¾›çš„GLSurfaceViewé…åˆOpenGL ESå®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚ GLSurfaceView å®ç°GLSurfaceView.Renderer glFrustumfï¼ŒglViewportï¼ŒglVertexPointer glDrawArrays ç¼–ç 1.åˆ›å»ºTriangleActivity&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot; xmlns:tools=&quot;http://schemas.android.com/tools&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; tools:context=&quot;.opengl.triangle.TriangleActivity&quot;&gt; &lt;android.opengl.GLSurfaceView android:id=&quot;@+id/gl_surface_view&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; app:layout_constraintBottom_toBottomOf=&quot;parent&quot; app:layout_constraintEnd_toEndOf=&quot;parent&quot; app:layout_constraintStart_toStartOf=&quot;parent&quot; app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt; &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt; åŠ è½½å¸ƒå±€,è®¾ç½®TriangleRenderer @Route(path = IRoute.MEDIA_OPENGL_TRIANGLE) class TriangleActivity : BaseActivity() { override fun getLayoutId(): Int = R.layout.activity_triangle override fun initViews(savedInstanceState: Bundle?) { gl_surface_view.setRenderer(TriangleRenderer()) } } 2.å®ç°TriangleRendererè¿™é‡Œçš„æ³¨é‡Šå†™çš„å¾ˆå®Œå–„äº†ï¼Œä¸åšå…¶ä»–çš„è¡¥å…… /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2019-11-29 10:49 * * ä¸‰è§’å½¢çš„renderer */ class TriangleRenderer : GLSurfaceView.Renderer { private var ratio = 0F override fun onDrawFrame(gl: GL10?) { //åˆ‡æ¢åˆ°æ¨¡å‹çŸ©é˜µ gl?.apply { //æ¸…å±,æ¸…é™¤é¢œè‰²ç¼“å†²åŒº glClear(GL10.GL_COLOR_BUFFER_BIT) //gluLookAt éœ€è¦æ“ä½œçš„æ˜¯æ¨¡å‹çŸ©é˜µ glMatrixMode(GL10.GL_MODELVIEW) //åŠ è½½å•ä½çŸ©é˜µ - åˆå§‹åŒ– glLoadIdentity() } /* * @param gl a GL10 interface glå¯¹è±¡ * * @param eyeX eye point X * @param eyeY eye point Y è§‚å¯Ÿè€…çš„ä½ç½®ï¼Œæœ€å¥½æ˜¯ä¸å¹³æˆªå¤´ä½“åœ¨ä¸€ä¸ªåŸç‚¹ä¸Š * @param eyeZ eye point Z * * @param centerX center of view X * @param centerY center of view Y è§‚å¯Ÿè€…çš„è§‚å¯Ÿæ–¹å‘ï¼ˆæœå‘0ï¼Œ0ï¼Œ0 åŸç‚¹ï¼‰ * @param centerZ center of view Z * * @param upX up vector X * @param upY up vector Y è§‚å¯Ÿè€…å‘ä¸Šçš„ä½ç½® * @param upZ up vector Z */ //ç¡®å®šè§‚å¯Ÿçš„ç©ºé—´åæ ‡ GLU.gluLookAt(gl, 0F, 0F, 5F, 0F, 0F, 0F, 0F, 1F, 0F) //é¡¶ç‚¹æ•°ç»„ val trianglePoint = floatArrayOf( 0F, ratio, 1F, -1F, -ratio, 1F, 1F, -ratio, 1F ) //åˆ›å»ºé¡¶ç‚¹ç¼“å†²åŒº val pointBuffer = ByteBuffer.allocateDirect(trianglePoint.size * 4) val floatBuffer = TextureUtils.loadVertexBuffer(pointBuffer,trianglePoint) //è®¾ç½®ç»˜å›¾çš„é¢œè‰²,ä½¿ç”¨çº¢è‰² gl?.glColor4f(1F,0F,0F,1F) //æŒ‡å®š3ä¸ªå€¼ç¡®å®šä¸€ä¸ªç‚¹ //Must use a native order direct Buffer gl?.glVertexPointer(3, GL10.GL_FLOAT, 0, floatBuffer) //ç”»ä¸€ä¸ªä¸‰è§’ gl?.glDrawArrays(GL10.GL_TRIANGLES,0,3) } override fun onSurfaceChanged(gl: GL10?, width: Int, height: Int) { gl?.apply { //viewportè§†å£ ä¹Ÿå°±æ˜¯openglå¯ä»¥æ˜¾ç¤ºçš„åŒºåŸŸå¤§å° glViewport(0, 0, width, height) //æŠ•å½±çŸ©é˜µ - çŸ©é˜µæ¨¡å¼ glMatrixMode(GL10.GL_PROJECTION) //åŠ è½½å•ä½çŸ©é˜µ - åˆå§‹åŒ– glLoadIdentity() //è®¡ç®—æ¯”ä¾‹ï¼Œé¿å…ç¼©æ”¾åæ˜¾ç¤ºå˜å½¢ ratio = width.toFloat() / height //è®¾ç½®å¹³æˆªå¤´ä½“ï¼Œä¸ºäº†æŠ•å°„åˆ°viewportä¸Šæ—¶ï¼Œä¸è¶…å‡ºviewportï¼Œtop/bottom æŒ‰ç…§æˆ‘ä»¬viewportçš„æ¯”ä¾‹è®¾ç½® //æ­¤å¤„, bottom = -left * ratio top = left * ratio //zNear è¿‘å¹³é¢è·ç¦» //zFar è¿œå¹³é¢è·ç¦» glFrustumf(-1F, 1F, -ratio, ratio, 3F, 7F) } } override fun onSurfaceCreated(gl: GL10?, config: EGLConfig?) { gl?.apply { //æ¸…å±é¢œè‰²è®¾ç½® glClearColor(0F, 0F, 0F, 1F) //å¼€å¯é¡¶ç‚¹ç¼“å†²åŒº glEnableClientState(GL10.GL_VERTEX_ARRAY) } } } TextureUtilsæ˜¯åœ¨æ¸²æŸ“Cameraæ—¶å°±å·²ç»å†™å¥½çš„å·¥å…·äº†ï¼Œä¸é‡å¤å†™äº†ã€‚ å°ç»“é¡¶ç‚¹åæ ‡val trianglePoint = floatArrayOf( 0F, ratio, 1F, -1F, -ratio, 1F, 1F, -ratio, 1F ) x [-1,1] æˆ‘ä»¬åœ¨å¹³æˆªå¤´ä½“ä¸­çš„æ¯”ä¾‹ï¼Œæœ€å¤§ä¹Ÿå°±æ˜¯[-1,1] y [-ratio,ratio] è¿™é‡Œæˆ‘ä»¬è®¡ç®—äº†å±å¹•çš„æ¯”ä¾‹ï¼Œå¾—å‡ºçš„ratio z è¿™ä¸ªæŒ‡å®šäº†ï¼Œæˆ‘ä»¬åœ¨å¹³æˆªå¤´ä½“ä¸­çš„zä½ç½®ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„glFrustumf(-1F, 1F, -ratio, ratio, 3F, 7F)ä¸­ï¼Œç”¨è¿œå¹³é¢å‡å»è¿‘å¹³é¢ï¼Œ 7 -3 = 4 [0,4] å¹³æˆªå¤´ä½“glFrustumf(-1F, 1F, -ratio, ratio, 3F, 7F) Left / right åˆ†åˆ«ä¸º -1 1 bottom = -left * ratio top = left * ratio zNear è¿‘å¹³é¢è·ç¦» zFar è¿œå¹³é¢è·ç¦» æ•ˆæœval trianglePoint = floatArrayOf( 0F, ratio, 1F, -1F, -ratio, 1F, 1F, -ratio, 1F ) val trianglePoint = floatArrayOf( 0F, ratio, 2F, -1F, -ratio, 2F, 1F, -ratio, 2F )","categories":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/categories/Media/"}],"tags":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"},{"name":"OpenGL","slug":"OpenGL","permalink":"https://www.wangzhumo.com/tags/OpenGL/"}]},{"title":"OpenGLçš„æ¨¡å‹ä»¥åŠæ¸²æŸ“ç®¡çº¿Pipeline","slug":"learn-opengl-pipeline","date":"2019-11-27T07:14:33.000Z","updated":"2019-11-29T09:34:24.863Z","comments":true,"path":"2019/11/27/learn-opengl-pipeline/","link":"","permalink":"https://www.wangzhumo.com/2019/11/27/learn-opengl-pipeline/","excerpt":"å‰è¨€OpenGLçš„å­¦ä¹ éš¾åº¦è¿˜æ˜¯å¾ˆå¤§çš„ã€‚ è¿™é‡Œä¸€ä¸€è®°å½•å­¦ä¹ çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œé¦–å…ˆæˆ‘æƒ³è¦å…ˆç®€å•äº†è§£OpenGLçš„å¤§æ¦‚å·¥ä½œæµç¨‹OpenGL Pipelineï¼Œåé¢ä¼šæ…¢æ…¢çš„å®Œå–„è¿™ä¸ªç¬”è®°ã€‚","text":"å‰è¨€OpenGLçš„å­¦ä¹ éš¾åº¦è¿˜æ˜¯å¾ˆå¤§çš„ã€‚ è¿™é‡Œä¸€ä¸€è®°å½•å­¦ä¹ çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œé¦–å…ˆæˆ‘æƒ³è¦å…ˆç®€å•äº†è§£OpenGLçš„å¤§æ¦‚å·¥ä½œæµç¨‹OpenGL Pipelineï¼Œåé¢ä¼šæ…¢æ…¢çš„å®Œå–„è¿™ä¸ªç¬”è®°ã€‚ æ‰¾åˆ°ä¸€å¼ æ¯”è¾ƒè€çš„å›¾ï¼Œè¿™é‡Œæ˜¯ä»¥opengl1.1çš„æ ‡å‡†æ¥ç”»çš„ï¼Œçœ‹èµ·æ¥æ›´å®¹æ˜“ä¸€äº›ï¼Œæ‰€ä»¥ä¸å¦¨å…ˆçœ‹çœ‹ã€‚ Pipeline https://www.khronos.org/opengl/wiki/Rendering_Pipeline_Overview è¿™å¼ ç®¡çº¿å›¾æ¥è‡ªå®˜æ–¹çš„wiki,å¯ä»¥è¯´æ˜¯æ¯”è¾ƒæƒå¨çš„ã€‚ é¡¶ç‚¹æ•°æ® VAO(Vertex Array Objects)æ¯ä¸ªé¡¶ç‚¹åŒ…å«çš„ä¿¡æ¯ VBO(Vertex Buffer Objects)é¡¶ç‚¹æ•°æ®çš„Buffer é¡¶ç‚¹å¤„ç† â€”OpenGLå°†è°ƒç”¨vertex shaderæ¥å¤„ç†é¡¶ç‚¹ é¡¶ç‚¹çš„å˜æ¢ï¼Œæ¯”å¦‚æŠ•å½±çŸ©é˜µå˜åŒ– å…‰ç…§ï¼Œæœ‰æ—¶è¿˜ä¼šæœ‰å…‰ç…§çš„å¤„ç† é¡¶ç‚¹ç€è‰²å™¨ å¯èƒ½ä¼šæœ‰å¤šä¸ªvertex shaderï¼Œä½†æ¯æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ª Tesselation Shading [å¯é€‰] Geometry Shading [å¯é€‰] å›¾å…ƒç»„è£… å›¾å…ƒç»„è£…é˜¶æ®µä¼šæŠŠé¡¶ç‚¹ç»„è£…æˆä¸€ç»„ç›¸å…³è”çš„å‡ ä½•å›¾å…ƒ è£å‰ª æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„é¡¶ç‚¹ä¼šè·‘åˆ°å¯æ˜¾ç¤ºèŒƒå›´ä¹‹å¤–å»ï¼ŒOpenGLä¼šå¸®æˆ‘ä»¬æŠŠè¿™äº›ä¸å¯æ˜¾ç¤ºçš„éƒ¨åˆ†è£åˆ‡æ‰ï¼Œä»¥æé«˜æ•ˆæœï¼ŒèŠ‚çœèµ„æº æ …æ ¼åŒ– è£åˆ‡åçš„å›¾å…ƒç»è¿‡æ …æ ¼åŒ–ï¼Œç”Ÿæˆfragment,å¹¶ä¸”ä¼šå­˜æ”¾åœ¨frameBufferä¸­ï¼Œè¿™äº›æ•°æ®è¿˜å¯ä»¥è¢«ä¸‹é¢çš„ä¸¤éƒ¨è¿›è¡ŒåŠ å·¥å¤„ç† Fragment Shading fragment shadingç”¨å‰é¢çš„ä¿¡æ¯æ¥å†³å®šfragmentçš„é¢œè‰²ï¼Œæ˜¯å¦éœ€è¦åœæ­¢ï¼Œä»¥åŠå¯ä»¥å¤„ç†texture mapping. Per-Fragment Operations ç°åœ¨å¯¹å®ƒä»¬çš„å…·ä½“å«ä¹‰å¹¶ä¸éå¸¸æ¸…æ¥šï¼Œç„¶è€Œæˆ‘ä»¬çŸ¥é“äº†æ•´ä¸ªæ¡†æ¶ï¼Œåé¢çš„å­¦ä¹ è¿‡ç¨‹å°±æ˜¯æ…¢æ…¢å¡«å……ï¼Œä¿®æ”¹è¿™ä¸ªæ¡†æ¶çš„è¿‡ç¨‹ã€‚ ModelOpenGlçš„æ¶æ„ï¼Œä¹Ÿæ˜¯å¾ˆç»å…¸çš„C-Sæ¶æ„ã€‚ https://cloud.tencent.com/developer/news/223343 END","categories":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/categories/Media/"}],"tags":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"},{"name":"OpenGL","slug":"OpenGL","permalink":"https://www.wangzhumo.com/tags/OpenGL/"}]},{"title":"MediaExtractorä¸MediaMuxerçš„ç®€å•ä½¿ç”¨","slug":"mediaextractor-and-mediamuxer-sample","date":"2019-11-26T11:50:39.000Z","updated":"2019-11-28T09:24:49.416Z","comments":true,"path":"2019/11/26/mediaextractor-and-mediamuxer-sample/","link":"","permalink":"https://www.wangzhumo.com/2019/11/26/mediaextractor-and-mediamuxer-sample/","excerpt":"MediaExtractorå¯ä»¥è¯´æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å°è£…äº†ï¼Œæ”¯æŒå¾ˆå¤šè¾“å…¥æ ¼å¼ï¼Œå¯ä»¥å¯¹æˆ‘ä»¬çš„å¤šåª’ä½“æ–‡ä»¶è¿›è¡Œåˆ†è§£ï¼Œå¯ä»¥ç”¨æ¥åˆ†ç¦»å®¹å™¨ä¸­çš„è§†é¢‘trackå’ŒéŸ³é¢‘trackã€‚ MediaMuxerç”¨äºå°è£…ç¼–ç åçš„è§†é¢‘æµå’ŒéŸ³é¢‘æµã€‚è™½ç„¶æœ‰ä¸€äº›é™åˆ¶æ¡ä»¶ï¼Œä½†æ˜¯å¯¹äºä¸€èˆ¬çš„ä½¿ç”¨è¿˜æ˜¯å¯ä»¥èƒœä»»çš„ã€‚","text":"MediaExtractorå¯ä»¥è¯´æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å°è£…äº†ï¼Œæ”¯æŒå¾ˆå¤šè¾“å…¥æ ¼å¼ï¼Œå¯ä»¥å¯¹æˆ‘ä»¬çš„å¤šåª’ä½“æ–‡ä»¶è¿›è¡Œåˆ†è§£ï¼Œå¯ä»¥ç”¨æ¥åˆ†ç¦»å®¹å™¨ä¸­çš„è§†é¢‘trackå’ŒéŸ³é¢‘trackã€‚ MediaMuxerç”¨äºå°è£…ç¼–ç åçš„è§†é¢‘æµå’ŒéŸ³é¢‘æµã€‚è™½ç„¶æœ‰ä¸€äº›é™åˆ¶æ¡ä»¶ï¼Œä½†æ˜¯å¯¹äºä¸€èˆ¬çš„ä½¿ç”¨è¿˜æ˜¯å¯ä»¥èƒœä»»çš„ã€‚ åˆæ­¥è®¤è¯†MediaExtractor https://developer.android.google.cn/reference/android/media/MediaExtractor?hl=en MediaExtractor facilitates extraction of demuxed, typically encoded, media data from a data source. ç®€å•çš„æè¿°å®ƒï¼Œå°±æ˜¯ä¸€ä¸ªè§£å°è£…çš„å·¥å…·ã€‚ MediaExtractor extractor = new MediaExtractor(); //è®¾ç½®æ¥æº extractor.setDataSource(...); //è·å–åª’ä½“æ–‡ä»¶çš„trackæ•°é‡ int numTracks = extractor.getTrackCount(); for (int i = 0; i &lt; numTracks; ++i) { MediaFormat format = extractor.getTrackFormat(i); String mime = format.getString(MediaFormat.KEY_MIME); //è·å–åˆ°ä½ æƒ³è¦ä½¿ç”¨çš„Track if (weAreInterestedInThisTrack) { //æ ‡è®°è¿™ä¸ªTrack extractor.selectTrack(i); } } ByteBuffer inputBuffer = ByteBuffer.allocate(...) while (extractor.readSampleData(inputBuffer, ...) &gt;= 0) { int trackIndex = extractor.getSampleTrackIndex(); long presentationTimeUs = extractor.getSampleTime(); ... //ä¸‹ä¸€å¸§ extractor.advance(); } //é‡Šæ”¾ extractor.release(); extractor = null; docä¸Šæä¾›äº†ä¸€æ®µæ¯”è¾ƒç®€å•çš„ä½¿ç”¨æ–¹å¼ å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„setDataSource,MediaFormat,selectTrack,release MediaMuxer https://developer.android.google.cn/reference/android/media/MediaMuxer?hl=en MediaMuxer facilitates muxing elementary streams. Currently MediaMuxer supports MP4, Webm and 3GP file as the output. It also supports muxing B-frames in MP4 since Android Nougat. æ”¯æŒçš„æ ¼å¼æœ‰MP4ï¼Œè€Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„å°è£…ä¹Ÿå°±æ˜¯MP4å•¦ï¼Œæ¯”è¾ƒé—æ†¾çš„æ˜¯åªèƒ½æ”¯æŒå•ä¸ªçš„Video Track å’Œ Audio Trackã€‚ åˆ†ç¦»MP4çš„Video/Audio Track /** * @param path åª’ä½“æ–‡ä»¶åœ°å€ * */ fun extractorMedia(path: String) { val extractor = MediaExtractor() //è®¾ç½®æ¥æº extractor.setDataSource(path) //è·å–åª’ä½“æ–‡ä»¶çš„trackæ•°é‡ val numTracks = extractor.trackCount for (index in 0 until numTracks){ val format = extractor.getTrackFormat(index) //è·å–åˆ°ä½ æƒ³è¦ä½¿ç”¨çš„Track appendLogs(format.toString()) } } æ˜ç¡®çš„çœ‹åˆ°ï¼Œè¿™ä¸ªMP4ä¸­æœ‰ä¸€æ¡éŸ³é¢‘è½¨ï¼Œä¸€æ¡è§†é¢‘è½¨é“ã€‚ { track-id=2, max-bitrate=129051, //ç ç‡ã€æ¯”ç‰¹ç‡ sample-rate=44100, //é‡‡æ ·ç‡ file-format=video/mp4, mime=audio/mp4a-latm, //ç±»å‹æ˜¯ audio bitrate=129051, language=, aac-profile=2, durationUs=95087233, aac-format-adif=0, channel-count=2, //å£°é“ max-input-size=65541, csd-0=java.nio.HeapByteBuffer[pos=0 lim=5 cap=5] } { track-id=1, file-format=video/mp4, level=2048, mime=video/avc, //ç±»å‹æ˜¯ audio profile=2, language=, display-width=1920, csd-1=java.nio.HeapByteBuffer[pos=0 lim=8 cap=8], durationUs=95041666, display-height=1080, width=1920, rotation-degrees=0, max-input-size=1555201, frame-rate=24, height=1080, csd-0=java.nio.HeapByteBuffer[pos=0 lim=41 cap=41] } æˆ‘ä»¬ç»§ç»­ï¼Œä¸‹é¢çš„æ“ä½œæŠŠè¿™ä¸ªMP4åˆ†ç¦»ä¸ºä¸€ä¸ª ouput_video_mp4 , ä¸€ä¸ª ouput_audio_mp4 /** * @param path åª’ä½“æ–‡ä»¶åœ°å€ * */ fun extractorMedia(path: String) { val extractor = MediaExtractor() //è®¾ç½®æ¥æº extractor.setDataSource(path) //è§†é¢‘æ–‡ä»¶ val videoStream = File(OUTPUT_DIR, &quot;output_video_mp4.mp4&quot;).outputStream() //éŸ³é¢‘æ–‡ä»¶ val audioStream = File(OUTPUT_DIR, &quot;output_audio_mp4&quot;).outputStream() //è®°å½•éŸ³é¢‘/è§†å±è½¨é“çš„index var videoTrackIndex = -1 var audioTrackIndex = -1 //è·å–åª’ä½“æ–‡ä»¶çš„trackæ•°é‡ val numTracks = extractor.trackCount for (index in 0 until numTracks) { val format = extractor.getTrackFormat(index) val mimeType = format.getString(MediaFormat.KEY_MIME) //æ ‡è®°è§†é¢‘è½¨é“ if (mimeType.startsWith(&quot;video/&quot;)) { videoTrackIndex = index } //æ ‡è®°éŸ³é¢‘è½¨é“ if (mimeType.startsWith(&quot;audio/&quot;)) { audioTrackIndex = index } appendLogs(&quot;è§†é¢‘åˆ†ç¦» - ä»»åŠ¡å¼€å§‹&quot;) // åˆ‡æ¢åˆ°è§†é¢‘ extractor.selectTrack(videoTrackIndex) readTrackStream(videoStream,extractor) videoStream.close() appendLogs(&quot;è§†é¢‘åˆ†ç¦» - ä»»åŠ¡ç»“æŸ&quot;) appendLogs(&quot;éŸ³é¢‘åˆ†ç¦» - ä»»åŠ¡å¼€å§‹&quot;) // åˆ‡æ¢åˆ°éŸ³é¢‘ extractor.selectTrack(audioTrackIndex) readTrackStream(audioStream,extractor) audioStream.close() appendLogs(&quot;éŸ³é¢‘åˆ†ç¦» - ä»»åŠ¡ç»“æŸ&quot;) } appendLogs(&quot;ä»»åŠ¡ç»“æŸ&quot;) extractor.release() } /** * è¯»å–æ•°æ®ï¼Œå†™å…¥åˆ°æ–‡ä»¶ä¸­ */ private fun readTrackStream(fileInput: FileOutputStream, extractor: MediaExtractor) { //Buffer val byteBuffer = ByteBuffer.allocate(1024 * 500) var readCount = 0 do { //è¯»å–æ•°æ® readCount = extractor.readSampleData(byteBuffer,0) if (readCount &lt; 0){ break } //å†™å…¥æ–‡ä»¶ val buffer = ByteArray(readCount) byteBuffer.get(buffer) fileInput.write(buffer) byteBuffer.clear() //ç§»åŠ¨åˆ°ä¸‹ä¸€å¸§ extractor.advance() }while (readCount &gt; 0) byteBuffer.clear() } å°†éŸ³é¢‘/è§†é¢‘åˆå¹¶ä¸ºMP4 /** * åˆå¹¶éŸ³è§†é¢‘ */ fun muxerMediaStream(path: String){ appendLogs(&quot;ä»»åŠ¡å¼€å§‹&quot;) val mOutputVideoPath = File(OUTPUT_DIR, &quot;output_mp4_file.mp4&quot;).absolutePath //æŒ‡å®šè¾“å‡ºç›®å½•ï¼ŒæŒ‡å®šFormatæ ¼å¼ appendLogs(&quot;è¾“å‡ºç›®å½•ï¼š$mOutputVideoPath&quot; ) val mMediaMuxer = MediaMuxer( mOutputVideoPath, MediaMuxer.OutputFormat.MUXER_OUTPUT_MPEG_4 ) //è·å–ä¸¤ä¸ªè½¨é“ï¼Œå¹¶ä¸”æ·»åŠ åˆ°mMediaMuxer val extractor = MediaExtractor() //è®¾ç½®æ¥æº extractor.setDataSource(path) //è®°å½•éŸ³é¢‘/è§†å±è½¨é“çš„index var videoTrackIndex = -1 var audioTrackIndex = -1 //è·å–åª’ä½“æ–‡ä»¶çš„trackæ•°é‡ val numTracks = extractor.trackCount for (index in 0 until numTracks) { val format = extractor.getTrackFormat(index) val mimeType = format.getString(MediaFormat.KEY_MIME) //æ ‡è®°è§†é¢‘è½¨é“ if (mimeType.startsWith(&quot;video/&quot;)) { videoTrackIndex = index appendLogs(&quot;videoTrackIndex ï¼š$videoTrackIndex&quot; ) } //æ ‡è®°éŸ³é¢‘è½¨é“ if (mimeType.startsWith(&quot;audio/&quot;)) { audioTrackIndex = index appendLogs(&quot;audioTrackIndex ï¼š$audioTrackIndex&quot; ) } } //æ·»åŠ Track mMediaMuxer.addTrack(extractor.getTrackFormat(videoTrackIndex)) mMediaMuxer.addTrack(extractor.getTrackFormat(audioTrackIndex)) //æ·»åŠ å®Œæ¯•å¼€å§‹ mMediaMuxer.start() //è¯»å–æ•°æ®ï¼Œå¹¶ä¸”å†™å…¥MediaMuxer //å†™å…¥è§†é¢‘æ–‡ä»¶ readTrackAndMuxer(videoTrackIndex,mMediaMuxer,extractor) //å†™å…¥éŸ³é¢‘æ–‡ä»¶ readTrackAndMuxer(audioTrackIndex,mMediaMuxer,extractor) //é‡Šæ”¾MediaExtractor extractor.release() //é‡Šæ”¾MediaMuxer mMediaMuxer.stop(); mMediaMuxer.release(); } /** * è¯»å–æ–‡ä»¶ï¼Œå¹¶ä¸”å†™å…¥mMediaMuxer. */ private fun readTrackAndMuxer(trackIndex: Int,mMediaMuxer: MediaMuxer, extractor: MediaExtractor) { appendLogs(&quot;readTrackAndMuxer å¼€å§‹å†™å…¥&quot; ) //è¯»å–æ•°æ® extractor.selectTrack(trackIndex) val byteBuffer = ByteBuffer.allocate(1024 * 500) val info: MediaCodec.BufferInfo = MediaCodec.BufferInfo() info.presentationTimeUs = 0 var readCount = 0 do { //è¯»å–æ•°æ® readCount = extractor.readSampleData(byteBuffer,0) if (readCount &lt; 0){ break } //å†™å…¥æ–‡ä»¶ info.offset = 0 info.size = readCount info.flags = MediaCodec.BUFFER_FLAG_KEY_FRAME info.presentationTimeUs = extractor.sampleTime mMediaMuxer.writeSampleData(trackIndex,byteBuffer,info) byteBuffer.clear() //ç§»åŠ¨åˆ°ä¸‹ä¸€å¸§ extractor.advance() }while (readCount &gt; 0) appendLogs(&quot;readTrackAndMuxer ç»“æŸå†™å…¥&quot; ) } ä»£ç çš„é€»è¾‘å·²ç»å¾ˆæ¸…æ™°ã€‚ END.","categories":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/categories/Media/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"}]},{"title":"ä½¿ç”¨Textureviewé¢„è§ˆç›¸æœº","slug":"camera-with-textureview","date":"2019-11-19T08:03:41.000Z","updated":"2019-11-26T11:52:47.085Z","comments":true,"path":"2019/11/19/camera-with-textureview/","link":"","permalink":"https://www.wangzhumo.com/2019/11/19/camera-with-textureview/","excerpt":"æµç¨‹åˆ†æå®ç°æ€è·¯ä½¿ç”¨TextureViewæ˜¾ç¤ºç›¸æœºçš„é¢„è§ˆï¼Œæ¸²æŸ“ä½¿ç”¨openglå®ç°ï¼Œä»¿ç…§GLSurfaceViewçš„æ–¹å¼æ¥é¢„è§ˆè¿™ä¸ªç›¸æœºã€‚","text":"æµç¨‹åˆ†æå®ç°æ€è·¯ä½¿ç”¨TextureViewæ˜¾ç¤ºç›¸æœºçš„é¢„è§ˆï¼Œæ¸²æŸ“ä½¿ç”¨openglå®ç°ï¼Œä»¿ç…§GLSurfaceViewçš„æ–¹å¼æ¥é¢„è§ˆè¿™ä¸ªç›¸æœºã€‚ ç›¸æœº â€”-ç”Ÿäº§â€”&gt; SurfaceTexture (OpenGL + GLThread å¤„ç†) â€”&gt; TextureView(SurfaceTextView)å…³è”çš„GLç¯å¢ƒ onSurfaceTextureAvailable(surface)â€”æ˜¾ç¤ºâ€“&gt; TextureView(SurfaceTextView)å…³è”çš„GLç¯å¢ƒ å¤§æ¦‚æµç¨‹ Activity æä¾›ä¸€ä¸ª TextureView åˆå§‹åŒ–ç›¸æœºç¡¬ä»¶ï¼ˆæƒé™/Camera1/2ï¼‰ï¼Œå‡†å¤‡å¼€å§‹é¢„è§ˆ æ·»åŠ TextureView setSurfaceTextureListener setSurfaceTextureListener åŠ è½½loadOESTexture åˆ›å»ºRenderer Thread initEGLContext ä½¿ç”¨TextureViewä¸­çš„surfaceTexture åˆ›å»ºä¸€ä¸ªTextureEGLRendererç”¨äºé¢„è§ˆ å®ŒæˆGLç¯å¢ƒçš„å»ºç«‹ åˆ›å»ºä¸€ä¸ªSurfaceTexture(mOESTextureId) ,ç”¨äºç›¸æœºçš„é¢„è§ˆ å¼€å¯é¢„è§ˆ setPreviewTexture(surfaceTexture) -&gt; åˆ›å»ºçš„surfaceTexture -&gt; setOnFrameAvailableListener TextureViewå‡ ä¸ªå¸¸ç”¨çš„SurfaceViewï¼ŒSurfaceTexture ,GlSurfaceViewä¸­ TextureViewæ˜¯å”¯ä¸€ä¸€ä¸ªå¯ä»¥å½“åšViewä½¿ç”¨ï¼Œæ”¯æŒåŠ¨ç”»æ•ˆæœï¼Œåœ¨5.0å‰åœ¨ä¸»çº¿ç¨‹æ¸²æŸ“ï¼Œåœ¨5.0ååœ¨å•ç‹¬çº¿ç¨‹æ¸²æŸ“ ä½†æ˜¯å®ƒçš„æ€§èƒ½æ²¡æœ‰å…¶ä»–å‡ ä¸ªå¥½ï¼Œè€—è´¹çš„å†…å­˜ä¹Ÿæ¯”è¾ƒå¤§ï¼Œå¸¸ç”¨åœ¨Listä¸­ï¼Œè€Œä¸”å¿…é¡»è¦åœ¨ç¡¬ä»¶ TextureView SurfaceView ç»˜åˆ¶ 1-3å¸§å»¶è¿Ÿ ä½ å†…å­˜ é«˜ ä½ åŠ¨ç”»å’Œæˆªå›¾ æ”¯æŒ ä¸æ”¯æŒ è€—ç”µ é«˜ ä½ ä»¥ä¸Šæ˜¯ç½‘ç»œä¸Šçš„èµ„æ–™å›¾è¡¨ ç¼–ç åˆ†æCameraActivityç”¨äºæ‰¿è½½è¿™ä¸ªDemo,å…¶ä¸­æ ¹å¸ƒå±€åªæœ‰ä¸€ä¸ªTextureView CameraOpenHelperç›¸æœºçš„å¸®åŠ©ç±»ï¼Œç”¨äºæ‰“å¼€Cameraä»¥åŠå¤„ç†Cameraä¸TextureViewçš„å…³è” ITextureRendererTextureEGLRendererfun onSurfaceCreated() //åŠ è½½GLçš„ä¸€äº›ä¸œè¥¿ï¼Œopenglçš„ç¨‹åºï¼Œç€è‰²å™¨ fun onSurfaceChanged(width: Int, height: Int) fun onDrawFrame(surfaceTexture: SurfaceTexture?) //æ¸²æŸ“ TextureEGLHelperclass TextureEGLHelper : SurfaceTexture.OnFrameAvailableListener æä¾› SurfaceTexture ç»™Camera initEGLContext HandlerThread åˆå§‹åŒ–/æ¸²æŸ“ æºç CameraActivitycom.wangzhumo.app.module.media.opengl.camera.CameraActivity @SuppressLint(&quot;RestrictedApi&quot;) override fun initViews(savedInstanceState: Bundle?) { super.initViews(savedInstanceState) val cameraOpenHelper = CameraOpenHelper(this) cameraOpenHelper.bindCameraUseCases(viewFinder) } è¿™ä¸ªCameraActivityå¾ˆç®€å•ï¼Œåªæœ‰xmlé‡Œä¹Ÿåªæœ‰ä¸€ä¸ªTextureView CameraOpenHelpercom.wangzhumo.app.module.media.opengl.camera.CameraOpenHelper class CameraOpenHelper constructor(private val lifeOwner: FragmentActivity) : TextureView.SurfaceTextureListener{ private var textureEGLHelper: TextureEGLHelper? = null private var viewFinder : TextureView? = null private var mCamera: ICamera? = null private var mCameraId = 0 fun bindCameraUseCases(textureView: TextureView) { this.viewFinder = textureView this.textureEGLHelper = TextureEGLHelper() textureView.surfaceTextureListener = this } override fun onSurfaceTextureSizeChanged(surface: SurfaceTexture?, width: Int, height: Int) { textureEGLHelper?.onSurfaceChanged(width, height) } override fun onSurfaceTextureUpdated(surface: SurfaceTexture?) {} override fun onSurfaceTextureDestroyed(surface: SurfaceTexture?): Boolean { onDestroy() return false } override fun onSurfaceTextureAvailable(surface: SurfaceTexture?, width: Int, height: Int) { //å½“å¤–éƒ¨çš„TextureViewå¯ç”¨ä¹‹åï¼Œå¼€å¯æ‘„åƒå¤´ï¼Œæ‰“å¼€æ¸²æŸ“çº¿ç¨‹ val textureId = TextureUtils.loadOESTexture() textureEGLHelper?.initEGL(viewFinder,textureId) //é€šè¿‡ä¼ é€’çš„textureId,æ„å»ºä¸€ä¸ªSurfaceTextureï¼Œç”¨äºç›¸æœºçš„é¢„è§ˆ val surfaceTexture = textureEGLHelper?.loadOESTexture() //ä¸ä½¿ç”¨è‡ªå·±çš„SurfaceViewï¼Œå¦å¤–æ„å»ºä¸€ä¸ªSurfaceViewæ¥æ¥æ”¶Cameraçš„é¢„è§ˆæ•°æ® //å‰ç½®æ‘„åƒå¤´ mCameraId = Camera.CameraInfo.CAMERA_FACING_FRONT mCamera = CameraV1(lifeOwner) mCamera?.apply { openCamera(mCameraId) setPreviewTexture(surfaceTexture) enablePreview(true) } } ITextureRendererTextureEGLRenderer/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2019-11-22 21:31 * * æ¸²æŸ“å®ç° */ class TextureEGLRenderer constructor(val textureId: Int) : ITextureRenderer { /** * ç¨‹åº */ private var mShaderProgram = -1 private var mOESTextureId = -1 private var mVertexBuffer: FloatBuffer /** * å˜æ¢çŸ©é˜µ */ private val transformMatrix = FloatArray(16) private var aPositionLocation = -1 private var aTextureCoordLocation = -1 private var uTextureMatrixLocation = -1 private var uTextureSamplerLocation = -1 init { mVertexBuffer = TextureUtils.loadVertexBuffer(VERTEX_DATA) mOESTextureId = textureId } override fun onSurfaceCreated() { //åŠ è½½GLçš„ä¸€äº›ä¸œè¥¿ val vertexShader = ShaderUtils.compileVertexShader(RawUtils.readResource(R.raw.vertex_texture_shader)) val fragmentShader = ShaderUtils.compileFragmentShader(RawUtils.readResource(R.raw.fragment_texture_shader)) Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLRenderer&quot;,&quot;onSurfaceCreated&quot;,56,&quot;vertexShader = $vertexShader , fragmentShader = $fragmentShader&quot;) mShaderProgram = ShaderUtils.linkProgram(vertexShader, fragmentShader) aPositionLocation = GLES30.glGetAttribLocation(mShaderProgram, POSITION_ATTRIBUTE) aTextureCoordLocation = GLES30.glGetAttribLocation(mShaderProgram, TEXTURE_COORD_ATTRIBUTE) uTextureMatrixLocation = GLES30.glGetUniformLocation(mShaderProgram, TEXTURE_MATRIX_UNIFORM) uTextureSamplerLocation = GLES30.glGetUniformLocation(mShaderProgram, TEXTURE_SAMPLER_UNIFORM) Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLRenderer&quot;,&quot;onSurfaceCreated&quot;,63, &quot;mShaderProgram = $mShaderProgram , aPositionLocation = $aPositionLocation , aTextureCoordLocation = $aTextureCoordLocation , uTextureMatrixLocation = $uTextureSamplerLocation , uTextureSamplerLocation = $uTextureSamplerLocation&quot;) } override fun onSurfaceChanged(width: Int, height: Int) { GLES30.glViewport(0, 0, width, height) } override fun onDrawFrame(surfaceTexture: SurfaceTexture?) { GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT) GLES30.glUseProgram(mShaderProgram) //å¼€å§‹ä½¿ç”¨ç¨‹åº surfaceTexture?.updateTexImage() surfaceTexture?.getTransformMatrix(transformMatrix) GLES30.glActiveTexture(GLES30.GL_TEXTURE0) GLES30.glBindTexture(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, mOESTextureId) GLES30.glUniform1i(uTextureSamplerLocation, 0) GLES30.glUniformMatrix4fv( uTextureMatrixLocation, 1, false, transformMatrix, 0 ) mVertexBuffer.position(0) GLES30.glEnableVertexAttribArray(aPositionLocation) GLES30.glVertexAttribPointer( aPositionLocation, 2, GLES30.GL_FLOAT, false, STRIDE, mVertexBuffer ) mVertexBuffer.position(2) GLES30.glEnableVertexAttribArray(aTextureCoordLocation) GLES30.glVertexAttribPointer( aTextureCoordLocation, 2, GLES30.GL_FLOAT, false, STRIDE, mVertexBuffer ) GLES30.glDrawArrays(GLES30.GL_TRIANGLES, 0, 6) } companion object { private const val TAG = &quot;TextureEGLRenderer&quot; private const val POSITION_ATTRIBUTE = &quot;aPosition&quot; private const val TEXTURE_COORD_ATTRIBUTE = &quot;aTextureCoord&quot; private const val TEXTURE_MATRIX_UNIFORM = &quot;uTextureMatrix&quot; private const val TEXTURE_SAMPLER_UNIFORM = &quot;uTextureSampler&quot; private const val POSITION_SIZE = 2 private const val TEXTURE_SIZE = 2 private const val STRIDE = (POSITION_SIZE + TEXTURE_SIZE) * 4 /** * é¡¶ç‚¹æ•°ç»„ */ private val VERTEX_DATA = floatArrayOf( 1.0f, 1.0f, 1.0f, 1.0f, -1.0f, 1.0f, 0.0f, 1.0f, -1.0f, -1f, 0.0f, 0.0f, 1.0f, 1.0f, 1.0f, 1.0f, -1.0f, -1.0f, 0f, 0.0f, 1.0f, -1.0f, 1.0f, 0.0f ) } } è¿™ä¸ªTextureEGLRendererä¸­çš„GLæ¸²æŸ“ï¼Œå¤§éƒ¨åˆ†å†…å®¹ä¸æ˜¯å¾ˆç†Ÿï¼Œæ‰€ä»¥ä¸åšå¤ªå¤šçš„è§£è¯»ï¼Œå½“å§‘ä¸”å…ˆå½“åšå›ºå®šçš„ç”¨æ³•ï¼Œå…ˆå¼€å§‹ä½¿ç”¨ TextureEGLHelpercom.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper class TextureEGLHelper : SurfaceTexture.OnFrameAvailableListener { /** * æ¸²æŸ“/åˆå§‹åŒ– çº¿ç¨‹ */ private var mHandlerThread: HandlerThread? = null /** * æ¸²æŸ“å™¨ */ private var mRenderer: ITextureRenderer? = null /** * mHandlerThread å†…éƒ¨çš„Handler */ private var mHandler: Handler? = null /** * æœ€ç»ˆæ˜¾ç¤ºçš„TextureView */ private var mTextureView: TextureView? = null /** * çº¹ç†ID */ private var mOESTextureId = 0 /** * æ˜¾ç¤ºè®¾å¤‡ */ private var mEGLDisplay = EGL14.EGL_NO_DISPLAY /** * EGLä¸Šä¸‹æ–‡ */ private var mEGLContext = EGL14.EGL_NO_CONTEXT /** * EGLç»˜å›¾surface */ private var mEglSurface: EGLSurface? = null /** * è‡ªå®šä¹‰çš„SurfaceTexture - å®é™…ä¸Šæ¥æ”¶Cameraä¸Šçš„æ•°æ® */ private var mOESSurfaceTexture: SurfaceTexture? = null /** * @param textureView å¤–éƒ¨çš„TextureView * @param textureId æä¾›çš„TextureID */ fun initEGL(textureView: TextureView?, textureId: Int) { mTextureView = textureView mOESTextureId = textureId Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGL&quot;,84,&quot;initEGL HandlerThread åˆ›å»º&quot;) mHandlerThread = HandlerThread(&quot;Renderer Thread&quot;) Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGL&quot;,85,&quot;initEGL HandlerThread å¼€å§‹è¿è¡Œ&quot;) mHandlerThread?.start() //æ­¤å¤„çš„Handlerï¼Œç”¨äºå¤„ç†å„ç§å‘é€è¿‡æ¥çš„å‘½ä»¤ mHandler = object : Handler(mHandlerThread?.looper) { override fun handleMessage(msg: Message) { when (msg.what) { MSG_INIT -&gt; { //initEGLContext initEGLContext() //åˆå§‹åŒ–EGLç¯å¢ƒ initEGLRenderer() //åˆå§‹åŒ–æ¸²æŸ“å™¨ //åˆå§‹åŒ– Renderer. } MSG_RENDER -&gt; { //å¼€å§‹æ¸²æŸ“ï¼ŒonFrameAvailableä¸­å‘é€ï¼Œç”±mHandlerThreadè´Ÿè´£æ¸²æŸ“çš„è°ƒç”¨ã€‚ drawFrame() } MSG_DESTROY -&gt; { //mHandlerThread å…³é—­ //åœæ­¢mHandler //é”€æ¯èµ„æº } else -&gt; return } } } Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGL&quot;,113,&quot;initEGL HandlerThread å¼€å§‹è¿è¡Œ -- sendEmptyMessage(MSG_INIT)&quot;) mHandler?.sendEmptyMessage(MSG_INIT) } /** * åˆå§‹åŒ–EGLContext */ private fun initEGLContext() { Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGLContext&quot;,122,&quot;initEGL initEGLContext start&quot;) mEGLDisplay = EGL14.eglGetDisplay(EGL14.EGL_DEFAULT_DISPLAY) //éœ€åˆ¤æ–­æ˜¯å¦æˆåŠŸè·å–EGLDisplay if (mEGLDisplay == EGL14.EGL_NO_DISPLAY) { throw RuntimeException(&quot;Unable to get EGL14 display&quot;) } val versions = IntArray(2) versions[0] = 3 if (!EGL14.eglInitialize(mEGLDisplay, versions, 0, versions, 1)) { throw RuntimeException(&quot;eglInitialize failed! &quot; + EGL14.eglGetError()) } //eglçš„ä¸€äº›é…ç½® val eglConfigAttribute = intArrayOf( EGL14.EGL_BUFFER_SIZE, 32, EGL14.EGL_RED_SIZE, 8, EGL14.EGL_GREEN_SIZE, 8, EGL14.EGL_BLUE_SIZE, 8, EGL14.EGL_ALPHA_SIZE, 8, EGL14.EGL_RENDERABLE_TYPE, 4, EGL14.EGL_SURFACE_TYPE, EGL14.EGL_WINDOW_BIT, EGL14.EGL_NONE ) val numConfig = IntArray(1) val eglConfig = arrayOfNulls&lt;EGLConfig&gt;(1) //EGLé…ç½® val eglChooseFlag = EGL14.eglChooseConfig( mEGLDisplay, eglConfigAttribute, 0, eglConfig, 0, eglConfig.size, numConfig, 0 ) if (!eglChooseFlag) { throw RuntimeException(&quot;eglChooseConfig failed! &quot; + EGL14.eglGetError()) } //åˆ›å»ºEGLæ˜¾ç¤ºçš„çª—å£ val surfaceAttribute = intArrayOf( EGL14.EGL_NONE ) val surfaceTexture = mTextureView?.surfaceTexture if (surfaceTexture == null) { throw RuntimeException(&quot;surfaceTexture is null&quot;) } mEglSurface = EGL14.eglCreateWindowSurface( mEGLDisplay, eglConfig[0], mTextureView?.surfaceTexture, surfaceAttribute, 0 ) //åˆ›å»ºä¸Šä¸‹æ–‡ val ctxAttribute = intArrayOf( EGL14.EGL_CONTEXT_CLIENT_VERSION, 3, EGL14.EGL_NONE ) mEGLContext = EGL14.eglCreateContext( mEGLDisplay, eglConfig[0], EGL14.EGL_NO_CONTEXT, ctxAttribute, 0 ) //æ ¡éªŒ1 if (mEGLDisplay === EGL14.EGL_NO_DISPLAY || mEGLContext === EGL14.EGL_NO_CONTEXT) { throw RuntimeException(&quot;eglCreateContext fail failed! &quot; + EGL14.eglGetError()) } //æ ¡éªŒ2 val makeFlag = EGL14.eglMakeCurrent(mEGLDisplay, mEglSurface, mEglSurface, mEGLContext) if (!makeFlag) { throw RuntimeException(&quot;eglMakeCurrent failed! &quot; + EGL14.eglGetError()) } Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGLContext&quot;,191,&quot;initEGL initEGLContext end&quot;) } /** * åˆå§‹åŒ–Renderer */ private fun initEGLRenderer() { Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGLRenderer&quot;,220,&quot;initEGLRenderer åˆ›å»º TextureEGLRenderer&quot;) mRenderer = TextureEGLRenderer(mOESTextureId) mRenderer?.onSurfaceCreated() } /** * åˆ›å»ºå¯ä»¥æ”¾åœ¨å¤–éƒ¨ï¼Œä½†æ˜¯ä¸ºäº†åŠ å…¥ç›‘å¬æ–¹ä¾¿ï¼Œå°±æ”¾åœ¨è¿™é‡Œåˆå§‹åŒ– */ fun loadOESTexture(): SurfaceTexture? { Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;loadOESTexture&quot;,198,&quot;loadOESTexture æä¾›SurfaceTexture&quot;) mOESSurfaceTexture = SurfaceTexture(mOESTextureId) mOESSurfaceTexture?.setOnFrameAvailableListener(this) Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;loadOESTexture&quot;,200,&quot;loadOESTexture æ·»åŠ setOnFrameAvailableListener&quot;) return mOESSurfaceTexture } /* * setOnFrameAvailableListener ç»™ loadOESTexture æä¾›çš„SurfaceTextureä½¿ç”¨ */ override fun onFrameAvailable(surfaceTexture: SurfaceTexture?) { //frameå¯ç”¨ä¹‹åï¼Œå¼€å§‹æ¸²æŸ“ if (mHandler != null) { //ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œéœ€è¦åœ¨mHandlerThreadä¸­å»æ¸²æŸ“ mHandler?.sendEmptyMessage(MSG_RENDER) } } /** * å®é™…ä¸Šæ¸²æŸ“ç”»é¢çš„æ–¹æ³• */ private fun drawFrame() { if (mRenderer != null) { EGL14.eglMakeCurrent(mEGLDisplay, mEglSurface, mEglSurface, mEGLContext) mRenderer?.onDrawFrame(mOESSurfaceTexture) EGL14.eglSwapBuffers(mEGLDisplay, mEglSurface) } } /** * onSurfaceChanged å›è°ƒ */ fun onSurfaceChanged(width: Int, height: Int) { mRenderer?.onSurfaceChanged(width, height) } /** * é‡Šæ”¾èµ„æº */ fun onDestroy() { mHandler?.removeCallbacksAndMessages(null) mHandlerThread?.quitSafely() } companion object { var MSG_INIT = 100 var MSG_RENDER = 200 var MSG_DESTROY = 300 const val TAG = &quot;TextureEGLHelper&quot; } } å·¥å…·ç±»TextureUtils/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2019-08-23$ 23:31$ */ object TextureUtils { /** * åŠ è½½OES Texture * * @return */ @JvmStatic fun loadOESTexture(): Int { val textureIds = IntArray(1) //textureIds ä¸­å­˜æ”¾ä¸€ä¸ªtexturesä¸­çš„å¯ç”¨å€¼ GLES20.glGenTextures(1, textureIds, 0) //å½“è°ƒç”¨glBindTexture //å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨è¿™ä¸ªå‡½æ•°textureIds[0] ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¹ç†å¯¹è±¡ //å¦‚æœtextureIds[0]å·²ç»åˆ›å»ºè¿‡äº†ï¼ŒæŠŠè¿™ä¸ªçº¹ç†ç½®ä¸º æ´»åŠ¨ //å¦‚æœtextureä¸º0ï¼Œå°±åœæ­¢ä½¿ç”¨è¿™ä¸ªçº¹ç†å¯¹è±¡ï¼Œå¹¶è¿”å›æ— åç§°çš„é»˜è®¤çº¹ç† GLES20.glBindTexture(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, textureIds[0]) //è®¾ç½®å‚æ•° GLES20.glTexParameterf( GLES11Ext.GL_TEXTURE_EXTERNAL_OES, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST.toFloat() ) GLES20.glTexParameterf( GLES11Ext.GL_TEXTURE_EXTERNAL_OES, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_LINEAR.toFloat() ) GLES20.glTexParameterf( GLES11Ext.GL_TEXTURE_EXTERNAL_OES, GLES20.GL_TEXTURE_WRAP_S, GLES20.GL_CLAMP_TO_EDGE.toFloat() ) GLES20.glTexParameterf( GLES11Ext.GL_TEXTURE_EXTERNAL_OES, GLES20.GL_TEXTURE_WRAP_T, GLES20.GL_CLAMP_TO_EDGE.toFloat() ) //å–æ¶ˆç»‘å®šçº¹ç†ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªé»˜è®¤çš„çº¹ç† GLES20.glBindTexture(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, 0) return textureIds[0] } /** * åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹Buffer */ fun loadVertexBuffer(vertexData: FloatArray): FloatBuffer { val buffer = ByteBuffer.allocateDirect(vertexData.size * 4) .order(ByteOrder.nativeOrder()) .asFloatBuffer() buffer.put(vertexData, 0, vertexData.size).position(0) return buffer } /** * åˆ›å»ºä¸€ä¸ªæ–°çš„SurfaceTexture */ fun loadOESTexture(mOESTextureId: Int): SurfaceTexture { return SurfaceTexture(mOESTextureId) } } ShaderUtils/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2019-09-28 16:16 */ object ShaderUtils { /** * ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨ * * @param shaderCode * @return */ @JvmStatic fun compileVertexShader(shaderCode: String): Int { return compileShader(GLES30.GL_VERTEX_SHADER, shaderCode) } /** * ç¼–è¯‘ç‰‡æ®µç€è‰²å™¨ * * @param shaderCode * @return */ @JvmStatic fun compileFragmentShader(shaderCode: String): Int { return compileShader(GLES30.GL_FRAGMENT_SHADER, shaderCode) } /** * ç¼–è¯‘ * * @param type é¡¶ç‚¹ç€è‰²å™¨:GLES30.GL_VERTEX_SHADER * ç‰‡æ®µç€è‰²å™¨:GLES30.GL_FRAGMENT_SHADER * @param shaderCode * @return */ @JvmStatic private fun compileShader(type: Int, shaderCode: String): Int { //åˆ›å»ºä¸€ä¸ªç€è‰²å™¨ val shaderId = GLES30.glCreateShader(type) if (shaderId != 0) { GLES30.glShaderSource(shaderId, shaderCode) GLES30.glCompileShader(shaderId) //æ£€æµ‹çŠ¶æ€ val compileStatus = IntArray(1) GLES30.glGetShaderiv(shaderId, GLES30.GL_COMPILE_STATUS, compileStatus, 0) if (compileStatus[0] == 0) { val logInfo = GLES30.glGetShaderInfoLog(shaderId) System.err.println(logInfo) //åˆ›å»ºå¤±è´¥ GLES30.glDeleteShader(shaderId) return 0 } return shaderId } else { //åˆ›å»ºå¤±è´¥ return 0 } } /** * é“¾æ¥å°ç¨‹åº * * @param vertexShaderId é¡¶ç‚¹ç€è‰²å™¨ * @param fragmentShaderId ç‰‡æ®µç€è‰²å™¨ * @return */ @JvmStatic fun linkProgram(vertexShaderId: Int, fragmentShaderId: Int): Int { val programId = GLES30.glCreateProgram() if (programId != 0) { //å°†é¡¶ç‚¹ç€è‰²å™¨åŠ å…¥åˆ°ç¨‹åº GLES30.glAttachShader(programId, vertexShaderId) //å°†ç‰‡å…ƒç€è‰²å™¨åŠ å…¥åˆ°ç¨‹åºä¸­ GLES30.glAttachShader(programId, fragmentShaderId) //é“¾æ¥ç€è‰²å™¨ç¨‹åº GLES30.glLinkProgram(programId) val linkStatus = IntArray(1) GLES30.glGetProgramiv(programId, GLES30.GL_LINK_STATUS, linkStatus, 0) if (linkStatus[0] == 0) { val logInfo = GLES30.glGetProgramInfoLog(programId) System.err.println(logInfo) GLES30.glDeleteProgram(programId) return 0 } return programId } else { //åˆ›å»ºå¤±è´¥ return 0 } } /** * éªŒè¯ç¨‹åºç‰‡æ®µæ˜¯å¦æœ‰æ•ˆ * * @param programObjectId * @return */ @JvmStatic fun validProgram(programObjectId: Int): Boolean { GLES30.glValidateProgram(programObjectId) val programStatus = IntArray(1) GLES30.glGetProgramiv(programObjectId, GLES30.GL_VALIDATE_STATUS, programStatus, 0) return programStatus[0] != 0 } } è¾“å‡ºæ—¥å¿—CameraActivity onCreated &lt;&lt;&lt; CameraActivity, createTextureView, 69]:åˆ›å»ºå¸®åŠ©ç±» CameraOpenHelper() CameraActivity, createTextureView, 71]:ç»‘å®šTextureView bindCameraUseCasesï¼ˆtextureViewï¼‰ CameraOpenHelper, bindCameraUseCases, 39]:åˆ›å»ºEGLHelper TextureEGLHelperï¼ˆï¼‰ CameraOpenHelper, bindCameraUseCases, 36]:æ·»åŠ  surfaceTextureListener CameraActivity onResumed &lt;&lt;&lt; CameraOpenHelper, onSurfaceTextureAvailable, 85]:onSurfaceTextureAvailable loadOESTexture = 0 TextureEGLHelper, initEGL, 84]:initEGL HandlerThread åˆ›å»º TextureEGLHelper, initEGL, 85]:initEGL HandlerThread å¼€å§‹è¿è¡Œ TextureEGLHelper, initEGL, 113]:initEGL HandlerThread å¼€å§‹è¿è¡Œ â€“ sendEmptyMessage(MSG_INIT) TextureEGLHelper, loadOESTexture, 198]:loadOESTexture æä¾›SurfaceTexture TextureEGLHelper, loadOESTexture, 200]:loadOESTexture æ·»åŠ setOnFrameAvailableListener TextureEGLHelper, initEGLContext, 122]:initEGL initEGLContext start TextureEGLHelper, initEGLContext, 191]:initEGL initEGLContext end TextureEGLHelper, initEGLRenderer, 220]:initEGLRenderer åˆ›å»º TextureEGLRenderer TextureEGLRenderer, init, 49]:mOESTextureId = 0 , mVertexBuffer = 24 TextureEGLRenderer, onSurfaceCreated, 63]:mShaderProgram = 3 , aPositionLocation = 0 , aTextureCoordLocation = 1 , uTextureMatrixLocation = 1 , uTextureSamplerLocation = 1 CameraOpenHelper, onSurfaceTextureAvailable, 95]:onSurfaceTextureAvailable enablePreview å¼€å¯æ‘„åƒå¤´","categories":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/categories/Media/"}],"tags":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"}]},{"title":"Ubuntuå®‰è£…coturnæœåŠ¡","slug":"coturn-install-ubuntu","date":"2019-11-06T03:59:03.000Z","updated":"2019-12-22T11:40:27.806Z","comments":true,"path":"2019/11/06/coturn-install-ubuntu/","link":"","permalink":"https://www.wangzhumo.com/2019/11/06/coturn-install-ubuntu/","excerpt":"coturn projectThis project evolved from rfc5766-turn-server project (https://code.google.com/p/rfc5766-turn-server/). è¿™æ˜¯ä¸€ä¸ªç©¿é€æœåŠ¡ï¼Œä¸ºwebrtcçš„é“¾æ¥åšæœåŠ¡,æŒ‰ç…§rfc5766-turn-serverå®ç°ã€‚","text":"coturn projectThis project evolved from rfc5766-turn-server project (https://code.google.com/p/rfc5766-turn-server/). è¿™æ˜¯ä¸€ä¸ªç©¿é€æœåŠ¡ï¼Œä¸ºwebrtcçš„é“¾æ¥åšæœåŠ¡,æŒ‰ç…§rfc5766-turn-serverå®ç°ã€‚ é¡¹ç›®åœ°å€ï¼šhttps://github.com/coturn/coturn å®‰è£…Wiki: https://github.com/coturn/coturn/wiki/CoturnConfig ä¾èµ–åº“Third-party librarieslibevent$ wget https://github.com/downloads/libevent/libevent/libevent-2.0.21-stable.tar.gz # éœ€è¦soduæƒé™ $ tar xvfz libevent-2.0.21-stable.tar.gz $ cd libevent-2.0.21-stable $ ./configure $ make $ make install å®‰è£…å®Œæ¯• /usr/local/lib coturn installä¸‹è½½åœ°å€ï¼šhttps://github.com/coturn/coturn/wiki/Downloads ä¸‹è½½æ–¹å¼ä¸€ï¼šæˆ‘é€‰æ‹©äº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œ4.5.0.8 $ wget https://coturn.net/turnserver/v4.5.0.8/turnserver-4.5.0.8.tar.gz ä¸€ç›´ä¸‹è½½å¤±è´¥..æ‰€ä»¥æˆ‘åœ¨æœ¬åœ°ä¸‹è½½äº†ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ home/wangzhumo/source æ–¹å¼äºŒï¼š$ cd /home/wangzhumo/source $ git clone https://github.com/coturn/coturn ç¼–è¯‘# è§£å‹ $ tar -xvf turnserver-4.5.0.8.tar $ cd turnserver-4.5.0.8 $ ./configure $ make $ sudo make install # è®°å½•å®‰è£…ä½ç½® install -d /usr/local install -d /usr/local/bin install -d /usr/local/var/db install -d /usr/local/man/man1 install -d /usr/local/etc install -d /usr/local/lib install -d /usr/local/share/examples/turnserver install -d /usr/local/share/doc/turnserver install -d /usr/local/share/turnserver install -d /usr/local/include/turn 1) If your system supports automatic start-up system daemon services, then to enable the turnserver as a system service that is automatically started, you have to: a) Create and edit /etc/turnserver.conf or /usr/local/etc/turnserver.conf . Use /usr/local/etc/turnserver.conf.default as an example. b) For user accounts settings: set up SQLite or PostgreSQL or MySQL or MongoDB or Redis database for user accounts. Use /usr/local/share/turnserver/schema.sql as SQL database schema, or use /usr/local/share/turnserver/schema.userdb.redis as Redis database schema description and/or /usr/local/share/turnserver/schema.stats.redis as Redis status &amp; statistics database schema description. If you are using SQLite, the default database location is in /var/db/turndb or in /usr/local/var/db/turndb or in /var/lib/turn/turndb. c) add whatever is necessary to enable start-up daemon for the /usr/local/bin/turnserver. 2) If you do not want the turnserver to be a system service, then you can start/stop it &quot;manually&quot;, using the &quot;turnserver&quot; executable with appropriate options (see the documentation). 3) To create database schema, use schema in file /usr/local/share/turnserver/schema.sql. 4) For additional information, run: $ man turnserver $ man turnadmin $ man turnutils coturn é…ç½®turnserver.conf$ sudo vim /usr/local/etc/turnserver.conf.default è¦ä¿®æ”¹çš„åœ°æ–¹åªæœ‰5å¤„ï¼š listening-port=3478 external-ip=[æœåŠ¡å™¨çš„ip] min-port=50001 max-port=65535 user=wangzhumo:webrtcpwd realm=stun.wangzhumo.com $ sudo mv /usr/local/etc/turnserver.conf.default /usr/local/etc/turnserver.conf é˜²ç«å¢™1.æ‰“å¼€äº‘æœåŠ¡å™¨çš„ å®‰å…¨ç»„ ï¼ŒåŠ å…¥ 3478 ï¼Œ50001â€”65535 2.æœ¬æœºçš„é˜²ç«å¢™ coturn å¼€å¯$ turnserver -o -c /usr/local/etc/turnserver.conf æµ‹è¯•æµ‹è¯•åœ°å€ï¼šhttps://webrtc.github.io/samples/src/content/peerconnection/trickle-ice/ 1.è¾“å…¥ï¼š STUN or TURN URI: turn:stun.wangzhumo.com TURN username: wangzhumo TURN password: webrtcpwd 2.Add Server 3.Gather candidates æµ‹è¯•ç»“æœï¼š Time Component Type Foundation Protocol Address Port Priority 0.003 rtp host 2749607730 udp 172.30.21.85 60720 126 | 30 | 255 7.794 rtp srflx 842163049 udp 221.221.255.18 33338 100 | 30 | 255 7.825 rtp relay 1676812102 udp 171.51.157.190 65032 2 | 30 | 255 7.825 Done 7.827 çœ‹åˆ°relayç±»å‹çš„å°±è¯´æ˜æˆåŠŸäº† END","categories":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/categories/Media/"}],"tags":[{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/tags/Server/"},{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"}]},{"title":"WireSharkä¸tcpdumpçš„å…¥é—¨ä½¿ç”¨è®°å½•","slug":"wireshark-dump-learn","date":"2019-10-23T11:46:35.000Z","updated":"2019-12-22T11:59:28.998Z","comments":true,"path":"2019/10/23/wireshark-dump-learn/","link":"","permalink":"https://www.wangzhumo.com/2019/10/23/wireshark-dump-learn/","excerpt":"åœ¨æˆ‘ä»¬å¼€å‘çš„è¿‡ç¨‹ä¸­,æœ‰äº›æ—¶å€™éœ€è¦æŸ¥çœ‹ç½‘ç»œä¼ è¾“è¿‡ç¨‹çš„ä¿¡æ¯ åœ¨æˆ‘å¹³æ—¶çš„å¼€å‘ä¸­,ç§»åŠ¨ç«¯ä»…ä»…ä½¿ç”¨Charleså°±å·²ç»èƒ½æ»¡è¶³æˆ‘æ‰€æœ‰éœ€è¦äº†.","text":"åœ¨æˆ‘ä»¬å¼€å‘çš„è¿‡ç¨‹ä¸­,æœ‰äº›æ—¶å€™éœ€è¦æŸ¥çœ‹ç½‘ç»œä¼ è¾“è¿‡ç¨‹çš„ä¿¡æ¯ åœ¨æˆ‘å¹³æ—¶çš„å¼€å‘ä¸­,ç§»åŠ¨ç«¯ä»…ä»…ä½¿ç”¨Charleså°±å·²ç»èƒ½æ»¡è¶³æˆ‘æ‰€æœ‰éœ€è¦äº†. åœ¨éŸ³è§†é¢‘çš„å¼€å‘è¿‡ç¨‹ä¸­,RTC,RTCP,Offer,Answerä¸­çš„sdpä»¥åŠä¿¡ä»¤æœåŠ¡ä¸­çš„socket éƒ½ä¸èƒ½ç®€å•çš„ä½¿ç”¨Charles,éœ€è¦æ›´åŠ åº•å±‚çš„å·¥å…·. è¿™æ—¶å€™å°±æ˜¯WireSharkå¤§æ˜¾èº«æ‰‹çš„æ—¶å€™,tcpdumpçš„è¾“å‡ºæ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥ç”¨WireSharkæ¥æŸ¥çœ‹çš„,è¿™é‡Œæˆ‘ä»…ä»…ç®€å•çš„è®°å½•ä¸€äº›ä½¿ç”¨æ–¹å¼,ç­‰åˆ°æˆ‘æ…¢æ…¢çš„æ·±å…¥ä½¿ç”¨ä»¥å,å†è¿›è¡Œæ›´æ·±å±‚çš„è®°å½•. tcpdumptcpdump -i eth0 src port 80 -xx -Xs 0 -w test.cap -i æŒ‡å®šç½‘å¡ src æŒ‡å®šåŒ…çš„æ¥æº port æŒ‡å®šç«¯å£å· -xx æŠ“å–åˆ°çš„åŒ…ä½¿ç”¨16è¿›åˆ¶æ˜¾ç¤º -X ä»¥ASCIIç æ˜¾ç¤º -s 0 æŠ“å–çš„åŒ…æ— é™åˆ¶,ä¹Ÿå°±æ˜¯æŠ“å–æ‰€æœ‰åŒ… -w å†™å…¥åˆ°æ–‡ä»¶ä¸­ wiresharké€»è¾‘è¿ç®— ä¸ : and æˆ–è€… &amp;&amp; æˆ– : or æˆ–è€… || é : not æˆ–è€… ! åˆ¤æ–­ ç­‰äº : eq æˆ– == å¤§äº : gt æˆ– &gt; å°äº : lt æˆ– &lt; å°äºç­‰äº : le æˆ–è€… &lt;= å¤§äºç­‰äº : ge æˆ–è€… &gt;= ä¸ç­‰äº : ne æˆ– != åè®®è¿‡æ»¤ stun udp tcp arp icmp http smtp ftp dns msnms ssl oicq æŒ‰ç…§httpè¿‡æ»¤ http.request.method == â€œGETâ€ http.request.method == â€œPOSTâ€ http.request.uri == â€œ/img/logo.pngâ€ http contains â€œGETâ€ http contains â€œHTTP/1.â€ æŒ‰IPè¿‡æ»¤ ip.dst == 192.168.1.1 å‘é€åˆ°çš„ç›®çš„IP ip.src == 192.168.2.13 æºIP Ip.addr == 192.168.2.23 æ‰€æœ‰è¯¥IPçš„é€šä¿¡, æºIP + ç›®çš„IP æŒ‰Portè¿‡æ»¤ tcp.port == 8080 udp.port == 8080 udp.dstport == 8080 udp.srcport == 8080 æŒ‰é•¿åº¦è¿‡æ»¤ udp.length &lt; 20 tcp.length &lt; 30 http.content_length &lt; 100","categories":[{"name":"Tools","slug":"Tools","permalink":"https://www.wangzhumo.com/categories/Tools/"}],"tags":[{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/tags/Server/"},{"name":"Http","slug":"Http","permalink":"https://www.wangzhumo.com/tags/Http/"}]},{"title":"TURNåè®®ç®€å•è®¤è¯†","slug":"turn-protocol-start","date":"2019-10-22T11:42:25.000Z","updated":"2019-12-22T11:44:56.077Z","comments":true,"path":"2019/10/22/turn-protocol-start/","link":"","permalink":"https://www.wangzhumo.com/2019/10/22/turn-protocol-start/","excerpt":"TURNç®€ä»‹Traversal Using Relays around NATï¼ˆTURNï¼‰ï¼šRelay Extensions to Session Traversal Utilities for NATï¼ˆSTUNï¼‰ä½¿ç”¨ä¸­ç»§ç©¿é€NATï¼šSTUNçš„ä¸­ç»§æ‰©å±•","text":"TURNç®€ä»‹Traversal Using Relays around NATï¼ˆTURNï¼‰ï¼šRelay Extensions to Session Traversal Utilities for NATï¼ˆSTUNï¼‰ä½¿ç”¨ä¸­ç»§ç©¿é€NATï¼šSTUNçš„ä¸­ç»§æ‰©å±• è§£å†³STUNä¸èƒ½ç©¿è¶ŠNATçš„æƒ…å†µ,é€šè¿‡TURNä¸­è½¬ å»ºç«‹åœ¨STUNæœåŠ¡ä¹‹ä¸Š,æ¶ˆæ¯æ ¼å¼ä½¿ç”¨STUNçš„è§„èŒƒ TURN Clientéœ€è¦TURNæœåŠ¡æä¾›ä¸€ä¸ªå…¬ç½‘IPä»¥åŠPortç”¨äºæ¥æ”¶/å‘é€æ•°æ® TURNä¸­è½¬https://tools.ietf.org/html/rfc5766#page-15 Peer A Server-Reflexive +---------+ Transport Address | | 192.0.2.150:32102 | | | /| | TURN | / ^| Peer A | Client&#39;s Server | / || | Host Transport Transport | // || | Address Address | // |+---------+ 10.1.1.2:49721 192.0.2.15:3478 |+-+ // Peer A | | ||N| / Host Transport | +-+ | ||A|/ Address | | | | v|T| 192.168.100.2:49582 | | | | /+-+ +---------+| | | |+---------+ / +---------+ | || |N| || | // | | | TURN |v | | v| TURN |/ | | | Client |----|A|----------| Server |------------------| Peer B | | | | |^ | |^ ^| | | | |T|| | || || | +---------+ | || +---------+| |+---------+ | || | | | || | | +-+| | | | | | | | | Client&#39;s | Peer B Server-Reflexive Relayed Transport Transport Address Transport Address Address 192.0.2.1:7000 192.0.2.15:50000 192.0.2.210:49191 Figure 1 TURNä¼ è¾“åè®® +----------------------------+---------------------+ | TURN client to TURN server | TURN server to peer | +----------------------------+---------------------+ | UDP | UDP | | TCP | UDP | | TLS over TCP | UDP | +----------------------------+---------------------+ TURN, as defined in this specification, always uses UDP between the server and the peer. However, this specification allows the use of any one of UDP, TCP, or Transport Layer Security (TLS) over TCP to carry the TURN messages between the client and the server. TURNçš„Allocate TURN TURN Peer Peer client server A B |-- Allocate request ---------------&gt;| | | | | | | |&lt;--------------- Allocate failure --| | | | (401 Unauthorized) | | | | | | | |-- Allocate request ---------------&gt;| | | | | | | |&lt;---------- Allocate success resp --| | | | (192.0.2.15:50000) | | | // // // // | | | | |-- Refresh request ----------------&gt;| | | | | | | |&lt;----------- Refresh success resp --| | | | | | | Figure 2 Clientå‘é€ä¸€ä¸ªAllocateåˆ°TURNæœåŠ¡ -&gt; æƒé‰´ -&gt; æˆåŠŸåº”ç­”(æºå¸¦åˆ†é…çš„IP:port) Refresh request å°±æ˜¯ä¿æ´» TURNä¸­è½¬ è¿™ä¸¤ç§æ–¹å¼æ˜¯å¯ä»¥åŒæ—¶ä½¿ç”¨çš„. Send And Data TURN TURN Peer Peer client server A B | | | | |-- CreatePermission req (Peer A) --&gt;| | | |&lt;-- CreatePermission success resp --| | | | | | | |--- Send ind (Peer A)--------------&gt;| | | | |=== data ===&gt;| | | | | | | |&lt;== data ====| | |&lt;-------------- Data ind (Peer A) --| | | | | | | | | | | |--- Send ind (Peer B)--------------&gt;| | | | | dropped | | | | | | | |&lt;== data ==================| | dropped | | | | | | | Figure 3 Client Send å®¢æˆ·ç«¯é€šè¿‡Send(Peer A) åˆ°TURNæœåŠ¡,æ­¤æ—¶æ‹¿åˆ°å…¶ä¸­çš„data(åŸå§‹çš„udpæ•°æ®) å°†data(åŸå§‹çš„udpæ•°æ®)ç›´æ¥è½¬åˆ°Peer A Client Data TRUNä¸­è½¬éœ€è¦å‘é€åˆ°å®¢æˆ·ç«¯çš„data,åŠ å…¥TURNå¤´ å®¢æˆ·ç«¯æ”¶åˆ°äº†TURNæœåŠ¡ä¸­è½¬çš„æ•°æ® Data ChannelTURN TURN Peer Peer client server A B | | | | |-- ChannelBind req ----------------&gt;| | | | (Peer A to 0x4001) | | | | | | | |&lt;---------- ChannelBind succ resp --| | | | | | | |-- [0x4001] data ------------------&gt;| | | | |=== data ===&gt;| | | | | | | |&lt;== data ====| | |&lt;------------------ [0x4001] data --| | | | | | | |--- Send ind (Peer A)--------------&gt;| | | | |=== data ===&gt;| | | | | | | |&lt;== data ====| | |&lt;------------------ [0x4001] data --| | | | | | | Figure 4 æˆ‘ä»¬ä½¿ç”¨Send / Dataçš„æ–¹å¼,æ¯æ¬¡éƒ½éœ€è¦ä¼ é€’ä¸€ä¸ª30å­—èŠ‚çš„æ•°æ®å¤´,è€—è´¹äº†æˆ‘ä»¬çš„å¸¦å®½ The client has already created an allocation and now wishes to bind a channel to Peer A å‘é€ä¸€ä¸ªç»‘å®šChannelçš„è¯·æ±‚(channel id 16è¿›åˆ¶çš„æ•°å­—) æˆåŠŸç»‘å®š ç›´æ¥å‘é€data -&gt; ä¸­è½¬ -&gt; Peer TURNæµç¨‹ STUN binding å‘ç»‘å®šè¯·æ±‚,è¿›è¡ŒNATçš„æ‰“é€š,æœåŠ¡æ‹¿åˆ°æ˜ å°„çš„åœ°å€ Caller TURN allocation allocation,è®©TURNåˆ†é…ä¸€ä¸ªå¯ç”¨çš„ä¸­ç»§åœ°å€ ip:port Caller send offer å‘¼å«è€…é€šè¿‡ä¿¡ä»¤,æŠŠè‡ªå·±çš„åª’ä½“,ç½‘ç»œä¿¡æ¯ä»¥SDPåè®®å‘é€ç»™å¯¹ç«¯ Callee(è¢«å‘¼å«è€…) TURN allocation è¢«å‘¼å«è€…ä¹Ÿéœ€è¦å‘é€allocation,è·å–ä¸­ç»§åœ°å€ Callee answer è¢«å‘¼å«è€…é€šè¿‡ä¿¡ä»¤,å‘é€è‡ªå·±çš„ä¿¡æ¯ Exchange candidate IP address äº¤æ¢åŒæ–¹çš„ä¿¡æ¯candidate,å¯ç”¨çš„å€™é€‰è€…åœ°å€ ICE check for P2P connection å…ˆæ£€æŸ¥æ•ˆç‡æœ€é«˜çš„p2pè¿æ¥ If P2P unsuccessful , make relay connection å¦‚æœP2Pä¸å¯ç”¨,åˆ™ä½¿ç”¨ä¸­ç»§æœåŠ¡","categories":[{"name":"WebRTC","slug":"WebRTC","permalink":"https://www.wangzhumo.com/categories/WebRTC/"}],"tags":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"},{"name":"WebRTC","slug":"WebRTC","permalink":"https://www.wangzhumo.com/tags/WebRTC/"}]},{"title":"STUNåè®®ç®€å•è®¤è¯†","slug":"stun-protocol-start","date":"2019-10-22T11:18:25.000Z","updated":"2019-12-22T11:40:45.075Z","comments":true,"path":"2019/10/22/stun-protocol-start/","link":"","permalink":"https://www.wangzhumo.com/2019/10/22/stun-protocol-start/","excerpt":"STUNç®€ä»‹ STUNä¸»è¦ç”¨äºNATçš„ç©¿è¶Š STUNä¹Ÿæ˜¯ä¸€ä¸ªc/sæ¶æ„","text":"STUNç®€ä»‹ STUNä¸»è¦ç”¨äºNATçš„ç©¿è¶Š STUNä¹Ÿæ˜¯ä¸€ä¸ªc/sæ¶æ„ STUNçš„è§„èŒƒRFC3489/STUNSimple Traversal of UDP Through NAT é€šè¿‡UDPå¯¹NATè¿›è¡Œç©¿è¶Š,ä½†æ˜¯ç°åœ¨å¯¹UDPçš„æ”¯æŒä¸å¥½,å› æ­¤æ•ˆæœä¸å¥½ RFC5389/STUNSession Traversal Utilities for NAT å®šä¹‰ä¸ºä¸€ç³»åˆ—çš„ç©¿è¶Šå·¥å…·,å·²ç»å’ŒRFC3489å®Œå…¨ä¸ä¸€è‡´äº†. UDP/TCPéƒ½ä½¿ç”¨,è¾¾åˆ°ç©¿è¶Šçš„ç›®çš„. STUNåè®®STUN Header 20ä¸ªå­—èŠ‚çš„STUN Header RFC3489 RFC5389 Figure 2 0 1 2 3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |0 0| STUN Message Type | Message Length | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Magic Cookie | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | | | Transaction ID (96 bits) | | | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Figure 2: Format of STUN Message Header ç±»å‹(2byte) 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 +--+--+-+-+-+-+-+-+-+-+-+-+-+-+ |M |M |M|M|M|C|M|M|M|C|M|M|M|M| |11|10|9|8|7|1|6|5|4|0|3|2|1|0| +--+--+-+-+-+-+-+-+-+-+-+-+-+-+ 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0x0001 ç»‘å®šæ¶ˆæ¯ 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0x0101 å“åº”æ¶ˆæ¯ 0 0 0 0 0 1 0 0 0 1 0 0 0 1 0x0111 é”™è¯¯æ¶ˆæ¯ Figure 3: Format of STUN Message Type Field RFC5389 Figure 3 å…¶ä¸­2ä¸ªå­—èŠ‚(16bit) 0-2å…±2ä½å›ºå®šä¸º00,å¦‚æœå¤ç”¨åŒä¸€ä¸ªç«¯å£,00å¤´è¡¨ç¤ºè¿™æ˜¯STUNåè®® 2-4å…±2ä½ç”¨äºåˆ†ç±» C0/C1 0b00 è¯·æ±‚ 0b01 æŒ‡ç¤º 0b10 æˆåŠŸçš„å“åº” 0b11 å¤±è´¥çš„å“åº” è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯,c0,c1å¹¶ä¸æ˜¯ä»…ä»…æŒ¨ç€çš„,éœ€è¦æŠŠ16è¿›åˆ¶æ•°å­—è½¬ä¸ºäºŒè¿›åˆ¶,ç„¶åçœ‹å¯¹åº”çš„ä½æ•° å›¾ä¸­å±•ç¤ºçš„æ˜¯å“åº”æ¶ˆæ¯,c0ä¹Ÿå°±æ˜¯ç¬¬5ä½æ˜¯0 4-16å…±12ä½ç”¨ä¸å®šä¹‰è¯·æ±‚/æŒ‡ç¤º æ¶ˆæ¯é•¿åº¦(2byte)æ¶ˆæ¯é•¿åº¦2ä¸ªå­—èŠ‚(16bit),æ³¨æ„å®ƒä¸åŒ…æ‹¬æ¶ˆæ¯å¤´çš„é•¿åº¦ äº‹åŠ¡ID(16byte)äº‹åŠ¡IDç”¨æ¥è¡¨ç¤ºæŸä¸€ä¸ªæ“ä½œ,è¯·æ±‚ä¸ç›¸åº”äº‹åŠ¡IDç›¸åŒ16ä¸ªå­—èŠ‚ (8bit * 16 = 128bit) 5389ä¸­,Transaction ID (96bit) + Magic Cookie(32bit) = 128bit Magic CookieåŒ…å«å›ºå®šå€¼0x2112A442 STUN Body æ¶ˆæ¯å¤´åæœ‰0æˆ–å¤šä¸ªå±æ€§ æ¯ä¸ªå±æ€§è¿›è¡ŒTLVç¼–ç  Type,Length,Value PS:32ä½å¯¹é½,ä¸è¶³çš„è¡¥0 TLV 0 1 2 3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Type | Length | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Value (variable) .... +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Figure 4: Format of STUN Attributes TYPEè¡¨ç¤ºå±æ€§çš„ç±»å‹,åªæœ‰ç¬¬ä¸€æ¬¡å‡ºç°çš„å±æ€§ä¼šè¢«æ¥æ”¶ç«¯è§£æï¼Œè€Œå…¶ä½™çš„å°†è¢«å¿½ç•¥ Typeå€¼åœ¨0x0000-0x7FFFä¹‹é—´çš„å±æ€§è¢«æŒ‡å®šä¸ºå¼ºåˆ¶ç†è§£,STUNç»ˆç«¯å¿…é¡»è¦ç†è§£æ­¤å±æ€§ Typeå€¼åœ¨0x8000-0xFFFFä¹‹é—´çš„å±æ€§ä¸ºé€‰æ‹©æ€§ç†è§£,å¦‚æœSTUNç»ˆç«¯ä¸è¯†åˆ«æ­¤å±æ€§åˆ™å°†å…¶å¿½ç•¥ 0x0001: MAPPED-ADDRESS 0x0002: RESPONSE-ADDRESS 0x0003: CHANGE-REQUEST 0x0004: SOURCE-ADDRESS 0x0005: CHANGED-ADDRESS 0x0006: USERNAME 0x0007: PASSWORD 0x0008: MESSAGE-INTEGRITY 0x0009: ERROR-CODE 0x000a: UNKNOWN-ATTRIBUTES 0x000b: REFLECTED-FROM MAPPED-ADDRESSï¼šMAPPED-ADDRESSå±æ€§è¡¨ç¤ºæ˜ å°„è¿‡çš„IPåœ°å€å’Œç«¯å£ã€‚å®ƒåŒ…æ‹¬8ä½çš„åœ°å€æ—ï¼Œ16ä½çš„ç«¯å£å·åŠé•¿åº¦å›ºå®šçš„IPåœ°å€ã€‚ RESPONSE-ADDRESSï¼šRESPONSE-ADDRESSå±æ€§è¡¨ç¤ºå“åº”çš„ç›®çš„åœ°å€ CHASNGE-REQUESTï¼šå®¢æˆ·ä½¿ç”¨32ä½çš„CHANGE-REQUESTå±æ€§æ¥è¯·æ±‚æœåŠ¡å™¨ä½¿ç”¨ä¸åŒçš„åœ°å€æˆ–ç«¯å£å·æ¥å‘é€å“åº”ã€‚ SOURCE-ADDRESSï¼šSOURCE-ADDRESSå±æ€§å‡ºç°åœ¨æ†ç»‘å“åº”ä¸­ï¼Œå®ƒè¡¨ç¤ºæœåŠ¡å™¨å‘é€å“åº”çš„æºIPåœ°å€å’Œç«¯å£ã€‚ CHANGED-ADDRESSï¼šå¦‚æœæ†ç»‘è¯·æ±‚çš„CHANGE-REQUESTå±æ€§ä¸­çš„â€œæ”¹å˜IPâ€å’Œâ€œæ”¹å˜ç«¯å£â€æ ‡å¿—è®¾ç½®äº†ï¼Œåˆ™CHANGED-ADDRESSå±æ€§è¡¨ç¤ºå“åº”å‘å‡ºçš„IPåœ°å€å’Œç«¯å£å·ã€‚ USERNAMEï¼šUSERNAMEå±æ€§ç”¨äºæ¶ˆæ¯çš„å®Œæ•´æ€§æ£€æŸ¥ï¼Œç”¨äºæ¶ˆæ¯å®Œæ•´æ€§æ£€æŸ¥ä¸­æ ‡è¯†å…±äº«ç§å¯†ã€‚USERNAMEé€šå¸¸å‡ºç°åœ¨å…±äº«ç§å¯†å“åº”ä¸­ï¼Œä¸PASSWORDä¸€èµ·ã€‚å½“ä½¿ç”¨æ¶ˆæ¯å®Œæ•´æ€§æ£€æŸ¥æ—¶ï¼Œå¯æœ‰é€‰æ‹©åœ°å‡ºç°åœ¨æ†ç»‘è¯·æ±‚ä¸­ã€‚ PASSWORDï¼šPASSWORDå±æ€§ç”¨åœ¨å…±äº«ç§å¯†å“åº”ä¸­ï¼Œä¸USERNAMEä¸€èµ·ã€‚PASSWORDçš„å€¼æ˜¯å˜é•¿çš„ï¼Œç”¨ä½œå…±äº«ç§å¯†ï¼Œå®ƒçš„é•¿åº¦å¿…é¡»æ˜¯4å­—èŠ‚çš„å€æ•°ï¼Œä»¥ä¿è¯å±æ€§ä¸è¾¹ç•Œå¯¹é½ã€‚ MESSAGE-INTEGRITYï¼šMESSAGE-INTEGRITYå±æ€§åŒ…å«STUNæ¶ˆæ¯çš„HMAC-SHA1ï¼Œå®ƒå¯ä»¥å‡ºç°åœ¨æ†ç»‘è¯·æ±‚æˆ–æ†ç»‘å“åº”ä¸­ï¼›MESSAGE-INTEGRITYå±æ€§å¿…é¡»æ˜¯ä»»ä½•STUNæ¶ˆæ¯çš„æœ€åä¸€ä¸ªå±æ€§ã€‚å®ƒçš„å†…å®¹å†³å®šäº†HMACè¾“å…¥çš„Keyå€¼ã€‚ ERROR-CODEï¼šERROR-CODEå±æ€§å‡ºç°åœ¨æ†ç»‘é”™è¯¯å“åº”æˆ–å…±äº«ç§å¯†é”™è¯¯å“åº”ä¸­ã€‚å®ƒçš„å“åº”å·æ•°å€¼èŒƒå›´ä»100åˆ°699ã€‚ UNKNOWN-ATTRIBUTESï¼šUNKNOWN-ATTRIBUTESå±æ€§åªå­˜åœ¨äºå…¶ERROR-CODEå±æ€§ä¸­çš„å“åº”å·ä¸º420çš„æ†ç»‘é”™è¯¯å“åº”æˆ–å…±äº«ç§å¯†é”™è¯¯å“åº”ä¸­ã€‚ REFLECTED-FROMï¼šREFLECTED-FROMå±æ€§åªå­˜åœ¨äºå…¶å¯¹åº”çš„æ†ç»‘è¯·æ±‚åŒ…å«RESPONSE-ADDRESSå±æ€§çš„æ†ç»‘å“åº”ä¸­ã€‚å±æ€§åŒ…å«è¯·æ±‚å‘å‡ºçš„æºIPåœ°å€ï¼Œå®ƒçš„ç›®çš„æ˜¯æä¾›è·Ÿè¸ªèƒ½åŠ›ï¼Œè¿™æ ·STUNå°±ä¸èƒ½è¢«ç”¨ä½œDOSæ”»å‡»çš„åå°„å™¨ã€‚ Attributesçš„ä½¿ç”¨ä½ç½® Binding Shared Shared Shared Binding Binding Error Secret Secret Secret Att. Req. Resp. Resp. Req. Resp. Error Resp. _____________________________________________________________________ MAPPED-ADDRESS N/A M N/A N/A N/A N/A RESPONSE-ADDRESS O N/A N/A N/A N/A N/A CHANGE-REQUEST O N/A N/A N/A N/A N/A SOURCE-ADDRESS N/A M N/A N/A N/A N/A CHANGED-ADDRESS N/A M N/A N/A N/A N/A USERNAME O N/A N/A N/A M N/A PASSWORD N/A N/A N/A N/A M N/A MESSAGE-INTEGRITY O O N/A N/A N/A N/A ERROR-CODE N/A N/A M N/A N/A M UNKNOWN-ATTRIBUTES N/A N/A C N/A N/A C REFLECTED-FROM N/A C N/A N/A N/A N/A MAPPED-ADDRESSNATå®¢æˆ·ç«¯çš„åå°„åœ°å€,Familyä¸ºIPç±»å‹ï¼Œå³IPV4(0x01)æˆ–IPV6(0x02)ï¼ŒPortä¸ºç«¯å£ï¼ŒAddressä¸º32ä½æˆ–128ä½çš„IPåœ°å€ã€‚æ³¨æ„é«˜8ä½å¿…é¡»å…¨éƒ¨ç½®é›¶ï¼Œ 0 1 2 3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |0 0 0 0 0 0 0 0| Family | Port | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | | | Address (32 bits or 128 bits) | | | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Figure 5: Format of MAPPED-ADDRESS Attribute","categories":[{"name":"WebRTC","slug":"WebRTC","permalink":"https://www.wangzhumo.com/categories/WebRTC/"}],"tags":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"},{"name":"WebRTC","slug":"WebRTC","permalink":"https://www.wangzhumo.com/tags/WebRTC/"}]},{"title":"JNI è®¤è¯†JNIçš„åŸºæœ¬æ¦‚å¿µ","slug":"jni-basic-conception","date":"2018-10-28T12:32:20.000Z","updated":"2019-11-26T11:53:47.436Z","comments":true,"path":"2018/10/28/jni-basic-conception/","link":"","permalink":"https://www.wangzhumo.com/2018/10/28/jni-basic-conception/","excerpt":"","text":"JNIEnvåœ¨Androidçš„ä¸–ç•Œä¸­,æˆ‘ä»¬ç¼–å†™å®Œæˆçš„æºä»£ç éƒ½è¢«ç¼–è¯‘æˆclassæ–‡ä»¶ï¼Œè€ŒAndroidåˆä¸ºäº†é¿å…ä¸€äº›é—®é¢˜ï¼Œæä¾›äº†Dalvik VMï¼ŒDalvikè™šæ‹Ÿæœºè´Ÿè´£æŠŠdexæ–‡ä»¶è½½å…¥ã€‚ é‚£ä¹ˆ .so æ–‡ä»¶æ€ä¹ˆè¿è¡Œé‚£ï¼Ÿ è‚¯å®šä¹Ÿæ˜¯è¦åœ¨Dalvik VMä¸­çš„,è¦ä¸æ€ä¹ˆäº’ç›¸è°ƒç”¨é‚£ï¼Ÿæ€»ä¸èƒ½é æ„å¿µæŠŠ","categories":[{"name":"JNI","slug":"JNI","permalink":"https://www.wangzhumo.com/categories/JNI/"}],"tags":[{"name":"JNI","slug":"JNI","permalink":"https://www.wangzhumo.com/tags/JNI/"}]},{"title":"JNI-ä»Android Studioé»˜è®¤å·¥ç¨‹è®¤è¯†JNI","slug":"taste-jni-default-project","date":"2018-10-28T12:12:17.000Z","updated":"2019-11-07T13:22:53.793Z","comments":true,"path":"2018/10/28/taste-jni-default-project/","link":"","permalink":"https://www.wangzhumo.com/2018/10/28/taste-jni-default-project/","excerpt":"å‰è¨€å¯¹äºJNI,Googleä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…¥é—¨æ–‡æ¡£ https://developer.android.com/ndk/guides/ æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨JNIé‚£ï¼ŸGoogleå·²ç»å¾ˆæ˜ç¡®çš„ä¸ºæˆ‘ä»¬æŒ‡æ˜äº†ï¼š åœ¨å¹³å°ä¹‹é—´ç§»æ¤å…¶åº”ç”¨ã€‚ é‡å¤ä½¿ç”¨ç°æœ‰åº“ï¼Œæˆ–è€…æä¾›å…¶è‡ªå·±çš„åº“ä¾›é‡å¤ä½¿ç”¨ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹æé«˜æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åƒæ¸¸æˆè¿™ç§è®¡ç®—å¯†é›†å‹åº”ç”¨ã€‚","text":"å‰è¨€å¯¹äºJNI,Googleä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…¥é—¨æ–‡æ¡£ https://developer.android.com/ndk/guides/ æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨JNIé‚£ï¼ŸGoogleå·²ç»å¾ˆæ˜ç¡®çš„ä¸ºæˆ‘ä»¬æŒ‡æ˜äº†ï¼š åœ¨å¹³å°ä¹‹é—´ç§»æ¤å…¶åº”ç”¨ã€‚ é‡å¤ä½¿ç”¨ç°æœ‰åº“ï¼Œæˆ–è€…æä¾›å…¶è‡ªå·±çš„åº“ä¾›é‡å¤ä½¿ç”¨ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹æé«˜æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åƒæ¸¸æˆè¿™ç§è®¡ç®—å¯†é›†å‹åº”ç”¨ã€‚ æœ¬æ¥æ˜¯æ‰“ç®—å­¦ä¹ NDKçš„è€ä¸€å¥—çš„ï¼Œä¸è¿‡æœ€è¿‘å­¦ä¹ çš„è¯¾ç¨‹åˆšå¥½è®²åˆ°è¿™ä¸ªéƒ¨åˆ†ï¼Œä½¿ç”¨CMakeçš„æ–¹å¼çš„ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥å­¦ä¹ æœ€æ–°çš„JNIä½¿ç”¨æ–¹å¼äº†ã€‚ å·¥ç¨‹ç»“æ„. â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ build.gradle â””â”€â”€ src â”œâ”€â”€ main â”œâ”€â”€ AndroidManifest.xml â”œâ”€â”€ cpp â”‚ â””â”€â”€ native-lib.cpp â”œâ”€â”€ java å½“æˆ‘ä»¬åˆ›å»ºå¥½ä¸€ä¸ªæ”¯æŒC++çš„Androidé¡¹ç›®åï¼Œä¼šå¾—åˆ°è¿™æ ·çš„ä¸€ä¸ªé¡¹ç›®ç»“æ„ï¼ˆä¸é‡è¦çš„çœç•¥æ‰äº†ï¼‰ CMakeLists.txt æ˜¯CMakeçš„é…ç½®æ–‡ä»¶ build.gradle Androidçš„æ„å»ºå·¥å…· Src æ˜¯Java &amp; C çš„æºç æ–‡ä»¶ç›®å½• cpp æ˜¯Cæºç  java æ˜¯Javaçš„æºç  CMakeLists.txt# Sets the minimum version of CMake required to build the native library. cmake_minimum_required(VERSION 3.4.1) # æ ¹æ®Cæ–‡ä»¶ç”Ÿæˆåº“æ–‡ä»¶ # å¯ä»¥æ·»åŠ å…¶ä»–çš„éç³»ç»Ÿåº“ add_library( # Sets the name of the library. native-lib # Sets the library as a shared(åŠ¨æ€åº“) library. SHARED # Provides a relative path to your source(æºæ–‡ä»¶) file(s). src/main/cpp/native-lib.cpp) # æ·»åŠ ä½ éœ€è¦ä½¿ç”¨çš„ç³»ç»Ÿåº“ find_library( # Sets the name of the path variable. log-lib # Specifies(æŒ‡å®šä¸€ä¸ªåå­—) the name of the NDK library that # you want CMake to locate. log) # å°†åº“é“¾æ¥èµ·æ¥ # ä¸‹é¢å†™ä½ éœ€è¦é“¾æ¥çš„åº“ target_link_libraries( # Specifies the target library. native-lib # Links the target library to the log library # included in the NDK. ${log-lib}) å½“ä½ ç¼–è¯‘æˆåŠŸåï¼Œå¯ä»¥åœ¨app/build/intermediates/cmake/çš„ç›®å½•ä¸‹çœ‹åˆ°ä½ ç¼–è¯‘æˆåŠŸç”Ÿæˆçš„.soæ–‡ä»¶ Androidéƒ¨åˆ†public class MainActivity extends AppCompatActivity { // Used to load the &#39;native-lib&#39; library on application startup. // æŠŠåº“è¯»å–åˆ°javaä¸­æ¥ libnative-lib.so ,æ³¨æ„è¦å»æ‰libè¿™ä¸ªå‰ç¼€ static { System.loadLibrary(&quot;native-lib&quot;); } @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); // Example of a call to a native method TextView tv = (TextView) findViewById(R.id.sample_text); // å¯ä»¥çœ‹åˆ°è¿™é‡Œç›´æ¥è°ƒç”¨äº† Â·nativeÂ· æ–¹æ³• tv.setText(stringFromJNI()); } /** * A native method that is implemented by the &#39;native-lib&#39; native library, * which is packaged with this application. */ public native String stringFromJNI(); } nativeéƒ¨åˆ†#include &lt;jni.h&gt; #include &lt;string&gt; extern &quot;C&quot; JNIEXPORT jstring JNICALL Java_com_wangzhumo_jni_MainActivity_stringFromJNI( //æ³¨æ„è¿™ä¸ª,æ˜¯åˆ¶å®šçš„æ ¼å¼ // javahå¯ä»¥ç”Ÿæˆ or æ‰‹å†™ JNIEnv *env, jobject /* this */) { std::string hello = &quot;Hello from C++&quot;; return env-&gt;NewStringUTF(hello.c_str()); }","categories":[{"name":"JNI","slug":"JNI","permalink":"https://www.wangzhumo.com/categories/JNI/"}],"tags":[{"name":"JNI","slug":"JNI","permalink":"https://www.wangzhumo.com/tags/JNI/"}]},{"title":"è®¤è¯†æ—¶åŸŸä¸é¢‘åŸŸ","slug":"time-and-frequency-domain","date":"2018-09-21T11:11:18.000Z","updated":"2019-12-22T12:06:02.778Z","comments":true,"path":"2018/09/21/time-and-frequency-domain/","link":"","permalink":"https://www.wangzhumo.com/2018/09/21/time-and-frequency-domain/","excerpt":"","text":"å‰è¨€æˆ‘ä¹Ÿæ²¡æƒ³åˆ°æˆ‘æœ‰ä¸€å¤©ä¼šæ¡èµ·è¿™äº›ä¸œè¥¿ï¼Œæˆ‘ä¸€ä¸ªæ•°å­¦å¼±é¸¡å‹åŠ›å±±å¤§ã€‚ èµ·å› æ˜¯æœ€è¿‘åœ¨å­¦ä¹ éŸ³è§†é¢‘å¼€å‘ï¼Œæˆ‘å‘ç°ä¸€æ¶‰åŠåˆ°ç†è®ºçŸ¥è¯†è¿™å—ï¼Œæ€»ä¼šæœ‰å‡ ä¸ª æ—¶åŸŸï¼Œé¢‘åŸŸï¼Œå‚…é‡Œå¶å˜åŒ–è¿™æ ·çš„åè¯å‡ºç°ï¼Œæˆ‘èƒ½æ€ä¹ˆåŠï¼Œå­¦å‘— é“¾æ¥ï¼š ä¿¡å·é¢‘åŸŸå’Œæ—¶åŸŸçš„å…³ç³»ï¼Ÿ https://www.zhihu.com/question/21040374 æƒ³å­¦ä¹ ä¸€ä¸ªä¸œè¥¿ï¼Œé¦–å…ˆè¦ææ˜ç™½æ˜¯ä»€ä¹ˆï¼Ÿç„¶åæ‰èƒ½ç»§ç»­å»è®¤è¯†å®ƒã€‚ è€Œæˆ‘å§‹ç»ˆè®¤ä¸ºï¼Œå­¦ä¹ ä¹Ÿæ˜¯ç”±æµ…å…¥æ·±çš„ï¼Œç”±ç‚¹åŠé¢çš„ï¼Œä¸å¯èƒ½ä¸€ä¸Šæ¥å°±è®¤è¯†åˆ°äº†å®ƒçš„æ ¸å¿ƒç†è®ºã€‚ ç®€å•çš„è®¤è¯† @èˆªç©ºèˆªå¤©è¿· https://www.zhihu.com/people/jin-it/activities è¿™ä½å¤§å…„å¼Ÿçš„å›¾æ˜¯æˆ‘çš„å¯è’™ã€‚ è¿™å¼ å›¾å°±æ˜¯ä¸€ä¸ªæ—¶åŸŸå›¾ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ­£å¼¦æ³¢ï¼Œxè½´ä¸Šæ˜¯æ—¶é—´çš„å˜åŒ–ï¼Œyè½´å°±æ˜¯æŒ¯å¹…äº† é¢‘ç‡ ï¼š6Hz æŒ¯å¹… ï¼š5V è¿™é‡Œå°±æ˜¯å›¾1ä¸­æ­£å¼¦æ³¢çš„é¢‘åŸŸå›¾ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°xè½´æ˜¯é¢‘ç‡äº†ï¼Œyè½´å°±æ˜¯æŒ¯å¹…äº† å…¶ä¸­ç»¿è‰²çš„çº¿ï¼Œå…¶xè½´çš„äº¤ç‚¹æ˜¯æŒ‡è¿™ä¸ªæ­£å¼¦æ³¢çš„é¢‘ç‡æ˜¯6,å®ƒçš„é«˜åº¦å°±æ˜¯è¿™ä¸ªæ­£å¼¦æ³¢çš„æ³¢å³°äº†5V è¿›ä¸€æ­¥è®¤è¯†æ¥è‡ªï¼š @ä¸€äºŒ https://www.zhihu.com/people/yier-64/activities https://zh.wikipedia.org/wiki/%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2# å‚…é‡Œå¶å˜æ¢å°†å‡½æ•°çš„æ—¶åŸŸï¼ˆçº¢è‰²ï¼‰ä¸é¢‘åŸŸï¼ˆè“è‰²ï¼‰ç›¸å…³è” åˆšå¼€å§‹çš„æ—¶å€™æˆ‘æ²¡çœ‹å‰é¢ @èˆªç©ºèˆªå¤©è¿·çš„ç­”æ¡ˆï¼Œç›´æ¥åœ¨CSDNä¸ŠæŸ¥çš„ï¼Œç„¶åå°±æˆ‘æ‡µé€¼äº†ã€‚ https://blog.csdn.net/jiujiaobusiniao/article/details/53321491 ç›¯ç€è¿™å‡ å¼ å›¾çœ‹äº†å¾ˆä¹…ï¼Œå¾ˆä¹…ã€‚ã€‚ã€‚ å¼€å§‹ç†è§£ @Heinrich https://www.zhihu.com/people/Erdnussoelbearbeiter/activities å‚…é‡Œå¶åˆ†æä¹‹ææ­»æ•™ç¨‹ https://zhuanlan.zhihu.com/p/19763358?refer=wille çœŸçš„æ˜¯ç»™å¤§ä½¬é€’çƒŸã€‚ å¤§ä½¬ï¼Œç« ä¸‹ä¸€æ­¥æˆ‘ä»¬å°±çœ‹çœ‹å‚…é‡Œå¶å˜æ¢","categories":[{"name":"Other","slug":"Other","permalink":"https://www.wangzhumo.com/categories/Other/"}],"tags":[{"name":"frequency","slug":"frequency","permalink":"https://www.wangzhumo.com/tags/frequency/"}]},{"title":"éŸ³è§†é¢‘-FFmpegçš„ç¼–è¯‘ä¸å®‰è£…","slug":"ffmpeg-build-install","date":"2018-09-20T02:31:07.000Z","updated":"2019-11-07T13:25:14.576Z","comments":true,"path":"2018/09/20/ffmpeg-build-install/","link":"","permalink":"https://www.wangzhumo.com/2018/09/20/ffmpeg-build-install/","excerpt":"å‰è¨€æ­£å¦‚FFmpegçš„ç®€ä»‹æ‰€è¯´ FFmpeg is a collection of libraries and tools to process multimedia content such as audio, video, subtitles and related metadata. FFmpegåœ¨éŸ³è§†é¢‘é¢†åŸŸç®—å¾—ä¸Šæ˜¯é›†å¤§æˆè€…ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œå¹¶ä¸”å¯ä»¥è‡ªè¡Œæ›¿æ¢æ·»åŠ ç¼–ç æ ‡å‡†ç­‰ å¯ä»¥åšåˆ°å½•åˆ¶ï¼Œæ’­æ”¾ï¼Œè§£ç ï¼Œè½¬ç ï¼Œæ»¤é•œç­‰ç­‰ï¼Œæ‰€ä»¥å®ƒè¢«å¾ˆå¤šå…¬å¸é‡‡ç”¨ã€‚","text":"å‰è¨€æ­£å¦‚FFmpegçš„ç®€ä»‹æ‰€è¯´ FFmpeg is a collection of libraries and tools to process multimedia content such as audio, video, subtitles and related metadata. FFmpegåœ¨éŸ³è§†é¢‘é¢†åŸŸç®—å¾—ä¸Šæ˜¯é›†å¤§æˆè€…ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œå¹¶ä¸”å¯ä»¥è‡ªè¡Œæ›¿æ¢æ·»åŠ ç¼–ç æ ‡å‡†ç­‰ å¯ä»¥åšåˆ°å½•åˆ¶ï¼Œæ’­æ”¾ï¼Œè§£ç ï¼Œè½¬ç ï¼Œæ»¤é•œç­‰ç­‰ï¼Œæ‰€ä»¥å®ƒè¢«å¾ˆå¤šå…¬å¸é‡‡ç”¨ã€‚ libavcodec ç¼–è§£ç . libavformat éŸ³è§†é¢‘çš„è§£å°è£… libavutil å·¥å…·å‡½æ•° libavfilter éŸ³è§†é¢‘æ»¤æ³¢å™¨ï¼ˆæ»¤é•œï¼‰ libavdevice ç¡¬ä»¶çš„éŸ³è§†é¢‘é‡‡é›†ã€åŠ é€Ÿå’Œæ˜¾ç¤º libswresample é‡é‡‡æ ·ï¼Œé‡‡æ ·æ ¼å¼è½¬æ¢å’Œæ··åˆ libswscale åŸå§‹è§†é¢‘çš„ç¼©æ”¾ï¼Œè‰²å½©æ˜ å°„è½¬æ¢ï¼Œå›¾åƒé¢œè‰²ç©ºé—´æˆ–æ ¼å¼è½¬æ¢ FFmpeg å®˜æ–¹ç½‘ç«™ https://ffmpeg.org/ Github https://github.com/FFmpeg/FFmpeg Homebrew# phyooos @ wangzhumo in ~ [20:58:24] C:127 $ brew install ffmpeg --with-sdl2 --with-fdk-aac --with-freetype --with-libass --with-libvorbis --with-libvpx --with-opus --with-x265 #ç»è¿‡ä¸€æ®µæ—¶é—´çš„ä¸‹è½½ ==&gt; ./configure --prefix=/usr/local/Cellar/ffmpeg/4.0.2 --enable-shared --enable-pthreads --ena ==&gt; make install ğŸº /usr/local/Cellar/ffmpeg/4.0.2: 251 files, 53.2MB, built in 8 minutes 1 second #å¥½äº†å·²ç»å®‰è£…æˆåŠŸäº† æ³¨æ„--with-sdl2 å…¶å®å°±æ˜¯ffplay --with-ffplayå·²ç»è¿‡æ—¶è¢«--with-sdl2æ›¿ä»£äº†ï¼Œæ‰€ä»¥ä¸€å®šè¦æ›¿æ¢æ‰ï¼Œè¦ä¸ç„¶ffplayçš„å®‰è£…ä¼šå¤±è´¥ å¦‚æœä½ ä¸æƒ³è‡ªå·±æ‰‹åŠ¨ç¼–è¯‘å®‰è£…ï¼Œé‚£ä¹ˆè¿™é‡Œå·²ç»å¤Ÿäº†ï¼Œä¸‹æ–‡æ˜¯æ‰‹åŠ¨çš„ç¼–è¯‘å®‰è£…è®°å½•ã€‚ ç¼–è¯‘ä¸‹è½½å®˜æ–¹ç½‘ç«™ï¼š http://ffmpeg.org/download.html ä¸‹è½½è§£å‹ï¼Œç›®å½•ffmpeg Git: git clone https://git.ffmpeg.org/ffmpeg.git ffmpeg å‡†å¤‡å…¶ä»–åº“brew insatll brew install pkg-config brew install speex brew install x264 brew install x265 brew install libsoxr opencore https://sourceforge.net/projects/opencore-amr/ $ ./configure $ make $ make install fdk-acc https://sourceforge.net/projects/opencore-amr/files/fdk-aac/ ##### ç¼–è¯‘å¼€å§‹ç¼–å†™build_mac_os.sh#è¿›å…¥ffmpegç›®å½• cd ~/ffmpeg #åˆ›å»ºæ–‡ä»¶build_mac_os.sh vim ./build_mac_os.sh #æ–‡ä»¶å†™å…¥ ./configure --cc=/usr/bin/clang \\ --prefix=/usr/local/ffmpeg \\ --enable-gpl \\ --enable-nonfree \\ --enable-libfdk-aac \\ --enable-libx264 \\ --enable-libmp3lame \\ --enable-libopencore-amrnb \\ --enable-libopencore-amrwb \\ --enable-libx265 \\ --enable-filter=delogo \\ --enable-debug \\ --disable-optimizations \\ --enable-libspeex \\ --enable-videotoolbox \\ --enable-shared \\ --enable-pthreads \\ --enable-version3 \\ --enable-hardcoded-tables \\ --host-cflags= \\ --host-ldflags= make clean #æ‰§è¡Œæ–‡ä»¶ sudo ./build_mac_os.sh å®‰è£…make &amp;&amp; make installç­‰å¾…ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™ make &amp;&amp; make install ä½¿ç”¨ç®€å•çš„å½•å±æŸ¥æ‰¾è®¾å¤‡# phyooos @ wangzhumo in ~ [10:51:09] C:1 $ ffmpeg -f avfoundation -list_devices true -i &quot;&quot; # æ³¨æ„ä¸Šé¢å‘½ä»¤-i çš„å‚æ•°å°±æ˜¯ â€â€œ åˆ«å¿˜äº† #è¾“å‡ºï¼š #... [AVFoundation input device @ 0x7fe495402280] AVFoundation video devices: [AVFoundation input device @ 0x7fe495402280] [0] FaceTime HD Camera [AVFoundation input device @ 0x7fe495402280] [1] Capture screen 0 [AVFoundation input device @ 0x7fe495402280] [2] Capture screen 1 [AVFoundation input device @ 0x7fe495402280] AVFoundation audio devices: [AVFoundation input device @ 0x7fe495402280] [0] Built-in Microphone : Input/output error å¯ä»¥çœ‹åˆ°AVFoundation video devicesçš„è®¾å¤‡æœ‰3ä¸ª [0] æ‘„åƒå¤´ [1] å±å¹•1 [2] å±å¹•2 å½•åˆ¶ffmpeg -f avfoundation -i 1 -r 30 ~/Downloads/out.yuv ä½¿ç”¨Ctrl + cç»ˆæ­¢å½•åˆ¶ -f ä½¿ç”¨ avfoundationæ¥å½•åˆ¶ -i æŒ‡å®šäº†å½“å‰ç”¨æ¥å½•åˆ¶çš„è®¾å¤‡ï¼Œè¿™é‡Œçš„1 -r å¸§ç‡30 out.yuv è¾“å‡ºæ–‡ä»¶ ç®€å•çš„æ’­æ”¾åœ¨å½•åˆ¶è¿‡ç¨‹ä¸­ï¼Œæœ‰æ‰“å°å½•åˆ¶çš„å‚æ•° Metadata: encoder : Lavf58.12.100 Stream #0:0: Video: rawvideo (UYVY / 0x59565955), uyvy422, 2880x1800, q=2-31, 2488320 kb/s, 30 fps, 30 tbn, 30 tbc æˆ‘ä»¬ä½¿ç”¨ffplayè¿›è¡Œæ’­æ”¾ ffplay -s 2880x1800 -pixel_format uyvy422 ~/Downloads/out.yuv -s æŒ‡å®šåˆ†è¾¨ç‡ -pixel_format ç¼–ç æ ¼å¼ æ·»åŠ è‡³ç¯å¢ƒå˜é‡","categories":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/categories/Media/"}],"tags":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"},{"name":"FFmpeg","slug":"FFmpeg","permalink":"https://www.wangzhumo.com/tags/FFmpeg/"}]},{"title":"éŸ³è§†é¢‘-éŸ³é¢‘çš„åŸºç¡€ç†è®º","slug":"multimedia-learn-audio-base","date":"2018-09-08T05:19:29.000Z","updated":"2019-11-07T13:24:17.979Z","comments":true,"path":"2018/09/08/multimedia-learn-audio-base/","link":"","permalink":"https://www.wangzhumo.com/2018/09/08/multimedia-learn-audio-base/","excerpt":"å‰è¨€å£°éŸ³å­¦è¿‡ç‰©ç†çš„æˆ‘ä»¬éƒ½çŸ¥é“,å£°éŸ³å…¶å®å°±æ˜¯ä¸€ç§ç‰©ä½“çš„éœ‡åŠ¨ è€Œå£°éŸ³æœ‰ä¸‰è¦ç´ : é¢‘ç‡,æŒ¯å¹…,æ³¢å½¢ é¢‘ç‡,ä»£è¡¨ç€å£°éŸ³çš„éŸ³é˜¶é«˜ä½ æŒ¯å¹…,æ ‡å¿—ç€éŸ³å£°çš„å“åº¦ æ³¢å½¢,æ—¢æ˜¯å£°è‰² é‚£ä¹ˆéŸ³é¢‘ä¿¡å·è¦åšçš„å°±æ˜¯æŠŠè¿™äº›éœ‡åŠ¨è½¬åŒ–ä¸ºæ•°å­—ä¿¡å·,å¯¹æ¨¡æ‹Ÿä¿¡å·è¿›è¡Œé‡‡æ ·,åœ¨æ—¶é—´è½´ä¸Šå¯¹æ¨¡æ‹Ÿä¿¡å·æ•°å­—åŒ–,æ ¹æ®é‡‡æ ·çš„é¢‘ç‡,æ¯ä¸€ç§’å¯¹æ¨¡æ‹Ÿä¿¡å·é‡‡æ ·næ¬¡.","text":"å‰è¨€å£°éŸ³å­¦è¿‡ç‰©ç†çš„æˆ‘ä»¬éƒ½çŸ¥é“,å£°éŸ³å…¶å®å°±æ˜¯ä¸€ç§ç‰©ä½“çš„éœ‡åŠ¨ è€Œå£°éŸ³æœ‰ä¸‰è¦ç´ : é¢‘ç‡,æŒ¯å¹…,æ³¢å½¢ é¢‘ç‡,ä»£è¡¨ç€å£°éŸ³çš„éŸ³é˜¶é«˜ä½ æŒ¯å¹…,æ ‡å¿—ç€éŸ³å£°çš„å“åº¦ æ³¢å½¢,æ—¢æ˜¯å£°è‰² é‚£ä¹ˆéŸ³é¢‘ä¿¡å·è¦åšçš„å°±æ˜¯æŠŠè¿™äº›éœ‡åŠ¨è½¬åŒ–ä¸ºæ•°å­—ä¿¡å·,å¯¹æ¨¡æ‹Ÿä¿¡å·è¿›è¡Œé‡‡æ ·,åœ¨æ—¶é—´è½´ä¸Šå¯¹æ¨¡æ‹Ÿä¿¡å·æ•°å­—åŒ–,æ ¹æ®é‡‡æ ·çš„é¢‘ç‡,æ¯ä¸€ç§’å¯¹æ¨¡æ‹Ÿä¿¡å·é‡‡æ ·næ¬¡. è®¤è¯†PCMPCMæ—¢ç„¶è¦æŠŠå£°éŸ³é‡‡é›†ä¸ºæ•°å­—ä¿¡å·,é‚£ä¹ˆè‚¯å®šå°±æœ‰ä¸€ç§ç¼–ç çš„æ ¼å¼,è€Œå¸¸ç”¨çš„å°±æ˜¯PCM(Pulse Code Modulation)è„‰å†²ç¼–ç è°ƒåˆ¶æ ¼å¼. PCMè¿˜æœ‰å‡ ä¸ªå…³é”®çš„æ¦‚å¿µ,å®ƒä»¬å…±åŒæè¿°äº†ä¸€æ®µPCMçš„æ•°æ®. é‡åŒ–æ ¼å¼(sampleFormat) ä¹Ÿæœ‰å«é‡‡æ ·ä½æ•°çš„,ä»£è¡¨ç€æè¿°æ•°å­—ä¿¡å·æ‰€ä½¿ç”¨çš„ä½æ•°,8bit(å·²ç»å¾ˆå°‘ç”¨äº†)ã€16bit(ä¸€èˆ¬ä½¿ç”¨è¿™ä¸ª)å’Œ24bit é‡‡æ ·ç‡(sampleRate) æˆ‘ä»¬çŸ¥é“äººçš„è€³æœµèƒ½å¬åˆ°çš„èŒƒå›´æ˜¯20Hz - 20kHz,æˆ‘ä»¬çš„é‡‡æ ·ç‡å¦‚æœé«˜äºè¿™ä¸ªå€¼,åˆ™å¿…å®šå¯ä»¥ä¿è¯å£°éŸ³çš„è¿˜åŸ, æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨44.1kHzé‡‡æ ·ç‡ å£°é“æ•°(channel) å£°é“æ•°å°±æ˜¯æŒ‡,å£°éŸ³åœ¨å½•åˆ¶æˆ–æ’­æ”¾æ—¶ä¸åŒç©ºé—´ä½ç½® å•å£°é“ é‡‡æ ·æ•°æ®ä¸º8ä½çš„çŸ­æ•´æ•°(short) åŒå£°é“ é‡‡æ ·æ•°æ®ä¸º16ä½çš„æ•´æ•°(int) é«˜å…«ä½(å·¦å£°é“)å’Œä½å…«ä½(å³å£°é“) è¿˜æœ‰ä¸€ä¸ªæ¦‚å¿µ,æ¯”ç‰¹ç‡éœ€è¦æˆ‘ä»¬æ³¨æ„:å®ƒæŒ‡çš„æ˜¯æ¯ä¸€ç§’çš„æ¯”ç‰¹æ•°,ç”¨æ¥è¡¡é‡å•ä½æ—¶é—´å†…éŸ³é¢‘æ•°æ®çš„å®¹é‡å¤§å° ä¸¾ä¸ªä¾‹å­: ä¸€ä¸ª44.1kHz åŒå£°é“ 16bité‡åŒ–æ ¼å¼ 44100 * 2 * 16 = 1411.2kbps //æŠŠbpsè£…æ¢ä¸ºMB 1411.2k / 8 / 1024 = 172Kb/s 172 * 60 = 10.08Mb PCMå…¶å®ä¸€èˆ¬å¹¶ä¸ç”¨æ¥ç¼–ç ä¼ è¾“,ä»–ç»å¸¸æ˜¯ä½œä¸ºä¸€ä¸ªè£¸æ•°æ®æ¥ä½¿ç”¨çš„,æ²¡æœ‰ç»è¿‡å‹ç¼©çš„. éŸ³é¢‘ç¼–ç å¸¸è§çš„æ¯”å¦‚PCM,ACC,MP3,WAVç­‰ç­‰ WAVæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç”¨è¿™ç§æ ¼å¼æ¥è¿›è¡Œä¼ è¾“,ç»å¸¸æ˜¯ä½œä¸ºæœ¬åœ°æ–‡ä»¶æ¥ä½¿ç”¨çš„. ç‰¹ç‚¹:æ”¯æŒå¹¿æ³›,éŸ³è´¨å¥½ ç”¨é€”:ç»å¸¸è¢«ç”¨æ¥åšéŸ³ä¹ç´ æ,ä»¥åŠæˆ‘ä»¬å¼€å‘çš„ä¸­é—´æ–‡ä»¶ MP3MP3æ‹¥æœ‰ä¸é”™çš„å‹ç¼©æ¯”,è¿™ä¹Ÿæ˜¯ä¸€ç§å…¼å®¹éå¸¸å¹¿æ³›ä¸€ç§ç¼–ç æ ¼å¼ ç‰¹ç‚¹: éŸ³è´¨åœ¨128Kbit/sä»¥ä¸Šè¡¨ç°çš„è¾ƒä¸ºä¸é”™,å‹ç¼©æ¯”é«˜,å…¼å®¹æ€§å¥½ ç”¨é€”:é«˜æ¯”ç‰¹ç‡ä¸‹çš„éŸ³ä¹. ACCæ–°ä¸€ä»£çš„éŸ³é¢‘å‹ç¼©ç¼–ç æŠ€æœ¯,ä½¿ç”¨äº†æœ‰æŸå‹ç¼©,å¯ä»¥åœ¨128kbit/sçš„é«˜ç ç‡","categories":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/categories/Media/"}],"tags":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"},{"name":"Audio","slug":"Audio","permalink":"https://www.wangzhumo.com/tags/Audio/"}]},{"title":"éŸ³è§†é¢‘-å…¥é—¨è·¯å¾„","slug":"multimedia-learn","date":"2018-09-01T02:51:29.000Z","updated":"2019-12-22T12:08:19.657Z","comments":true,"path":"2018/09/01/multimedia-learn/","link":"","permalink":"https://www.wangzhumo.com/2018/09/01/multimedia-learn/","excerpt":"","text":"å‚è€ƒèµ„æ–™é›·ç¥ï¼š https://blog.csdn.net/column/details/ffmpeg-devel.html googleæä¾›çš„æ–‡æ¡£ï¼š https://source.android.com/devices/graphics/ https://source.android.com/devices/audio Jhusterçš„ä¸“æ  http://blog.51cto.com/ticktick/category15.html Android éŸ³è§†é¢‘å¼€å‘å­¦ä¹ æ€è·¯ https://www.cnblogs.com/renhui/p/7452572.html","categories":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/categories/Media/"}],"tags":[{"name":"Media","slug":"Media","permalink":"https://www.wangzhumo.com/tags/Media/"}]},{"title":"OkHttpæºç åˆ†æ-WebSocket","slug":"okhttp-source-code-websocket","date":"2018-08-20T02:05:55.000Z","updated":"2019-12-22T12:08:06.486Z","comments":true,"path":"2018/08/20/okhttp-source-code-websocket/","link":"","permalink":"https://www.wangzhumo.com/2018/08/20/okhttp-source-code-websocket/","excerpt":"å‰è¨€OkHttpå¯ä»¥è¯´æ˜¯Androidä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶,æœ€è¿‘çš„ä¸šåŠ¡éœ€è¦WebSocketçš„åŠŸèƒ½,çœ‹åˆ°æœ‰äººè¯´okhttpå°±å¯ä»¥åšåˆ°äº†,äºæ˜¯æˆ‘æ‰“å¼€äº†æºç ,æœç„¶. Okhttp - internal - ws okhttp3.internal.ws.RealWebSocket okhttp3.internal.ws.WebSocketProtocol okhttp3.internal.ws.WebSocketReader okhttp3.internal.ws.WebSocketWriter okhttp3.WebSocket okhttp3.WebSocketListener é‚£ä¹ˆæ¥ä¸‹æ¥,è®©æˆ‘æ¥ä¸€æ¢ç©¶ç«Ÿ","text":"å‰è¨€OkHttpå¯ä»¥è¯´æ˜¯Androidä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶,æœ€è¿‘çš„ä¸šåŠ¡éœ€è¦WebSocketçš„åŠŸèƒ½,çœ‹åˆ°æœ‰äººè¯´okhttpå°±å¯ä»¥åšåˆ°äº†,äºæ˜¯æˆ‘æ‰“å¼€äº†æºç ,æœç„¶. Okhttp - internal - ws okhttp3.internal.ws.RealWebSocket okhttp3.internal.ws.WebSocketProtocol okhttp3.internal.ws.WebSocketReader okhttp3.internal.ws.WebSocketWriter okhttp3.WebSocket okhttp3.WebSocketListener é‚£ä¹ˆæ¥ä¸‹æ¥,è®©æˆ‘æ¥ä¸€æ¢ç©¶ç«Ÿ WebSocketåˆ›å»ºokhttp3.WebSocket public interface WebSocket { /** Returns the original request that initiated this web socket. */ Request request(); /** * Returns the size in bytes of all messages enqueued to be transmitted to the server. */ long queueSize(); /** * Attempts to enqueue {@code text} to be UTF-8 encoded and sent as a the data of a text (type */ boolean send(String text); /** * Attempts to enqueue {@code bytes} to be sent as a the data of a binary (type {@code 0x2}) * message. * &lt;p&gt;This method returns immediately. */ boolean send(ByteString bytes); boolean close(int code, @Nullable String reason); /** * Immediately and violently release resources held by this web socket, discarding any enqueued * messages. This does nothing if the web socket has already been closed or canceled. */ void cancel(); interface Factory { /** * Creates a new web socket and immediately returns it. Creating a web socket initiates an asynchronous process to connect the socket */ WebSocket newWebSocket(Request request, WebSocketListener listener); } } å“,,,è¿™æ³¨é‡Šå†™çš„,éƒ½èˆä¸å¾—åˆ äº†. å¯ä»¥çœ‹åˆ°,æ¥å£ä¸­çš„æ–¹æ³•åŸºæœ¬ä¸Šéƒ½æ˜¯å¯¹WebSocketçš„æ“ä½œ,å¦‚å‘é€,å…³é—­,å–æ¶ˆ,å¤§å° éœ€è¦å…³æ³¨çš„æ˜¯interface Factory ä¸­çš„newWebSocket()æ–¹æ³•,å®ç°åœ¨OkHttpClient okhttp3.OkHttpClient /** * Uses {@code request} to connect a new web socket. */ @Override public WebSocket newWebSocket(Request request, WebSocketListener listener) { RealWebSocket webSocket = new RealWebSocket(request, listener, new Random(), pingInterval); webSocket.connect(this); return webSocket; } å‘ç°æ˜¯ç”±RealWebSocketæ¥åˆ›å»ºWebSocketçš„è¿æ¥çš„ å®ƒæ¥æ”¶äº†ä¸€ä¸ªRequest,ä»¥åŠWebSocketListener å…¶ä¸­çš„pingIntervalæ˜¯å‘é€pingæ¶ˆæ¯çš„æ—¶é—´,æ˜¯ç”±OkhttpClientå»è®¾ç½®çš„. æ¥ä¸‹æ¥å…³æ³¨connetc(this)è¿™ä¸ªæ–¹æ³•,æˆ‘ä»¬å»çœ‹çœ‹RealWebSocket okhttp3.internal.ws.RealWebSocket public final class RealWebSocket implements WebSocket, WebSocketReader.FrameCallback { //public interface FrameCallback { // void onReadMessage(String text) throws IOException; // void onReadMessage(ByteString bytes) throws IOException; // void onReadPing(ByteString buffer); // void onReadPong(ByteString buffer); // void onReadClose(int code, String reason); //} } å®ç°æ¥å£: å®ç°äº†WebSocketæ¥å£ä¸­çš„æ–¹æ³• å®ç°WebSocketReader.FrameCallbackæ¥å£ å¯ä»¥çœ‹åˆ°,å…¶ä¸­éƒ½æ˜¯è¯»å–æ•°æ®çš„å›è°ƒ å±æ€§å­—æ®µ: private final Request originalRequest; æ˜¯æˆ‘ä»¬åº”ç”¨ä¸­ä¼ è¿‡æ¥çš„åŸå§‹è¯·æ±‚ final WebSocketListener listener; è¿™æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„è¿‡ç¨‹ä¸­,æ¯”è¾ƒå…³æ³¨çš„ä¸€ä¸ªç±»,ä»–æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»,ä¸»è¦è´Ÿè´£æŠŠWebSocketä¸­çš„é€šä¿¡ onOpen(WebSocket webSocket, Response response) onMessage(WebSocket webSocket, String text) onMessage(WebSocket webSocket, ByteString bytes) onClosing(WebSocket webSocket, int code, String reason) onClosed(WebSocket webSocket, int code, String reason) onFailure(WebSocket webSocket, Throwable t, @Nullable Response response)","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"WebSocketçš„ä½¿ç”¨ç¬”è®°-ç†è®ºåŸºç¡€","slug":"websocket-note","date":"2018-08-19T02:57:00.000Z","updated":"2019-12-22T12:05:52.905Z","comments":true,"path":"2018/08/19/websocket-note/","link":"","permalink":"https://www.wangzhumo.com/2018/08/19/websocket-note/","excerpt":"å‰è¨€WebSocket æ˜¯HTML5ä¸€ç§æ–°çš„webé€šä¿¡æŠ€æœ¯,å®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„å…¨åŒå·¥å®æ—¶é€šä¿¡(full-duplex) åœ¨WebSocketä¸­,ç¬¬ä¸€æ¬¡è¿˜æ˜¯é‡‡ç”¨Httpçš„å½¢å¼æ¥é€šçŸ¥æœåŠ¡å™¨,å‡†å¤‡ä½¿ç”¨WebSocketçš„åè®®,è€Œå¦‚æœæœåŠ¡å™¨æ”¯æŒçš„è¯,ä¼šè¿”å›æˆåŠŸçš„é€šçŸ¥101,è€Œåå°±ä¼šé•¿è¿æ¥æ¥è¿›è¡Œå…¨åŒå·¥çš„é€šä¿¡,è€Œä¸æ˜¯Request &amp; Response,æ¯ä¸€æ¬¡è¯·æ±‚å®Œæˆéƒ½æ–­å¼€è¿æ¥. å› æ­¤,WebSocketé€šå¸¸æ˜¯ä½¿ç”¨åœ¨æ¨é€,å³æ—¶é€šè®¯,ç­‰ç­‰éœ€è¦å³æ—¶æ€§çš„é€šè®¯éœ€æ±‚. Wiki WebSocket æ˜¯ç‹¬ç«‹çš„ã€åˆ›å»ºåœ¨ TCP ä¸Šçš„åè®®. WebSocketä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚åœ¨WebSocket APIä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚","text":"å‰è¨€WebSocket æ˜¯HTML5ä¸€ç§æ–°çš„webé€šä¿¡æŠ€æœ¯,å®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„å…¨åŒå·¥å®æ—¶é€šä¿¡(full-duplex) åœ¨WebSocketä¸­,ç¬¬ä¸€æ¬¡è¿˜æ˜¯é‡‡ç”¨Httpçš„å½¢å¼æ¥é€šçŸ¥æœåŠ¡å™¨,å‡†å¤‡ä½¿ç”¨WebSocketçš„åè®®,è€Œå¦‚æœæœåŠ¡å™¨æ”¯æŒçš„è¯,ä¼šè¿”å›æˆåŠŸçš„é€šçŸ¥101,è€Œåå°±ä¼šé•¿è¿æ¥æ¥è¿›è¡Œå…¨åŒå·¥çš„é€šä¿¡,è€Œä¸æ˜¯Request &amp; Response,æ¯ä¸€æ¬¡è¯·æ±‚å®Œæˆéƒ½æ–­å¼€è¿æ¥. å› æ­¤,WebSocketé€šå¸¸æ˜¯ä½¿ç”¨åœ¨æ¨é€,å³æ—¶é€šè®¯,ç­‰ç­‰éœ€è¦å³æ—¶æ€§çš„é€šè®¯éœ€æ±‚. Wiki WebSocket æ˜¯ç‹¬ç«‹çš„ã€åˆ›å»ºåœ¨ TCP ä¸Šçš„åè®®. WebSocketä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚åœ¨WebSocket APIä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚ WebSocketç®€ä»‹æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ å›¾: é¢,å†æ¥ä¸€å¼ : å…ˆè¯´ç¬¬äºŒå¼ å›¾,è¯´æ˜äº†WebSocketä¸Httpçš„å…³ç³»,å…¶å®ä¸¤è€…é™¤äº†éƒ½æ˜¯åŸºäºTCPä¹‹å¤–è”ç³»å¹¶ä¸å¤§,åªæ˜¯WebSocketçš„ç¬¬ä¸€æ¬¡æ¡æ‰‹ç”³è¯·å‡çº§åè®®çš„æ—¶å€™ä½¿ç”¨äº†Httpçš„è¿æ¥,è€Œåçš„å„ç§è¿æ¥éƒ½æ˜¯ä½¿ç”¨WebSocketçš„. å†æ¥è¯´ç¬¬ä¸€å¼ å›¾,ä¸»è¦æ­ç¤ºäº†WebSocketçš„å·¥ä½œæµç¨‹,é€šè¿‡æ¡æ‰‹ååŒæ–¹å¯ç”¨äº†WebSocketé€šä¿¡,è€Œä¹‹åçš„ä¸€ç³»åˆ—æ“ä½œéƒ½æ˜¯WebSocketè‡ªå·±æ¥æ“ä½œçš„. WebSocketå®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚ GET ws://echo.websocket.org/?encoding=text HTTP/1.1 Origin: http://websocket.org Cookie: __utma=99as Connection: Upgrade Host: echo.websocket.org Sec-WebSocket-Key: uRovscZjNol/umbTt5uKmw== Upgrade: websocket Sec-WebSocket-Version: 13 è¿™æ˜¯WebSocketç¬¬ä¸€æ¬¡å‘é€çš„è¯·æ±‚,åªæ”¯æŒGETè¯·æ±‚ Upgrade ä¸»è¦è¡¨æ˜æˆ‘éœ€è¦å‡çº§åè®®,å…¶åæ ‡æ˜äº†éœ€è¦å‡çº§çš„åè®®ç±»å‹ Sec-WebSocket-Key åˆ™æ˜¯WebSocket å®¢æˆ·ç«¯å‘é€çš„ä¸€ä¸ª base64 ç¼–ç çš„å¯†æ–‡,éœ€è¦æœåŠ¡å™¨ç«¯è¿”ä¸€ä¸ªå¯¹åº”åŠ å¯†Sec-WebSocket-Acceptåº”ç­”,å¦‚æœä¸åˆæ³•åˆ™æŠ›å‡ºError during WebSocket handshakeé”™è¯¯,å¹¶å…³é—­è¿æ¥ WebSocketæœåŠ¡å™¨è¿”å› HTTP/1.1 101 WebSocket Protocol Handshake Date: Fri, 10 Feb 2012 17:38:18 GMT Connection: Upgrade Server: Kaazing Gateway Upgrade: WebSocket Access-Control-Allow-Origin: http://websocket.org Access-Control-Allow-Credentials: true Sec-WebSocket-Accept: rLHCkw/SKsO9GAH/ZSFhBATDKrU= Access-Control-Allow-Headers: content-type Sec-WebSocket-Keyçš„å†…å®¹åŠ ä¸Šå­—ç¬¦ä¸²258EAFA5-E914-47DA-95CA-C5AB0DC85B11 ç”Ÿæˆçš„å­—ç¬¦ä¸²è¿›è¡ŒSHA1ç¼–ç  å†å°†ç”Ÿæˆçš„å­—ç¬¦ä¸²è¿›è¡ŒBase64ç¼–ç  WebSocketé€šä¿¡WebSocketä¸­æ‰€æœ‰æ•°æ®å‡ä½¿ç”¨å¸§çš„å½¢å¼å‘é€ã€‚ å®¢æˆ·ç«¯å‘é€çš„æ•°æ®å¸§éƒ½è¦ç»è¿‡æ©ç å¤„ç†,æœåŠ¡ç«¯å‘é€çš„æ‰€æœ‰æ•°æ®å¸§éƒ½ä¸èƒ½ç»è¿‡æ©ç å¤„ç†,å¦åˆ™å¯¹æ–¹éœ€è¦å‘é€å…³é—­å¸§ã€‚ ä¸€ä¸ªå¸§åŒ…å«ä¸€ä¸ªå¸§ç±»å‹çš„æ ‡è¯†ç ,ä¸€ä¸ªè´Ÿè½½é•¿åº¦,å’Œè´Ÿè½½(åŒ…æ‹¬æ‰©å±•å†…å®¹å’Œåº”ç”¨å†…å®¹) WebSocketæ•°æ®å¸§çš„ç»Ÿä¸€æ ¼å¼ 0 1 2 3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-------+-+-------------+-------------------------------+ |F|R|R|R| opcode|M| Payload len | Extended payload length | |I|S|S|S| (4) |A| (7) | (16/64) | |N|V|V|V| |S| | (if payload len==126/127) | | |1|2|3| |K| | | +-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - + | Extended payload length continued, if payload len == 127 | + - - - - - - - - - - - - - - - +-------------------------------+ | |Masking-key, if MASK set to 1 | +-------------------------------+-------------------------------+ | Masking-key (continued) | Payload Data | +-------------------------------- - - - - - - - - - - - - - - - + : Payload Data continued ... : + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - + | Payload Data continued ... | +---------------------------------------------------------------+ FIN 1ä¸ªæ¯”ç‰¹ã€‚ å¦‚æœæ˜¯1,è¡¨ç¤ºè¿™æ˜¯æ¶ˆæ¯çš„æœ€åä¸€ä¸ªåˆ†ç‰‡,è‹¥æ˜¯0è¡¨ç¤ºä¸æ˜¯æœ€åä¸€ä¸ª RSV1, RSV2, RSV3å„å 1ä¸ªæ¯”ç‰¹ è¿™ä¸‰ä¸ªéƒ½æ˜¯ç•™ç€æ‰©å±•ç”¨çš„ Opcode 4ä¸ªæ¯”ç‰¹ 0 è¡¨ç¤ºæ­¤å¸§æ˜¯ä¸€ä¸ªç»§ç»­å¸§,éœ€è¦æ‹¼æ¥åœ¨ä¸Šä¸€ä¸ªæ”¶åˆ°çš„å¸§,ç»„æˆä¸€ä¸ªå®Œæ•´çš„æ¶ˆæ¯,æ‰€ä»¥éæ§åˆ¶å¸§çš„å‘é€å’Œæ¥æ”¶å¿…é¡»æ˜¯ç›¸åŒçš„é¡ºåº 1 æ–‡æœ¬å¸§ 2 äºŒè¿›åˆ¶å¸§ 3 - 7 ä¿ç•™ 8 å…³é—­è¿æ¥æ§åˆ¶å¸§ æ­¤å¸§å¯èƒ½ä¼šåŒ…å«å†…å®¹,ä»¥è¡¨ç¤ºå…³é—­è¿æ¥çš„åŸå› ,æ³¨æ„å¿…é¡»æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯æˆå¯¹å‡ºç°,è€Œåå…³é—­é“¾æ¥. 9 Pingç±»ä¼¼äºå¿ƒè·³,æ”¶åˆ°Pingä¹‹ååº”ç«‹å³å‘é€Pongå“åº” 10 Pong å¦‚æœé€šä¿¡ä¸€æ–¹å¹¶æ²¡æœ‰å‘é€Ping,ä½†æ˜¯æ”¶åˆ°äº†Pong,å¹¶ä¸è¦æ±‚å®ƒè¿”å›ä»»ä½•ä¿¡æ¯ 11 - 15 ä¿ç•™ Mask 1ä¸ªæ¯”ç‰¹ è¡¨ç¤ºæ˜¯å¦è¦å¯¹æ•°æ®è½½è·è¿›è¡Œæ©ç æ“ä½œ Payload length 7bit æ•°æ®çš„é•¿åº¦, length == 126 æ—¶,åé¢çš„2 ä¸ªå­—èŠ‚ä¹Ÿæ˜¯è¡¨ç¤ºæ•°æ®é•¿åº¦ å½“å®ƒ length == 127 æ—¶,åé¢çš„ 8 ä¸ªå­—èŠ‚è¡¨ç¤ºæ•°æ®é•¿åº¦ Masking-key 0æˆ–4å­—èŠ‚ ä¸»è¦çœ‹Maskçš„å€¼æ¥å†³å®š Payload data æ‰©å±•æ•°æ®+åº”ç”¨æ•°æ® åº”ç”¨æ•°æ®,åœ¨æ‰©å±•æ•°æ®ä¹‹å,å¸§æ•°æ®çš„å‰©ä½™é•¿åº¦å°±æ˜¯åº”ç”¨æ•°æ®çš„é•¿åº¦. WebSocketä¿æŒå¿ƒè·³WebSocketä¿æŒå®¢æˆ·ç«¯,æœåŠ¡ç«¯çš„å®æ—¶åŒå‘é€šä¿¡,éœ€è¦ç¡®ä¿å®¢æˆ·ç«¯,æœåŠ¡ç«¯ä¹‹é—´çš„TCPè¿æ¥æ²¡æœ‰æ–­å¼€ã€‚ ä½†æ˜¯åˆä¸èƒ½ä¸€ç›´å»å‘é€æ•°æ®,è¿™æ ·çš„è¯ä¼šæµªè´¹å¤§é‡çš„èµ„æº. æ­¤æ—¶å°±æ˜¯å¿ƒè·³æ¥ä¿æŒè¿æ¥: å‘é€æ–¹ ping opcode = 9 æ¥æ”¶æ–¹ pong opcode = A WebSocketçš„ä½¿ç”¨è¿™ä¸€éƒ¨åˆ†æˆ‘å‡†å¤‡ç”¨å¦ä¸€ç¯‡ç¬”è®°æ¥è®°å½• OkHttpè¿™é‡Œå•ç‹¬è¯´ä¸€ä¸‹okhttp,ç«Ÿç„¶æ”¯æŒwebsocketçš„é€šä¿¡åè®®,è€Œä¸”è¿˜æœ‰ä¸€ä¸ªæ‰©å±•æ¨¡å—mockserveræ”¯æŒæµ‹è¯•..ç®€ç›´å®Œç¾ implementation â€œcom.squareup.okhttp3:okhttp:$okhttpVersionâ€ implementation â€œcom.squareup.okhttp3:mockwebserver:$okhttpVersionâ€ Java-websocketJava-WebSocket,è¿™æ˜¯ä½¿ç”¨javaæ¥å®ç°çš„WebSocketå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯,ä¹Ÿæ˜¯6çš„é£èµ·. é‚£ä¹ˆæˆ‘ä¸‹ä¸€ç¯‡ç¬”è®°ä¸»è¦ä¼šè®°å½•Okhttpçš„ä½¿ç”¨,æˆ–è€…ä¼šåˆ†æä¸€ä¸‹okhttpä¸­å®ç°websocketçš„æºç .","categories":[{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/categories/Server/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/tags/Server/"}]},{"title":"MacOSè£…æœºå¿…å¤‡","slug":"macos-change-list","date":"2018-08-17T07:54:36.000Z","updated":"2019-12-22T12:08:38.547Z","comments":true,"path":"2018/08/17/macos-change-list/","link":"","permalink":"https://www.wangzhumo.com/2018/08/17/macos-change-list/","excerpt":"å‰è¨€æ›´æ¢å·¥ä½œçš„æœºå™¨,æ‰€æœ‰çš„ç¯å¢ƒéƒ½è¦å†æ­ä¸€æ¬¡,è¿˜æ˜¯æŒºè‹¦é€¼çš„ è¿™é‡Œè®°å½•ä¸‹æ¥.","text":"å‰è¨€æ›´æ¢å·¥ä½œçš„æœºå™¨,æ‰€æœ‰çš„ç¯å¢ƒéƒ½è¦å†æ­ä¸€æ¬¡,è¿˜æ˜¯æŒºè‹¦é€¼çš„ è¿™é‡Œè®°å½•ä¸‹æ¥. ç¯å¢ƒssh ç›¸å…³ ~/.ssh/config é…ç½®ç›®å½• ~/.ssh/ä¸‹çš„æ‰€æœ‰å…¬é’¥/å¯†é’¥ brewåŒ…ç®¡ç† å®‰è£… /usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot; List brew install htop //ç³»ç»Ÿç›‘æ§ brew install hexo //åšå®¢ç³»ç»Ÿ brew install kotlin //kotlinç¼–è¯‘ç¯å¢ƒ brew insatll zsh //zsh brew install vim //vim brew install tree //tree å·¥å…· brew install python3 //py brew install polipo //ç»ˆç«¯çš„ä»£ç†å·¥å…· brew install git //git brew install cmake //cmakeç¼–è¯‘ brew install hightlight //é«˜äº® brew install autojump //autojump ç»ˆç«¯iterm2 https://www.iterm2.com/ go2Shell http://zipzapmac.com/go2shell zsh~/.zshrc ç¯å¢ƒå˜é‡ulimit -S -n 1024 export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_161.jdk/Contents/Home export ANDROID_HOME=/Users/phyooos/Library/Android/sdk export TOMCAT_HOME=/Users/phyooos/develop/apache-tomcat-7.0.77 export GRADLE_USER_HOME=/Users/phyooos/develop/gradle export MYSQL_HOME=/usr/local/mysql-5.7.18-macos10.12-x86_64 export GOROOT=/usr/local/go export GOPATH=/Users/phyooos/develop/workspace export GOBIN=$GOPATH/bin export NDK_HOME=/Users/phyooos/Library/Android/sdk/ndk-bundle export REPO_URL=&#39;https://mirrors.tuna.tsinghua.edu.cn/git/git-repo/&#39; export SCALA_HOME=/Users/phyooos/develop/scala-2.11.8 export MAVEN_HOME=/Users/phyooos/develop/apache-maven-3.5.0 export FLUTTER_HOME=/Users/phyooos/develop/flutter export WEBP_HOME=/Users/phyooos/develop/libwebp export DART_HOME=/Users/phyooos/develop/flutter/bin/cache/dart-sdk export PATH=/usr/local/Cellar/gcc/8.1.0/bin:/usr/local/bin:$PATH:$JAVA_HOME/bin:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools:$TOMCAT_HOME/bin:$GRADLE_HOME/bin:$MYSQL_HOME/bin:$GOROOT/bin:$GOPATH:$GOBIN:$GOPATH/bin:$FLUTTER_HOME/bin:$DART_HOME/bin:$MAVEN_HOME/bin:$SCALA_HOME/bin:$NDK_HOME:$WEBP_HOME/bin æ–‡ä»¶æ¡Œé¢æ–‡ä»¶ æ–‡ä»¶å¤¹ Develop flutter çš„å®‰è£… hexo proxyee workspace å›¾ç‰‡å…¬å…±éŸ³ä¹workspaceè½¯ä»¶ç½‘ç»œé€šè®¯ Aira2GUI Google Chrome ShadowsocksX-NG-R8 LanScan Pro Little Snitch Configuration Charles Foxmail å¾®ä¿¡ QQ é’‰é’‰ Zeplin ç³»ç»Ÿå·¥å…· Enpass æˆªå›¾ - è…¾è®¯ Dukto Bartender 3 Go2Shell Iterm2 Kaleidoscope Cheat Sheet TinyPNG4Mac Pap.er CleanMyMac Tuxera Disk Manager å¼€å‘å·¥å…· Android Studio Intellij IDEA PyCharm Xcode Tower GoLand CodeRunner Visual Studio Code Postman Yummy FTP Pro Typora æœ‰é“è¯å…¸ NWeb Paw for Trello å…¶ä»– MindNode IThoughtsX Sketch Xnip ç½‘æ˜“äº‘éŸ³ä¹ Acorn IINA PicGIF","categories":[{"name":"Tools","slug":"Tools","permalink":"https://www.wangzhumo.com/categories/Tools/"}],"tags":[{"name":"Tools","slug":"Tools","permalink":"https://www.wangzhumo.com/tags/Tools/"}]},{"title":"Kotlinå­¦ä¹ ç¬”è®°-é«˜çº§å‡½æ•°","slug":"kotlin-learn-advance-fun","date":"2018-08-13T03:28:04.000Z","updated":"2019-12-22T12:09:06.518Z","comments":true,"path":"2018/08/13/kotlin-learn-advance-fun/","link":"","permalink":"https://www.wangzhumo.com/2018/08/13/kotlin-learn-advance-fun/","excerpt":"","text":"å¸¸ç”¨é«˜çº§å‡½æ•°map ä¸€èˆ¬æ–¹å¼ ```kotlinfun main(args: Array) { val list = listOf(1,2,3,4,5,6,7) //å‡½æ•°å¼•ç”¨çš„æ–¹å¼intè½¬ä¸ºdouble list.map(Int::toDouble) val newList = list.map{ //it å°±æ˜¯å½“å‰å…ƒç´  it *2 } } &lt;!--more--&gt; - å¼•ç”¨å‡½æ•°çš„map ```kotlin fun main(args: Array&lt;String&gt;) { val list = listOf(1,2,3,4,5,6,7) //å‡½æ•°å¼•ç”¨çš„æ–¹å¼intè½¬ä¸ºdouble list.map(Int::toDouble) } //æºç  map public inline fun &lt;T, R&gt; Iterable&lt;T&gt;.map(transform: (T) -&gt; R): List&lt;R&gt; { return mapTo(ArrayList&lt;R&gt;(collectionSizeOrDefault(10)), transform) //ArrayList&lt;R&gt;(collectionSizeOrDefault(10)) åˆå§‹åŒ–ä¸€ä¸ªå’ŒåŸæ¥ä¸€æ ·é•¿çš„list //transform å°±æ˜¯æˆ‘ä»¬ä¼ è¿›å»çš„å‡½æ•° } //æºç  mapTo //destination å°±æ˜¯ä¸Šé¢åˆå§‹åŒ–å¥½çš„List //transform ä¹Ÿæ˜¯ä¸Šé¢ä¼ è¿›æ¥çš„å‡½æ•°,è´Ÿè´£è½¬æ¢ public inline fun &lt;T, R, C : MutableCollection&lt;in R&gt;&gt; Iterable&lt;T&gt;.mapTo(destination: C, transform: (T) -&gt; R): C { //ä¸€ä¸ªforå¾ªç¯,éå†æ‰€æœ‰å…ƒç´ ,å¹¶è½¬æ¢åæ·»åŠ åˆ°æ–°List for (item in this) destination.add(transform(item)) return destination //è¿”å›List } flatMapfun main(args: Array&lt;String&gt;) { //ä»¥ä¸Šæ˜¯ä¸€ä¸ªå…ƒç´ ä¸ºæ•°ç»„çš„List val list = listOf(1..8,9..12,13..27 step 2,28..32) //å±•å¼€List,å¹¶æŠŠListä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´  + 1 val newList = list.flatMap { intRange -&gt; intRange.map { item -&gt; item + 1 } } //åŒä¸Š val newList2 = list.flatMap { it -&gt; it.map { it + 1 } } // åªæ˜¯å±•å¼€äº†List,å…¶ä»–ä»€ä¹ˆä¹Ÿæ²¡åš val newList3 = list.flatMap { it -&gt; it } } //æºç  /** * Returns a single list of all elements yielded from results of [transform] function being invoked on each element of original collection. */ public inline fun &lt;T, R&gt; Iterable&lt;T&gt;.flatMap(transform: (T) -&gt; Iterable&lt;R&gt;): List&lt;R&gt; { //åˆ›å»ºList , ä¼ å…¥é’ˆå¯¹åŸListä¸­å…ƒç´ çš„è½¬æ¢æ–¹æ³• return flatMapTo(ArrayList&lt;R&gt;(), transform) } /** * Appends all elements yielded from results of [transform] function being invoked on each element of original collection, to the given [destination]. */ public inline fun &lt;T, R, C : MutableCollection&lt;in R&gt;&gt; Iterable&lt;T&gt;.flatMapTo(destination: C, transform: (T) -&gt; Iterable&lt;R&gt;): C { //éå†åŸæ¥List for (element in this) { //æ­¤å¤„çš„transform,è½¬æ¢åŸListä¸­çš„æ¯ä¸€ä¸ªå…ƒç´  val list = transform(element) destination.addAll(list) } //è¿”å›äº†æ–°List return destination } reduce//å®é™…å°±è®¡ç®—äº†æ‰€æœ‰å…ƒç´ çš„å’Œ newList.reduce { acc, i -&gt; //acc æ˜¯ä¸Šä¸€æ¬¡è®¡ç®—çš„ç»“æœ //i æ˜¯å½“å‰çš„å…ƒç´  acc + i // è¿™ä¸ªæ˜¯æ“ä½œçš„å‡½æ•° } //æºç  /** * Accumulates value starting with the first element and applying [operation] from left to right to current accumulator value and each element. */ public inline fun &lt;S, T: S&gt; Iterable&lt;T&gt;.reduce(operation: (acc: S, T) -&gt; S): S { //è·å–äº†æˆ‘ä»¬çš„è¿­ä»£å¯¹è±¡ val iterator = this.iterator() //å¦‚æœä¸æ˜¯ç©ºListå°±ç»§ç»­æ‰§è¡Œ if (!iterator.hasNext()) throw UnsupportedOperationException(&quot;Empty collection can&#39;t be reduced.&quot;) //å–åˆ°Listçš„ç¬¬ä¸€ä¸ªå…ƒç´  var accumulator: S = iterator.next() while (iterator.hasNext()) { //è¿™ä¸€æ­¥å°±æ˜¯æŠŠä¸Šé¢ä¸€ä¸ªè¿›å…¥æ“ä½œçš„ç»“æœå’Œä¸‹ä¸€ä¸ªå…ƒç´ åšäº† operation çš„æ“ä½œ, //è€Œè¿™ä¸ª operation å°±æ˜¯ä½ ä¼ è¿›æ¥çš„å‡½æ•° //è®¡ç®—å®Œæ¯•ä¹‹å,åˆæŠŠè®¡ç®—ç»“æœèµ‹ç»™äº† accumulator accumulator = operation(accumulator, iterator.next()) } //æœ€åè¿”å›ç»“æœ return accumulator } eg: val list = listOf(1,2,3,4) val accumulator = list[0] = 1 while ( -- ){ //ç¬¬ä¸€æ¬¡ 1 = 1 + 2 = 3 //ç¬¬äºŒæ¬¡ 3 = 3 + 3 = 6 //ç¬¬ä¸‰æ¬¡ 6 = 6 + 6 = 10 } return 10 flod//æºç è¡¨ç¤º,åªæ˜¯åˆå§‹å€¼æ˜¯ä½ æŒ‡å®šçš„é‚£ä¸ªå€¼,å…¶ä»–å’Œreduceå·®ä¸å¤šä¸€è‡´çš„æ€è·¯ /** * Accumulates value starting with [initial] value and applying [operation] from left to right to current accumulator value and each element. */ public inline fun &lt;T, R&gt; Iterable&lt;T&gt;.fold(initial: R, operation: (acc: R, T) -&gt; R): R { var accumulator = initial //operation æ“ä½œä¸Šæ¬¡ç»“æ„ for (element in this) accumulator = operation(accumulator, element) return accumulator } //å­—ç¬¦ä¸²æ‹¼æ¥ newList.fold(StringBuffer()){ acc, i -&gt; acc.append(i).append(&quot;,&quot;) } è¾“å‡º: 2,3,4,5,6,7,8,9,10,11,12,13,14,16,18,20,22,24,26,28,29,30,31,32,33, filterè¿‡æ»¤æ‰ä¸ç¬¦åˆæ¡ä»¶çš„ takeWhileå–ç¬¬ä¸€ä¸ªä¸ç¬¦åˆæ¡ä»¶å…ƒç´ ä¹‹å‰çš„æ‰€æœ‰å…ƒç´ . #### letæœ€å¸¸ç”¨çš„åœºæ™¯å°±æ˜¯ä½¿ç”¨letå‡½æ•°å¤„ç†éœ€è¦é’ˆå¯¹ä¸€ä¸ªå¯nullçš„å¯¹è±¡ç»Ÿä¸€åšåˆ¤ç©ºå¤„ç† fun main(args: Array&lt;String&gt;) { //ä»¥ä¸Šæ˜¯ä¸€ä¸ªå…ƒç´ ä¸ºæ•°ç»„çš„List val list = listOf(1..8,9..12,13..27 step 2,28..32) val kc = KotlinClassA() val per : DataClass? = DataClass(12,&quot;è„‘å£³ç—›&quot;) per?.copy() per?.addWhat1(kc) per?.addWhat2(kc) per?.addWhat3(kc) //let per?.let { it.copy() it.addWhat1(kc) it.addWhat2(kc) it.addWhat3(kc) } } //æºç  @kotlin.internal.InlineOnly public inline fun &lt;T, R&gt; T.let(block: (T) -&gt; R): R { contract { callsInPlace(block, InvocationKind.EXACTLY_ONCE) } //æŠŠæ¥æ”¶çš„å‚æ•°,ä¼ å…¥äº†æˆ‘ä»¬æä¾›çš„å‡½æ•°ä¸­ return block(this) } withé€‚ç”¨äºè°ƒç”¨åŒä¸€ä¸ªç±»çš„å¤šä¸ªæ–¹æ³•æ—¶ï¼Œå¯ä»¥çœå»ç±»åé‡å¤ï¼Œç›´æ¥è°ƒç”¨ç±»çš„æ–¹æ³•å³å¯ï¼Œå¦‚Androidä¸­onBinderViewHolderä¸­ï¼Œæ•°æ®modelçš„å±æ€§æ˜ å°„åˆ°UIä¸Š @kotlin.internal.InlineOnly public inline fun &lt;T, R&gt; with(receiver: T, block: T.() -&gt; R): R { contract { callsInPlace(block, InvocationKind.EXACTLY_ONCE) } return receiver.block() } //ç”¨æ”¶åˆ°çš„å®ä¾‹å»è°ƒç”¨ blockæ–¹æ³•,è¿”å›å€¼è‡ªå·±å®šä¹‰ runlet + with çš„ç»“åˆä½“ æ—¢å¯ä»¥ç›´æ¥è®¿é—®å®ä¾‹çš„å…¬æœ‰å±æ€§å’Œæ–¹æ³• åˆå¼¥è¡¥äº†withå‡½æ•°ä¼ å…¥å¯¹è±¡åˆ¤ç©ºé—®é¢˜ @kotlin.internal.InlineOnly public inline fun &lt;T, R&gt; T.run(block: T.() -&gt; R): R { contract { callsInPlace(block, InvocationKind.EXACTLY_ONCE) } return block() } apply@kotlin.internal.InlineOnly public inline fun &lt;T&gt; T.apply(block: T.() -&gt; Unit): T { contract { callsInPlace(block, InvocationKind.EXACTLY_ONCE) } block() return this } //æ³¨æ„å®ƒè¿”å›çš„æ˜¯this é—­åŒ… å°±æ˜¯å‡½æ•°çš„è¿è¡Œç¯å¢ƒ æŒæœ‰å‡½æ•°çš„è¿è¡ŒçŠ¶æ€ å‡½æ•°å†…éƒ¨å¯ä»¥å®šä¹‰å‡½æ•° å‡½æ•°å†…éƒ¨ä¹Ÿå¯ä»¥å®šä¹‰ç±» fun fibonacci(): () -&gt; Long { var first = 0L var second = 1L return fun() : Long{ val result = second second += first first = second - first return result } } fun main(args: Array&lt;String&gt;) { val f = fibonacci() println(f()) println(f()) println(f()) println(f()) println(f()) } è¾“å‡º: 1 1 2 3 5 æˆ‘ä»¬å‘ç°var first = 0L,var second = 1L è¿™ä¸¤ä¸ªçš„å€¼è¢«ä¿å­˜ä½äº† æ¯æ¬¡f() å,firstå’Œ secondéƒ½èƒ½è®°ä½ä»–ä»¬å½“å‰è¢«èµ‹äºˆçš„å€¼ å¤åˆå‡½æ•°è¿™ç®€ç›´å¤ªç§€äº† fun add(int: Int) = int + 1 fun multiply(int: Int) = int * 2 fun &lt;A, B, C&gt; compose(f: (B) -&gt; C, g: (A) -&gt; B) : (A) -&gt; C { return { x -&gt; f(g(x)) } } fun main(args: Array&lt;String&gt;) { val addAndMultiply = compose(::add, ::multiply) println(addAndMultiply(9)) //è¾“å‡º 19 } ###","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Javaï¼ŒKotlin","slug":"Javaï¼ŒKotlin","permalink":"https://www.wangzhumo.com/tags/Javaï¼ŒKotlin/"}]},{"title":"Kotlinå­¦ä¹ ç¬”è®°-åŸºç¡€","slug":"kotlin-learn-note-basic","date":"2018-08-10T07:47:59.000Z","updated":"2019-12-22T12:09:02.880Z","comments":true,"path":"2018/08/10/kotlin-learn-note-basic/","link":"","permalink":"https://www.wangzhumo.com/2018/08/10/kotlin-learn-note-basic/","excerpt":"åŸºæœ¬ç±»å‹ä¸ä¼šéšå¼è½¬æ¢val a = 123 val b : Float = a //è¿™æ ·æ˜¯ä¸åˆæ³•çš„,ä¸æ”¯æŒéšå¼è½¬æ¢ val c : Float = a.toFloat()","text":"åŸºæœ¬ç±»å‹ä¸ä¼šéšå¼è½¬æ¢val a = 123 val b : Float = a //è¿™æ ·æ˜¯ä¸åˆæ³•çš„,ä¸æ”¯æŒéšå¼è½¬æ¢ val c : Float = a.toFloat() å¤šè¡Œval lines = &quot;&quot;&quot; å¥½äººå•Š. #/ $a &quot;&quot;&quot; print(lines) è¾“å‡ºä¸º å¥½äººå•Š. #/ 123 Process finished with exit code 0 å¼•ç”¨ç±»å‹ç©ºå®‰å…¨fun getValue() : String { return null //æŠ¥é”™ } å¦‚æœä½ è¿™ä¹ˆå†™,ä¸€å®šæ˜¯ä¼šæŠ¥é”™çš„,åŸå› æ˜¯ æŒ‡å®šçš„è¿”å›å€¼ String ä¸æ¥å—nullçš„è¿”å›å€¼ å¦‚æœä½ ä¸€å®šè¦å®ƒå¯ä»¥è¿”å›ä¸€ä¸ªç©ºé‚£å°±åªèƒ½åŠ ä¸€ä¸ª? fun getValue() : String? { return null } é‚£ä¹ˆä½œä¸ºè°ƒç”¨è€… print(getValue()?.length) //è¾“å‡º null print(getValue()!!.length) //è¾“å‡º KotlinNullPointerException ,ç›´æ¥å°±ç»™å¹²å´©äº† ? çš„ä½œç”¨æ˜¯,å¦‚æœä¸ºç©ºåˆ™è¾“å‡ºnull ,å¦‚æœä¸ä¸ºç©ºåˆ™æ­£å¸¸ä½¿ç”¨ !!å–æ¶ˆç©ºå®‰å…¨æœºåˆ¶,å°±å’Œjavaä¸€æ ·äº† ç±»å‹è½¬æ¢å¯¹äºè½¬æ¢å¼‚å¸¸çš„é‚£äº›,å¦‚æœä¸€æ—¦é”™è¯¯å°±ç›´æ¥å¥”æºƒ,æˆ‘ä»¬å¸Œæœ›å®ƒä¸è¦å´©æºƒ,è€Œæ˜¯ä»¥å…¶ä»–çš„æ–¹å¼æ¥è¡¨ç° open class Parent class Child : Parent() fun main(args: Array&lt;String&gt;) { val parent = Parent() val child = parent as? Child //ç„¶è€ŒæŠ›å‡ºäº†ä¸€ä¸ªå¼‚å¸¸ ClassCastException,ç±»å‹è½¬æ¢å¼‚å¸¸ print(child) } é‚£ä¹ˆKotlinå¯¹æ­¤åšäº†ä»€ä¹ˆæ“ä½œ? val child = parent as? Child print(child) //è¾“å‡º null,è€Œä¸ä¼šç›´æ¥å¥”æºƒ åŒºé—´Range a..b è¿ç®—ç¬¦ [a,b] a until b [a,b) val range : IntRange = 1..29 Range çš„æ–¹æ³• contains ä¹Ÿå¯ä»¥ä½¿ç”¨ in è¿ç®—ç¬¦ isEmpty EMPTY (é™æ€å˜é‡) print(range.contains(9)) // ture print(99 in range) // false éå†Rangefor (i in range){ print(i) } æ•°ç»„åˆ›å»ºæ•°ç»„val intArr: IntArray = intArrayOf(1,2,3,4,5) val charArr: CharArray = charArrayOf(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;) val objArr: Array&lt;Parent&gt; = arrayOf(Parent(&quot;ç‹&quot;),Parent(&quot;è¯›&quot;),Parent(&quot;é­”&quot;)) éå†for map iterator ... val/var/coustvar å¯ä»¥ä¿®æ”¹ val ä¸å¯ä¿®æ”¹final è¿è¡Œæ—¶å¸¸é‡ const é™æ€å¸¸é‡ ç¼–è¯‘æœŸå¸¸é‡ Lambda//ä¸€èˆ¬å†™æ³• fun doSome(a:Int,b:Int) : Int{ return a + b +1 } //å¦‚æœåªæœ‰è¿”å›å€¼,å…¶å®å¯ä»¥ç›´æ¥å†™ fun doSome(a:Int,b:Int) : Int = a + b +1 val array = arrayOf(1,3,4,5,6,7) fun main(args: Array&lt;String&gt;) { //lambdaè¡¨è¾¾å¼ array.forEach { print(it) } // :: å¼•ç”¨ array.forEach(::print) array.forEachIndexed { index, i -&gt; print(&quot;index = $index , value = $i&quot;) } } æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯,Lambdaä¸­çš„Return fun main(args: Array&lt;String&gt;) { array.forEachIndexed { index, i -&gt; if (index ==2 ) return println(&quot;index = $index , value = $i&quot;) } print(&quot;Fun End&quot;) } //è¾“å‡º: index = 0 , value = 1 index = 1 , value = 3 Process finished with exit code 0 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,if (index ==2 ) returnç›´æ¥å°±è¿”å›äº†mainçš„æ–¹æ³• é‚£ä¹ˆæˆ‘æƒ³è·³å‡ºforEachIndexedæ€ä¹ˆåŠ? fun main(args: Array&lt;String&gt;) { array.forEachIndexed JUMP@{ index, i -&gt; if (index == 2) return@JUMP println(&quot;index = $index , value = $i&quot;) } print(&quot;Fun End&quot;) } //è¾“å‡º index = 0 , value = 1 index = 1 , value = 3 index = 3 , value = 5 index = 4 , value = 6 index = 5 , value = 7 Fun End æˆ‘ä»¬å¯ä»¥å‘ç°,index = 2 çš„é‚£ä¸€æ¡æ¶ˆå¤±äº†,å› ä¸ºæˆ‘ä»¬è·³å‡ºäº†æ–¹æ³•,å›åˆ°äº†æˆ‘ä»¬æ ‡è®°çš„åœ°æ–¹ JUMP@ ç±»æˆå‘˜é‡å†™é»˜è®¤çš„Get/Setæ–¹æ³•class KotlinClassA{ var a = 123 get() { println(&quot;get a value&quot;) return field } set(value) { field = value println(&quot;someone set value&quot;) } } å­—æ®µå»¶è¿Ÿåˆå§‹åŒ–class KotlinClassA{ var a = 123 get() { print(&quot;get a value&quot;) return field } set(value) { field = value print(&quot;someone set value&quot;) } //varç›´æ¥ä½¿ç”¨lateinitå³å¯ lateinit var b:String //valçš„åªèƒ½ç”¨ by äº†,lazyè¿”å›ä¸€ä¸ªlambdaè¡¨è¾¾å¼ val c :String by lazy { print(&quot;lazy init c&quot;) &quot;666&quot; } } fun main(args: Array&lt;String&gt;) { val kot = KotlinClassA() println(kot.a) println(kot.c) } è¾“å‡º: get a value 123 lazy init c 666 Process finished with exit code 0 å¯ä»¥çœ‹åˆ°,cæ˜¯åœ¨æˆ‘è°ƒç”¨å®ƒçš„æ—¶å€™,æ‰æ‰“å°äº†lazy init cè¯´æ˜ç¡®å®æ˜¯å»¶è¿ŸåŠ è½½çš„,å¦åˆ™åº”è¯¥æ˜¯KotlinClassAåˆå§‹åŒ–çš„æ—¶å€™å°±åº”è¯¥æ‰“å°è¿™å¥è¯çš„. æ“ä½œç¬¦åœ¨javaä¸­,æ“ä½œç¬¦çš„ä½œç”¨æ˜¯å›ºå®šçš„,æˆ‘ä»¬æ²¡æœ‰åŠæ³•å»æ”¹å˜å®ƒ ä½†æ˜¯åœ¨kotlinä¸­,å…è®¸æˆ‘ä»¬å»è‡ªé‡å†™æ“ä½œç¬¦,åªéœ€è¦ä¿è¯å…¥å…¥å‚æ•°é‡ä¸å‡½æ•°åä¸€è‡´å³å¯ Kotlinç»™å‡ºçš„æ–‡æ¡£ class OperatorClass(val value :Int){ //æ¯”å¦‚æˆ‘æƒ³è®©åŠ æ³•å˜æˆå‡æ³• operator fun plus(other : OperatorClass):Int{ return value - other.value } operator fun plus(other : Int):Int{ return value - other.value } } fun main(args: Array&lt;String&gt;) { val opera = OperatorClass(66) //ä¸¤ä¸ªç±»ç›¸åŠ  print(opera + OperatorClass(6)) print(opera + 10) } è¾“å‡º: 60 56 æˆ‘ä¸ä»…ä»…è®©OperatorClassæœ‰äº†åŠ æ³•,è€Œä¸”è¿˜æŠŠåŠ æ³•æ”¹å†™æˆäº†å‡æ³• è¿˜æœ‰å¾ˆå¤šçš„æ“ä½œç¬¦æ˜¯å¯ä»¥é‡å†™çš„,çœ‹çœ‹æ–‡æ¡£å°±çŸ¥é“äº†. è¡¨è¾¾å¼ifè¡¨è¾¾å¼kotlinä¸­çš„ifç­‰ç­‰,éƒ½æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼,ä»–æ˜¯å¯ä»¥æœ‰å€¼çš„,æˆ‘ä¸€ç›´æ²¡æœ‰ç†è§£è¿™ä¸ª. çœ‹åˆ°è¿™ä¸ªä¾‹å­,æˆ‘æ˜ç™½äº† const val DEBUG = 0 const val USER = 1 const val USER_NAME = &quot;kotlin&quot; const val USER_PASS_WD = &quot;jetBrains&quot; const val ADMIN = &quot;admin&quot; fun main(args: Array&lt;String&gt;) { //ä½¿ç”¨äº†ifçš„è¿”å›å€¼,æ¯å—ä¸­çš„æœ€åä¸€è¡Œå°±æ˜¯è¿”å›å€¼ val mode = if (args.isNotEmpty() &amp;&amp; args[0] == &quot;0&quot;) { DEBUG } else { USER } println(&quot;USER:&quot;) val user = readLine() println(&quot;PASSWORD:&quot;) val passwd = readLine() if (mode == DEBUG &amp;&amp; user == ADMIN &amp;&amp; passwd == ADMIN) { println(&quot;Welcome Admin Login.&quot;) } else if (user == USER_NAME &amp;&amp; passwd == USER_PASS_WD) { println(&quot;Welcome $user Login.&quot;) } else { println(&quot;Error.&quot;) } } Whenè¡¨è¾¾å¼whenä¹Ÿå’Œifè¡¨è¾¾å¼ä¸€æ ·,ä½†è¦æ³¨æ„çš„æ˜¯,å¦‚æœæ˜¯è¦ç”¨æ¥èµ‹å€¼,é‚£ä¹ˆelse -&gt; ä¹Ÿéœ€è¦è¿”å›å€¼ val mode = when{ args.isNotEmpty() &amp;&amp; args[0] == &quot;0&quot; -&gt; 0 else -&gt; 1 } when (mode){ !is Int -&gt; println(&quot;mode is Int&quot;) in 0..9 -&gt; println(&quot;$mode in 1..9&quot;) 0 -&gt; println(&quot;mode == 0&quot;) else -&gt; println(&quot;bye&quot;) } å¾ªç¯forå¾ªç¯åªè¦ä¸€ä¸ªæ•°æ®ç»“æ„å¯è¿­ä»£,å°±å¯ä»¥ä½¿ç”¨è¿™æ ·çš„æ–¹å¼æ¥éå† fun main(args: Array&lt;String&gt;) { for (value in args){ println(value) } for ((index,value) in args.withIndex()){ println(&quot;current $index index = $value&quot;) } for (valueWithIndex in args.withIndex()){ println(&quot;current ${valueWithIndex.index} index = ${valueWithIndex.value}&quot;) } } è·³å‡ºå’Œè·³è¿‡@LABEL æ ‡ç­¾ break continue å¼‚å¸¸è¿™ç©æ„ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼,åˆ«çš„å°±ä¸è¯´äº† å‚æ•°å¤šä¸ªå‚æ•°fun sing(vararg words: String,count :Int){ words.forEach(::println) println(count) } fun main(args: Array&lt;String&gt;) { val array = arrayOf(&quot;ds&quot;,&quot;ce&quot;,&quot;lp&quot;) sing(&quot;abc&quot;,&quot;def&quot;,&quot;zyx&quot;,&quot;opl&quot;,count = 4) // *Array å¯ä»¥æŠŠä¸€ä¸ªæ•°ç»„å±•å¼€ sing(*array,count = array.size) } é»˜è®¤å€¼fun sing(vararg words: String,count :Int = 1000){ words.forEach(::println) println(count) } fun main(args: Array&lt;String&gt;) { sing(&quot;12&quot;,&quot;23&quot;,&quot;63&quot;) } ä¸‹é¢çš„è°ƒç”¨ä¸­,å¹¶æ²¡æœ‰ä¼ å…¥countçš„å€¼,ä½†æ˜¯å¹¶ä¸ä¼šæŠ¥é”™,å› ä¸ºå‡½æ•°ä¸­æŒ‡å®šcountçš„é»˜è®¤å€¼äº† æ¥å£/ç»§æ‰¿interface Drive{ fun drive() } interface Fix{ fun fix(){ println(&quot;ç»´ä¿®æŠ€èƒ½&quot;) } } class CarDrive: Drive{ override fun drive() { println(&quot;é©¾é©¶æŠ€èƒ½-æ±½è½¦&quot;) } } class ComputerFix: Fix{ override fun fix() { super.fix() println(&quot;ç»´ä¿®æŠ€èƒ½-ä¿®ç”µè„‘&quot;) } } class Manager : Drive,Fix{ override fun drive() { println(&quot;ç»ç†å¼€è½¦-å¥¥è¿ªè½¿è½¦&quot;) } override fun fix() { super.fix() println(&quot;ç»ç†ç»´ä¿®-æ±½è½¦&quot;) } } class SeniorManager(val drive: Drive,val fix: Fix) : Drive by drive , Fix by fix fun main(args: Array&lt;String&gt;) { val manager = Manager() manager.drive() manager.fix() val carDrive = CarDrive() val computerFix = ComputerFix() val seniorManager = SeniorManager(carDrive,computerFix) seniorManager.drive() seniorManager.fix() } æ¥å£å¯ä»¥æœ‰é»˜è®¤çš„æ–¹æ³•,ä½†æ˜¯æ²¡æœ‰çŠ¶æ€ Drive by drive , Fix by fix ä»£ç†äº†ç»ç†çš„æŠ€èƒ½. é™æ€æ–¹æ³•/@JvmStaticclass Pay private constructor(val money : Double){ companion object { fun toPay(v : Double): Pay{ return Pay(v) } // JvmStaticæ³¨è§£çš„,å¯ä»¥åœ¨Javaä¸­åƒé™æ€æ–¹æ³•ä¸€æ ·è°ƒç”¨ @JvmStatic fun copyPay(p : Pay) : Pay{ return Pay(p.money) } } } kotlin: val pay = Pay.toPay(10.93) val pay2 = Pay.copyPay(pay) Java: //æ­£å¸¸çš„è°ƒç”¨,å¿…é¡»ä½¿ç”¨ Companion ä¼´ç”Ÿå¯¹è±¡ Pay pay = Pay.Companion.toPay(123.8); Pay pay2 = Pay.copyPay(pay);","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Javaï¼ŒKotlin","slug":"Javaï¼ŒKotlin","permalink":"https://www.wangzhumo.com/tags/Javaï¼ŒKotlin/"}]},{"title":"Glide4.Xç‰ˆæœ¬å›¾ç‰‡åŠ è½½æ˜¾ç¤ºè¿›åº¦","slug":"glide-okhttp-progress","date":"2018-08-09T09:40:04.000Z","updated":"2019-12-22T12:10:05.141Z","comments":true,"path":"2018/08/09/glide-okhttp-progress/","link":"","permalink":"https://www.wangzhumo.com/2018/08/09/glide-okhttp-progress/","excerpt":"å‰è¨€Glideæ— ç–‘æ˜¯ä¸€æ¬¾éå¸¸ä¼˜ç§€çš„å›¾ç‰‡åŠ è½½æ¡†æ¶,ä½†æ˜¯ä»–å¹¶æ²¡æœ‰æ”¯æŒæ˜¾ç¤ºå›¾ç‰‡åŠ è½½çš„è¿›åº¦. é‚£ä¹ˆæˆ‘ä»¬é‡åˆ°è¿™ç§éœ€æ±‚çš„æ—¶å€™åº”è¯¥æ€ä¹ˆåŠ?è‡ªå·±å†™ä¸€ä¸ªå›¾ç‰‡åŠ è½½æ¡†æ¶ä¹ˆ? ä¸,æˆ‘ä»¬è‚¯å®šæ˜¯é€‰æ‹©è‡ªå·±æ¥æ‰©å±•è¿™ä¸ªæ¡†æ¶,ä½¿å¾—Glideâ€æ”¯æŒâ€æ˜¾ç¤ºè¿›åº¦ GlideImageView ç”¨æ¥æ§åˆ¶start &amp; autoStart , ç”¨æ¥æ˜¾ç¤º progress , error OkHttp ç”¨æ¥æ”¯æŒè¿›åº¦çš„å›è°ƒ","text":"å‰è¨€Glideæ— ç–‘æ˜¯ä¸€æ¬¾éå¸¸ä¼˜ç§€çš„å›¾ç‰‡åŠ è½½æ¡†æ¶,ä½†æ˜¯ä»–å¹¶æ²¡æœ‰æ”¯æŒæ˜¾ç¤ºå›¾ç‰‡åŠ è½½çš„è¿›åº¦. é‚£ä¹ˆæˆ‘ä»¬é‡åˆ°è¿™ç§éœ€æ±‚çš„æ—¶å€™åº”è¯¥æ€ä¹ˆåŠ?è‡ªå·±å†™ä¸€ä¸ªå›¾ç‰‡åŠ è½½æ¡†æ¶ä¹ˆ? ä¸,æˆ‘ä»¬è‚¯å®šæ˜¯é€‰æ‹©è‡ªå·±æ¥æ‰©å±•è¿™ä¸ªæ¡†æ¶,ä½¿å¾—Glideâ€æ”¯æŒâ€æ˜¾ç¤ºè¿›åº¦ GlideImageView ç”¨æ¥æ§åˆ¶start &amp; autoStart , ç”¨æ¥æ˜¾ç¤º progress , error OkHttp ç”¨æ¥æ”¯æŒè¿›åº¦çš„å›è°ƒ æ€è€ƒä¸ºä»€ä¹ˆæˆ‘è¦é€‰æ‹©ä½¿ç”¨OkHttpæ¥æ”¹é€ é‚£? @Override public void registerComponents(Context context, Glide glide, Registry registry) { registry.replace(GlideUrl.class, InputStream.class, new OkHttpUrlLoader.Factory()); } æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,ModelLoaderFactoryæ˜¯æˆ‘ä»¬è‡ªå·±ä¼ è¿›å»çš„,é‚£ä¹ˆæˆ‘åªè¦æŒæœ‰è¿™ä¸ªModelLoaderFactoryä¸å°±å¯ä»¥çŸ¥é“è¿›åº¦äº†ä¹ˆ? è¿½è¸ªæºç å‘ç°äº†åˆå§‹åŒ–OkHttpClientçš„æ–¹æ³•,internalClient æ˜¯Call.Factoryç±»å‹çš„,è€ŒOkHttpClientæ˜¯Call.Factoryçš„å®ç°ç±». /** * Constructor for a new Factory that runs requests using a static singleton client. */ public Factory() { this(getInternalClient()); } /** * Constructor for a new Factory that runs requests using given client. * * @param client this is typically an instance of {@code OkHttpClient}. * * çœ‹åˆ°è¿™ä¸ªæœ‰å‚çš„æ„é€ å‡½æ•°äº†ä¹ˆ?è¿˜æ˜¯Publicçš„.. */ public Factory(@NonNull Call.Factory client) { this.client = client; } private static Call.Factory getInternalClient() { if (internalClient == null) { synchronized (Factory.class) { if (internalClient == null) { internalClient = new OkHttpClient(); } } } return internalClient; } é‚£ä¹ˆ,å¯ä»¥ç¡®å®šæ›¿æ¢OkHttpClientçš„æ€è·¯æ˜¯æ­£ç¡®çš„,ä¸‹é¢æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹ OkHttpLoadImage æä¾›OkHttpClientå¹¶æ·»åŠ æ‹¦æˆªå™¨ OnProgressListener ç”±éœ€è¦æ˜¾ç¤ºè¿›åº¦çš„Viewå®ç°,æä¾›ä¸€ä¸ªUrl,å›è°ƒprogress OkHttpClient çš„å®ä¾‹ HashMap å®é™…ä¸Šå­˜æ”¾çš„æ˜¯Viewè‡ªå·± ProgressResponseBody å¯¹å¤–æä¾›å½“å‰ä¸‹è½½çš„è¿›åº¦ LoadImageView è®°å½•å½“å‰url,æ˜¾ç¤ºè¿›åº¦ GlideLoaderModule @GlideModule é€šè¿‡new OkHttpUrlLoader.Factory(OkHttpLoadImage.INSTANCE())æ›¿ä»£é»˜è®¤çš„OkHttpClient ä»£ç å®ç°OkHttpLoadImageè¯¥ç±»æä¾›ä¸€ä¸ªOkHttpClientçš„å®ä¾‹,åœ¨è¿™ä¸ªå®ä¾‹ä¸­æ·»åŠ ä¸€ä¸ªNetworkInterceptor,è¿™ä¸ªæ‹¦æˆªå™¨æä¾›å½“å‰ä¸‹è½½çš„è¿›åº¦ /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/8/9 ä¸‹åˆ6:10 */ public final class OkHttpLoadImage { //ä¸€å®šè¦è®°å¾—unRegister,è¿™é‡Œå­˜æ”¾çš„æ˜¯keyä»¥åŠOnProgressListener //å®é™…ä¸Š,æˆ‘ä»¬æœ€å¥½é‡‡ç”¨è½¯å¼•ç”¨,è¿™æ ·æ›´åŠ çš„å®‰å…¨,æ¯•ç«Ÿæˆ‘ä»¬æ— æ³•æ„ŸçŸ¥Viewçš„ç”Ÿå‘½å‘¨æœŸ private static HashMap&lt;String, OnProgressListener&gt; progressListenerMap; //æ·»åŠ äº†æ‹¦æˆªçš„OkHttpClient private OkHttpClient okHttpClient; static { progressListenerMap = new HashMap&lt;&gt;(); } private OkHttpLoadImage() { initOkHttp(); } /** * æ„å»ºä¸€ä¸ªOkHttpçš„å®ä¾‹ * ProgressResponseBody æ˜¯ä¸€ä¸ªæ¯”è¾ƒå…³é”®çš„ç±»,ä»–æä¾›äº†è¿›åº¦ */ private void initOkHttp() { okHttpClient = new OkHttpClient.Builder() .addNetworkInterceptor(chain -&gt; { Request request = chain.request(); Response response = chain.proceed(request); ProgressResponseBody body = new ProgressResponseBody(response, request.url().toString()); //æ·»åŠ ç›‘å¬,ä½¿å¾—å½“å‰ç±»çŸ¥é“è¿›åº¦ body.addOnResponseListener(responseListener); return response.newBuilder() .body(body) .build(); }) .build(); } private static class SingletonHolder { private static OkHttpLoadImage instance = new OkHttpLoadImage(); } public static OkHttpClient INSTANCE(){ return SingletonHolder.instance.okHttpClient; } private static ProgressResponseBody.OnResponseListener responseListener = new ProgressResponseBody.OnResponseListener() { @Override public void update(String key, float progress) { //å»å¯»æ‰¾è¿™ä¸ªkeyï¼Œå¹¶ä¼ å›å»å½“å‰çš„è¿›åº¦ OnProgressListener listener = progressListenerMap.get(key); if (listener != null) { listener.onProgress(progress); } } }; /** * æ³¨å†Œè¿›åº¦çš„å›è°ƒ */ public static void register(OnProgressListener listener) { //å¯èƒ½ä¼šæœ‰å¤šä¸ªViewæ³¨å†Œï¼Œä½†æ˜¯æˆ‘ä»¬åªå›è°ƒå½“å‰è¿™ä¸ª progressListenerMap.put(listener.getKey(), listener); } /** * å–æ¶ˆç›‘å¬ * * @param listener view */ public static void unRegister(OnProgressListener listener) { progressListenerMap.remove(listener.getKey()); } /** * ç›‘å¬è¿›åº¦çš„æ¥å£ */ public interface OnProgressListener { //å›è°ƒå½“å‰çš„è¿›åº¦ç»™View void onProgress(float progress); //è·å–å½“å‰Viewèµ„æºçš„key(URLå³å¯) String getKey(); } } ProgressResponseBodyè¿™ä¸ªä¸œè¥¿,ç½‘ä¸Šåˆ°å¤„éƒ½æ˜¯ public class ProgressResponseBody extends ResponseBody{ //OkHttpLoadImageä¸­ä¼ è¿›æ¥çš„response private final ResponseBody responseBody; private String url; private BufferedSource bufferedSource; public ProgressResponseBody(Response response,String url) { this.responseBody = response.body(); this.url = url; } @Override public MediaType contentType() { return responseBody.contentType(); } @Override public long contentLength() { return responseBody.contentLength(); } @Override public BufferedSource source() { if (bufferedSource == null) { bufferedSource = Okio.buffer(source(responseBody.source())); } return bufferedSource; } private Source source(BufferedSource source) { return new ForwardingSource(source) { long totalBytes = 0L; @Override public long read(Buffer sink, long byteCount) throws IOException { long bytesRead = super.read(sink, byteCount); // read() returns the number of bytes read, or -1 if this source is exhausted. totalBytes += bytesRead != -1 ? bytesRead : 0; if (listener != null) { //æ³¨æ„è¿™å—çš„ 1.0 * , è¦ä¸ä¸¤ä¸ªlongé™¤æ³•ä¼šä¸€ç›´æ˜¯ 0 listener.update(url, (float) 1.0 * totalBytes/contentLength()); } return bytesRead; } }; } private OnResponseListener listener; public void addOnResponseListener(OnResponseListener listener){ this.listener = listener; } public interface OnResponseListener{ void update(String key,float progress); } } LoadImageView/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/8/9 ä¸‹åˆ5:59 */ public class LoadImageView extends AppCompatImageView implements OkHttpLoadImage.OnProgressListener{ private Paint mPaint; private float progress; private String url; public LoadImageView(Context context) { this(context,null); } public LoadImageView(Context context, @Nullable AttributeSet attrs) { this(context, attrs,0); } public LoadImageView(Context context, AttributeSet attrs, int defStyleAttr) { super(context, attrs, defStyleAttr); init(); } public void setImageUrl(String url){ this.url = url; //æ­¤æ—¶å¼€å§‹åŠ è½½ OkHttpLoadImage.register(this); ImageLoader.LoaderImg(getContext(),url).into(this); Glide.with(this).load(url).into(this); } /** * åˆå§‹åŒ–å·¥å…· */ private void init() { mPaint = new Paint(); mPaint.setColor(Color.BLACK); mPaint.setAntiAlias(true); mPaint.setStrokeWidth(5); mPaint.setTextSize(50); } @SuppressLint(&quot;DefaultLocale&quot;) @Override protected void onDraw(Canvas canvas) { super.onDraw(canvas); canvas.drawText(String.format(&quot;Already : %d&quot;,(int)(100 * progress)),100,100,mPaint); } public void progress(float progress){ this.progress = progress; invalidate(); } @Override public void onProgress(float progress) { post(() -&gt; progress(progress)); } @Override public String getKey() { return url; } public boolean isLoaded(){ return progress == 1F; } } GlideLoaderModule/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2017/8/9 ä¸‹åˆ12:16 * */ @GlideModule public final class GlideLoaderModule extends AppGlideModule { @Override public void applyOptions(Context context, GlideBuilder builder) { RequestOptions options = new RequestOptions() .centerCrop() .placeholder(R.drawable.default_images_load) .error(R.drawable.default_images_load) .priority(Priority.HIGH) .format(DecodeFormat.PREFER_ARGB_8888) .diskCacheStrategy(DiskCacheStrategy.ALL); int maxMemory = (int) Runtime.getRuntime().maxMemory(); int memoryCacheSize = maxMemory / 8; //è®¾ç½®å†…å­˜ç¼“å­˜å¤§å° File cacheDir = new File(ApiConstants.INSTANCE.getIMAGE_PATH() + File.separator); if(!cacheDir.exists()){ cacheDir.mkdirs(); } int diskCacheSize = 1024 * 1024 * 512; //è®¾ç½®ç£ç›˜ç¼“å­˜å¤§å° builder.setMemoryCache(new LruResourceCache(memoryCacheSize)); builder.setDiskCache(new DiskLruCacheFactory(cacheDir.getPath(), &quot;Images&quot;, diskCacheSize)); builder.setDefaultRequestOptions(options); } @Override public void registerComponents(Context context, Glide glide, Registry registry) { registry.replace(GlideUrl.class, InputStream.class, new OkHttpUrlLoader.Factory(OkHttpLoadImage.INSTANCE())); } } ä½¿ç”¨","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"View","slug":"View","permalink":"https://www.wangzhumo.com/tags/View/"},{"name":"Glide","slug":"Glide","permalink":"https://www.wangzhumo.com/tags/Glide/"}]},{"title":"Glide4.Xç‰ˆæœ¬çš„åŸºæœ¬ä½¿ç”¨","slug":"glide-4-note","date":"2018-08-09T06:32:53.000Z","updated":"2019-12-22T12:10:00.751Z","comments":true,"path":"2018/08/09/glide-4-note/","link":"","permalink":"https://www.wangzhumo.com/2018/08/09/glide-4-note/","excerpt":"å‰è¨€Glideæ˜¯ä¸€æ¬¾æ€§èƒ½ä¼˜å¼‚,åŒ…å¤§å°ä¸­ç­‰,åŠ è½½é€Ÿåº¦å¿«çš„å›¾ç‰‡åŠ è½½å·¥å…·,ä¹Ÿæ˜¯Googleæ¨èä½¿ç”¨çš„åŠ è½½æ¡†æ¶ä¹‹ä¸€. åœ¨ä»¥å‰çš„å·¥ç¨‹ä¸­,æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨3.8ç‰ˆæœ¬ä¸€ä¸‹çš„Glide,è€Œåœ¨4.Xç‰ˆæœ¬ä¸­,Glideçš„ä½¿ç”¨æ–¹å¼å‘ç”Ÿäº†ä¸€äº›å˜åŒ–,æ‰€ä»¥ä»Šå¤©ç‰¹æ„å†™äº†ç¬”è®°æ¥è®°å½•,ä»¥ä¾¿äºä»¥åä½¿ç”¨æ—¶æŸ¥é˜… åœ°å€ Glide: https://github.com/bumptech/glide","text":"å‰è¨€Glideæ˜¯ä¸€æ¬¾æ€§èƒ½ä¼˜å¼‚,åŒ…å¤§å°ä¸­ç­‰,åŠ è½½é€Ÿåº¦å¿«çš„å›¾ç‰‡åŠ è½½å·¥å…·,ä¹Ÿæ˜¯Googleæ¨èä½¿ç”¨çš„åŠ è½½æ¡†æ¶ä¹‹ä¸€. åœ¨ä»¥å‰çš„å·¥ç¨‹ä¸­,æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨3.8ç‰ˆæœ¬ä¸€ä¸‹çš„Glide,è€Œåœ¨4.Xç‰ˆæœ¬ä¸­,Glideçš„ä½¿ç”¨æ–¹å¼å‘ç”Ÿäº†ä¸€äº›å˜åŒ–,æ‰€ä»¥ä»Šå¤©ç‰¹æ„å†™äº†ç¬”è®°æ¥è®°å½•,ä»¥ä¾¿äºä»¥åä½¿ç”¨æ—¶æŸ¥é˜… åœ°å€ Glide: https://github.com/bumptech/glide ä¾èµ–:implementation (&quot;com.github.bumptech.glide:glide:4.7.1&quot;) { exclude group: &quot;com.android.support&quot; } annotationProcessor &quot;com.github.bumptech.glide:compiler:4.7.1&quot; //kotlinä½¿ç”¨kapt // kapt &#39;com.github.bumptech.glide:compiler:4.7.1&#39; //å¦‚æœä½ éœ€è¦ä½¿ç”¨okhttpä½œä¸ºç½‘ç»œå±‚ implementation &quot;com.github.bumptech.glide:okhttp3-integration:4.7.1&quot; æ··æ·†(proguard):-keep public class * implements com.bumptech.glide.module.GlideModule -keep public class * extends com.bumptech.glide.module.AppGlideModule -keep public enum com.bumptech.glide.load.resource.bitmap.ImageHeaderParser$** { **[] $VALUES; public *; } # for DexGuard only -keepresourcexmlelements manifest/application/meta-data@value=GlideModule å¼€å§‹ä½¿ç”¨åŸºæœ¬é…ç½®ç»§æ‰¿ AppGlideModule /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/8/9 ä¸‹åˆ12:16 */ @GlideModule public class GlideLoaderModule extends AppGlideModule { @Override public void applyOptions(Context context, GlideBuilder builder) { RequestOptions options = new RequestOptions() .centerCrop() .placeholder(R.drawable.default_images_load) .error(R.drawable.default_images_load) .priority(Priority.HIGH) .format(DecodeFormat.PREFER_ARGB_8888) .diskCacheStrategy(DiskCacheStrategy.ALL); int maxMemory = (int) Runtime.getRuntime().maxMemory(); int memoryCacheSize = maxMemory / 8; //è®¾ç½®å†…å­˜ç¼“å­˜å¤§å° File cacheDir = new File(ApiConstants.INSTANCE.getIMAGE_PATH() + File.separator); if(!cacheDir.exists()){ cacheDir.mkdirs(); } int diskCacheSize = 1024 * 1024 * 512; //è®¾ç½®ç£ç›˜ç¼“å­˜å¤§å° builder.setMemoryCache(new LruResourceCache(memoryCacheSize)); builder.setDiskCache(new DiskLruCacheFactory(cacheDir.getPath(), &quot;Images&quot;, diskCacheSize)); builder.setDefaultRequestOptions(options); } @Override public void registerComponents(Context context, Glide glide, Registry registry) { registry.replace(GlideUrl.class, InputStream.class, new OkHttpUrlLoader.Factory()); } } æ³¨æ„,GlideLoaderModuleåœ¨4.Xç‰ˆæœ¬ä¹‹å,ä¸éœ€è¦å†™åˆ°Manifestæ–‡ä»¶ä¸­å»,ä½†æ˜¯éœ€è¦ä½ æ·»åŠ @GlideModuleæ³¨è§£ æ³¨æ„,GlideLoaderModuleåœ¨4.Xç‰ˆæœ¬ä¹‹å,ä¸éœ€è¦å†™åˆ°Manifestæ–‡ä»¶ä¸­å»,ä½†æ˜¯éœ€è¦ä½ æ·»åŠ @GlideModuleæ³¨è§£ å ä½ç¬¦ placeholder å ä½ç¬¦æ˜¯å½“è¯·æ±‚æ­£åœ¨æ‰§è¡Œæ—¶è¢«å±•ç¤ºçš„ Drawable,å½“è¯·æ±‚æˆåŠŸå®Œæˆæ—¶,å ä½ç¬¦ä¼šè¢«è¯·æ±‚åˆ°çš„èµ„æºæ›¿ å¦‚æœèµ„æºæ˜¯ä»å†…å­˜ä¸­åŠ è½½å‡ºæ¥çš„ï¼Œé‚£ä¹ˆå ä½ç¬¦å¯èƒ½æ ¹æœ¬ä¸ä¼šè¢«æ˜¾ç¤º å¦‚æœè¯·æ±‚å¤±è´¥å¹¶ä¸”æ²¡æœ‰è®¾ç½® error Drawable ï¼Œåˆ™å ä½ç¬¦å°†è¢«æŒç»­å±•ç¤º error åœ¨è¯·æ±‚æ°¸ä¹…æ€§å¤±è´¥æ—¶å±•ç¤º ä¹Ÿåœ¨è¯·æ±‚çš„url/modelä¸º null ï¼Œä¸”å¹¶æ²¡æœ‰è®¾ç½® fallback Drawable æ—¶å±•ç¤º fallback åœ¨è¯·æ±‚çš„url/modelä¸º null æ—¶å±•ç¤º(æ³¨æ„,null). ä¼šè¦†ç›–errorçš„ç¬¬äºŒæ¡æ˜¾ç¤ºæ¡ä»¶ Transform(åœ†è§’)å˜æ¢è¿™å—,åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ† é»˜è®¤å˜æ¢ CenterCrop FitCenter CircleCrop å¤šé‡å˜æ¢ä½¿ç”¨transformæ–¹æ³• æ–¹å¼ä¸€ Glide.with(context) .load(url) .transform(new MultiTransformation(new FitCenter(), new CustomTransformation()) .into(imageView); æ–¹å¼äºŒ GlideApp.with(context) .load(url) .transforms(new FitCenter(), new CustomTransformation()) .into(imageView); è‡ªå®šä¹‰å˜æ¢()/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/11/2 ä¸Šåˆ12:20 * åœ†è§’å›¾ç‰‡ */ public class GlideRoundTransform extends BitmapTransformation { private static final String ID = &quot;com.wangzhumo.app.commonlib.utils.GlideRoundTransform&quot;; private static float radius = 0f; public GlideRoundTransform() { this(5); } /** * åœ†è§’åƒç´  * @param dp */ public GlideRoundTransform(int dp) { radius = Resources.getSystem().getDisplayMetrics().density * dp; } @Override protected Bitmap transform(@NonNull BitmapPool pool, @NonNull Bitmap toTransform, int outWidth, int outHeight) { return roundCrop(pool, toTransform); } private static Bitmap roundCrop(BitmapPool pool, Bitmap source) { if (source == null) return null; Bitmap result = pool.get(source.getWidth(), source.getHeight(), Bitmap.Config.ARGB_8888); Canvas canvas = new Canvas(result); Paint paint = new Paint(); paint.setShader(new BitmapShader(source, BitmapShader.TileMode.CLAMP, BitmapShader.TileMode.CLAMP)); paint.setAntiAlias(true); RectF rectF = new RectF(0f, 0f, source.getWidth(), source.getHeight()); canvas.drawRoundRect(rectF, radius, radius, paint); return result; } @Override public boolean equals(Object o) { return o instanceof GlideRoundTransform; } @Override public int hashCode() { return ID.hashCode(); } @Override public void updateDiskCacheKey(MessageDigest messageDigest) { messageDigest.update(ID.getBytes()); } } å…¶ä¸­equals(),hashCode(),updateDiskCacheKeyä¸»è¦æ˜¯ä¸ºäº†ç¼“å­˜å’Œå­˜å‚¨çš„æ­£å¸¸å·¥ä½œ GlideExtension(æ‰©å±•API)GlideOption/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/8/9 ä¸‹åˆ2:57 * æ”¯æŒå¿«æ·ä½¿ç”¨åœ†è§’å›¾ç‰‡ */ @GlideExtension public final class RoundGlideExtension { private RoundGlideExtension(){ } /** * ç»™urlæ·»åŠ å‚æ•° * @param options RequestOptions */ @GlideOption public static void round(RequestOptions options,int corner){ options.transform(new GlideRoundTransform(corner)); } /** * ç»™urlæ·»åŠ å‚æ•° * @param options RequestOptions */ @GlideOption public static void round(RequestOptions options){ options.transform(new GlideRoundTransform()); } } æ·»åŠ @GlideExtensionæ³¨è§£ ç§æœ‰æ„é€  é™æ€æ–¹æ³•,ä»¥åŠ@GlideOptionæ³¨è§£ //é€šè¿‡ GlideApp.with(context).load(url).apply(options).round(); // or GlideApp.with(context).load(url).apply(options).round(corner); //æ¥åŠ è½½åœ†è§’å›¾ç‰‡ GlideTypeå…è®¸ä½ æ·»åŠ å¯¹æ–°çš„èµ„æºç±»å‹çš„æ”¯æŒï¼ŒåŒ…æ‹¬æŒ‡å®šé»˜è®¤é€‰é¡¹ã€‚ æš‚æ—¶æ²¡æœ‰ä½¿ç”¨. æ€»ç»“ä¸‹ä¸€æœŸ,æˆ‘ä»¬åšä¸€ä¸ªå¸¦è¿›åº¦æ¡çš„å›¾ç‰‡åŠ è½½.","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"Androidä¸­ä½¿ç”¨æ³¨è§£ç¬”è®°","slug":"annotation-simple-note","date":"2018-08-09T02:26:42.000Z","updated":"2019-12-22T12:04:34.312Z","comments":true,"path":"2018/08/09/annotation-simple-note/","link":"","permalink":"https://www.wangzhumo.com/2018/08/09/annotation-simple-note/","excerpt":"å‰è¨€@Override å°±æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„æ³¨è§£. æ£€æŸ¥æ˜¯å¦æ­£ç¡®çš„å¤å†™çˆ¶ç±»æ–¹æ³• æ ‡å¿—æ˜¯é‡å†™æ–¹æ³• å…ƒæ³¨è§£ å…ƒæ³¨è§£æ˜¯,é¢,å—¯ æ³¨è§£çš„æ³¨è§£ @Retentionï¼šæ³¨è§£ç”Ÿå‘½å‘¨æœŸ @Targetï¼šä½œç”¨èŒƒå›´ @Inheritedï¼šæ ‡æ˜æ‰€ä¿®é¥°çš„æ³¨è§£ç±»å‹æ˜¯è¢«ç»§æ‰¿çš„,å­ç±»ä¼šç»§æ‰¿è¿™ä¸ªæ³¨è§£ @Documentedï¼šjavadoc è¿™äº›éƒ½æ˜¯ç”±Javaè¯­è¨€æœ¬èº«æä¾›çš„æœ€åŸºç¡€çš„æ³¨è§£,ä»–ä»¬è´Ÿè´£æ³¨è§£å…¶ä»–çš„æ³¨è§£,å…·ä½“çš„ä½œç”¨è§ä¸Šæ–‡","text":"å‰è¨€@Override å°±æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„æ³¨è§£. æ£€æŸ¥æ˜¯å¦æ­£ç¡®çš„å¤å†™çˆ¶ç±»æ–¹æ³• æ ‡å¿—æ˜¯é‡å†™æ–¹æ³• å…ƒæ³¨è§£ å…ƒæ³¨è§£æ˜¯,é¢,å—¯ æ³¨è§£çš„æ³¨è§£ @Retentionï¼šæ³¨è§£ç”Ÿå‘½å‘¨æœŸ @Targetï¼šä½œç”¨èŒƒå›´ @Inheritedï¼šæ ‡æ˜æ‰€ä¿®é¥°çš„æ³¨è§£ç±»å‹æ˜¯è¢«ç»§æ‰¿çš„,å­ç±»ä¼šç»§æ‰¿è¿™ä¸ªæ³¨è§£ @Documentedï¼šjavadoc è¿™äº›éƒ½æ˜¯ç”±Javaè¯­è¨€æœ¬èº«æä¾›çš„æœ€åŸºç¡€çš„æ³¨è§£,ä»–ä»¬è´Ÿè´£æ³¨è§£å…¶ä»–çš„æ³¨è§£,å…·ä½“çš„ä½œç”¨è§ä¸Šæ–‡ è‡ªå®šä¹‰æ³¨è§£è¿è¡Œæ—¶æ³¨è§£(RUNTIME)/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/8/9 ä¸Šåˆ10:50 * * æ ‡è®°å­—æ®µä¸ºimageUrl,å›¾ç‰‡åœ°å€ */ @Retention(RetentionPolicy.RUNTIME) @Target(ElementType.FIELD) public @interface ImageUrl { String error() default &quot;http://wangzhumo.com/css/images/avatar.png&quot;; } /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/8/9 ä¸Šåˆ10:48 * * æ ‡è®°å­—æ®µä¸ºContent,å†…å®¹ */ @Retention(RetentionPolicy.RUNTIME) @Target(ElementType.FIELD) public @interface Content { } @ImageUrl ä¸ @Content ä¸­éƒ½æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•,è¿™é‡Œåªæ˜¯ä½¿ç”¨æ ‡è®°çš„åŠŸèƒ½ ä¸ºäº†ä½“ç°æ ‡è®°çš„ä½œç”¨ /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/8/9 ä¸Šåˆ10:47 */ public class Whatever { public String haha; //çå†™çš„å­—æ®µå,æ ‡è®°ä¸ºæ­£æ–‡ @Content public String aaaa; //çå†™çš„å­—æ®µå,æ ‡è®°ä¸ºå›¾ç‰‡åœ°å€ @ImageUrl(error = &quot;http://wangzhumo.com/images/java_heap_stack.png&quot;) public String bajkfhajks; public String waht; /** * è‡ªåŠ¨ç”Ÿäº§ * * @return List */ public static List&lt;Whatever&gt; create() { List&lt;Whatever&gt; whatever = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10; i++){ //å¼€å§‹å»ºç«‹ if (i==3){ whatever.add(new Whatever(String.format(Locale.CHINA,&quot;ç¬¬%dä¸ªé¡¹ç›®&quot;,i),&quot;&quot;)); }else{ whatever.add(new Whatever(String.format(Locale.CHINA,&quot;ç¬¬%dä¸ªé¡¹ç›®&quot;,i),&quot;http://wangzhumo.com/css/images/avatar.png&quot;)); } } return whatever; } } åœ¨RecyclerViewä¸­ä½¿ç”¨ com.wangzhumo.playground.SimpleAdapter#onBindViewHolder @Override public void onBindViewHolder(@NonNull ViewHolder holder, int position) { try { for (Field field : getItem(position).getClass().getDeclaredFields()) { field.setAccessible(true); if (field.isAnnotationPresent(Content.class)) { holder.bindView.setContext((String) field.get(getItem(position))); } else if (field.isAnnotationPresent(ImageUrl.class)) { String imageUrl = (String) field.get(getItem(position)); if (TextUtils.isEmpty(imageUrl)) { ImageUrl url = field.getAnnotation(ImageUrl.class); holder.bindView.setImageUrl(url.error()); }else{ holder.bindView.setImageUrl(imageUrl); } } } } catch (IllegalAccessException e) { e.printStackTrace(); } } TextUtils.isEmpty(imageUrl)ç®€å•çš„åˆ¤æ–­,æ˜¯å¦è®¾ç½®äº†å€¼,å¦‚æœå®ƒæ²¡æœ‰å€¼,é‚£å°±ç›´æ¥ä½¿ç”¨ url.error() ä¸­è®¾ç½®çš„å€¼ åœ¨ç”Ÿæˆæ•°æ®æ—¶,æˆ‘ç»™ç¬¬4ä¸ªä½ç½®çš„å›¾ç‰‡è®¾ç½®äº†&quot;&quot;ç©ºå€¼,åˆ™è¿™é‡Œç›´æ¥æ˜¾ç¤ºäº†æˆ‘ @ImageUrl( error = â€œxxxxxâ€)ä¸­è®¾ç½®çš„å›¾ç‰‡ å¦‚æœæˆ‘æ”¹é€ ä¸€ä¸‹,è®¾ç½®GlideApp.with(imageUrl ).error(@ImageUrl.error()) å¯ä»¥æˆä¸ºä¸€ä¸ªå¾ˆå®ç”¨çš„æ–¹æ³• ç¼–è¯‘æ—¶æ³¨è§£(CLASS)å¯¹äºæˆ‘ä¸ªäººæ¥è¯´,åŸºæœ¬ä¸Šæ²¡æœ‰è¿™æ ·çš„éœ€è¦,ä½†æ˜¯å¦‚Dagger2 ä½¿ç”¨ç¼–è¯‘æ—¶æ³¨è§£ + APT å®ç°ä¾èµ–æ³¨å…¥ å…¶ä»–å¦‚ARouter,BufferKnike,Glideä¹Ÿä¼šä½¿ç”¨è¿™æ ·çš„æŠ€æœ¯. å¦‚Glide package com.bumptech.glide.annotation.compiler; // public final class GlideAnnotationProcessor extends AbstractProcessor{ @Override public synchronized void init(ProcessingEnvironment processingEnvironment) { super.init(processingEnvironment); //... //ä¸»è¦æ˜¯åˆå§‹åŒ–ä¸€äº›å·¥å…·ç±»å•Šä»€ä¹ˆçš„ } @Override public Set&lt;String&gt; getSupportedAnnotationTypes() { //... //è¯¥æ–¹æ³•ä¸­è¿”å›æ‰€æœ‰æ³¨è§£çš„ç±» } @Override public SourceVersion getSupportedSourceVersion() { return SourceVersion.latestSupported(); } @Override public boolean process(Set&lt;? extends TypeElement&gt; set, RoundEnvironment env) { //... //è¿™é‡Œæ˜¯é‡è¦çš„éƒ¨åˆ†,é€šè¿‡æ³¨é‡Šæˆ‘ä»¬å°±èƒ½çŸ¥é“å®ƒå¤§æ¦‚åšä»€ä¹ˆäº† } } éå†å¾—åˆ°éœ€è¦è§£æçš„å…ƒç´ åˆ—è¡¨ åˆ¤æ–­ç¬¦åˆè¦æ±‚çš„å…ƒç´  ä¿®æ”¹,æ•´ç†è¾“å‡ºå‚æ•°,æˆ–è€…å€ŸåŠ©APTç”Ÿäº§ä»£ç ç­‰ å¦‚æœä½ å¯¹è¿™éƒ¨åˆ†æ„Ÿå…´è¶£,ä¸å¦¨é€‰ä¸€ä¸ªåº“çœ‹çœ‹","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"LeetCode-ç½—é©¬æ•°å­—è½¬æ•´æ•°","slug":"roman-to-integer","date":"2018-08-06T08:36:46.000Z","updated":"2019-12-22T12:07:09.901Z","comments":true,"path":"2018/08/06/roman-to-integer/","link":"","permalink":"https://www.wangzhumo.com/2018/08/06/roman-to-integer/","excerpt":"ç»™å®šä¸€ä¸ªç½—é©¬æ•°å­—ï¼Œå°†å…¶è½¬æ¢æˆæ•´æ•°ã€‚è¾“å…¥ç¡®ä¿åœ¨ 1 åˆ° 3999 çš„èŒƒå›´å†…ã€‚ ç¤ºä¾‹ 1: è¾“å…¥: &quot;III&quot; è¾“å‡º: 3 å‰è¨€è¿™ä¸€é¢˜å…¶å®ä¸åœ¨äºç®—æ³•æœ‰å¤šéš¾,è€Œæ˜¯åœ¨äºä½ å¯¹äºè¿™ä¸ªç½—é©¬æ•°å­—ä¸æ•´å½¢ä¹‹é—´çš„å…³ç³»è¦ææ¸…æ¥š åŸºæœ¬å­—ç¬¦ I V X L C D M ç›¸åº”çš„é˜¿æ‹‰ä¼¯æ•°å­—è¡¨ç¤ºä¸º 1 5 10 50 100 500 1000 ä¸Šé¢æ˜¯ä»–ä»¬ä¹‹é—´çš„å¯¹åº”å…³ç³»,ä½†æ˜¯è¿™è¿˜ä¸å¤Ÿ(ä»¥ä¸‹æ¥è‡ªç™¾åº¦ç™¾ç§‘)","text":"ç»™å®šä¸€ä¸ªç½—é©¬æ•°å­—ï¼Œå°†å…¶è½¬æ¢æˆæ•´æ•°ã€‚è¾“å…¥ç¡®ä¿åœ¨ 1 åˆ° 3999 çš„èŒƒå›´å†…ã€‚ ç¤ºä¾‹ 1: è¾“å…¥: &quot;III&quot; è¾“å‡º: 3 å‰è¨€è¿™ä¸€é¢˜å…¶å®ä¸åœ¨äºç®—æ³•æœ‰å¤šéš¾,è€Œæ˜¯åœ¨äºä½ å¯¹äºè¿™ä¸ªç½—é©¬æ•°å­—ä¸æ•´å½¢ä¹‹é—´çš„å…³ç³»è¦ææ¸…æ¥š åŸºæœ¬å­—ç¬¦ I V X L C D M ç›¸åº”çš„é˜¿æ‹‰ä¼¯æ•°å­—è¡¨ç¤ºä¸º 1 5 10 50 100 500 1000 ä¸Šé¢æ˜¯ä»–ä»¬ä¹‹é—´çš„å¯¹åº”å…³ç³»,ä½†æ˜¯è¿™è¿˜ä¸å¤Ÿ(ä»¥ä¸‹æ¥è‡ªç™¾åº¦ç™¾ç§‘) ç›¸åŒçš„æ•°å­—è¿å†™ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºè¿™äº›æ•°å­—ç›¸åŠ å¾—åˆ°çš„æ•°,å¦‚:â…¢ = 3 å°çš„æ•°å­—åœ¨å¤§çš„æ•°å­—çš„å³è¾¹ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºè¿™äº›æ•°å­—ç›¸åŠ å¾—åˆ°çš„æ•°, å¦‚:â…§ = 8; â…« = 12 å°çš„æ•°å­—,(é™äºâ… ã€X å’ŒC)åœ¨å¤§çš„æ•°å­—çš„å·¦è¾¹ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºå¤§æ•°å‡å°æ•°å¾—åˆ°çš„æ•°,å¦‚:â…£= 4; â…¨= 9 æ­£å¸¸ä½¿ç”¨æ—¶,è¿å†™çš„æ•°å­—é‡å¤ä¸å¾—è¶…è¿‡ä¸‰æ¬¡ åœ¨ä¸€ä¸ªæ•°çš„ä¸Šé¢ç”»ä¸€æ¡æ¨ªçº¿,è¡¨ç¤ºè¿™ä¸ªæ•°æ‰©å¤§1000å€ æ€è·¯ éœ€è¦ä¸€ä¸ªé”®å€¼å¯¹æ¥ä¿å­˜ç½—é©¬æ•°å­—ä¸æ•´å½¢çš„å…³ç³» éå†,å¹¶æ¯”è¾ƒå‰ä¸€ä¸ªç½—é©¬å­—ç¬¦ä¸å½“å‰ç½—é©¬å­—ç¬¦çš„å¤§å° å½“å‰ç½—é©¬å­—ç¬¦æ›´å¤§,åˆ™+= å½“å‰å°,åˆ™-= è¾“å‡ºç»“æœ ä»£ç å®ç°/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/8/7 ä¸‹åˆ5:41 * ç»™å®šä¸€ä¸ªç½—é©¬æ•°å­—ï¼Œå°†å…¶è½¬æ¢æˆæ•´æ•°ã€‚è¾“å…¥ç¡®ä¿åœ¨ 1 åˆ° 3999 çš„èŒƒå›´å†…ã€‚ * * ç¤ºä¾‹ 1: * * è¾“å…¥: &quot;III&quot; * è¾“å‡º: 3 * */ public class RomanToIntClass { private static HashMap&lt;Character, Integer&gt; contrastMap; static { contrastMap = new HashMap&lt;&gt;(); contrastMap.put(&#39;I&#39;, 1); contrastMap.put(&#39;V&#39;, 5); contrastMap.put(&#39;X&#39;, 10); contrastMap.put(&#39;L&#39;, 50); contrastMap.put(&#39;C&#39;, 100); contrastMap.put(&#39;D&#39;, 500); contrastMap.put(&#39;M&#39;, 1000); } /** * ç½—é©¬è½¬æ•´å½¢ * @param romanStr ç½—é©¬å­—ç¬¦ä¸² * @return æ•´æ•° */ public static int romanToInt(String romanStr){ char[] romanCharArray = romanStr.toCharArray(); int result = 0; for (int i = 0; i &lt; romanCharArray.length; i++) { //éå†è¿™ä¸ªç½—é©¬æ•°ç»„ if (i == romanCharArray.length -1 || contrastMap.get(romanCharArray[i+1]) &lt;= contrastMap.get(romanCharArray[i])){ //å¦‚æœæ»¡è¶³,è¯´æ˜å½“å‰çš„è¿™ä¸ªç½—é©¬å­—ç¬¦æ˜¯å¤§äºåä¸€ä¸ªç½—é©¬æ•°å­—çš„,åˆ™åº”è¯¥åŠ ä¸Šå½“å‰çš„ç½—é©¬å­—ç¬¦ result += contrastMap.get(romanCharArray[i]); }else{ //åˆ™æ˜¯å‰é¢å°,åé¢å¤§,åº”è¯¥å‡å»å½“å‰çš„è¿™ä¸ªç½—é©¬å­—ç¬¦ result -= contrastMap.get(romanCharArray[i]); } } return result; } } ç»“æœè¾“å…¥: MCMXCIV è¾“å‡º: 1994 Process finished with exit code 0","categories":[{"name":"Programme","slug":"Programme","permalink":"https://www.wangzhumo.com/categories/Programme/"}],"tags":[{"name":"Programme","slug":"Programme","permalink":"https://www.wangzhumo.com/tags/Programme/"}]},{"title":"ç®—æ³•å¤ä¹ ç¬”è®°-å¿«é€Ÿæ’åº","slug":"Arithmetic-quick-sort","date":"2018-07-31T10:04:11.000Z","updated":"2019-12-22T12:04:54.504Z","comments":true,"path":"2018/07/31/Arithmetic-quick-sort/","link":"","permalink":"https://www.wangzhumo.com/2018/07/31/Arithmetic-quick-sort/","excerpt":"å‰è¨€é€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†,å…¶ä¸­ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½æ¯”å¦å¤–ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°,ç„¶åå†æŒ‰æ­¤æ–¹æ³•å¯¹è¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åº,æ•´ä¸ªæ’åºè¿‡ç¨‹å¯ä»¥é€’å½’è¿›è¡Œ,ä»¥æ­¤è¾¾åˆ°æ•´ä¸ªæ•°æ®å˜æˆæœ‰åºåºåˆ—ã€‚ å¿«é€Ÿæ’åºç”± C. A. R. Hoareï¼ˆä¸œå°¼éœå°”ï¼ŒCharles Antony Richard Hoareï¼‰åœ¨1960å¹´æå‡º .è€Œåç»è¿‡å¾ˆå¤šäºº,å¾ˆé•¿æ—¶é—´çš„ä¼˜åŒ–,æ‰å¾—åˆ°ç°åœ¨çš„ç‰ˆæœ¬.å¿«é€Ÿæ’åºå¯ä»¥è¯´æ˜¯ä¸€ä¸ªè‡³å…³é‡è¦çš„ç®—æ³•äº†,ç°åœ¨çš„å¾ˆå¤šè¯­è¨€åŸºç¡€åº“ä¸­çš„æ’åº,å°±æ˜¯ä½¿ç”¨çš„å¿«é€Ÿæ’åºç®—æ³•æ¥å®Œæˆçš„.","text":"å‰è¨€é€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†,å…¶ä¸­ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½æ¯”å¦å¤–ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°,ç„¶åå†æŒ‰æ­¤æ–¹æ³•å¯¹è¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åº,æ•´ä¸ªæ’åºè¿‡ç¨‹å¯ä»¥é€’å½’è¿›è¡Œ,ä»¥æ­¤è¾¾åˆ°æ•´ä¸ªæ•°æ®å˜æˆæœ‰åºåºåˆ—ã€‚ å¿«é€Ÿæ’åºç”± C. A. R. Hoareï¼ˆä¸œå°¼éœå°”ï¼ŒCharles Antony Richard Hoareï¼‰åœ¨1960å¹´æå‡º .è€Œåç»è¿‡å¾ˆå¤šäºº,å¾ˆé•¿æ—¶é—´çš„ä¼˜åŒ–,æ‰å¾—åˆ°ç°åœ¨çš„ç‰ˆæœ¬.å¿«é€Ÿæ’åºå¯ä»¥è¯´æ˜¯ä¸€ä¸ªè‡³å…³é‡è¦çš„ç®—æ³•äº†,ç°åœ¨çš„å¾ˆå¤šè¯­è¨€åŸºç¡€åº“ä¸­çš„æ’åº,å°±æ˜¯ä½¿ç”¨çš„å¿«é€Ÿæ’åºç®—æ³•æ¥å®Œæˆçš„. æ€è€ƒè¿™é‡Œæˆ‘æ‰“ç®—ä½¿ç”¨å‰åæŒ‡é’ˆçš„æ–¹æ³•æ¥å®Œæˆå¿«é€Ÿæ’åº.å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆ,ä¸€ä¸ªcurræŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ,è€ŒpreæŒ‡å‘çš„æ˜¯curr-1çš„ä½ç½®. å®šä¹‰currä»¥åŠpreä¸¤ä¸ªæŒ‡é’ˆ å½“array[curr] &lt; key åˆ™currä¸preæŒ‡é’ˆåŒæ—¶å‘åç§»åŠ¨ å½“array[curr] &gt; key åˆ™currå‘åç§»åŠ¨ä¸€ä½,preä¿æŒä¸åŠ¨(å½“å‰è¿™ä¸ªä½ç½®çš„å€¼æ˜¯å°äºkeyçš„) å½“array[curr] &lt; key åˆ™éœ€è¦äº¤æ¢array[curr]ä»¥åŠarray[pre] å¯ä»¥è¿™ä¹ˆè¯´,æ¯æ¬¡æ‰¾åˆ°array[curr] è¿™ä¸ªä½ç½®çš„å…ƒç´ æ¯”keyè¦å°,è¯´æ˜å®ƒä¸åº”è¯¥åœ¨å½“å‰çš„è¿™ä¸ªä½ç½®,éœ€è¦å’Œpreçš„ä½ç½®å…ƒç´ äº¤æ¢,åº”ä¸ºpreä¸€ç›´æ˜¯æŒ‡å‘äº†æœ€åä¸€ä¸ªå°äºkeyçš„å…ƒç´ ä½ç½® çœ‹ä¸Šå›¾æ‰€ç¤º,åºå·5çš„è¿™ä¸€æ’,æˆ‘ç”¨æ¡†åˆ†å‡ºäº†ä¸‰ä¸ªéƒ¨åˆ†. ç»¿è‰²åŒºåŸŸ[0,pre] éƒ½æ˜¯å°äºkeyçš„ çº¢è‰²åŒºåŸŸ[pre+1,curr)éƒ½æ˜¯å¤§äºkeyçš„ è€Œæ©™è‰²çš„åŒºåŸŸ[curr,right]éƒ½æ˜¯æ²¡æœ‰ç»è¿‡æ¯”è¾ƒçš„åŒºåŸŸ é‚£ä¹ˆå¾ˆå®¹æ˜“å°±å¯ä»¥çœ‹å‡º,å…¶å®æˆ‘ä»¬å°±æ˜¯æƒ³è®©è¿™ä¸ªæ•°ç»„,ä»¥preä¸ºåˆ†ç•Œç‚¹,å·¦é¢çš„éƒ½å°äºkey,è€Œå³é¢çš„éƒ½å¤§äº é‚£ä¹ˆ,åªè¦å‘ç°array[curr] &lt; key ç›´æ¥å’Œarray[pre+1]äº¤æ¢ä½ç½®,è¿˜æ˜¯æ»¡è¶³ä¸Šé¢çš„è¦æ±‚çš„. ä»£ç å®ç°/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/7/31 ä¸‹åˆ5:54 * å¿«é€Ÿæ’åº[left,right) */ public class QuickClass{ //ä¸ºäº†ç»™åˆ†å‰²æ•°ç»„çš„æ–¹æ³•ä½¿ç”¨,ç”¨äºé€‰å‡ºä¸€ä¸ªkey private static Random mRandom = new Random(System.currentTimeMillis()); /** * å¿«é€Ÿæ’åºå…¥å£-å‰åæŒ‡é’ˆ * * @param array è¦æ’åºçš„æ•°ç»„ * @param left å·¦è¾¹ç•Œ * @param right å³è¾¹ç•Œ */ public static void quickSort(int[] array, int left, int right) { //å¦‚æœleft &gt;= rightäº†,è¯´æ˜è¿™ä¸ªæ•°ç»„å·²ç»ä¸èƒ½å†ç»§ç»­åˆ†äº† if (left &gt;= right) return; //æ­¤å¤„æ‰¾åˆ°è¿™ä¸ªp,åˆ†å‰²ç‚¹,éœ€è¦ç»è¿‡ä¸€è½®çš„å¿«é€Ÿæ’åº int p = partition(array, left, right); //é€’å½’è°ƒç”¨ quickSort(array, left, p); quickSort(array, p + 1, right); } /** * åˆ†å‰²æ•°ç»„ * æ’åºarray[left , right] çš„é¡ºåº * ä½¿å¾—è¿”å›ä¸€ä¸ªp ,åœ¨ array[left,p] éƒ½å°äºk åœ¨array[p+1 , right)éƒ½å¤§äºk * * @param array è¦æ’åºçš„æ•°ç»„ * @param left å·¦è¾¹è¾¹ç•Œ * @param right å³è¾¹è¾¹ç•Œ * @return p åˆ†å‰²äº†ä¸¤ä¸ªæ•°ç»„çš„ä½ç½® */ private static int partition(int[] array, int left, int right) { //éšæœºæ›¿æ¢ä¸€ä¸ªå…ƒç´ åˆ°keyçš„ä½ç½®,è¿™æ˜¯ä¸ºäº†é¿å…å¦‚æœæ’åˆ—ä¸€ä¸ªè¿‘ä¹æœ‰åºçš„æ•°ç»„æ—¶, //é€ æˆä¸€ä¾§çš„å­æ•°ç»„ç‰¹å¤š,è€Œå¦ä¸€ä¾§åˆ™å¾ˆå°‘,ä½¿å¾—æ•ˆç‡é™ä½ swap(array,left,mRandom.nextInt(right - left + 1) + left); //æ‹¿å‡ºkey int key = array[left]; //å®šä¹‰ä¸€ä¸ªpreç­‰äºcurr-1 //ä¸ºä»€ä¹ˆç›´æ¥èµ‹å€¼ä¸ºlefté‚£?å› ä¸ºleftæ˜¯æˆ‘keyçš„ä½ç½®, //å¯ä»¥ç›´æ¥ä¸ç”¨æ¯”è¾ƒ,curr = pre+1å³æ˜¯ç¬¬ä¸€ä¸ªè¦æ¯”è¾ƒçš„å…ƒç´  int pre = left; for(int curr = pre+1;curr &lt;= right;curr++){ //æ­¤æ—¶åˆ¤æ–­ array[curr] ä¸ keyçš„å…³ç³»å³å¯ if(array[curr] &lt; key){ swap(array,curr, ++pre); } } //å®Œæˆåéœ€è¦æŠŠkeyå…ƒç´ ç§»åŠ¨åˆ°preçš„ä½ç½®å» swap(array,left,pre); return pre; } /** * äº¤æ¢ä½ç½® * * @param arr æ•°ç»„ * @param a * @param b */ private static void swap(int[] arr, int a, int b) { int temp = arr[a]; arr[a] = arr[b]; arr[b] = temp; } } æ€»ç»“è¿™è¿˜åªæ˜¯å¿«é€Ÿæ’åºçš„æœ€ç®€å•æ–¹æ³•,è¿˜æœ‰æ›´ä¸ºå¤æ‚ä¸€äº›çš„ä¸‰è·¯å¿«æ’ç­‰,åé¢ç»§ç»­å­¦ä¹  æµ‹è¯•æ‰“å°: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21","categories":[{"name":"Programme","slug":"Programme","permalink":"https://www.wangzhumo.com/categories/Programme/"}],"tags":[{"name":"Programme","slug":"Programme","permalink":"https://www.wangzhumo.com/tags/Programme/"}]},{"title":"ç®—æ³•å¤ä¹ ç¬”è®°-å½’å¹¶æ’åº","slug":"Arithmetic-merge-sort","date":"2018-07-31T08:24:50.000Z","updated":"2019-12-22T12:12:04.759Z","comments":true,"path":"2018/07/31/Arithmetic-merge-sort/","link":"","permalink":"https://www.wangzhumo.com/2018/07/31/Arithmetic-merge-sort/","excerpt":"å‰è¨€å½’å¹¶æ’åºå¯ä»¥è¯´æ˜¯ä¸€ä¸ªç»å…¸çš„ä½¿ç”¨åˆ†æ²»æ€ç»´çš„æ’åºç®—æ³•äº†. å…ˆæŠŠé—®é¢˜åˆ†ä¸ºä¸€äº›å°çš„é—®é¢˜ç„¶åé€’å½’æ±‚è§£,è€Œä½¿ç”¨æ²»çš„æ€æƒ³æŠŠåˆ†é˜¶æ®µæ±‚å¾—çš„ç­”æ¡ˆåˆå¹¶åœ¨ä¸€èµ·.","text":"å‰è¨€å½’å¹¶æ’åºå¯ä»¥è¯´æ˜¯ä¸€ä¸ªç»å…¸çš„ä½¿ç”¨åˆ†æ²»æ€ç»´çš„æ’åºç®—æ³•äº†. å…ˆæŠŠé—®é¢˜åˆ†ä¸ºä¸€äº›å°çš„é—®é¢˜ç„¶åé€’å½’æ±‚è§£,è€Œä½¿ç”¨æ²»çš„æ€æƒ³æŠŠåˆ†é˜¶æ®µæ±‚å¾—çš„ç­”æ¡ˆåˆå¹¶åœ¨ä¸€èµ·. é¦–å…ˆæˆ‘å¾—æ¥ä¸€å¼ å›¾è¯´æ˜è¿™ä¸ªäº‹: ä¸Šå›¾æ˜¾ç¤ºäº†ä¸€ä¸ªè¾“å…¥æ•°ç»„è¢«åˆ†è§£çš„è¿‡ç¨‹,ä¸‹é¢åªè¦æˆ‘ä»¬èƒ½ç»™ä»–åˆå¹¶èµ·æ¥å°±å¯ä»¥å®Œæˆè¿™æ˜¯è¾“å…¥æ•°ç»„çš„æ’åºäº† åˆå¹¶æ€è·¯åˆå¹¶çš„æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸´æ—¶æ•°ç»„çš„å¸®åŠ©,è¿™ä¸ªä¸´æ—¶æ•°ç»„çš„å¤§å°åº”è¯¥æ˜¯ä¸è¾“å…¥æ•°ç»„çš„å¤§å°ä¸€è‡´çš„. int[] array,int left,int mid,int right,int [] tempArray éœ€è¦ä¼ å…¥ éœ€è¦æ’åºçš„æ•°ç»„,å·¦æ•°ç»„çš„å·¦è¾¹ç•Œ, å·¦æ•°ç»„çš„å³è¾¹ç•Œ ,å³æ•°ç»„å³è¾¹ç•Œ,ä¸´æ—¶æ•°ç»„ éå†å·¦å³æ•°ç»„,ç›´è‡³ä¸¤ä¸ªæ•°ç»„è‡³å°‘æœ‰ä¸€ä¸ªæ•°ç»„å…¨éƒ¨éå†ä¸€æ¬¡ =&gt; å·¦æ•°ç»„å½“å‰index &lt;= mid &amp;&amp; å³æ•°ç»„å½“å‰index &lt;= right æ¯”è¾ƒå·¦å³ä¸¤ä¸ªæ•°ç»„ä¸­å…ƒç´ çš„å¤§å°. åˆ†ä¸ºä¸¤ç§æƒ…å†µ: å·¦æ•°ç»„å½“å‰å…ƒç´  &lt;= å³è¾¹æ•°ç»„å½“å‰å…ƒç´  äº¤æ¢tempArrayå½“å‰ä½ç½® ä¸ å·¦æ•°ç»„å½“å‰å…ƒç´  tempArray çš„index ++ ,å› ä¸ºè¿™ä¸€ä¸ªä½ç½®å·²ç»ç¡®å®šäº†,åº”è¯¥ç¡®å®šä¸‹ä¸€ä¸ªå…ƒç´ äº† å·¦è¾¹å½“å‰å…ƒç´ index ++ ,è¿™ä¸ªå…ƒç´ å·²ç»æ¯”è¾ƒè¿‡äº†,åº”è¯¥ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªä½ç½®ä¸å³æ•°ç»„å…ƒç´ æ¯”è¾ƒ å³è¾¹å½“å‰å…ƒç´ æ›´å¤§ äº¤æ¢tempArrayå½“å‰ä½ç½® ä¸ å³æ•°ç»„å½“å‰å…ƒç´  tempArray çš„index ++ å³è¾¹å½“å‰å…ƒç´ index ++ å½“ä¸Šé¢çš„å¾ªç¯å®Œæˆå,è¿˜æœ‰ä¸€ç§å¯èƒ½æ˜¯,å³è¾¹æˆ–å·¦è¾¹çš„æ•°ç»„ä¸­è¿˜æœ‰å…ƒç´ æ²¡æœ‰å‚ä¸æ¯”è¾ƒ =&gt; å› ä¸ºè¿™äº›å‰©ä¸‹çš„å…ƒç´ éƒ½æ¯”å¦ä¸€ä¸ªæ•°ç»„ä¸­å…ƒç´ å¤§,è€Œè¿™ä¸ªæ•°ç»„æœ¬èº«ä¹Ÿæ˜¯æœ‰åºçš„åˆ™ =&gt; æŠŠè¿™äº›å‰©ä¸‹çš„å…ƒç´ å…¨éƒ¨è¿½åŠ åˆ°tempArray æœ€åæˆ‘ä»¬å‘ç°,tempArrayå·²ç»æ˜¯ä¸€ä¸ªæœ‰åºçš„æ•°ç»„äº†,ä½†æ˜¯æˆ‘ä»¬è¦æ’åºçš„æ˜¯array =&gt; æŠŠtempArrayä¸­å…ƒç´ å…¨éƒ¨å¤åˆ¶ç»™array ä»£ç å®ç°/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/7/31 ä¸‹åˆ4:26 * å½’å¹¶æ’åº */ public class MergeClass { /** * å½’å¹¶æ’åº * * @param array éœ€è¦æ’åºçš„æ•°ç»„ * @param left å·¦è¾¹ç•Œ * @param right å³è¾¹ç•Œ * @param tempArray ä¸´æ—¶æ•°ç»„,é¿å…é¢‘ç¹åˆ›å»ºæ•°ç»„ */ public static void MergeSort(int[] array,int left,int right,int [] tempArray){ mergeSort(array, left, right, tempArray); } public static void mergeSort(int[] array,int left,int right,int [] tempArray){ //é€šè¿‡è§‚å¯Ÿä¸Šå›¾,æˆ‘ä»¬å¯ä»¥çŸ¥é“,å¦‚æœ left &gt;= right //å°±æ˜¯æœ€å°çš„æ•°ç»„äº†,æ‰€ä»¥è¦åœæ­¢é€’å½’,å¼€å§‹è¿”å› if(left &gt;= right){ return; } //è®¡ç®—å½“å‰ä¼ å…¥æ•°ç»„çš„ä¸­ç‚¹,ç”¨æ¥æŠŠæ•°ç»„åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†,è¿™é‡Œæ³¨æ„é¿å…intè¶Šç•Œ int mid = left + (right - left) / 2 ; //é€’å½’è°ƒç”¨å·¦å³æ•°ç»„ //å·¦è¾¹æ•°ç»„ [left , mid] mergeSort(array, left, mid, tempArray); //å³è¾¹æ•°ç»„ (mid,right] mergeSort(array, mid + 1 , right , tempArray); //åˆå¹¶è¿™ä¸ªæ•°ç»„,éœ€è¦åŸå§‹æ•°ç»„,ä¸´æ—¶æ•°ç»„,å·¦å³è¾¹ç•Œä»¥åŠmid(è¿™æ˜¯ä¸ºäº†è®¡ç®—å³è¾¹æ•°ç»„çš„å¼€å§‹index) merge(array,left,mid,right,tempArray); } /** * åˆå¹¶æ•°ç»„ * * @param array * @param left * @param mid * @param right * @param tempArray */ public static void merge(int[] array,int left,int mid,int right,int [] tempArray){ //ä¸ºäº†åé¢çš„æ“ä½œ,å…ˆå®šä¹‰å¥½å‡ ä¸ªè¾¹ç•Œå€¼ int i = left; //å·¦æ•°ç»„indexå¼€å§‹ä½ç½® int j = mid + 1; //å³æ•°ç»„idnexå¼€å§‹ä½ç½® int temp = 0; //ä¸´æ—¶æ•°ç»„indexçš„å¼€å§‹ä½ç½® //1.å¾ªç¯ while(i &lt;= mid &amp;&amp; j &lt;= right){ //2.æ¯”è¾ƒå¤§å° if(array[i] &lt;= array[j]){ //åˆå¹¶èµ‹å€¼ä¸index ++ tempArray[temp++] = array[i++]; }else{ tempArray[temp++] = array[j++]; } } //3.å‰©ä½™å…ƒç´  while(i &lt;= mid){ tempArray[temp++] = array[i++]; } while(j &lt;= right){ tempArray[temp++] = array[j++]; } //4.å¤åˆ¶å›array temp = 0; while(left &lt;= right){ array[left++] = tempArray[temp++]; } } } æœ€åæµ‹è¯•äº†ä¸€ä¸‹,æ²¡é—®é¢˜ 13 21 23 26 45 67 123 213 456 563","categories":[{"name":"Programme","slug":"Programme","permalink":"https://www.wangzhumo.com/categories/Programme/"}],"tags":[{"name":"Programme","slug":"Programme","permalink":"https://www.wangzhumo.com/tags/Programme/"}]},{"title":"ConstraintLayoutä½¿ç”¨æŒ‡å—-è¿›é˜¶ä½¿ç”¨","slug":"ConstraintLayout-Advance","date":"2018-07-30T06:54:45.000Z","updated":"2019-12-22T12:11:36.552Z","comments":true,"path":"2018/07/30/ConstraintLayout-Advance/","link":"","permalink":"https://www.wangzhumo.com/2018/07/30/ConstraintLayout-Advance/","excerpt":"å‰è¨€ConstraintLayoutä½¿ç”¨æŒ‡å—-åŸºç¡€çš„çº¦æŸ é€šè¿‡ä¸Šä¸€ç¯‡çš„äº†è§£,å¤§æ¦‚å·²ç»çŸ¥é“ConstraintLayoutçš„åŸºæœ¬åŠŸèƒ½äº†,ä½†æ˜¯å¯¹äºæˆ‘ä»¬æ—¥å¸¸çš„å¼€å‘å·¥ä½œ,è¿˜æ˜¯æœ‰ä¸€å®šçš„å·®è·,æ‰€ä»¥è¿™ä¸€ç¯‡,ä¸»è¦è®°å½•ä¸€äº›å¼€å‘ä¸­ç”¨åˆ°çš„è¿›é˜¶åŠŸèƒ½. è¡Œäº†,æ¥ä¸Šæ–‡çš„çºµæ¨ªæ¯”,ä¸Šä»£ç ","text":"å‰è¨€ConstraintLayoutä½¿ç”¨æŒ‡å—-åŸºç¡€çš„çº¦æŸ é€šè¿‡ä¸Šä¸€ç¯‡çš„äº†è§£,å¤§æ¦‚å·²ç»çŸ¥é“ConstraintLayoutçš„åŸºæœ¬åŠŸèƒ½äº†,ä½†æ˜¯å¯¹äºæˆ‘ä»¬æ—¥å¸¸çš„å¼€å‘å·¥ä½œ,è¿˜æ˜¯æœ‰ä¸€å®šçš„å·®è·,æ‰€ä»¥è¿™ä¸€ç¯‡,ä¸»è¦è®°å½•ä¸€äº›å¼€å‘ä¸­ç”¨åˆ°çš„è¿›é˜¶åŠŸèƒ½. è¡Œäº†,æ¥ä¸Šæ–‡çš„çºµæ¨ªæ¯”,ä¸Šä»£ç  å¼€å‘ä¸­å®ä¾‹å‚ç…§çº¿(Guidelines) æœ¬æ¥ä»¥ä¸ºå¾ˆé«˜ç«¯ public class Guideline extends View{ æ„é€ å‡½æ•°{ super.setVisibility(8); } public void setVisibility(int visibility) { } public void draw(Canvas canvas) { } } å“ˆå“ˆ,å°±æ˜¯ä¸€ä¸ªVIew,ä¸ç»˜åˆ¶åœ¨ç•Œé¢ä¸Šè€Œå·². &lt;android.support.constraint.Guideline android:id=&quot;@+id/guideline&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; app:layout_constraintGuide_begin=&quot;127dp&quot; //è¿™é‡Œæ˜¯æŒ‡ä»å³è¾¹å¼€ä½¿,åç§»127dp app:layout_constraintGuide_end=&quot;127dp&quot; //è¿™é‡Œæ˜¯æŒ‡ä»å·¦è¾¹å¼€ä½¿,åç§»127dp app:layout_constraintGuide_percent=&quot;0.5&quot; //åœ¨æ•´ä¸ªå¸ƒå±€çš„50%å¤„,ä¹Ÿå°±æ˜¯å±…ä¸­ android:orientation=&quot;vertical&quot;/&gt; //çº¿çš„ç±»å‹æ˜¯,å‚ç›´ é‚£ä¹ˆ,æˆ‘ä»¬å¯ä»¥å°†å…¶ä»–æ§ä»¶é™„ç€åœ¨å®ƒä¸Šé¢,ä¸€èµ·å¸ƒå±€ç§»åŠ¨ Chain é“¾è¿™ç©æ„å¯å‰å®³äº†,å°±æ¯”æƒé‡ä»€ä¹ˆçš„å¼ºäº†æœ‰1000å€å§ æ¯”å¦‚æˆ‘æƒ³æŠŠä¸‹å›¾è¿™æ ·çš„ä¸‰ä¸ªæ§ä»¶å¹³åˆ†æ•´ä¸ªå¸ƒå±€å®½åº¦ æ­£å¸¸çš„æ“ä½œæ˜¯,ç”¨ä¸€ä¸ªLinearLayoutè®¾ç½®æƒé‡ å¦‚æœæˆ‘ä»¬ä½¿ç”¨ConstraintLayoutä¼šæ›´åŠ ç®€å•,è€Œä¸”åŠŸèƒ½æ›´å¤š &lt;layout xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot; xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt; &lt;android.support.constraint.ConstraintLayout android:id=&quot;@+id/rootView&quot; android:background=&quot;@android:color/white&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot;&gt; &lt;ImageView android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; app:srcCompat=&quot;@mipmap/ic_launcher&quot; android:id=&quot;@+id/imageView2&quot; app:layout_constraintStart_toStartOf=&quot;parent&quot; app:layout_constraintEnd_toStartOf=&quot;@+id/imageView3&quot; app:layout_constraintHorizontal_chainStyle=&quot;spread_inside&quot;/&gt; &lt;ImageView android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; app:srcCompat=&quot;@mipmap/ic_launcher&quot; android:id=&quot;@+id/imageView3&quot; app:layout_constraintStart_toEndOf=&quot;@+id/imageView2&quot; app:layout_constraintEnd_toStartOf=&quot;@+id/imageView4&quot;/&gt; &lt;ImageView android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; app:srcCompat=&quot;@mipmap/ic_launcher&quot; android:id=&quot;@+id/imageView4&quot; app:layout_constraintStart_toEndOf=&quot;@+id/imageView3&quot; app:layout_constraintEnd_toEndOf=&quot;parent&quot;/&gt; &lt;/android.support.constraint.ConstraintLayout&gt; &lt;/layout&gt; ä½ å¯èƒ½ä¼šè¯´,è¿™ä¹ˆå¤šlayout_constraintStart_toEndOf ä»€ä¹ˆçš„,æ˜æ˜æ›´éº»çƒ¦ æ“ä½œæ­¥éª¤ é€‰ä¸­ä¸€ä¸ªæ§ä»¶ æ¡†é€‰æ‰€æœ‰è¦ç»„æˆChainçš„æ§ä»¶ æ·»åŠ Chain è¿˜èƒ½çœ‹åˆ°æˆ‘ç‚¹å‡»äº†ä¸€ä¸ª é“¾æ¥ æŒ‰é’®,ä»–ä»¬ä¸‰ä¸ªçš„å¸ƒå±€åˆå‘ç”Ÿäº†å˜åŒ– chainStyleè¿™æ˜¯ç”±chainStyleçš„æ”¹å˜é€ æˆçš„ app:layout_constraintHorizontal_chainStyle=&quot;spread_inside&quot; spread(é»˜è®¤çš„æ¨¡å¼) å¹³åˆ†é—´éš™è®©å¤šä¸ª View å¸ƒå±€åˆ°å‰©ä½™ç©ºé—´ spread_inside è¾¹ç¼˜çš„ä¸¤ä¸ª View ç´§è´´çˆ¶æ§ä»¶è¾¹ç¼˜,å‰©ä½™çš„ View åœ¨å‰©ä½™çš„ç©ºé—´å†…å¹³åˆ†é—´éš™å¸ƒå±€ packed æ‰€æœ‰çš„Viewsæ‰“åŒ…å±…ä¸­,ç›¸äº’æ²¡æœ‰é—´éš” è¦æ³¨æ„çš„æ˜¯spreadè¿˜æœ‰ä¸¤ä¸ªå¼ºå¤§çš„ä¸œè¥¿ å¦‚æœæˆ‘æŠŠä¸‰ä¸ªæ§ä»¶çš„widthè®¾ç½®ä¸º 0dpä¼šè¿™æ ·: å¦‚æœä½ æƒ³è®©ä»–ä»¬å‡ ä¸ªæ§ä»¶æŒ‰æ¯”ä¾‹å¹³åˆ†: å¯ä»¥æ·»åŠ è¯¥å±æ€§ app:layout_constraintHorizontal_weight = &quot;0.3&quot; è¿™æ˜¯æˆ‘è®¾ç½®çš„ 0.3 : 0.2 : 0.5 è¦†ç›–çˆ¶æ§ä»¶&lt;ImageView android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;200dp&quot; app:srcCompat=&quot;@drawable/ic_launcher_background&quot; android:id=&quot;@+id/imageView5&quot; android:scaleType=&quot;fitXY&quot; app:layout_constraintStart_toStartOf=&quot;parent&quot; app:layout_constraintEnd_toEndOf=&quot;parent&quot; app:layout_constraintTop_toTopOf=&quot;parent&quot; tools:ignore=&quot;VectorDrawableCompat&quot;/&gt; &lt;ImageView android:id=&quot;@+id/imageView7&quot; android:layout_width=&quot;40dp&quot; android:layout_height=&quot;40dp&quot; app:srcCompat=&quot;@mipmap/icon_youtube&quot; tools:layout_editor_absoluteX=&quot;160dp&quot; app:layout_constraintBottom_toBottomOf=&quot;@+id/imageView5&quot; app:layout_constraintTop_toBottomOf=&quot;@+id/imageView5&quot;/&gt; ä¸»è¦å…³æ³¨è¿™ä¸¤å¥ app:layout_constraintBottom_toBottomOf=&quot;@+id/imageView5&quot; app:layout_constraintTop_toBottomOf=&quot;@+id/imageView5&quot; æˆ‘ä»¬çš„imageView7 å§å®ƒçš„ä¸Šä¸‹éƒ½æŒ‡å®šäº†ä½äº imageView5çš„ä¸‹åº•è¾¹. ç™¾åˆ†æ¯”å¸ƒå±€app:layout_constraintHorizontal_bias=&quot;0.3&quot; ç”¨å¥½è¿™ä¸ªå±æ€§å’Œ GuideLineå³å¯ æœªå®Œå¾…ç»­..åé¢æœ‰ç”¨çš„,ä¼šç»§ç»­æ·»åŠ åˆ°è¿™é‡Œ","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"ä»Šæ—¥å¤´æ¡çš„å±å¹•é€‚é…æ–¹æ¡ˆ","slug":"Screen-toutiao-resize","date":"2018-07-30T06:16:26.000Z","updated":"2019-12-22T12:06:45.760Z","comments":true,"path":"2018/07/30/Screen-toutiao-resize/","link":"","permalink":"https://www.wangzhumo.com/2018/07/30/Screen-toutiao-resize/","excerpt":"å‰è¨€ ä»Šæ—¥å¤´æ¡ä¼ é€é—¨: https://mp.weixin.qq.com/s/d9QCoBP6kV9VSWvVldVVwA ç°åœ¨Androidç«¯çš„é€‚é…æ–¹æ¡ˆä¹Ÿæ˜¯äº”èŠ±å…«é—¨çš„,ä½†å°±æ˜¯è¿™æ ·,æˆ‘ä»¬çš„UIè®¾è®¡å¸ˆä»¬è¿˜è§‰å¾—å’Œä»–ä»¬çš„è®¾è®¡å›¾ä¸ä¸€è‡´,æˆ‘çœŸçš„æ˜¯æœäº†ä»–ä»¬çš„åƒç´ çœ¼. ä»Šæ—¥å¤´æ¡çš„è¿™ä¸ªé€‚é…æ–¹æ¡ˆ,å¯ä»¥è¯´æ˜¯å–å·§åˆ°ä¸€ä¸ªå¦™å•Šçš„æ°´å¹³äº†.","text":"å‰è¨€ ä»Šæ—¥å¤´æ¡ä¼ é€é—¨: https://mp.weixin.qq.com/s/d9QCoBP6kV9VSWvVldVVwA ç°åœ¨Androidç«¯çš„é€‚é…æ–¹æ¡ˆä¹Ÿæ˜¯äº”èŠ±å…«é—¨çš„,ä½†å°±æ˜¯è¿™æ ·,æˆ‘ä»¬çš„UIè®¾è®¡å¸ˆä»¬è¿˜è§‰å¾—å’Œä»–ä»¬çš„è®¾è®¡å›¾ä¸ä¸€è‡´,æˆ‘çœŸçš„æ˜¯æœäº†ä»–ä»¬çš„åƒç´ çœ¼. ä»Šæ—¥å¤´æ¡çš„è¿™ä¸ªé€‚é…æ–¹æ¡ˆ,å¯ä»¥è¯´æ˜¯å–å·§åˆ°ä¸€ä¸ªå¦™å•Šçš„æ°´å¹³äº†. æ€è·¯android.util.TypedValue#applyDimension public static float applyDimension(int unit, float value, DisplayMetrics metrics) { switch (unit) { case COMPLEX_UNIT_PX: return value; case COMPLEX_UNIT_DIP: return value * metrics.density; case COMPLEX_UNIT_SP: return value * metrics.scaledDensity; case COMPLEX_UNIT_PT: return value * metrics.xdpi * (1.0f/72); case COMPLEX_UNIT_IN: return value * metrics.xdpi; case COMPLEX_UNIT_MM: return value * metrics.xdpi * (1.0f/25.4f); } return 0; } è¿™ä¸€æ®µå°±æ˜¯,ç³»ç»Ÿæ¥è°ƒç”¨,ä»¥ä¾¿ç¼©æ”¾è°ƒæ•´è‡ªå·±çš„å¤§å°,æ»¡è¶³å¯¹åº”å±å¹•å¤§å°çš„ä»£ç äº†. ä¸»è¦çœ‹COMPLEX_UNIT_PX,COMPLEX_UNIT_DIP ,COMPLEX_UNIT_SPè¿™ä¸‰ä¸ªcase å› ä¸ºæˆ‘ä»¬å¼€å‘çš„è¿‡ç¨‹ä¸­,ä¹Ÿä¸»è¦æ˜¯ç”¨äº†è¿™ä¸‰ç§å•ä½,å°¤å…¶æ˜¯DIP,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šæŠŠå­—ä½“çš„å¤§å°ä¹Ÿç”¨DIPè¿™ä¸ªå•ä½æ¥å†™. value * metrics.density é€šè¿‡è§‚å¯Ÿæˆ‘ä»¬å¯ä»¥å‘ç°,éƒ½æ˜¯value * DisplayMetrics.å¸¸é‡ é‚£ä¹ˆæˆ‘è¦æ˜¯èƒ½æŠŠDisplayMetricsé‡Œé¢çš„è¿™ä¸ªå¸¸é‡å€¼æ”¹äº†,æ˜¯ä¸æ˜¯å°±å¯ä»¥ä¸ºæ‰€æ¬²ä¸ºäº†? public float density; //... public float scaledDensity; å¹¸ç¦æ¥å¾—å¤ªçªç„¶,è¿™å‡ ä¸ªå¸¸é‡éƒ½æ˜¯ public è€Œä¸”é finalçš„. å…·ä½“å®ç°ä¸¾ä¾‹è¯´æ˜æˆ‘æœ€è¿‘åšäº†ä¸€ä¸ªå¤§å±çš„é¡¹ç›®,ä½¿å¾—æ˜¯960dp,çœ‹çœ‹è¿™ä¸ªå…¬å¼ æˆ‘çš„è¿™ä¸ªå±å¹•å®½åº¦æ˜¯ 3000px,ä»–çš„å®½åº¦æ˜¯960dp case COMPLEX_UNIT_DIP: return value * metrics.density; å¸¦å…¥å…¬å¼ 3000px = density * 960dp =&gt; åˆ™ density = 3000 / 960 =&gt; åˆ™ density = å±å¹•çœŸå®å®½åº¦ / è®¾è®¡å›¾å®½åº¦(dp) é‚£ä¹ˆä¸‹é¢ç›´æ¥è´´ä»£ç äº† /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/6/25 ä¸‹åˆ5:17 * * ä»Šæ—¥å¤´æ¡çš„å±å¹•é€‚é…æ–¹æ¡ˆ: * ä¿®æ”¹densityå€¼,å¼ºè¡ŒæŠŠæ‰€æœ‰ä¸åŒå°ºå¯¸åˆ†è¾¨ç‡çš„æ‰‹æœºçš„å®½åº¦dpå€¼æ”¹æˆåŒä¸€ä¸ªå€¼ */ public class ResizeDensity { private static float sNoncompatDensity; private static float sNoncompatScaledDensity; /** * * @param activity activity * @param application application */ public static void setCustomDensity(@NonNull Activity activity, @NonNull final Application application) { DisplayMetrics appDisplayMetrics = application.getResources().getDisplayMetrics(); if (sNoncompatDensity == 0) { sNoncompatDensity = appDisplayMetrics.density; sNoncompatDensity = appDisplayMetrics.scaledDensity; application.registerComponentCallbacks(new ComponentCallbacks() { @Override public void onConfigurationChanged(Configuration newConfig) { if (newConfig != null &amp;&amp; newConfig.fontScale &gt; 0) { sNoncompatScaledDensity = application.getResources().getDisplayMetrics().scaledDensity; } } @Override public void onLowMemory() { } }); } float targetDensity = appDisplayMetrics.widthPixels / 960; float targetScaleDensity = targetDensity * (sNoncompatScaledDensity / sNoncompatDensity); int targetDensityDpi = (int) (160 * targetDensity); appDisplayMetrics.density = targetDensity; appDisplayMetrics.scaledDensity = targetScaleDensity; appDisplayMetrics.densityDpi = targetDensityDpi; final DisplayMetrics activityDisplayMetrics = activity.getResources().getDisplayMetrics(); activityDisplayMetrics.density = targetDensity; activityDisplayMetrics.scaledDensity = targetScaleDensity; activityDisplayMetrics.densityDpi = targetDensityDpi; } } æ€»ç»“ç›´æ¥åœ¨Activityä¸­å»è°ƒç”¨å°±å¯ä»¥è¾¾åˆ°æ•ˆæœäº†. ä»Šæ—¥å¤´æ¡å‘ç°çš„ä¸€ä¸ªå°é—®é¢˜: ä½†æ˜¯æµ‹è¯•åå‘ç°å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœåœ¨ç³»ç»Ÿè®¾ç½®ä¸­åˆ‡æ¢å­—ä½“ï¼Œå†è¿”å›åº”ç”¨ï¼Œå­—ä½“å¹¶æ²¡æœ‰å˜åŒ–ã€‚äºæ˜¯è¿˜å¾—ç›‘å¬ä¸‹å­—ä½“åˆ‡æ¢ï¼Œè°ƒç”¨ Application#registerComponentCallbacks æ³¨å†Œä¸‹ onConfigurationChanged ç›‘å¬å³å¯ã€‚ é˜…è¯»æºç â€¦è¯»æºç â€¦æºç â€¦","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"Androidäº‹ä»¶åˆ†å‘æœºåˆ¶-ViewGroup","slug":"Android-MotionEvent-ViewGroup","date":"2018-07-30T04:20:02.000Z","updated":"2019-12-22T12:03:43.376Z","comments":true,"path":"2018/07/30/Android-MotionEvent-ViewGroup/","link":"","permalink":"https://www.wangzhumo.com/2018/07/30/Android-MotionEvent-ViewGroup/","excerpt":"æ€»è§ˆä»€ä¹ˆæ˜¯äº‹ä»¶åˆ†å‘å°±æ˜¯å°†ç³»ç»Ÿä¼ é€’è¿‡æ¥çš„MotionEventåˆ†å‘åˆ°æŸä¸ªå…·ä½“çš„View,å¹¶å¤„ç†è¿™ä¸ªMotionEventçš„æ•´ä¸ªè¿‡ç¨‹ æˆ‘ä»¬å…ˆè¦æ˜ç™½ è´£ä»»é“¾æ¨¡å¼ ViewGroupå’ŒViewçš„æ ‘å½¢ç»“æ„ ä¸€æ¬¡å®Œæ•´çš„MotionEventäº‹ä»¶(ACTION_DOWN , ACTION_MOVE , ACTION_UP)","text":"æ€»è§ˆä»€ä¹ˆæ˜¯äº‹ä»¶åˆ†å‘å°±æ˜¯å°†ç³»ç»Ÿä¼ é€’è¿‡æ¥çš„MotionEventåˆ†å‘åˆ°æŸä¸ªå…·ä½“çš„View,å¹¶å¤„ç†è¿™ä¸ªMotionEventçš„æ•´ä¸ªè¿‡ç¨‹ æˆ‘ä»¬å…ˆè¦æ˜ç™½ è´£ä»»é“¾æ¨¡å¼ ViewGroupå’ŒViewçš„æ ‘å½¢ç»“æ„ ä¸€æ¬¡å®Œæ•´çš„MotionEventäº‹ä»¶(ACTION_DOWN , ACTION_MOVE , ACTION_UP) ä¸»è¦æ–¹æ³• boolean dispatchTouchEvent(MotionEvent ev) è¿™ä¸ªæ–¹æ³•æ˜¯åˆ†å‘ç‚¹å‡»äº‹ä»¶çš„æ–¹æ³•,åªè¦è¿™ä¸ªç‚¹å‡»äº‹ä»¶èƒ½ä¼ é€’åˆ°å½“å‰çš„æ§ä»¶,å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³• boolean onInterceptTouchEvent(MotionEvent ev) æ˜¯å¦è¦æ‹¦æˆªè¿™ä¸ªäº‹ä»¶?è¦æ˜ç™½çš„æ˜¯,Viewæ˜¯æ²¡æœ‰è¿™ä¸ªæ–¹æ³•çš„,å› ä¸ºViewæ˜¯æœ€ä¸‹å±‚çš„,æ²¡æœ‰èµ„æ ¼å»æ‹¦æˆª. å®ƒè¦ä¹ˆæ¶ˆè´¹äº‹ä»¶,è¦ä¹ˆä¸æ¶ˆè´¹è¿”å›å®ƒçš„çˆ¶æ§ä»¶,è€Œä¸æ˜¯è‡ªå·±æ‹¦æˆªæ‰äº‹ä»¶. boolean onTouchEvent(MotionEvent event) å¤„ç†ç‚¹å‡»äº‹ä»¶,ViewGroupçš„dispatchTouchEventæ–¹æ³•ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•. ä¸»è¦å‚ä¸æˆå‘˜ Activity æˆ‘ä»¬è¦æ˜ç™½,ä¸€ä¸ªäº‹ä»¶åœ¨ç‰©ç†ç¡¬ä»¶å±‚äº§ç”Ÿå,æ˜¯ç”±ç³»ç»Ÿçš„è¾“å…¥ç³»ç»Ÿå¤„ç†,ç„¶åç»è¿‡å…¶ä¼ é€’é€šé“(å¦‚æœæ·±å…¥äº†è§£,æˆ‘ä»¬å¯ä»¥çŸ¥é“,å…¶åº•å±‚æ˜¯ç”±ä¸€ä¸ªåŒå‘çš„Socketæ¥åšåˆ°çš„),ä¼ é€’åˆ°UIçº¿ç¨‹,Activityæ˜¯ç¬¬ä¸€ä¸ªæ‹¿åˆ°è¿™ä¸ªäº‹ä»¶çš„,ä½†æ˜¯å®ƒå¹¶ä¸èƒ½å¤„ç†è¿™ä¸ªäº‹ä»¶,æ‰€ä»¥Activityå¿…é¡»æŠŠè¿™ä¸ªäº‹ä»¶åˆ†å‘ä¸‹å»,è€Œä¸ä¼šè‡ªå·±å¤„ç†. ViewGroup å®ƒä¸Viewæœ€å¤§çš„ä¸åŒåœ¨äº,è™½ç„¶å®ƒä¹Ÿæ˜¯Viewçš„å­ç±»,ä½†æ˜¯å®ƒå¯èƒ½è¿˜ç®¡ç†ç€å…¶ä»–ViewGroup &amp; View,æ‰€ä»¥å®ƒæ˜¯æœ‰æ‰€æœ‰çš„ä¸‰ä¸ªæ–¹æ³•çš„. View æ—¢æ˜¯æ‰€æœ‰æ§ä»¶çš„çˆ¶ç±»,ä¹Ÿæ˜¯æˆ‘ä»¬è¯´çš„æœ€åŸºæœ¬çš„æ§ä»¶,å®ƒåªèƒ½é€‰æ‹©å¤„ç†æˆ–ä¸å¤„ç†äº‹ä»¶,æ²¡æœ‰å…¶ä»–æ“ä½œäº†. é˜…è¯»æºç Activity#dispatchTouchEventpublic boolean dispatchTouchEvent(MotionEvent ev) { if (ev.getAction() == MotionEvent.ACTION_DOWN) { onUserInteraction(); //ç©ºæ–¹æ³•,ä¸çœ‹ } //æŸ¥çœ‹superDispatchTouchEventå‘ç°æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•,é‚£ä¹ˆæˆ‘ä»¬å»æ‰¾å®ƒçš„å®ç°ç±» if (getWindow().superDispatchTouchEvent(ev)) { return true; } //ç›´æ¥è°ƒç”¨äº†onTouchEvent() return onTouchEvent(ev); } =&gt; Window çš„å®ç°ç±»,ç°åœ¨åªæœ‰ä¸€ä¸ª PhoneWindow @Override public boolean superDispatchTouchEvent(MotionEvent event) { return mDecor.superDispatchTouchEvent(event); //é‚£ä¹ˆæˆ‘ä»¬çŸ¥é“mDecoræ˜¯DecorView,å®ƒç»§æ‰¿äº†FrameLayoutå¹¶ä¸”æ˜¯TitleView å’Œ ContextViewçš„å®¹å™¨ } //DecorViewçš„superDispatchTouchEventæ–¹æ³• public boolean superDispatchTouchEvent(MotionEvent event) { return super.dispatchTouchEvent(event); } å¾ˆæ˜æ˜¾çš„,æˆ‘ä»¬çŸ¥é“è¿™ä¸ªsuperæ˜¯æŒ‡çš„DecorViewçš„çˆ¶ç±»ViewGroup android.view.ViewGroup#dispatchTouchEvent ViewGroup#dispatchTouchEventè¿™ä¸ªä»£ç é•¿åˆ°çˆ†ç‚¸ @Override public boolean dispatchTouchEvent(MotionEvent ev) { //...çœç•¥ //æœäº†åŠå¤©æ‰çŸ¥é“,mInputEventConsistencyVerifierè°ƒè¯•ç”¨çš„,è¿å¸¦è¾…åŠ©åŠŸèƒ½çš„éƒ½çœç•¥äº† boolean handled = false; //onFilterTouchEventForSecurity è¿™ä¸ªæ–¹æ³•æ˜¯Viewä¸­çš„,å¦‚æœfalseå°±è¦ä¸¢å¼ƒäº‹ä»¶ //ç¬¬ä¸€æ­¥ : //å¦‚æœæ˜¯tureæ‰ç»§ç»­æ¥å¤„ç†è¿™ä¸ªäº‹ä»¶,å…¶å®å°±æ˜¯Windowæ˜¯å¦è¢«é®ç›–çš„å€¼ if (onFilterTouchEventForSecurity(ev)) { final int action = ev.getAction(); final int actionMasked = action &amp; MotionEvent.ACTION_MASK; // Handle an initial down. if (actionMasked == MotionEvent.ACTION_DOWN) { //ç¬¬äºŒæ­¥ : //è¿™é‡Œæ¸…é™¤æ‰äº†æ‰€æœ‰ä¹‹å‰çš„çŠ¶æ€, //1. clearTouchTargets() çœ‹èµ·æ¥æ˜¯æ¸…ç©ºäº†ä¸€ä¸ªä¿å­˜éœ€è¦æ¥å—äº‹ä»¶Viewçš„é“¾è¡¨ // mFirstTouchTargeté“¾è¡¨åˆå§‹åŒ– //2.mGroupFlags &amp;= ~FLAG_DISALLOW_INTERCEPT; // è¿™ä¸ªæ ‡è®°æ„ä¸º:ä¸å…è®¸ViewGroupå¯¹è§¦æ‘¸äº‹ä»¶è¿›è¡Œæ‹¦æˆª cancelAndClearTouchTargets(ev); resetTouchState(); } final boolean intercepted; //ç¬¬ä¸‰æ­¥: //æ£€æŸ¥å½“å‰ViewGroupæ˜¯å¦æƒ³è¦æ‹¦æˆªè§¦æ‘¸äº‹ä»¶,å¹¶æŠŠå€¼å†™å…¥interceptedè¿”å› if (actionMasked == MotionEvent.ACTION_DOWN || mFirstTouchTarget != null) { //è¿™ä¸ªæ ‡å¿—ä½é€šè¿‡requestDisallowInterceptTouchEventæ¥è®¾ç½® final boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0; if (!disallowIntercept) { //å¦‚æœä¸ç¦ç”¨æ‹¦æˆªäº‹ä»¶,åˆ™è°ƒç”¨onInterceptTouchEvent(ev); //å¹¶ä¸”è¿”å›onInterceptTouchEventçš„è¿”å›å€¼ç»™intercepted intercepted = onInterceptTouchEvent(ev); ev.setAction(action); // restore action in case it was changed } else { intercepted = false; } } else { // There are no touch targets and this action is not an initial down // so this view group continues to intercept touches. intercepted = true; } //...çœç•¥ //ç¬¬å››æ­¥,æ£€æŸ¥æ˜¯å¦å–æ¶ˆäº†äº‹ä»¶ final boolean canceled = resetCancelNextUpFlag(this) || actionMasked == MotionEvent.ACTION_CANCEL; // ç¬¬äº”æ­¥,æŠŠäº‹ä»¶canceled,intercepted æ—¢æ²¡æœ‰è¢«å–æ¶ˆ,ä¹Ÿæ²¡æœ‰è¢«æ‹¦æˆªçš„æ—¶å€™ // æŠŠäº‹ä»¶åˆ†å‘åˆ°å®ƒçš„å­Viewä¸­å» final boolean split = (mGroupFlags &amp; FLAG_SPLIT_MOTION_EVENTS) != 0; TouchTarget newTouchTarget = null; boolean alreadyDispatchedToNewTouchTarget = false; if (!canceled &amp;&amp; !intercepted) { //çœç•¥.. if (actionMasked == MotionEvent.ACTION_DOWN || (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_DOWN) || actionMasked == MotionEvent.ACTION_HOVER_MOVE) { final int actionIndex = ev.getActionIndex(); // always 0 for down final int idBitsToAssign = split ? 1 &lt;&lt; ev.getPointerId(actionIndex) : TouchTarget.ALL_POINTER_IDS; //æ¸…ç©ºè¿™ä¸ªidBitsToAssignä¹‹å‰çš„TouchTargeté“¾è¡¨ removePointersFromTouchTargets(idBitsToAssign); //è·å–è¿™ä¸ªViewçš„æ‰€æœ‰å­Viewä¸ªæ•° final int childrenCount = mChildrenCount; if (newTouchTarget == null &amp;&amp; childrenCount != 0) { final float x = ev.getX(actionIndex); final float y = ev.getY(actionIndex); // Find a child that can receive the event. // Scan children from front to back. final ArrayList&lt;View&gt; preorderedList = buildTouchDispatchChildList(); final boolean customOrder = preorderedList == null &amp;&amp; isChildrenDrawingOrderEnabled(); final View[] children = mChildren; //ç¬¬å…­æ­¥,æ‰§è¡Œäº‹ä»¶åˆ†å‘ //æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯éå†æ‰€æœ‰çš„å­View,å¹¶æŠŠ for (int i = childrenCount - 1; i &gt;= 0; i--) { final int childIndex = getAndVerifyPreorderedIndex( childrenCount, i, customOrder); final View child = getAndVerifyPreorderedView( preorderedList, children, childIndex); //çœç•¥... //è¿™é‡Œåˆ¤æ–­,å½“å‰å¾ªç¯åˆ°çš„è¿™ä¸ªå­Viewæ˜¯å¦å¯ç‚¹å‡»,å¹¶ä¸”è¿™ä¸ªåæ ‡ //åœ¨å­Viewçš„å¯è§†èŒƒå›´å†…,å¦‚æœéƒ½æ»¡è¶³,åˆ™è·³å‡ºåˆ¤æ–­ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ,å¦‚æœ //ä¸èƒ½æ»¡è¶³æ¡ä»¶,åˆ™continue,è·³è¿‡è¿™ä¸ªView if (!canViewReceivePointerEvents(child) || !isTransformedTouchPointInView(x, y, child, null)) { ev.setTargetAccessibilityFocus(false); continue; } newTouchTarget = getTouchTarget(child); if (newTouchTarget != null) { // Child is already receiving touch within its bounds. // Give it the new pointer in addition to the ones it is handling. newTouchTarget.pointerIdBits |= idBitsToAssign; break; } resetCancelNextUpFlag(child); //æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,è¿™é‡ŒæŠŠäº‹ä»¶åˆ†å‘ä¸‹å»äº†,ç»™äº†å½“å‰çš„è¿™ä¸ªchild if (dispatchTransformedTouchEvent(ev, false, child, idBitsToAssign)) { // Child wants to receive touch within its bounds. //å¦‚æœèƒ½èµ°åˆ°è¿™é‡Œ,åˆ™å­Viewè¿”å›çš„è‚¯å®šæ˜¯ture,è¯´æ˜å­View //æ¶ˆè´¹ &amp; æ‹¦æˆªäº†è¿™ä¸ªäº‹ä»¶ mLastTouchDownTime = ev.getDownTime(); if (preorderedList != null) { // childIndex points into presorted list, find original index for (int j = 0; j &lt; childrenCount; j++) { if (children[childIndex] == mChildren[j]) { mLastTouchDownIndex = j; break; } } } else { mLastTouchDownIndex = childIndex; } mLastTouchDownX = ev.getX(); mLastTouchDownY = ev.getY(); //ddTouchTarget()å°†childæ·»åŠ åˆ°mFirstTouchTarget newTouchTarget = addTouchTarget(child, idBitsToAssign); //è®¾ç½®alreadyDispatchedToNewTouchTargetä¸ºtrue alreadyDispatchedToNewTouchTarget = true; break; } // The accessibility focus didn&#39;t handle the event, so clear // the flag and do a normal dispatch to all children. ev.setTargetAccessibilityFocus(false); } if (preorderedList != null) preorderedList.clear(); } if (newTouchTarget == null &amp;&amp; mFirstTouchTarget != null) { // Did not find a child to receive the event. // Assign the pointer to the least recently added target. newTouchTarget = mFirstTouchTarget; while (newTouchTarget.next != null) { newTouchTarget = newTouchTarget.next; } newTouchTarget.pointerIdBits |= idBitsToAssign; } } } //ä»¥ä¸Š,åˆ¤æ–­ä¸è¢«å–æ¶ˆ,ä¸è¢«æ‹¦æˆªçš„æ–¹æ³•å®Œæ¯•äº† //ç¬¬ä¸ƒæ­¥,ç»§ç»­åˆ†å‘äº‹ä»¶ // Dispatch to touch targets. //è¿™é‡Œæ³¨æ„çœ‹dispatchTransformedTouchEventçš„ç¬¬ä¸‰ä¸ªå‚æ•°,æ˜¯null //åœ¨è¯¥æ–¹æ³•ä¸­,childè¿™ä¸ªå‚æ•°ä¸ºnull,åˆ™æ˜¯ç›´æ¥è°ƒç”¨äº†super.dispatchTouchEvent(ev) if (mFirstTouchTarget == null) { // No touch targets so treat this as an ordinary view. handled = dispatchTransformedTouchEvent(ev, canceled, null, TouchTarget.ALL_POINTER_IDS); } else { // Dispatch to touch targets, excluding the new touch target if we already // dispatched to it. Cancel touch targets if necessary. TouchTarget predecessor = null; TouchTarget target = mFirstTouchTarget; while (target != null) { //TouchTarget è¿™é‡Œæ˜¯ä¸€ç›´åœ¨éå†è¿™ä¸ªé“¾è¡¨,è¿›è¡Œåˆ¤æ–­,äº‹ä»¶åˆ†å‘ final TouchTarget next = target.next; if (alreadyDispatchedToNewTouchTarget &amp;&amp; target == newTouchTarget) { handled = true; } else { final boolean cancelChild = resetCancelNextUpFlag(target.child) || intercepted; if (dispatchTransformedTouchEvent(ev, cancelChild, target.child, target.pointerIdBits)) { handled = true; } if (cancelChild) { if (predecessor == null) { mFirstTouchTarget = next; } else { predecessor.next = next; } target.recycle(); target = next; continue; } } predecessor = target; target = next; } } //ç¬¬å…«æ­¥ å¦‚æœæœ‰å¿…è¦,æ›´æ–°å–æ¶ˆæ ‡è®° // Update list of touch targets for pointer up or cancel, if needed. if (canceled || actionMasked == MotionEvent.ACTION_UP || actionMasked == MotionEvent.ACTION_HOVER_MOVE) { resetTouchState(); } else if (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_UP) { final int actionIndex = ev.getActionIndex(); final int idBitsToRemove = 1 &lt;&lt; ev.getPointerId(actionIndex); removePointersFromTouchTargets(idBitsToRemove); } } if (!handled &amp;&amp; mInputEventConsistencyVerifier != null) { mInputEventConsistencyVerifier.onUnhandledEvent(ev, 1); } return handled; } æˆ‘ä»¬ä¸å¦¨æ¥æ¢³ç†ä¸€ä¸‹ ç¬¬ä¸€æ­¥è‡³ç¬¬ä¸‰æ­¥éƒ½æ˜¯æ ¹æ®å„ç§æ ‡è®°,æ˜¯å¦å¯è§ç­‰æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ†å‘è¿™ä¸ªäº‹ä»¶. ä»ç¬¬å››æ­¥å¼€å§‹,æ‰æ˜¯å¼€å§‹åˆ†å‘è¿™ä¸ªäº‹ä»¶çš„ä»£ç ,ç¬¬äº”æ­¥åˆ¤æ–­æ˜¯ä¸æ˜¯DOWN,MOVEäº‹ä»¶,å¦‚æœæ˜¯å°±å¼€å§‹åˆ†å‘ç»™æ¯ä¸€ä¸ªå­View,åŒæ—¶æŠŠè¿™ä¸ªViewæ·»åŠ åˆ°äº†mFirstTouchTargetè¿™ä¸ªé“¾è¡¨ä¸­ è€Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬ä¸ƒæ­¥,mFirstTouchTarget == nullåˆ¤æ–­è¿™ä¸ªé“¾è¡¨,å¦‚æœä¸æ˜¯nullå°±ç»§ç»­åˆ†å‘äº‹ä»¶,å¦‚æœæ˜¯nullçš„è¯å°±ç›´æ¥å›è°ƒçˆ¶ç±»çš„super.dispatchTouchEvent è¿™æ ·æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®º: å¦‚æœä¸€ä¸ªViewæ²¡æœ‰æ¥æ”¶åˆ°DOWNäº‹ä»¶,è€Œåçš„äº‹ä»¶å®ƒè‚¯å®šä¹Ÿæ— æ³•æ¥æ”¶åˆ°. android.view.ViewGroup#dispatchTransformedTouchEvent private boolean dispatchTransformedTouchEvent(MotionEvent event, boolean cancel, View child, int desiredPointerIdBits) { final boolean handled; //çœç•¥... // Perform any necessary transformations and dispatch. if (child == null) { //å¦‚æœå­Viewä¸ºç©º,åˆ™æŠŠè‡ªå·±å½“åšä¸€ä¸ªViewæ¥å¤„ç†,è¿™é‡Œæ˜¯ç›´æ¥è°ƒç”¨çš„View.dispatchTouchEvent handled = super.dispatchTouchEvent(transformedEvent); } else { final float offsetX = mScrollX - child.mLeft; final float offsetY = mScrollY - child.mTop; transformedEvent.offsetLocation(offsetX, offsetY); if (! child.hasIdentityMatrix()) { transformedEvent.transform(child.getInverseMatrix()); } //è¿™é‡Œå°±å¾ˆæ˜ç™½äº†,äº‹ä»¶åˆä¼ é€’åˆ°è¯¥ViewGroupçš„å­Viewä¸­å»äº† handled = child.dispatchTouchEvent(transformedEvent); } // Done. transformedEvent.recycle(); //è¿”å› return handled; } android.view.ViewGroup#onInterceptTouchEvent public boolean onInterceptTouchEvent(MotionEvent ev) { if (ev.isFromSource(InputDevice.SOURCE_MOUSE) &amp;&amp; ev.getAction() == MotionEvent.ACTION_DOWN &amp;&amp; ev.isButtonPressed(MotionEvent.BUTTON_PRIMARY) &amp;&amp; isOnScrollbarThumb(ev.getX(), ev.getY())) { return true; } return false; } æ³¨æ„çœ‹ä¸€ä¸‹ä»–çš„æ³¨é‡Š Implement this method to intercept all touch screen motion events. ä¸€èˆ¬éƒ½æ˜¯è¿”å›falseçš„,å¦‚æœä½ éœ€è¦æ‹¦æˆªæ‰€æœ‰çš„äº‹ä»¶è€Œä¸å»åˆ†å‘,é‡å†™ç„¶åè¿”å›tureå³å¯ è€ŒViewGroupçš„onTouchEventæ˜¯ç›´æ¥èµ°çš„View.onTouchEvent()æ€»ç»“ ViewGroupä¸­dispatchTouchEvent()ä¼šæŠŠäº‹ä»¶è¿›è¡Œéå†ä¼ é€’ éå†å®ƒè‡ªå·±çš„æ‰€æœ‰å­View,ç„¶åè°ƒç”¨childçš„dispatchTouchEvent()æ¥åˆ†å‘è§¦æ‘¸äº‹ä»¶ ViewGroupçš„æŸä¸ªå­Viewæ²¡æœ‰æ¥å—ACTION_DOWN,åˆ™å®ƒå†ä¹Ÿä¸ä¼šè¢«åˆ†å‘äº‹ä»¶äº† ViewGroupçš„onInterceptTouchEvent()é»˜è®¤è¿”å›false ä¹Ÿå°±æ˜¯è¯´,å¦‚æœä½ éœ€è¦è‡ªå®šä¹‰çš„ViewGroupæ‹¦æˆªäº‹ä»¶,ç›´æ¥é‡å†™è¿”å›falseå³å¯ ViewGroupçš„onTouchEvent å¹¶æ²¡æœ‰è‡ªå·±çš„å®ç°,ç›´æ¥è°ƒç”¨å…¶çˆ¶ç±»Viewçš„ ä¸‹ç¯‡Viewèµ°èµ·","categories":[{"name":"View","slug":"View","permalink":"https://www.wangzhumo.com/categories/View/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"View","slug":"View","permalink":"https://www.wangzhumo.com/tags/View/"}]},{"title":"è´å¡å°”æ›²çº¿ç»ƒä¹ -è°·æ­ŒçŒœç”»å°æ­Œçš„å€’è®¡æ—¶","slug":"Bezier-Google-caihuaxiaoge","date":"2018-07-27T08:42:41.000Z","updated":"2019-12-22T12:05:02.754Z","comments":true,"path":"2018/07/27/Bezier-Google-caihuaxiaoge/","link":"","permalink":"https://www.wangzhumo.com/2018/07/27/Bezier-Google-caihuaxiaoge/","excerpt":"æ€»çš„æ¥è¯´ä¸€å…±æœ‰å››æ®µäºŒé˜¶è´å¡å°”æ›²çº¿ï¼Œå…¶å®æˆ‘ä»¬æ˜¯å¯ä»¥åªç”¨ä¸€æ¬¡é«˜é˜¶è´å¡å°”æ›²çº¿æ¥æå®šçš„ï¼Œä½†æ˜¯é‚£æ ·ä¸æ˜¯å¾ˆåˆ’ç®—ï¼Œæ‰€ä»¥æˆ‘ç”¨å››æ®µäºŒé˜¶æ›²çº¿æ‹¼æ¥ä¸ºä¸€ä¸ªå¾ªç¯ã€‚ ç¤ºæ„å›¾ï¼š å›¾ä¸­å¤§æ¡†è¡¨ç¤ºæ‰‹æœºå±å¹•ï¼Œæˆ‘ä»¬åªè¦æ¯æ¬¡éƒ½ç§»åŠ¨Sç‚¹çš„ä½ç½®å°±å¯ä»¥åšåˆ°æ¨¡æ‹Ÿæ³¢æµªã€‚","text":"æ€»çš„æ¥è¯´ä¸€å…±æœ‰å››æ®µäºŒé˜¶è´å¡å°”æ›²çº¿ï¼Œå…¶å®æˆ‘ä»¬æ˜¯å¯ä»¥åªç”¨ä¸€æ¬¡é«˜é˜¶è´å¡å°”æ›²çº¿æ¥æå®šçš„ï¼Œä½†æ˜¯é‚£æ ·ä¸æ˜¯å¾ˆåˆ’ç®—ï¼Œæ‰€ä»¥æˆ‘ç”¨å››æ®µäºŒé˜¶æ›²çº¿æ‹¼æ¥ä¸ºä¸€ä¸ªå¾ªç¯ã€‚ ç¤ºæ„å›¾ï¼š å›¾ä¸­å¤§æ¡†è¡¨ç¤ºæ‰‹æœºå±å¹•ï¼Œæˆ‘ä»¬åªè¦æ¯æ¬¡éƒ½ç§»åŠ¨Sç‚¹çš„ä½ç½®å°±å¯ä»¥åšåˆ°æ¨¡æ‹Ÿæ³¢æµªã€‚ é‚£ä¹ˆéœ€è¦ç¡®å®š å®½åº¦ï¼ˆDç‚¹ä½ç½®ï¼‰ æ³¢æµªé«˜åº¦ ï¼ˆC ç‚¹ï¼Œæ§åˆ¶ç‚¹çš„é«˜åº¦ï¼Œå®ƒçš„å®½åº¦æ˜¯ä¸åšå˜åŒ–çš„ï¼‰ èµ·å§‹ç‚¹çš„ä½ç½® å½“æˆ‘ä»¬å¼€å§‹ç§»åŠ¨æ—¶ï¼Œåªéœ€è¦ç§»åŠ¨Sç‚¹ä½ç½®å³å¯ï¼Œå…¶ä»–ç‚¹éƒ½è°ƒç”¨quadTo ï¼ŒlineTo çš„APIå°±å¯ä»¥ç›´æ¥ç›¸å¯¹ä½ç½®çš„ä½ç§» å®ç°æ•ˆæœå›¾: å¥½äº†ï¼Œæ—¢ç„¶é“ç†å·²ç»æ˜ç™½äº†ï¼Œé‚£å°±å¼€å§‹ä»£ç æŠŠ å®ç°é€‰æ‹©ç»§æ‰¿Viewå®ç°ï¼Œæˆ‘ä»¬æ²¡æœ‰å…¶ä»–çš„æ§ä»¶éœ€è¦åè°ƒï¼Œåªè¦ç®¡å¥½è‡ªå·±å°±OK,ç›´æ¥ä¸ŠViewå³å¯ æœ¬æ¥æ„æ€çš„æ˜¯åšä¸€ä¸ªå¯ä»¥ç”»å¤šæ¡æ³¢æµªçš„View,ä½†æ˜¯è¯•äº†ä¸€ä¸‹,å¤šæ¡å¾ˆéš¾çœ‹â€¦..è€Œä¸”æˆ‘æ˜¯ä¸ºäº†ç»ƒæ‰‹,æ‰€ä»¥åŠé€”æ”¹äº†è®¾è®¡ WaveView.java WaveViewä¸»è¦è´Ÿè´£åˆå§‹åŒ–Wave.javaå®ä¾‹,ä»¥åŠè®¡ç®—æ°´é¢çš„é«˜åº¦å…¶ä»–éƒ½æ˜¯å…·ä½“äº¤ç»™äº†Wave.javaåšçš„ onDrawçš„ä¸»è¦é€»è¾‘: @Override protected void onDraw(Canvas canvas) { //è¿™ä¸€æ­¥æ˜¯ç”»äº†ä¸€ä¸ªåœ†è§’çŸ©å½¢,è¾¾åˆ°æ•´ä¸ªæ§ä»¶çš„åœ†è§’æ•ˆæœ //åœ¨superä¹‹å‰è°ƒç”¨,é™¤äº†èƒŒæ™¯,å¯ä»¥æŒ¡ç€æ‰€æœ‰çš„ç»˜åˆ¶ canvas.clipPath(radiusPath); super.onDraw(canvas); //ä¸ºäº†å®ç°æœ€åæ—¶åˆ»çš„æŠ–åŠ¨æ•ˆæœ matrix.setRotate(postRotate, 0.5F, 0.5F);//å¿½ç•¥,æœªå®ç° canvas.save();//å¿½ç•¥,æœªå®ç° canvas.concat(matrix);//å¿½ç•¥,æœªå®ç° //draw wave,è¿™ä¸€æ­¥å°±æ˜¯æŠŠä¸¤æ¡æ³¢æµªéƒ½ç”»äº†å‡ºæ¥,forå¾ªç¯æ‰€æœ‰çš„æ³¢æµª,å…¶å®å°±2æ¡ for (int i = waveList.length-1; i &gt;= 0; i--) { waveList[i].drawWave(canvas); } canvas.restore();//å¿½ç•¥,æœªå®ç° } æ°´é¢é«˜åº¦åŠ¨ç”»:(å…¶å®è¿™é‡Œæ²¡æœ‰è®¾ç½®åŠ¨ç”»çš„æ—¶é•¿,å› ä¸ºè¿™ä¸ªæ˜¯ç•™ç»™ä½¿ç”¨è€…æ¥è®¾ç½®çš„) /** * è®¾ç½®æ°´å‡èµ·çš„åŠ¨ç”» * @return ValueAnimator */ private ValueAnimator getWaterRaiseAnim() { //åˆå§‹åŒ–åŠ¨ç”» if (waterAnimator == null) { //å¯ä»¥çœ‹åˆ°,æˆ‘ä»¬çš„å˜åŒ–èŒƒå›´æ˜¯ 0F - mHeight waterAnimator = ValueAnimator.ofFloat(0F, mHeight); waterAnimator.setInterpolator(new AccelerateInterpolator()); waterAnimator.addUpdateListener(animation -&gt; { for (Wave wave : waveList) { //å¾ªç¯è°ƒç”¨wave,å‘Šè¯‰æ¯ä¸€ä¸ªå®ä¾‹,é«˜åº¦å˜åŒ–äº† wave.updateHeight((float) animation.getAnimatedValue()); } }); } return waterAnimator; } ä¸¤ä¸ªstartAnim,ç›®çš„æ˜¯ç”¨æˆ·ä¸ä¼ é€’æ—¶é—´æ—¶,æˆ‘ä»¬ä½¿ç”¨é»˜è®¤çš„20 * 1000æ¯«ç§’ //å¼€å§‹åŠ¨ç”» public void startAnim() { startAnim(DEFAULT_TIME); } /** * å¼€å§‹åŠ¨ç”» * @param time æ—¶é—´å•ä½ ç§’ */ public void startAnim(long time) { if (animatorSet != null) { if (animatorSet.isRunning()) { animatorSet.cancel(); } animatorSet.start(); }else{ initAnim(time); animatorSet.start(); } } //è¿™é‡Œæœ¬æ¥è¿˜æ·»åŠ äº†æ™ƒåŠ¨çš„åŠ¨ç”»,æ³¨é‡Šæ‰çš„å°±æ˜¯ private void initAnim(long time) { animatorSet = new AnimatorSet(); waterAnimator = getWaterRaiseAnim(); waterAnimator.setDuration(time); animatorSet.play(waterAnimator); //rotateAnim = getRotateAnim(); //animatorSet.play(rotateAnim).after(time / 5 * 4) } Wave.java ä¸»è¦è´Ÿè´£ç»˜åˆ¶æ³¢æµª,å¹¶è‡ªå·±è°ƒç”¨åŠ¨ç”»è¾¾åˆ°æ³¢æµªèµ·ä¼æ•ˆæœ ç»˜åˆ¶çš„æ–¹æ³•: /** * å½“å‰è¿™ä¸€æ¡æ³¢æµªçš„ç»˜åˆ¶ * * @param canvas ç”»å¸ƒ */ public void drawWave(Canvas canvas) { //å¦‚æœä¸æ˜¯ç¬¬ä¸€å±‚,åˆ™ä¸éœ€è¦è¦ç”»æ³¢æµªä¸‹é¢çš„éƒ¨åˆ† drawWave(isTop()); canvas.drawPath(mPath, mPaint); } /** * @param isNeed æ˜¯å¦éœ€è¦ç»˜åˆ¶ä¸‹é¢éƒ¨åˆ† */ private void drawWave(boolean isNeed) { mPath.reset(); mPath.moveTo(mLeftTop.x, mLeftTop.y); mPath.quadTo(mControlFirst.x, mControlFirst.y, mLeftMid.x, mLeftMid.y); mPath.quadTo(mControlSecond.x, mControlSecond.y, mMid.x, mMid.y); mPath.quadTo(mControlThree.x, mControlThree.y, mRightMid.x, mRightMid.y); mPath.quadTo(mControlFour.x, mControlFour.y, mRightTop.x, mRightTop.y); if (isNeed) { mPath.lineTo(mRightBottom.x, mRightBottom.y); mPath.lineTo(mLeftBottom.x, mLeftBottom.y); mPath.lineTo(mLeftTop.x, mLeftTop.y); } else { mPath.lineTo(mRightTop.x, mRightTop.y + mWaveTrough); mPath.lineTo(mLeftTop.x, mLeftTop.y + mWaveTrough); mPath.lineTo(mLeftTop.x, mLeftTop.y); } } åŠ¨ç”» /** * åˆå§‹åŒ–ä¸€ä¸ªåŠ¨ç”»,å¹¶å¼€å¯åŠ¨ç”» */ public void startAnim() { ValueAnimator valueAnimator; if ((layerNum &amp; 1) == 0) { //è¾¾åˆ°ä½ç§»æ˜¯ä»å·¦å‘å³çš„æ•ˆæœ valueAnimator = ValueAnimator.ofFloat(mLeftTop.x, 0); } else { //ä½ç§»ä»å³å‘å·¦çš„ç§»åŠ¨ valueAnimator = ValueAnimator.ofFloat(mRightTop.x, mWidth); } valueAnimator.setInterpolator(new LinearInterpolator()); valueAnimator.setDuration(1000); //æ— é™çš„åŠ¨ç”»,ä¸€ç›´æ’­æ”¾,è¾¾æˆä¸€ä¸ªå¾ªç¯ valueAnimator.setRepeatCount(Animation.INFINITE); valueAnimator.addUpdateListener(animation -&gt; { float value = (float) animation.getAnimatedValue(); //äº¤ç»™nextæ–¹æ³•,å…·ä½“çš„ç®—å‡ºæ¯ä¸€ä¸ªç‚¹çš„ä¸‹ä¸€ä¸ªä½ç½® next(value); }); valueAnimator.start(); } next(float value) /** * å˜åŒ–åçš„æ•°å€¼ * @param value xæ–¹å‘çš„ä½ç§» */ private void next(float value) { if ((layerNum &amp; 1) == 0) { //è¿™æ˜¯å‘å³ç§»åŠ¨ mLeftTop.set(value, mHeight - mWaterHeight); mLeftMid.set(mLeftTop.x + mWidth / 2f, mHeight - mWaterHeight); mMid.set(mLeftMid.x + mWidth / 2f, mHeight - mWaterHeight); mRightMid.set(mMid.x + mWidth / 2f, mHeight - mWaterHeight); mRightTop.set(mRightMid.x + mWidth / 2f, mHeight - mWaterHeight); mControlFirst.set(mLeftTop.x + mWidth / 4f, mLeftTop.y + mWaveTrough); mControlSecond.set(mLeftMid.x + mWidth / 4f, mLeftMid.y - mWavePeak); mControlThree.set(mMid.x + mWidth / 4f, mMid.y + mWaveTrough); mControlFour.set(mRightMid.x + mWidth / 4f, mRightMid.y - mWaveTrough); } else { //å‘å·¦ç§»åŠ¨ mLeftTop.set(value, mHeight - mWaterHeight); mLeftMid.set(mLeftTop.x - mWidth / 2f, mHeight - mWaterHeight); mMid.set(mLeftMid.x - mWidth / 2f, mHeight - mWaterHeight); mRightMid.set(mMid.x - mWidth / 2f, mHeight - mWaterHeight); mRightTop.set(mRightMid.x - mWidth / 2f, mHeight - mWaterHeight); mControlFirst.set(mLeftTop.x - mWidth / 4f, mLeftTop.y + mWaveTrough); mControlSecond.set(mLeftMid.x - mWidth / 4f, mLeftMid.y - mWavePeak); mControlThree.set(mMid.x - mWidth / 4f, mMid.y + mWaveTrough); mControlFour.set(mRightMid.x - mWidth / 4f, mRightMid.y - mWaveTrough); } //è¿™é‡Œæˆ‘ä»¬åªå¯¹ç¬¬ä¸€ä¸ªæ³¢æµªè®¾ç½®äº†å›è°ƒ,æ‰€ä»¥å¿…é¡»è¦åˆ¤æ–­,ä¸æ˜¯ç©ºæ‰èƒ½é€šçŸ¥WaveViewé‡ç»˜ if (onRequestDraw != null) { onRequestDraw.onDraw(); } } æ€»ç»“å®šä¹‰ä¸€å®šè¦æ¸…æ¥š,è¦ä¸ç„¶ä¼šæŠŠè‡ªå·±æ··è¿›å». å…·ä½“ä»£ç è¯·åˆ° GIthub : https://github.com/wangzhumo/module_views","categories":[{"name":"View","slug":"View","permalink":"https://www.wangzhumo.com/categories/View/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"View","slug":"View","permalink":"https://www.wangzhumo.com/tags/View/"}]},{"title":"Androidå¼€å‘xmlä¸­çš„æ ·å¼","slug":"Android-xml-style","date":"2018-07-26T05:23:26.000Z","updated":"2019-12-22T12:04:30.976Z","comments":true,"path":"2018/07/26/Android-xml-style/","link":"","permalink":"https://www.wangzhumo.com/2018/07/26/Android-xml-style/","excerpt":"å‰è¨€æˆ‘ä»¬åœ¨Appä¸­,å¾ˆå¤šæ—¶å€™éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„é£æ ¼,æ ·å¼.å¦‚TextView,EditText,Button,ProgressBar,CheckBoxç­‰ç­‰,éƒ½éœ€è¦èƒŒæ™¯,é˜´å½±ç­‰.æˆ‘ä»¬å¯ä»¥ç”¨UIè®¾è®¡å¸ˆæä¾›çš„åˆ‡å›¾,ä½†æ˜¯å¦‚æœæˆ‘ä»¬èƒ½ä½¿ç”¨Androidæä¾›çš„shapeã€selectorã€layer-listã€level-listã€styleã€themeç­‰å®ç°ä¼šæ›´å¥½. ä¸‹é¢åšä¸€ä¸ªåŸºæœ¬ä½¿ç”¨çš„ç¬”è®°.","text":"å‰è¨€æˆ‘ä»¬åœ¨Appä¸­,å¾ˆå¤šæ—¶å€™éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„é£æ ¼,æ ·å¼.å¦‚TextView,EditText,Button,ProgressBar,CheckBoxç­‰ç­‰,éƒ½éœ€è¦èƒŒæ™¯,é˜´å½±ç­‰.æˆ‘ä»¬å¯ä»¥ç”¨UIè®¾è®¡å¸ˆæä¾›çš„åˆ‡å›¾,ä½†æ˜¯å¦‚æœæˆ‘ä»¬èƒ½ä½¿ç”¨Androidæä¾›çš„shapeã€selectorã€layer-listã€level-listã€styleã€themeç­‰å®ç°ä¼šæ›´å¥½. ä¸‹é¢åšä¸€ä¸ªåŸºæœ¬ä½¿ç”¨çš„ç¬”è®°. Shapeshapeå®šä¹‰çš„xmlæ–‡ä»¶æˆ‘ä»¬éƒ½æ˜¯å­˜æ”¾åœ¨drawableç›®å½•ä¸‹ï¼Œå¦‚æœä½ çš„é¡¹ç›®æ²¡æœ‰åˆ™æ–°å»ºä¸€ä¸ª. ä½¿ç”¨shapeå¯ä»¥é€šè¿‡android:shapeå±æ€§æŒ‡å®šä¸‹é¢å››ç§ç±»å‹çš„å½¢çŠ¶ rectangle: çŸ©å½¢ oval: æ¤­åœ†å½¢ line: çº¿å½¢ ring: ç¯å½¢ åŸºæœ¬å±æ€§ corners è®¾ç½®åœ†è§’,rectangleçŸ©å½¢çš„æ—¶å€™ç”¨ å¯ä»¥radiusä½¿ç”¨æ‰€æœ‰çš„åœ†è§’,ä¹Ÿå¯ä»¥å•ç‹¬è®¾ç½®æ¯ä¸€ä¸ªåœ†è§’ android:radius å››ä¸ªåœ†è§’éƒ½ä¼šä½¿ç”¨è¿™ä¸ªå€¼ android:topLeftRadius å·¦ä¸Šè§’çš„åŠå¾„ android:topRightRadius å³ä¸Šè§’çš„åŠå¾„ android:bottomLeftRadius å·¦ä¸‹è§’çš„åŠå¾„ android:bottomRightRadius å³ä¸‹è§’çš„åŠå¾„ soid è®¾ç½®å¡«å……è‰² android:color å¡«å……è‰² stroke è®¾ç½®æè¾¹çº¿æ¡ android:color æè¾¹çº¿æ¡é¢œè‰² android:width æè¾¹çº¿æ¡å®½åº¦ android:dashWidth è®¾ç½®çº¿æ¡ä¸ºè™šçº¿æ—¶çš„æ¨ªçº¿é•¿åº¦ android:dashGap è®¾ç½®çº¿æ¡ä¸ºè™šçº¿æ—¶çš„æ¨ªçº¿ä¹‹é—´çš„é—´éš” padding å†…å®¹ä¸è¾¹ç•Œçš„å†…é—´è· android:left å·¦å†…é—´è· android:right å³å†…é—´è· android:top ä¸Šå†…é—´è· android:bottom ä¸‹å†…é—´è· gradient è¿™ä¸ªå±æ€§å¯ä»¥ç»™ä½ çš„å›¾å½¢è®¾ç½®æ¸å˜ android:type æ¸å˜çš„ç±»å‹ (ç¬¬ä¸€æ¬¡ç”¨æ–¹å½¢,å“ˆå“ˆ) linear çº¿æ€§æ¸å˜ sweep æ‰«ææ¸å˜ radial æ”¾å°„æ¸å˜ android:startColor æ¸å˜å¼€å§‹çš„é¢œè‰² android:centerColor æ¸å˜çš„ä¸­é—´è‰² android:endColor æ¸å˜ç»“æŸçš„é¢œè‰² android:angle æ¸å˜çš„è§’åº¦,å½“ä½ è®¾ç½®çº¿æ€§æ¸å˜å¯ç”¨ android:centerX æ¸å˜ä¸­å¿ƒçš„Xåæ ‡,å½“ä½ è®¾ç½®æ”¾å°„æ¸å˜æœ‰æ•ˆ android:centerY æ¸å˜ä¸­å¿ƒçš„Yåæ ‡ ,å½“ä½ è®¾ç½®æ”¾å°„æ¸å˜æœ‰æ•ˆ android:gradientRadius æ¸å˜çš„åŠå¾„,é’ˆå¯¹æ”¾å°„æ¸å˜ rectangleåŒåŸºæœ¬å±æ€§ linestroke &amp; size ç»„åˆå®ç°,å¸¸ç”¨æ¥åšEditTextçš„å…‰æ ‡ oval size å¯ä»¥è®¾ç½®å›¾å½¢çš„å®½,é«˜ android:width å®½åº¦ android:height é«˜åº¦ å…¶ä»–åŒåŸºæœ¬å±æ€§ ring android:innerRadius é‡Œé¢åœ†çš„åŠå¾„ android:innerRadiusRatio é»˜è®¤3,ä¾¿æ˜¯å†…åœ†åŠå¾„æ˜¯å®½åº¦/3 android:thickness ç¯çš„å®½åº¦ android:thicknessRatio é»˜è®¤æ˜¯9,è¡¨ç¤ºç¯çš„å®½åº¦æ˜¯å®½åº¦/9 &lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; android:innerRadiusRatio=&quot;3&quot; android:shape=&quot;ring&quot; android:thicknessRatio=&quot;9&quot; android:useLevel=&quot;false&quot;&gt; &lt;gradient android:endColor=&quot;@color/colorAccent&quot; android:startColor=&quot;#FFFFFF&quot; android:type=&quot;sweep&quot; /&gt; &lt;/shape&gt; å›¾ç¤º: Selectorselectorå¯ä»¥æ·»åŠ å¤šä¸ªItem,è¡¨ç¤ºä¸åŒçš„çŠ¶æ€çš„ä¸åŒèµ„æº.drawable &amp; color è¦æ³¨æ„çš„: drawableçš„èµ„æºæ”¾åœ¨ drawableç›®å½•,å¹¶ä¸”æŒ‡å®šçš„æ˜¯ android:drawable color çš„æ”¾åœ¨colorç›®å½•,å¹¶ä¸”æŒ‡å®š android:color é‚£ä¹ˆä¸‹é¢æˆ‘åˆ—ä¸¾å‡ºæ‰€æœ‰çš„å¯ä»¥è®¾ç½®çš„çŠ¶æ€ android:state_enabled: è®¾ç½®è§¦æ‘¸æˆ–ç‚¹å‡»äº‹ä»¶æ˜¯å¦å¯ç”¨çŠ¶æ€ android:state_pressed: æ˜¯å¦æŒ‰å‹çŠ¶æ€ android:state_selected: æ˜¯å¦é€‰ä¸­çŠ¶æ€ï¼Œtrueè¡¨ç¤ºå·²é€‰ä¸­ï¼Œfalseè¡¨ç¤ºæœªé€‰ä¸­ android:state_checked: æ˜¯å¦å‹¾é€‰çŠ¶æ€ android:state_checkable: å‹¾é€‰æ˜¯å¦å¯ç”¨çŠ¶æ€ android:state_focused: æ˜¯å¦è·å¾—ç„¦ç‚¹çŠ¶æ€ android:state_window_focused: å½“å‰çª—å£æ˜¯å¦è·å¾—ç„¦ç‚¹çŠ¶æ€ android:state_activated: æ˜¯å¦è¢«æ¿€æ´»çŠ¶æ€ android:state_hovered: æ˜¯åœ¨ä¸Šé¢æ»‘åŠ¨çš„çŠ¶æ€ android:enterFadeDuration çŠ¶æ€æ”¹å˜æ—¶çš„æ·¡å…¥æ—¶é—´ android:exitFadeDuration çŠ¶æ€æ”¹å˜æ—¶æ—§çŠ¶æ€æ¶ˆå¤±çš„æ·¡å‡º layout-listlayer-listçš„ä½œç”¨æ˜¯æŠŠå¤šä¸ªdrawableæŒ‰ç…§é¡ºåºå±‚å åœ¨ä¸€èµ·æ˜¾ç¤º. å®ƒæ—¢å¯ä»¥æ˜¯æ ¹èŠ‚ç‚¹,ä¹Ÿå¯ä»¥ä½œä¸ºselectorçš„Itemå­˜åœ¨. æˆ‘ä»¬å¯ä»¥ä½¿ç”¨layer-listçš„ç‰¹æ€§æ¥åšé˜´å½±æ•ˆæœ. &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt; &lt;item android:left=&quot;4dp&quot; android:top=&quot;4dp&quot;&gt; &lt;shape&gt; &lt;solid android:color=&quot;@android:color/darker_gray&quot; /&gt; &lt;corners android:radius=&quot;10dp&quot; /&gt; &lt;/shape&gt; &lt;/item&gt; &lt;item android:bottom=&quot;4dp&quot; android:right=&quot;4dp&quot;&gt; &lt;shape&gt; &lt;solid android:color=&quot;@android:color/white&quot; /&gt; &lt;corners android:radius=&quot;10dp&quot; /&gt; &lt;/shape&gt; &lt;/item&gt; &lt;/layer-list&gt; layer-listçš„itemå¯ä»¥é€šè¿‡ä»¥ä¸‹å››ä¸ªå±æ€§æ¥è®¾ç½®åç§»é‡ï¼š android:top é¡¶éƒ¨åç§»é‡ android:bottom åº•éƒ¨åç§»é‡ android:left å·¦è¾¹åç§»é‡ android:right å³è¾¹åç§»é‡ level-listlevel-listå¯ä»¥å­˜æ”¾å¤šå¼ drawable,æ¯ä¸€å¼ drawableå¯¹åº”ä¸€å®šçš„levelèŒƒå›´,ä½¿ç”¨æ—¶é€šè¿‡levelå€¼å±•ç¤ºå¯¹åº”çš„drawable android:drawable æŒ‡å®šdrawableèµ„æº android:minLevel è¯¥Drawableçš„æœ€å°levelå€¼ android:maxLevel è¯¥Drawableçš„æœ€å¤§levelå€¼ &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;level-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt; &lt;item android:drawable=&quot;@drawable/draw1&quot; android:maxLevel=&quot;50&quot; android:minLevel=&quot;0&quot; /&gt; &lt;item android:drawable=&quot;@drawable/draw2&quot; android:maxLevel=&quot;100&quot; android:minLevel=&quot;50&quot; /&gt; &lt;/level-list&gt;","categories":[{"name":"View","slug":"View","permalink":"https://www.wangzhumo.com/categories/View/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"View","slug":"View","permalink":"https://www.wangzhumo.com/tags/View/"}]},{"title":"Android Studioä¸­ä½¿ç”¨CMakeè¿›è¡ŒJNIå¼€å‘","slug":"Android-Studio-CMake-JNI","date":"2018-07-25T03:07:06.000Z","updated":"2019-12-22T12:03:56.577Z","comments":true,"path":"2018/07/25/Android-Studio-CMake-JNI/","link":"","permalink":"https://www.wangzhumo.com/2018/07/25/Android-Studio-CMake-JNI/","excerpt":"å‰è¨€å®šä¸€ä¸ªå°ç›®æ ‡,æ›¿ä»£RenderScriptæ¥åšä¸€ä¸ªå›¾ç‰‡çš„é«˜æ–¯æ¨¡ç³Š,å› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€ƒéªŒæ€§èƒ½çš„æ“ä½œ,æ‰€ä»¥æˆ‘æ‰“ç®—ç”¨Cæ¥åšè¿™ä¸ªæ“ä½œ(ä¸»è¦åŸå› æ˜¯æˆ‘è‡ªå·±ä¸ä¼šå†™C++,åˆšå¥½çœ‹åˆ°æœ‰è¿™ä¸ªå¼€æºç®—æ³•â€¦) åˆ›å»ºé¡¹ç›® new -&gt; new Module -&gt; Android Library å½“é¡¹ç›®åˆ›å»ºå¥½ä¹‹å,è¿™åªæ˜¯ä¸€ä¸ªå•çº¯çš„Library,å¹¶ä¸èƒ½ä½¿ç”¨JNIå¼€å‘ ä¸‹é¢,æˆ‘ä»¬æŠŠå®ƒæ”¹é€ ä¸€ä¸‹(ä¸‹å›¾æ˜¯æ”¹é€ å®Œæˆçš„ç›®å½•ç»“æ„):","text":"å‰è¨€å®šä¸€ä¸ªå°ç›®æ ‡,æ›¿ä»£RenderScriptæ¥åšä¸€ä¸ªå›¾ç‰‡çš„é«˜æ–¯æ¨¡ç³Š,å› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€ƒéªŒæ€§èƒ½çš„æ“ä½œ,æ‰€ä»¥æˆ‘æ‰“ç®—ç”¨Cæ¥åšè¿™ä¸ªæ“ä½œ(ä¸»è¦åŸå› æ˜¯æˆ‘è‡ªå·±ä¸ä¼šå†™C++,åˆšå¥½çœ‹åˆ°æœ‰è¿™ä¸ªå¼€æºç®—æ³•â€¦) åˆ›å»ºé¡¹ç›® new -&gt; new Module -&gt; Android Library å½“é¡¹ç›®åˆ›å»ºå¥½ä¹‹å,è¿™åªæ˜¯ä¸€ä¸ªå•çº¯çš„Library,å¹¶ä¸èƒ½ä½¿ç”¨JNIå¼€å‘ ä¸‹é¢,æˆ‘ä»¬æŠŠå®ƒæ”¹é€ ä¸€ä¸‹(ä¸‹å›¾æ˜¯æ”¹é€ å®Œæˆçš„ç›®å½•ç»“æ„): æ·»åŠ CMakeLists.txt é€‰ä¸­lib_blur - new File - CMakeLists.txt cmake_minimum_required(VERSION 3.4.1) #è®¾ç½®ç”Ÿæˆçš„soåŠ¨æ€åº“æœ€åè¾“å‡ºçš„è·¯å¾„ #set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/src/main/jniLibs/${ANDROID_ABI}) add_library( # åº“å sample # è¯¥åº“ç”ŸæˆåŠ¨æ€å‡½æ•° SHARED # ä¾èµ–çš„æ–‡ä»¶ src/main/cpp/samplelib.cpp) find_library( # è®¾ç½®Pathå˜é‡çš„åç§° log-lib # æŒ‡å®šè¦æŸ¥è¯¢çš„åº“åå­— # åœ¨ndkä¸­æŸ¥æ‰¾ liblog.so å‡½æ•°åº“ log ) target_link_libraries( # ç›®æ ‡åº“ sample # è¦é“¾æ¥çš„åº“ android # Links the target library to the log library # included in the NDK. ${log-lib} ) ä¿®æ”¹build.gradeandroid { defaultConfig { //... ndk { // è®¾ç½®æ”¯æŒçš„SOåº“æ¶æ„ abiFilters &#39;armeabi-v7a&#39;, &#39;x86&#39; } externalNativeBuild { cmake { cppFlags &quot;-std=c++14&quot;, &quot;-frtti&quot;, &quot;-fexceptions&quot; } } } //... externalNativeBuild { cmake { path &quot;CMakeLists.txt&quot; } } } ç¼–å†™C++æ–‡ä»¶æˆ‘ä»¬çš„Cæ–‡ä»¶éƒ½åœ¨src/main/cppæ–‡ä»¶å¤¹ä¸‹,æ¯ä¸€ä¸ªCæ–‡ä»¶éƒ½éœ€è¦åœ¨CMakeLists.txtæ–‡ä»¶ä¸­æŒ‡å®š # ä¾èµ–çš„æ–‡ä»¶ src/main/cpp/samplelib.cpp samplelib.cpp #include &lt;jni.h&gt; #include &lt;stdlib.h&gt; #include &lt;string&gt; #include &lt;android/log.h&gt; #define TAG &quot;JNI_LOG&quot; #define LOGE(...) __android_log_print(ANDROID_LOG_ERROR,TAG ,__VA_ARGS__) using namespace std; #ifdef __cplusplus extern &quot;C&quot; { #endif //å®šä¹‰æˆ‘Javaæ–‡ä»¶çš„ä½ç½®,æ³¨æ„æ˜¯&#39;/&#39;åˆ†å¼€ static const char *className = &quot;com/wangzhumo/app/commonlib/jni/JniManager&quot;; //è¿”å›ä¸€ä¸ªstring jstring stringFromJNI(JNIEnv *env,jclass clz) { std::string hello = &quot;Hello from C++&quot;; return env-&gt;NewStringUTF(hello.c_str()); } //è¿”å›ä¸€ä¸ªstring å¹¶æŠŠè¿™å¥è¯æ‰“å°åˆ°logcatä¸­å» jstring sayHello(JNIEnv* env,jclass clz) { std::string hello = &quot;Say Hello from C++&quot;; LOGE(&quot;Say Hello and value&quot;); return env-&gt;NewStringUTF(hello.c_str()); } //è·å–æ‰€æœ‰æ–¹æ³•å static JNINativeMethod gJniMethods[] = { {&quot;sayHello&quot;, &quot;()Ljava/lang/String;&quot;, (void*)sayHello}, {&quot;stringFromJNI&quot;, &quot;()Ljava/lang/String;&quot;, (void*)stringFromJNI}, }; //å…¶ä¸­{&quot;MethodName&quot;,&quot;(å…¥å‚)è¿”å›å€¼&quot;,()Method} //åŠ¨æ€æ³¨å†Œæœ¬åœ°æ–¹æ³• static int jniRegisterNativeMethods(JNIEnv* env, const char* className, const JNINativeMethod* gMethods, int numMethods) { jclass clazz; clazz = (env)-&gt;FindClass( className); if (clazz == NULL) { return -1; } int result = 0; if ((env)-&gt;RegisterNatives(clazz, gMethods, numMethods) &lt; 0) { result = -1; } (env)-&gt;DeleteLocalRef(clazz); return result; } //JNI_OnLoadå›è°ƒ JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* vm, void* reserved){ JNIEnv* env = NULL; jint result = -1; if (vm-&gt;GetEnv((void**) &amp;env, JNI_VERSION_1_6) != JNI_OK) { return result; } jniRegisterNativeMethods(env, className, gJniMethods, sizeof(gJniMethods) / sizeof(JNINativeMethod)); return JNI_VERSION_1_6; } #ifdef __cplusplus } #endif ç¼–å†™Javaæ–‡ä»¶public class JniManager { static{ System.loadLibrary(&quot;sample&quot;); } public static native String sayHello(); public static native String stringFromJNI(); } ç¼–è¯‘ Build -&gt; Make Project ç¼–è¯‘å®Œæˆ,å¦‚æœæˆåŠŸåˆ™ build -&gt; intermediates -&gt; cmake ä¸‹å°±æœ‰ .soæ–‡ä»¶ å¦‚å›¾æ‰€ç¤º: æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,ç”Ÿæˆäº† armeabi-v7a, x86ä¸¤ç§ç±»å‹çš„.soæ–‡ä»¶,å¦‚æœä¸åœ¨build.gradleä¸­å£°æ˜: ndk { // è®¾ç½®æ”¯æŒçš„SOåº“æ¶æ„ abiFilters &#39;armeabi-v7a&#39;, &#39;x86&#39; } è°ƒç”¨class MainActivity : AppCompatActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContentView(R.layout.activity_main) } override fun onResume() { super.onResume() Log.e(&quot;JNI&quot;,JniManager.sayHello()) Log.e(&quot;JNI&quot;,JniManager.stringFromJNI()) } } ç»“æœ: 07-26 17:42:41.420 6685-6685/com.wangzhumo.playground E/JNI_LOG: Say Hello and value 07-26 17:42:41.420 6685-6685/com.wangzhumo.playground E/JNI: Say Hello from C++ 07-26 17:42:41.420 6685-6685/com.wangzhumo.playground E/JNI: Hello from C++ å…¶ä¸­JNI_LOGæ˜¯ç”± cpp ä¸­çš„æ–¹æ³•æ‰“å°åˆ°Androidçš„æ§åˆ¶å°çš„ JNIæ˜¯æˆ‘ä»¬åœ¨MainActivityä¸­è°ƒç”¨çš„ Log.e(&quot;JNI&quot;,JniManager.sayHello()) Log.e(&quot;JNI&quot;,JniManager.stringFromJNI()) ç»“è¯­ä»¥ä¸Šè¯´æ˜æˆ‘çš„JNIç®—æ˜¯åˆæ­¥å®Œæˆäº†è°ƒç”¨ http://zhixinliu.com/2015/07/01/2015-07-01-jni-register/ https://developer.android.com/ndk/guides/ å‰è¨€ä¸­çš„FlagçœŸæ˜¯ç«‹çš„å¥½,C++ä¸æ˜¯å¾ˆä¼š,æ‰€ä»¥åªèƒ½å¾€ç®€å•äº†å†™,çœŸæ˜¯å¯æ€œçš„æˆ‘","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"é€’å½’è°ƒç”¨åˆ›å»ºå•é“¾è¡¨","slug":"Recursion-Linked-List","date":"2018-07-15T03:05:09.000Z","updated":"2019-12-22T12:07:54.299Z","comments":true,"path":"2018/07/15/Recursion-Linked-List/","link":"","permalink":"https://www.wangzhumo.com/2018/07/15/Recursion-Linked-List/","excerpt":"å‰è¨€å¾ˆå¤šçš„é¢è¯•ä¸­,éƒ½æœ‰è¦æ±‚å®ç°ä¸€ä¸ªå•é“¾è¡¨,è¿™é‡Œå°±æä¸€ä¸ªè¯•è¯•.","text":"å‰è¨€å¾ˆå¤šçš„é¢è¯•ä¸­,éƒ½æœ‰è¦æ±‚å®ç°ä¸€ä¸ªå•é“¾è¡¨,è¿™é‡Œå°±æä¸€ä¸ªè¯•è¯•. å®ç°Node.kt //åˆ›å»ºä¸€ä¸ªNode class Node(val value:Int){ var next : Node? = null } è¿™ä¸ªNodeæœ‰ä¸€ä¸ªvalue,å®ƒæ˜¯ä¸€ä¸ªå¿…ä¼ ä¸”ä¸å¯ä¿®æ”¹çš„å‚æ•°,å°±ç›´æ¥æ”¾åœ¨äº†æ„é€ äº† nextæŒ‡å‘äº†ä¸‹ä¸€ä¸ªNode,è¿™æ ·å°±å¯ä»¥å®Œæˆä¸€ä¸ªå•å‘çš„é“¾è¡¨,è®©æˆ‘æƒ³èµ·äº† Messageçš„next nexté»˜è®¤æ˜¯null,è¿™æ˜¯å› ä¸ºå•é“¾è¡¨æœ€åä¸€ä¸ªnextä¸­å°±æ˜¯null. ListCreated.kt class ListCreated { fun createList(list: List&lt;Int&gt;): Node? { //1. if (list.isEmpty()) { return null } //2. val currentNode = Node(list[0]) println(&quot;before ${currentNode.value}&quot;) //3. val nextNode = createList(list.subList(1, list.size)) if (nextNode != null) { println(&quot;after ${currentNode.value}&quot;) } //4. currentNode.next = nextNode return currentNode } } class ListCreated { fun createList(list: List&lt;Int&gt;): Node? { //1. if (list.isEmpty()) { return null } //2. val currentNode = Node(list[0]) println(&quot;before ${currentNode.value}&quot;) //3. val nextNode = createList(list.subList(1, list.size)) if (nextNode != null) { println(&quot;after ${currentNode.value}&quot;) } //4. currentNode.next = nextNode return currentNode } } æˆ‘ä»¬éœ€è¦å»åˆ¤æ–­List,å¦‚æœä¸ºç©ºå°±ç›´æ¥è¿”å›nulläº† è¿™é‡Œå°±æ˜¯å½“å‰çš„è¿™ä¸ªNode,ä¿å­˜äº†å½“å‰çš„value,ä½†æ˜¯nextè¿˜æ˜¯ä¸ºnullçš„ è¿™é‡Œå°±æ˜¯é€’å½’è°ƒç”¨çš„åœ°æ–¹,ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªsubList,å½“ç„¶æ˜¯å»æ‰äº†ç¬¬ä¸€ä¸ª,å› ä¸ºç¬¬ä¸€ä¸ªå·²ç»æ˜¯currentNodeäº† æŠŠcurrentNodeçš„nextæŒ‡å‘äº†nextNode,æ„æˆå•å‘ MainTest.java public class MainClass { public static void main(String[] args){ List&lt;Integer&gt; integerList = Arrays.asList(1,4,6,2); ListCreated created = new ListCreated(); Node node = created.createList(integerList); printAll(node); } public static void printAll(Node node){ while (node != null){ System.out.print(node.getValue()); System.out.print(&quot; &quot;); node = node.getNext(); } } } æ‰“å°ç»“æœ: before 1 before 4 before 6 before 2 after 6 after 4 after 1 1 4 6 2 æˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çŸ¥é“before 1,4,6,2 è€Œæ²¡æœ‰æ‰“å°,è¯´æ˜å‹å…¥äº†æ ˆ,æŒ‡ä»¤æ²¡æœ‰è¿”å› afteræœ¬æ¥åº”è¯¥æ˜¯ 2,6,4,1çš„,ä¸ºä»€ä¹ˆ2æ²¡æœ‰æ‰“å°å‡ºæ¥,æ˜¯å› ä¸º if (nextNode != null) { println(&quot;after ${currentNode.value}&quot;) } é“¾è¡¨æœ€åä¸€ä¸ªNodeçš„nextæ˜¯ä¸ºnullçš„,æ‰€ä»¥æ²¡æœ‰æ‰“å° å‡ºæ ˆçš„é¡ºåº,ä¹Ÿæ˜¯æŒ‰ç…§æ ˆçš„è§„åˆ™,å…ˆè¿›åå‡º. å¯ä»¥çœ‹åˆ°å‡ºå…¥æ ˆçš„é¡ºåº","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"è®¾è®¡æ¨¡å¼-è£…é¥°è€…è®¾è®¡æ¨¡å¼","slug":"Design-Pattern-Decoration","date":"2018-07-14T11:05:28.000Z","updated":"2019-12-22T12:11:05.936Z","comments":true,"path":"2018/07/14/Design-Pattern-Decoration/","link":"","permalink":"https://www.wangzhumo.com/2018/07/14/Design-Pattern-Decoration/","excerpt":"è®¤è¯†è£…é¥°è€…æ¨¡å¼è£…é¥°è€…æ¨¡å¼ä¸€èˆ¬ç”±ä¸€ä¸‹å‡ éƒ¨åˆ†ç»„æˆ: Componentï¼šè£…é¥°è€…å’Œè¢«è£…é¥°è€…çš„å…±åŒçˆ¶ç±»,æ˜¯ä¸€ä¸ªæ¥å£æˆ–è€…æŠ½è±¡ç±»,å®šä¹‰äº†åŸºæœ¬è¡Œä¸º ConcreteComponentï¼šå…·ä½“çš„ç»„ä»¶å¯¹è±¡,å®ç°äº†ç»„ä»¶çš„æ¥å£,å®šä¹‰å…·ä½“å¯¹è±¡,é€šå¸¸å°±æ˜¯è¢«è£…é¥°è€… Decoratorï¼šæŠ½è±¡è£…é¥°è€…,éœ€è¦ç»§æ‰¿Component,å®ƒå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªæŒ‡å‘Componentå®ä¾‹çš„å¼•ç”¨,å¯¹äºConcreteComponentæ¥è¯´,ä¸éœ€è¦çŸ¥é“Decoratorçš„å­˜åœ¨,å°±å¯ä»¥å®Œæˆå¯¹ConcreteComponentçš„è£…é¥° ConcreteDecoratorï¼šå…·ä½“è£…é¥°è€…,æ¥å®Œæˆå…·ä½“çš„è£…é¥°åŠŸèƒ½,æ‰©å±•ConcreteComponent.","text":"è®¤è¯†è£…é¥°è€…æ¨¡å¼è£…é¥°è€…æ¨¡å¼ä¸€èˆ¬ç”±ä¸€ä¸‹å‡ éƒ¨åˆ†ç»„æˆ: Componentï¼šè£…é¥°è€…å’Œè¢«è£…é¥°è€…çš„å…±åŒçˆ¶ç±»,æ˜¯ä¸€ä¸ªæ¥å£æˆ–è€…æŠ½è±¡ç±»,å®šä¹‰äº†åŸºæœ¬è¡Œä¸º ConcreteComponentï¼šå…·ä½“çš„ç»„ä»¶å¯¹è±¡,å®ç°äº†ç»„ä»¶çš„æ¥å£,å®šä¹‰å…·ä½“å¯¹è±¡,é€šå¸¸å°±æ˜¯è¢«è£…é¥°è€… Decoratorï¼šæŠ½è±¡è£…é¥°è€…,éœ€è¦ç»§æ‰¿Component,å®ƒå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªæŒ‡å‘Componentå®ä¾‹çš„å¼•ç”¨,å¯¹äºConcreteComponentæ¥è¯´,ä¸éœ€è¦çŸ¥é“Decoratorçš„å­˜åœ¨,å°±å¯ä»¥å®Œæˆå¯¹ConcreteComponentçš„è£…é¥° ConcreteDecoratorï¼šå…·ä½“è£…é¥°è€…,æ¥å®Œæˆå…·ä½“çš„è£…é¥°åŠŸèƒ½,æ‰©å±•ConcreteComponent. æˆ‘ä»¬çŸ¥é“åœ¨ç¼–ç ä¸­,å€¡å¯¼ä½¿ç”¨ç»„åˆ,è€Œä¸æ˜¯ç»§æ‰¿æ¥æ‰©å±•å’Œå¤ç”¨åŠŸèƒ½,è£…é¥°è€…æ¨¡å¼ä¹Ÿæ˜¯åŸºäºç»„åˆæ¥å®Œæˆçš„.è£…é¥°è€…æ¨¡å¼å¯ä»¥å¾ˆçµæ´»çš„ç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½,ä½œä¸ºä¸€ä¸ªå¤–éƒ¨çš„ç±»ç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½,è€Œä¸ç”¨ç›´æ¥ä¿®æ”¹å¯¹è±¡æœ¬èº«,æˆ–è€…åˆ›å»ºå­ç±». å®ç°é‚£æˆ‘ä»¬å°±æŒ‰ç…§ä¸Šé¢çš„ç»“æ„,ä¸€ä¸€æ¥åˆ›å»º å°±æ‹¿æˆ‘ä¸‹ç­åè¦å¹²çš„äº‹è¯´èµ·å§,æ¯å¤©ä¸‹ç­æˆ‘å›å®¶å¿…é¡»è¦èƒŒä¸€ä¼šå•è¯,è¿™ä¸ªæ˜¯æˆ‘çš„åŸºæœ¬ä»»åŠ¡ å¯é€‰çš„ä»»åŠ¡: Coding çœ‹ä¹¦ çœ‹ç”µè§† ç©æ‰‹æœº Componentabstract class HomeWork{ //å®Œæˆäº†ä½œä¸š open fun doWork() : String { return &quot;ä¸‹ç­åä»»åŠ¡&quot; } //å®Œæˆä½œä¸šèŠ±è´¹æ—¶é—´ abstract fun costTime() : Int } å¯ä»¥çœ‹åˆ°,æˆ‘ä¸‹ç­åçš„ä»»åŠ¡,å®šä¹‰äº†ä¸€ä¸ªä»»åŠ¡,ä¸€ä¸ªè€—è´¹æ—¶é—´ è¿™ä¸ªComponentå¯ä»¥æ˜¯æ¥å£,ä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡ç±»,æ ¹æ®è‡ªå·±çš„éœ€è¦æ¥å®šå°±è¡Œ ConcreteComponentclass BaseWork : HomeWork(){ override fun doWork(): String { return &quot;èƒŒå•è¯&quot; } override fun costTime() : Int { return 30 } } Decoratorabstract class Decorator : HomeWork(){ abstract override fun costTime(): Int } ConcreteDecoratorclass ProgrammeWork(private val work : HomeWork) : Decorator(){ override fun doWork(): String { return work.doWork() + &quot; Coding&quot; } override fun costTime(): Int { return work.costTime() + 45 } } class TelevisionWork(private val work: HomeWork) : Decorator(){ override fun doWork(): String { return work.doWork() + &quot; çœ‹ç”µè§†&quot; } override fun costTime(): Int { return work.costTime() + 60 } } æ‰§è¡Œç»“æœpublic static void main(String[] args){ BaseWork work = new BaseWork(); System.out.println(work.doWork() + String.format(&quot; è€—è´¹æ—¶é—´ : %d åˆ†é’Ÿ&quot;, work.costTime())); //å¦‚æœè¯´æˆ‘å¿ƒæƒ…å¥½è¿˜å­¦äº†ä¸€ä¼šä»£ç  ProgrammeWork programmeWork = new ProgrammeWork(work); System.out.println(programmeWork.doWork() + String.format(&quot; è€—è´¹æ—¶é—´ : %d åˆ†é’Ÿ&quot;, programmeWork.costTime())); //æœ¬æ¥æƒ³ç¡äº†,ä½†æ˜¯åª³å¦‡çœ‹çš„ç”µè§†ç‰¹å¥½çœ‹,æˆ‘åˆå»çœ‹äº†ç”µè§† TelevisionWork tvWork = new TelevisionWork(programmeWork); System.out.println(tvWork.doWork() + String.format(&quot; è€—è´¹æ—¶é—´ : %d åˆ†é’Ÿ&quot;, tvWork.costTime())); } //Run: èƒŒå•è¯ è€—è´¹æ—¶é—´ : 30 åˆ†é’Ÿ èƒŒå•è¯ Coding è€—è´¹æ—¶é—´ : 75 åˆ†é’Ÿ èƒŒå•è¯ Coding çœ‹ç”µè§† è€—è´¹æ—¶é—´ : 135 åˆ†é’Ÿ Process finished with exit code 0 å…¶å®æˆ‘è§‰å¾—è£…é¥°è€…å’Œä»£ç†æ¨¡å¼å¾ˆåƒ,åƒåˆ°æˆ‘æƒ³ä¸åˆ°æœ‰ä»€ä¹ˆæœ¬è´¨çš„å·®å¼‚,å¯èƒ½æ˜¯æˆ‘è‡ªå·±æ²¡æœ‰æ·±åˆ»çš„ç†è§£è¿™ä¸¤ä¸ªè®¾è®¡æ¨¡å¼,æ‰€ä»¥æˆ‘å¸Œæœ›ä¸‹æ¬¡æœ‰æœºä¼šèƒ½ææ˜ç™½. https://blog.csdn.net/yeguxin/article/details/77337649 è¿™é‡Œæ˜¯æˆ‘ç°åœ¨è§‰å¾—è®²çš„æœ‰ç‚¹é“ç†çš„.","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://www.wangzhumo.com/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"è®¾è®¡æ¨¡å¼-çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨","slug":"Design-pattern-State","date":"2018-07-14T00:45:32.000Z","updated":"2019-12-22T12:10:52.272Z","comments":true,"path":"2018/07/14/Design-pattern-State/","link":"","permalink":"https://www.wangzhumo.com/2018/07/14/Design-pattern-State/","excerpt":"çŠ¶æ€æ¨¡å¼(State)å®šä¹‰å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸º,å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»,çŠ¶æ€æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ã€‚ é‚£ä¹ˆæˆ‘ä»¬åœ¨ç¼–ç çš„è¿‡ç¨‹ä¸­,æœ‰ä»€ä¹ˆåœ°æ–¹ä¼šé‡åˆ°è¿™æ ·çš„çŠ¶å†µé‚£?","text":"çŠ¶æ€æ¨¡å¼(State)å®šä¹‰å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸º,å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»,çŠ¶æ€æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ã€‚ é‚£ä¹ˆæˆ‘ä»¬åœ¨ç¼–ç çš„è¿‡ç¨‹ä¸­,æœ‰ä»€ä¹ˆåœ°æ–¹ä¼šé‡åˆ°è¿™æ ·çš„çŠ¶å†µé‚£? ç»„æˆç¯å¢ƒç±»(Context) : å®ƒå†…éƒ¨ç»´æŠ¤ä¸€ä¸ªStateå­ç±»çš„å®ä¾‹,è¿™ä¸ªå®ä¾‹å®šä¹‰çš„æ˜¯å½“å‰çŠ¶æ€. æŠ½è±¡çŠ¶æ€ç±»(State) : å®šä¹‰ä¸€ä¸ªæ¥å£,å…¶ä¸­å°è£…Contextçš„ä¸€ä¸ªç‰¹å®šçŠ¶æ€çš„ç›¸å…³è¡Œä¸º. å…·ä½“çŠ¶æ€ç±»(ConcreteState): å®ç°ä¸€ä¸ªä¸Contextçš„ä¸€ä¸ªçŠ¶æ€ç›¸å…³çš„è¡Œä¸º. ä½¿ç”¨æƒ…å†µ å¦‚æœä¸€ä¸ªå¯¹è±¡,å®ƒçš„è¡Œä¸ºå®Œå…¨å–å†³äºå®ƒçš„æŸä¸€ç§çŠ¶æ€,è€Œä¸”è¿™ä¸ªçŠ¶æ€æ˜¯åŠ¨æ€å˜åŒ–çš„. ä»£ç ä¸­åŒ…å«å¤§é‡ä¸å¯¹è±¡çŠ¶æ€æœ‰å…³çš„æ¡ä»¶è¯­å¥ ä»£ç å®ç°ç°åœ¨æœ‰è¿™ä¹ˆä¸€ä¸ªéœ€æ±‚,ç”¨æˆ·åˆ†ä¸ºä¸åŒçš„ç­‰çº§,æ¯ä¸ªç­‰çº§æ‰€è¿›è¡Œçš„æ“ä½œæ˜¯ä¸ä¸€æ ·çš„. State interface UserState{ //æ¥æ”¶ä¸€ä¸ªä»·æ ¼,å†è¿”å›ä¸€ä¸ªå¤„ç†åçš„ä»·æ ¼ fun pay (level:Double) : Double } ConcreteState class NormalState :UserState{ override fun pay(level: Double): Double { val result = level * 1.0 println(&quot;${javaClass.simpleName} éœ€è¦æ”¯ä»˜ : $result&quot;) return result } } class BossState : UserState{ override fun pay(level: Double): Double { val result = 0 println(&quot;${javaClass.simpleName} éœ€è¦æ”¯ä»˜ : $result&quot;) return 0.0 } } class VIPState : UserState{ override fun pay(level: Double): Double { //ä¼šå‘˜95% val result = level * 0.95 println(&quot;${javaClass.simpleName} éœ€è¦æ”¯ä»˜ : $result&quot;) return result } } Context class UserContext{ //ä¿å­˜çŠ¶æ€ private var mState : UserState = NormalState() fun setUser(state: UserState){ this.mState = state } fun pay(price:Double){ mState.pay(price) } } æµ‹è¯•public class MainClass { public static void main(String[] args){ UserContext userContext = new UserContext(); userContext.pay(1000); userContext.setUser(new VIPState()); userContext.pay(1000); userContext.setUser(new BossState()); userContext.pay(1000); } } //result: NormalState éœ€è¦æ”¯ä»˜ : 1000.0 VIPState éœ€è¦æ”¯ä»˜ : 950.0 BossState éœ€è¦æ”¯ä»˜ : 0 Process finished with exit code 0 StateMachineå¤æ‚çš„çŠ¶æ€æœºçœ‹ç€æ˜¯æ²¡å•¥ç”¨çš„ä¸œè¥¿,æ˜æ˜å¯ä»¥ç”¨if else æå®šçš„,ä¸ºä»€ä¹ˆä¸€å®šè¦ä½¿ç”¨è®¾è®¡æ¨¡å¼,è€Œä¸”è¿˜å¤šäº†å¥½å‡ ä¸ªç±» åªæ˜¯æˆ‘è¿™é‡Œå†™çš„ä¾‹å­å¤ªç®€å•,ä½†è¿˜æ˜¯æŠŠstate å’Œ è¡Œä¸ºæ‹‰äº†å‡ºæ¥,å¦‚æœåé¢è¦åŠ çŠ¶æ€å†æ·»åŠ å®ç°ç±»å³å¯ BUTè¿™åªæ˜¯æœ€ç®€å•çš„å®ç°,æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ç³»ç»Ÿä¸­æœ‰ä»€ä¹ˆé«˜çº§çš„ä¸œè¥¿ com/android/internal/util/StateMachine.java å½“æˆ‘çœ‹åˆ°è¿™ä¸ªç±»,æˆ‘ä¸€ä¸‹å°±æ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨çŠ¶æ€æ¨¡å¼ æˆ‘ä»¬ç°åœ¨çš„ç»“æ„,éå¸¸ç®€å•,ç¡®å®å¯ä»¥è¢«if elseæ›¿æ¢,åªæ˜¯ä¸é‚£ä¹ˆä¼˜é›… ä½†æ˜¯å¦‚æœ,ä½ çš„Stateæ˜¯è¿™æ ·çš„é‚£? ä½ è¿˜å¯ä»¥ç”¨if - elseä¹ˆ?è¿™æ—¶å€™ç»™ä½ åŠ ä¸€ä¸ªstate,ä¸è¯´æ”¹ä»£ç ,èµ·ç è¦ç†ä¸€ä¼šæ‰è¡Œ ä½¿ç”¨SmHandle sm; //æ·»åŠ çŠ¶æ€ sm.addState(S0,null); //S1 S2æ·»åŠ ä¸ºS0çš„å­ç±» sm.addState(S1,S0); sm.addState(S2,S0); //S3 S3æ·»åŠ ä¸ºS1çš„å­ç±» sm.addState(S3,S1); sm.addState(S4,S1); //S5 S6 S7æ·»åŠ ä¸ºS2çš„å­ç±» sm.addState(S5,S2); sm.addState(S6,S2); sm.addState(S7,S2); //è®¾ç½®åˆå§‹çŠ¶æ€ setInitialState(S4); è¿™æ ·ä¼šæ„é€ æˆ","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://www.wangzhumo.com/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"RecyclerViewä¸­notifyItemRangeChangedæ— æ•ˆçš„BUG","slug":"RecyclerView-unuseful-notifyItemRangeChanged","date":"2018-07-13T14:39:55.000Z","updated":"2019-12-22T12:07:39.310Z","comments":true,"path":"2018/07/13/RecyclerView-unuseful-notifyItemRangeChanged/","link":"","permalink":"https://www.wangzhumo.com/2018/07/13/RecyclerView-unuseful-notifyItemRangeChanged/","excerpt":"å‰è¨€RecyclerViewæ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç”¨çš„æœ€é¢‘ç¹çš„å‡ ä¸ªæ§ä»¶ä¹‹ä¸€,å¯ä»¥è¯´ä¸€ä¸ªAppæ²¡æœ‰RecyclerViewçš„å‚ä¸,å¯èƒ½æ ¹æœ¬å°±åšä¸å‡ºæ¥.ç„¶è€ŒåŒæ—¶,RecyclerViewå°½ç®¡æœ‰å¤ç”¨æœºåˆ¶,æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™,è¿˜æ˜¯åº”è¯¥å°½é‡çš„èŠ‚çœå†…å­˜,æé«˜æ€§èƒ½. æ‰€ä»¥,å¯¹äºRecyclerViewä¸­çš„Item,å°½é‡å°‘åˆ·æ–°,è¶Šå°‘è¶Šå¥½.","text":"å‰è¨€RecyclerViewæ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç”¨çš„æœ€é¢‘ç¹çš„å‡ ä¸ªæ§ä»¶ä¹‹ä¸€,å¯ä»¥è¯´ä¸€ä¸ªAppæ²¡æœ‰RecyclerViewçš„å‚ä¸,å¯èƒ½æ ¹æœ¬å°±åšä¸å‡ºæ¥.ç„¶è€ŒåŒæ—¶,RecyclerViewå°½ç®¡æœ‰å¤ç”¨æœºåˆ¶,æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™,è¿˜æ˜¯åº”è¯¥å°½é‡çš„èŠ‚çœå†…å­˜,æé«˜æ€§èƒ½. æ‰€ä»¥,å¯¹äºRecyclerViewä¸­çš„Item,å°½é‡å°‘åˆ·æ–°,è¶Šå°‘è¶Šå¥½. notifyItemRangeChangedæ˜¯ä¸»è¦çš„ä¸€ä¸ªæ–¹æ³•,å…¶ä»–çš„notifyItemChangedç­‰å‡ ä¸ªä¸åŒå…¥å‚çš„æ–¹æ³•,å…¶å®æœ€åéƒ½æ˜¯è°ƒç”¨notifyItemRangeChanged: android.support.v7.widget.RecyclerView.Adapter #notifyItemRangeChanged(int positionStart, int itemCount, @Nullable Object payload) æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒçš„å‡ ä¸ªå‚æ•° positionStart å¼€å§‹çš„ä½ç½® itemCount éœ€è¦åˆ·æ–°å‡ ä¸ªItem payload è¿™ä¸ªå‚æ•°æ¯”è¾ƒé‡è¦,å¦‚æœå®ƒä¸ºnull,åˆ™å›è°ƒä¸­ä¼šåˆ·æ–°æ•´ä¸ªViewè€Œä¸æ˜¯å±€éƒ¨åˆ·æ–° å¥½äº†,æˆ‘ä»¬æ¥è¯´è¯´è¿™ä¸ªBUG çœ‹åˆ°èµ,è¯„è®ºä¸¤ä¸ªå­—æ®µäº†ä¹ˆ? ç°åœ¨çš„éœ€æ±‚æ˜¯è¦åŠ ä¸€ä¸ªé˜…è¯»é‡çš„,å¦‚å›¾ä¸­çš„çº¢è‰²å­— è¿™ä¸ªé˜…è¯»é‡æœ¬åœ°å…ˆåšä¸€ä¸ªç‚¹å‡»å°±åŠ ä¸€çš„ä¸œè¥¿,è€Œä¸å»è¯·æ±‚ç½‘ç»œæ¥åˆ·æ–°. å…¶å®æ€ä¹ˆåˆ·è¿™ä¸ªèµéƒ½è¡Œ,æˆ‘ä»¬éƒ½éœ€è¦å…ˆæä¾›ä¸€ä¸ªä¿®æ”¹è¿™ä¸€ä¸ª é˜…è¯»é‡View çš„åŠŸèƒ½ æ‰€ä»¥æˆ‘ç†æ‰€å½“ç„¶çš„ç”¨notifyItemRangeChangedæ¥åšäº†ä¸€é. BUGå†ç°å½“æˆ‘ä¿¡å¿ƒæ»¡æ»¡çš„æŠŠè¿™ä¸ªè¿è¡Œåˆ°çœŸæœºä¸Šæµ‹è¯•çš„æ—¶å€™,æˆ‘æ˜¯æ‹’ç»çš„,è¿™ä¸ªé˜…è¯»é‡çš„æ•°å­—,ä¸€ç›´ä¿æŒ0 ä¸€åŠ¨ä¹Ÿä¸åŠ¨,äºæ˜¯æˆ‘å°±å¼€å§‹äº†ä¸€æ­¥æ­¥çš„æ’é™¤ä¹‹æ—….å±‹æ¼åé€¢è¿å¤œé›¨,æˆ‘çš„æ•°æ®çº¿å¥½åƒæœ‰ç‚¹æ¥è§¦ä¸è‰¯,åªå¾—å¼€å¯äº†WIFI ADBç”¨æ¥è°ƒè¯•App,ä½†æ˜¯è¿™å°±æ„å‘³ç€æˆ‘ä¸èƒ½ debugäº†,é‚£ä¹ˆæˆ‘åªèƒ½ä½¿å‡º Log å¤§æ³•. å…ˆè´´ä¸Šæˆ‘å½“æ—¶çš„ä»£ç : @Override protected void onBindViewHolder(@NonNull ViewHolder holder, @NonNull MediaItem item, @NonNull List&lt;Object&gt; payloads) { Log.d(&quot;Adapter&quot;,&quot;onBindViewHolder&quot; + payloads.isEmpty()); if (payloads.isEmpty()){ onBindViewHolder(holder, item); }else{ holder.mTvPvNum.setText(payloads.get(0).toString()); } } @Override protected void onBindViewHolder(@NonNull ViewHolder holder, @NonNull MediaItem item) { holder.mTvMediaAuthor.setText(item.getSourceName()); holder.mTvMediaTime.setText(DateFormatUtil.getDataStringForNews(item.getPublishTimeBO())); // çœç•¥å…¶ä»–ä¸ç›¸å…³ä»£ç ... holder.itemView.setOnClickListener(v -&gt; { if (onNewsClickListener != null) { Log.d(&quot;Adapter&quot;,&quot;onBindViewHolder&quot; + item.getFormatPvNum()); getAdapter().notifyItemChanged(holder.getAdapterPosition(),item.addPvNum().getFormatPvNum()); onNewsClickListener.onArticleClick(item); } }); } ä½¿ç”¨notifyItemChanged è°ƒç”¨notifyItemXXXç³»åˆ—æ–¹æ³• åœ¨onBindViewHolder(ViewHolder,MediaItem item,List&lt;Object&gt; payloads)æ–¹æ³•ä¸­åˆ¤æ–­List&lt;Object&gt; payloadsçš„å€¼ å¦‚æœpayloadså€¼ä¸ºç©º,åˆ™åˆ·æ–°å…¨éƒ¨,æˆ‘è¿™é‡Œç›´æ¥è°ƒç”¨äº†onBindViewHolder(holder, item);æ¥è¿›è¡Œæ•´ä¸ªItemçš„æ›´æ–° å¦‚æœpayloadsçš„å€¼ä¸ä¸ºç©º,åˆ™è¿›è¡Œå±€éƒ¨æ›´æ–°å³å¯ é¢„æœŸæ•ˆæœåœ¨ç‚¹å‡»æ•´ä¸ªItemæ—¶è°ƒç”¨ä¹‹å‰å‡†å¤‡çš„å›è°ƒæ–¹æ³•,å¹¶ä¸” getAdapter().notifyItemChanged(postion,item.addPvNum().getFormatPvNum()); é‚£ä¹ˆå¯¹åº”postionä½ç½®çš„Itemåº”è¯¥ä¼šåˆ·æ–°å®ƒçš„ é˜…è¯»é‡ BUGå‘ç”ŸåŸå› æ¢ç´¢å·²çŸ¥æ¡ä»¶(é€šè¿‡Logå¯çŸ¥) è°ƒç”¨notifyItemChangedæˆåŠŸäº† onBindViewHolder(ViewHolder, item,List&lt;Object&gt; payloads)æ–¹æ³•æ²¡æœ‰è¢«æˆåŠŸè°ƒèµ· æ¨æµ‹åŸå› å¦‚æœè¯´æˆ‘å½“å‰çš„è¿™ä¸ªAdapterç¡®å®è°ƒç”¨äº†notifyItemChanged,å¹¶ä¸”å‚æ•°æ— è¯¯,ä½†æ˜¯å´æ— æ³•æ‹‰èµ·å›è°ƒ åªèƒ½æ˜¯å›è°ƒæ–¹æ³•æ²¡æœ‰è¢«è°ƒèµ·,æˆ‘è®°èµ·æ¥äº†ä¸€äº›å½“æ—¶çœ‹è¿‡çš„RecyclerViewæºç  æ…¢æ…¢è¯´èµ·: public void setAdapter(Adapter adapter) { // bail out if layout is frozen setLayoutFrozen(false); setAdapterInternal(adapter, false, true); processDataSetCompletelyChanged(false); requestLayout(); } RecyclerViewä¸­çš„setAdapter,æˆ‘ä»¬åªéœ€è¦å…³æ³¨å…¶ä¸­çš„setAdapterInternal(adapter, false, true); æš‚æ—¶ä¸ç”¨å»äº†è§£å…¶ä»–å‡ ä¸ªæ–¹æ³•,è¿™4ä¸ªæ–¹æ³•ä¸­åªæœ‰è¿™ä¸€ä¸ªæ–¹æ³•å‚æ•°ä¸­å¸¦äº†adapter,è¯´æ˜å°±æ˜¯è¿™ä¸ªæ–¹æ³•æŠŠRecyclerViewå’ŒAdapterå…³è”äº†èµ·æ¥. private void setAdapterInternal(Adapter adapter, boolean compatibleWithPrevious, boolean removeAndRecycleViews) { if (mAdapter != null) { mAdapter.unregisterAdapterDataObserver(mObserver); mAdapter.onDetachedFromRecyclerView(this); } if (!compatibleWithPrevious || removeAndRecycleViews) { removeAndRecycleViews(); } mAdapterHelper.reset(); final Adapter oldAdapter = mAdapter; mAdapter = adapter; if (adapter != null) { adapter.registerAdapterDataObserver(mObserver); adapter.onAttachedToRecyclerView(this); } if (mLayout != null) { mLayout.onAdapterChanged(oldAdapter, mAdapter); } mRecycler.onAdapterChanged(oldAdapter, mAdapter, compatibleWithPrevious); mState.mStructureChanged = true; } çœ‹èµ·æ¥,æ˜¯æŠŠè€çš„Adapteræ¸…é™¤,å¹¶è®¾ç½®ä¼ å…¥çš„adapterä¸ºAdapterçš„å€¼ if (adapter != null) { adapter.registerAdapterDataObserver(mObserver); adapter.onAttachedToRecyclerView(this); } é‡ç‚¹åœ¨è¿™å¥è¯adapter.registerAdapterDataObserver(mObserver); å¾ˆæ˜æ˜¾,è¿™æ˜¯å¯¹æ•°æ®å˜åŒ–æ³¨å†Œæˆä¸ºä¸€ä¸ªè§‚å¯Ÿè€…,æŸ¥çœ‹æºç å‘ç°æœ€åæ˜¯æ”¾åˆ°äº† mObservable ä¸­ å¤§æ¦‚å·²ç»çŸ¥é“æ˜¯æ€ä¹ˆå›äº‹äº†,å¯èƒ½æˆ‘ä»¬å½“å‰çš„Adapteræ²¡æœ‰æ³¨å†Œä¸Šè§‚å¯Ÿè€…,æ‰€ä»¥æ²¡æœ‰å›è°ƒè¿‡æ¥å§. ä¸ºäº†è¯å®æˆ‘çš„çŒœæµ‹,æˆ‘å€Ÿäº†åŒäº‹çš„æµ‹è¯•æœºå’Œçº¿ è¯å®çŒœæƒ³å¼€å¯DEBUGä¸€æ­¥ä¸€æ­¥è·Ÿè¿‡æ¥. android.support.v7.widget.RecyclerView.AdapterDataObserver#onItemRangeChanged(int, int) æœ€å,è·‘åˆ°äº†è¿™é‡Œæ¥.ä¸€ä¸ªçœŸçœŸæ­£æ­£çš„ç©ºæ–¹æ³• äºæ˜¯æŸ¥çœ‹äº†ä¸€ä¸‹mObservable,åªæœ‰ä¸€ä¸ªå€¼RefreshAndLoadMoreHelper,è€Œæˆ‘è‡ªå·±çš„Adapteræ˜æ˜æ˜¯å«åšMultiTypeAdapter çœ‹åˆ°è¿™é‡Œ,æˆ‘çš„çŒœæƒ³å·²ç»è¯å®,RefreshAndLoadMoreHelperæ˜¯æˆ‘è‡ªå·±å°è£…,ç”¨æ¥æ”¯æŒä¸Šæ‹‰åŠ è½½,ä¸‹æ‹‰åˆ·æ–°çš„å·¥å…·ç±»,å…¶å®å®ƒè‡ªå·±ä¹Ÿç»§æ‰¿äº†RecyclerView.Adapter,å¹¶ä¸”åœ¨RefreshAndLoadMoreHelperçš„æ„é€ æ–¹æ³•ä¸­,è°ƒç”¨äº† recyclerView.setAdapter(mHeaderFooterAdapter);,è¿™å°±æ˜¯è¯´,æˆ‘è‡ªå·±è®¾ç½®çš„Adapteræ°¸è¿œä¼šè¢«å®ƒè¦†ç›–. è§£å†³BUGå·²ç»çŸ¥é“äº†åŸå› ,æ˜¯ç”±äºæˆ‘è‡ªå·±çš„å·¥å…·ç±»,æ›¿ä»£äº†æœ¬æ¥è®¾ç½®çš„Adapter,,ç°åœ¨çš„mHeaderFooterAdapteræ˜¯ä¸å½“å‰RecyclerViewå…³è”çš„,ä½†æ˜¯æˆ‘ä»¬åœ¨ä»£ç ä¸­ è°ƒç”¨çš„æ˜¯(å¼€å¤´çš„ä»£ç ): getAdapter().notifyItemChanged(holder.getAdapterPosition(),item.addPvNum().getFormatPvNum()); getAdapter()è¿”å›çš„æ˜¯Adapterè€Œä¸æ˜¯å…³è”RecyclerViewçš„mHeaderFooterAdapter æ‰€ä»¥,æˆ‘ä»¬åªè¦æƒ³åŠæ³•,åœ¨Adapterä¸­è°ƒç”¨äº†æ–¹æ³•å,é€šçŸ¥mHeaderFooterAdapterä¸€å£°,è®©å®ƒå»å®Œæˆæ“ä½œå³å¯ ä»£ç å¦‚ä¸‹: Adapter.registerAdapterDataObserver(new RecyclerView.AdapterDataObserver() { @Override public void onChanged() { mHeaderFooterAdapter.notifyDataSetChanged(); } @Override public void onItemRangeChanged(int positionStart, int itemCount, @Nullable Object payload) { mHeaderFooterAdapter.notifyItemRangeChanged(positionStart, itemCount, payload); } }); Adapteræ˜¯æˆ‘è‡ªå·±åŸæ¥è®¾ç½®çš„ mHeaderFooterAdapteræ˜¯å·¥å…·ç±» è¿™é‡Œé¢çš„æ„æ€å°±æ˜¯,ç»™æˆ‘è‡ªå·±çš„Adapteræ³¨å†Œäº†ä¸€ä¸ªè§‚å¯Ÿè€…,æ¯å½“æˆ‘åœ¨Adapterä¸­è°ƒç”¨äº†æ–¹æ³•,å°±ä¼šå›è°ƒè¿™é‡Œ,åœ¨è¿™é‡Œæœ¬æ¥æ˜¯é€šçŸ¥RecyclerViewæ¥å¤„ç†çš„,ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦ç›´æ¥æ¥å¤„ç†,å§”æ‰˜ç»™mHeaderFooterAdapterå³å¯,æ‰€ä»¥æˆ‘åœ¨å›è°ƒä¸­ç›´æ¥è°ƒç”¨äº†,mHeaderFooterAdapter.notifyItemRangeChangedè¿™æ ·å°±OKäº†.","categories":[{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/categories/Bug/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/tags/Bug/"}]},{"title":"ConstraintLayoutä½¿ç”¨æŒ‡å—-åŸºç¡€çš„çº¦æŸ","slug":"ConstraintLayout-Basic","date":"2018-07-12T07:49:34.000Z","updated":"2019-12-22T12:11:28.692Z","comments":true,"path":"2018/07/12/ConstraintLayout-Basic/","link":"","permalink":"https://www.wangzhumo.com/2018/07/12/ConstraintLayout-Basic/","excerpt":"å‰è¨€ConstraintLayoutç°åœ¨å·²ç»æ˜¯æ–°å»ºå¸ƒå±€çš„é»˜è®¤è·Ÿå¸ƒå±€äº†,å†µä¸”ç¡®å®å¥½ç”¨,æœ‰å¿…è¦å­¦ä¹ ä¸€æ³¢ ConstraintLayout,æ¥è‡ªå®˜ç½‘çš„æ–‡æ¡£,è§‰å¾—ä¸æ˜¯å¾ˆç›´è§‚,äºæ˜¯æˆ‘æƒ³æŠŠå®ƒåšæˆGIFå›¾ compile &#39;com.android.support.constraint:constraint-layout:1.1.2&#39; æˆªæ­¢æˆ‘å†™ä¸‹è¿™ç¯‡ç¬”è®°çš„æ—¶å€™,å·²ç»æ˜¯1.1.2ç‰ˆæœ¬äº†,ä¸‹é¢æ‰€æœ‰çš„ä»£ç éƒ½æ˜¯åŸºäº1.1.2ç‰ˆæœ¬.","text":"å‰è¨€ConstraintLayoutç°åœ¨å·²ç»æ˜¯æ–°å»ºå¸ƒå±€çš„é»˜è®¤è·Ÿå¸ƒå±€äº†,å†µä¸”ç¡®å®å¥½ç”¨,æœ‰å¿…è¦å­¦ä¹ ä¸€æ³¢ ConstraintLayout,æ¥è‡ªå®˜ç½‘çš„æ–‡æ¡£,è§‰å¾—ä¸æ˜¯å¾ˆç›´è§‚,äºæ˜¯æˆ‘æƒ³æŠŠå®ƒåšæˆGIFå›¾ compile &#39;com.android.support.constraint:constraint-layout:1.1.2&#39; æˆªæ­¢æˆ‘å†™ä¸‹è¿™ç¯‡ç¬”è®°çš„æ—¶å€™,å·²ç»æ˜¯1.1.2ç‰ˆæœ¬äº†,ä¸‹é¢æ‰€æœ‰çš„ä»£ç éƒ½æ˜¯åŸºäº1.1.2ç‰ˆæœ¬. é¢æ¿ é¦–å…ˆåº”è¯¥æ˜ç™½ä¸»è¦çš„ä¸¤ä¸ªé¢æ¿ è“è‰²çš„åŒºåŸŸ,æˆ‘ä»¬æˆä¸ºè®¾è®¡è“å›¾,ä¸‹æ–‡ç§°è“å›¾é¢æ¿ å³è¾¹çš„æ˜¯å±æ€§é¢æ¿,ä¸‹æ–‡ç§°å±æ€§é¢æ¿,å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œç²¾ç»†è°ƒæ•´ å•ä¸ªæ§ä»¶çš„çº¦æŸå†æ¼”ç¤ºä¹‹å‰,å»ºè®®å¤§å®¶éƒ½ä½¿ç”¨Android Studio æä¾›çš„Design æ¨¡å¼æ¥åˆ›å»ºå’Œä¿®æ”¹çº¦æŸå¸ƒå±€,æ–¹ä¾¿è€Œä¸”ç›´è§‚ æˆ‘çš„Android Studio ç‰ˆæœ¬æ˜¯3.1.3,å¦‚æœæœ‰å’Œæˆ‘æ“ä½œç•Œé¢ä¸ä¸€è‡´çš„,è¯·è‡ªè¡Œå¯¹åº” marginæ•ˆæœ å¦‚æœæˆ‘åªç»™å·¦è¾¹å’Œä¸Šè¾¹åŠ ä¸Šçº¦æŸ,é‚£ä¹ˆå°±ä¼šæ˜¯marginçš„æ•ˆæœ,ä»£ç è¡¨ç°å¦‚ä¸‹: &lt;Button android:id=&quot;@+id/button&quot; android:layout_width=&quot;wrap_content&quot; android:text=&quot;Button&quot; android:layout_height=&quot;wrap_content&quot; android:layout_marginStart=&quot;28dp&quot; android:layout_marginTop=&quot;28dp&quot; app:layout_constraintStart_toStartOf=&quot;parent&quot; app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt; å¦‚æœä½ æƒ³è°ƒèŠ‚è¿™ä¸ªmargin,å³å¯ä»¥æ‹–åŠ¨,ä¹Ÿå¯ä»¥å»å±æ€§é¢æ¿è°ƒæ•´,ä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­ä¿®æ”¹ å±…ä¸­/åç§»æ•ˆæœ å¯ä»¥çœ‹åˆ°,æˆ‘åœ¨å·¦è¾¹å’Œä¸Šè¾¹å·²ç»æœ‰marginçš„æƒ…å†µä¸‹,ç»™å³è¾¹å’Œä¸‹è¾¹ä¹ŸåŠ ä¸Šäº†çº¦æŸ,ç°åœ¨BUTTONå¤§ä½“ä¸Šæ˜¯å±…ä¸­æ•ˆæœ ä¸ºä»€ä¹ˆæ˜¯â€å¤§ä½“â€å±…ä¸­é‚£? çœ‹ç®­å¤´é™„è¿‘çš„ 28 28 8 8 ,è¿™æ˜¯åœ¨marginçš„åŸºç¡€ä¸Šå±…ä¸­çš„,å»æ‰marginå°±æ˜¯ç»å¯¹å±…ä¸­çš„äº† ç°åœ¨æˆ‘ä»¬çœ‹å±æ€§é¢æ¿: ç•¥å°çš„çº¢æ¡†ä¸­,å°±æ˜¯margin,è¿™æ ·çš„è°ƒèŠ‚æ¡†è¿˜æœ‰3ä¸ª çœ‹åˆ°é‚£ä¸ªå¯ä»¥æ»‘åŠ¨çš„è½´äº†ä¹ˆ? ä¸­é—´è¿˜æœ‰ä¸ª50çš„æ•°å­—,è¿™ä¸ªæ˜¯è°ƒèŠ‚BUTTONåœ¨å‚ç›´æ–¹å‘çš„åç§» å…¶ä»–å‡ ä¸ªæ“ä½œæ¡†åŒç†å¯æ¨å…¶ä½œç”¨ æ¯”å¦‚æˆ‘éœ€è¦ä¸€ä¸ªç™»å½•åœ¨å‚ç›´æ–¹å‘çš„0.75å¤„,ä¹Ÿå°±æ˜¯åœ¨æ•´ä¸ªé¡µé¢çš„3/4å¤„ å¯ä»¥ç›´æ¥æ‹‰åŠ¨è¿™ä¸ªæ§åˆ¶ç‚¹,ä½¿ä»–çš„æ•°å€¼å˜ä¸º75,ä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­ä¿®æ”¹,ä»£ç è¡¨ç°å¦‚ä¸‹: &lt;Button android:id=&quot;@+id/button&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:text=&quot;ç™»å½•&quot; app:layout_constraintBottom_toBottomOf=&quot;parent&quot; app:layout_constraintEnd_toEndOf=&quot;parent&quot; app:layout_constraintStart_toStartOf=&quot;parent&quot; app:layout_constraintTop_toTopOf=&quot;parent&quot; app:layout_constraintVertical_bias=&quot;0.75&quot; /&gt; æ­¤æ—¶çš„BUTTONå°±ä¼šå¤„åœ¨æ•´ä¸ªå¸ƒå±€çš„3/4å¤„,å°±ä¸æ”¾å›¾äº† çºµæ¨ªæ¯” ä»£ç è¡¨ç°å¦‚ä¸‹: &lt;ImageView android:layout_width=&quot;0dp&quot; android:layout_height=&quot;0dp&quot; android:src=&quot;@mipmap/login_bg&quot; android:scaleType=&quot;fitXY&quot; app:layout_constraintDimensionRatio=&quot;h,16:9&quot; app:layout_constraintEnd_toEndOf=&quot;parent&quot; app:layout_constraintStart_toStartOf=&quot;parent&quot; app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt; å¤šä¸ªæ§ä»¶çš„çº¦æŸ","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"JVMçš„åƒåœ¾å›æ”¶Garbage Collection","slug":"JVM-Garbage-Collection","date":"2018-07-11T07:45:01.000Z","updated":"2019-12-22T12:09:12.086Z","comments":true,"path":"2018/07/11/JVM-Garbage-Collection/","link":"","permalink":"https://www.wangzhumo.com/2018/07/11/JVM-Garbage-Collection/","excerpt":"å‰è¨€æˆ‘ä»¬çŸ¥é“åœ¨çº¿ç¨‹åˆ›å»ºæ—¶,ç¨‹åºè®¡æ•°å™¨,æœ¬åœ°æ–¹æ³•æ ˆ,è™šæ‹Ÿæœºæ ˆéšä¹‹åˆ›å»º,çº¿ç¨‹é”€æ¯æ—¶éšä¹‹é”€æ¯ å¹¶ä¸”æ ˆä¸­çš„æ ˆå¸§ä¹Ÿéšç€æ–¹æ³•çš„è¿›å…¥ä¸é€€å‡ºæ‰§è¡Œå‡ºå…¥æ ˆæ“ä½œ,æœ€é‡è¦çš„æ˜¯æ¯ä¸€ä¸ªæ ˆå¸§æ¶ˆè€—çš„å†…å­˜åŸºæœ¬ä¸Šåœ¨ç±»ç»“æ„ç¡®å®šæ—¶å°±å·²ç»çŸ¥é“,è¿™å‡ ä¸ªåŒºåŸŸçš„å†…å­˜åˆ†é…ä¸å›æ”¶éƒ½æ˜¯ç¡®å®šçš„,ä¸éœ€è¦è¿‡å¤šè€ƒè™‘å›æ”¶. ä½†æ˜¯è¿›ç¨‹ä¸­çš„ å †(heap) ä»¥åŠ æ–¹æ³•åŒºä¸ä¸Šé¢çš„å‡ ä¸ªæ ˆæ˜¯ä¸åŒçš„,å½“ç¨‹åºå¤„äºè¿è¡Œæ—¶æœŸæ‰èƒ½ç¡®å®š,å®ƒä»¬çš„å†…å­˜åˆ†é…ä¸å›æ”¶éƒ½æ˜¯åŠ¨æ€çš„. åƒåœ¾æ”¶é›†ä¸»è¦å°±æ˜¯è¿™éƒ¨åˆ†.","text":"å‰è¨€æˆ‘ä»¬çŸ¥é“åœ¨çº¿ç¨‹åˆ›å»ºæ—¶,ç¨‹åºè®¡æ•°å™¨,æœ¬åœ°æ–¹æ³•æ ˆ,è™šæ‹Ÿæœºæ ˆéšä¹‹åˆ›å»º,çº¿ç¨‹é”€æ¯æ—¶éšä¹‹é”€æ¯ å¹¶ä¸”æ ˆä¸­çš„æ ˆå¸§ä¹Ÿéšç€æ–¹æ³•çš„è¿›å…¥ä¸é€€å‡ºæ‰§è¡Œå‡ºå…¥æ ˆæ“ä½œ,æœ€é‡è¦çš„æ˜¯æ¯ä¸€ä¸ªæ ˆå¸§æ¶ˆè€—çš„å†…å­˜åŸºæœ¬ä¸Šåœ¨ç±»ç»“æ„ç¡®å®šæ—¶å°±å·²ç»çŸ¥é“,è¿™å‡ ä¸ªåŒºåŸŸçš„å†…å­˜åˆ†é…ä¸å›æ”¶éƒ½æ˜¯ç¡®å®šçš„,ä¸éœ€è¦è¿‡å¤šè€ƒè™‘å›æ”¶. ä½†æ˜¯è¿›ç¨‹ä¸­çš„ å †(heap) ä»¥åŠ æ–¹æ³•åŒºä¸ä¸Šé¢çš„å‡ ä¸ªæ ˆæ˜¯ä¸åŒçš„,å½“ç¨‹åºå¤„äºè¿è¡Œæ—¶æœŸæ‰èƒ½ç¡®å®š,å®ƒä»¬çš„å†…å­˜åˆ†é…ä¸å›æ”¶éƒ½æ˜¯åŠ¨æ€çš„. åƒåœ¾æ”¶é›†ä¸»è¦å°±æ˜¯è¿™éƒ¨åˆ†. å†…å­˜ä¸­å¯¹è±¡å¼•ç”¨çŠ¶æ€è¦è¿›è¡Œåƒåœ¾æ”¶é›†,ç¬¬ä¸€ä»¶è¦ç¡®å®šçš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡æ˜¯å¦ä¸è¢«ä»»ä½•æ–¹å¼å¼•ç”¨,å½“ç¡®å®šæ²¡æœ‰ä»»ä½•å¼•ç”¨å°±å¯ä»¥è¿›è¡Œå›æ”¶. å¼•ç”¨ï¼šè¦è¯´å¼•ç”¨çŠ¶æ€å°±è¦æ˜ç™½ä»€ä¹ˆæ˜¯å¼•ç”¨ï¼Œå¦‚æœReferenceç±»å‹çš„æ•°æ®ä¸­å­˜å‚¨çš„æ•°å€¼ä»£è¡¨çš„æ˜¯å¦å¤–ä¸€å—å†…å­˜çš„èµ·å§‹åœ°å€ï¼Œæˆ‘ä»¬å°±è¯´è¿™å—å†…å­˜ä»£è¡¨ç€ä¸€ä¸ªå¼•ç”¨ã€‚ åœ¨JDK1.2ä¹‹å,JAVAå¯¹å¼•ç”¨çš„æ¦‚å¿µè¿›è¡Œäº†æ‰©å……,å°†å¼•ç”¨åˆ†å¤–4ç§ å¼ºå¼•ç”¨, val onj = Object() è½¯å¼•ç”¨ ,æœ‰ç”¨ä½†æ˜¯éå¿…é¡»çš„å¯¹è±¡ å¼±å¼•ç”¨,ç”¨æ¥æè¿°éå¿…é¡»å¯¹è±¡ è™šå¼•ç”¨ é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­å‘¢? å¼•ç”¨è®¡æ•°æ³•å³å¯¹è±¡æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨,æ¯è¢«å¼•ç”¨ä¸€æ¬¡å°±åŠ 1,å¼•ç”¨é‡Šæ”¾å°±å‡å»1,å¦‚æœè®¡æ•°å™¨ä¸º0,é‚£å°±è¯´æ˜å¯¹è±¡â€å·²æ­»â€ ä½†æ˜¯Javaè™šæ‹Ÿæœºå¹¶æ²¡æœ‰é‡‡ç”¨è¿™ç§æ–¹å¼,å› ä¸ºæ²¡æœ‰åŠæ³•è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ Aä¸Bå¯¹è±¡,äº’ç›¸æŒæœ‰å¯¹æ–¹çš„å¼•ç”¨,é‚£ä¹ˆå°±ç®—ä»–ä»¬ä¸¤ä¸ªè®¡æ•°å™¨æ°¸è¿œä¸å¯èƒ½ç­‰äº0,å“ªæ€•è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½æ²¡æœ‰ç”¨äº†. å¯è¾¾æ€§åˆ†æç®—æ³•JVMå°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´». è¿™ç§ç®—æ³•,å°±æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„GC Rootså¯¹è±¡ä½œä¸ºèµ·å§‹ç‚¹,ä»è¿™äº›èŠ‚ç‚¹å‘ä¸‹æœç´¢,æœç´¢èµ°è¿‡çš„è·¯å¾„è¢«ç§°ä¸ºå¼•ç”¨é“¾(Reference Chain),å½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ¥çš„è¯,å°±å¯ä»¥åˆ¤æ–­è¿™ä¸ªå¯¹è±¡ä¸å¯ç”¨äº†. GC Rootsï¼š è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­çš„å¼•ç”¨å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨å˜é‡ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­çš„JNIå¼•ç”¨å¯¹è±¡ å›æ”¶å¯¹è±¡é€šè¿‡ä¸Šé¢çš„å¯è¾¾æ€§åˆ†æç®—æ³•,æˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­å‡ºé‚£äº›å¯å›æ”¶çš„å¯¹è±¡,ä½†æ˜¯å®é™…ä¸Šä»–ä»¬ä¹Ÿä¸æ˜¯ç«‹å³è¢«å›æ”¶ ç¬¬ä¸€æ¬¡ä¸å¯è¾¾,æ²¡æœ‰ä¸GC Rootsç›¸è¿æ¥çš„å¼•ç”¨é“¾,ä»–ä¼šè¢«æ ‡è®°ä¸€æ¬¡å¹¶ä¸”è¿›è¡Œä¸€æ¬¡ç­›é€‰,ç­›é€‰æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•,å½“å¯¹è±¡æ²¡æœ‰è¦†ç›–finalize()æˆ–è€…æ˜¯è¯¥æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨,éƒ½å°†è§†ä¸ºâ€æ²¡æœ‰å¿…è¦æ‰§è¡Œâ€. å¦‚æœä¸€ä¸ªå¯¹è±¡è¢«åˆ¤å®šéœ€è¦æ‰§è¡Œfinalize()æ–¹æ³•,é‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¼šè¢«æ”¾åœ¨F-Queueçš„é˜Ÿåˆ—ä¸­,å¹¶åœ¨ç¨åç”±è™šæ‹Ÿæœºåˆ›å»ºä¸€ä¸ªä½ä¼˜å…ˆçº§çš„Finalizerçº¿ç¨‹å»æ‰§è¡Œå®ƒ,ç¨åGCå°†ä¼šå¯¹F-Queueä¸­çš„å¯¹è±¡è¿›è¡Œç¬¬äºŒæ¬¡ç­›é€‰,å¦‚æœè¯¥å¯¹è±¡é‡æ–°è¢«å¼•ç”¨äº†,é‚£ä¹ˆå®ƒå°†è¢«ç§»å‡ºF-Queueé˜Ÿåˆ—,å®Œæˆè‡ªæ•‘.å¦åˆ™,å°±çœŸçš„è¢«å›æ”¶äº†. åƒåœ¾æ”¶é›†ç®—æ³•æ ‡è®°-æ¸…é™¤ç®—æ³•è¿™ä¸ªç®—æ³•åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†,é¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ è¿™æ ·çš„ç®—æ³•è™½ç„¶å¯ä»¥è¾¾åˆ°ç›®çš„,ä½†æ˜¯æ•ˆç‡ä¸é«˜,è€Œä¸”æ ‡è®°-æ¸…é™¤åä¼šäº§ç”Ÿå¤§é‡çš„ä¸è¿ç»­å†…å­˜ç¢ç‰‡,è¿™ä¼šå¯¼è‡´è¾ƒå¤§çš„å¯¹è±¡åˆ†é…å†…å­˜æ—¶æ— æ³•æ‰¾åˆ°ç¬¦åˆçš„å†…å­˜å—,å¯¼è‡´æå‰è§¦å‘å¦ä¸€æ¬¡åƒåœ¾å›æ”¶. å¤åˆ¶ç®—æ³•è¿™ç§ç®—æ³•çš„æ€è·¯æ˜¯,æŠŠä¸€å¤§å—å†…å­˜åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†,Aéƒ¨åˆ†æ­£å¸¸ä½¿ç”¨,å½“Aå—å†…å­˜ä½¿ç”¨å®Œ,å°±æŠŠAå†…å­˜ä¸­è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—å†…å­˜ä¸Šå»,ç„¶åä¸€æ¬¡æ€§æ¸…ç†æ‰Aä¸Šæ‰€æœ‰çš„å†…å®¹. è¿™æ ·çš„ç®—æ³•,ç®€å•è€Œä¸”é«˜æ•ˆ,è€Œä¸”ä¸ä¼šæœ‰å¤§é‡ä¸è¿ç»­å†…å­˜çš„é—®é¢˜äº§ç”Ÿ,ä½†æ˜¯è¿™æ ·çš„è¯,æ°¸è¿œåªèƒ½ä½¿ç”¨åˆ°å†…å­˜çš„ä¸€åŠç©ºé—´,æœªå…æœ‰äº›æµªè´¹äº†. IBMé€šè¿‡ç ”ç©¶,å°†å†…å­˜åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„Edenç©ºé—´å’Œä¸¤å—è¾ƒå°çš„Survivorç©ºé—´,8:1:1 æ ‡è®°-æ•´ç†ç®—æ³•æ ‡è®°è¿‡ç¨‹ ä»ç„¶ä¸ä¸Šé¢è¯´çš„â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¸€æ ·,ä½†æ˜¯åç»­ä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¸…ç†,è€Œæ˜¯æŠŠå¯å›æ”¶å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨,ç„¶åç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜. åˆ†ä»£å›æ”¶ç®—æ³•ä¸€èˆ¬æ˜¯æŠŠJavaå † åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨æœ€é€‚å½“çš„æ”¶é›†ç®—æ³•ã€‚ æ–°ç”Ÿä»£:åªæœ‰å°‘é‡å­˜æ´»,å°±é€‰ç”¨å¤åˆ¶ç®—æ³•,ä»˜å‡ºå°‘é‡å­˜æ´»å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›† è€å¹´ä»£:å¯¹è±¡å­˜æ´»ç‡é«˜,æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿,å°±è¦ä½¿ç”¨â€œæ ‡è®°â€”æ¸…ç†â€æˆ–è€…â€œæ ‡è®°â€”æ•´ç†â€ç®—æ³•æ¥è¿›è¡Œå›æ”¶ å®‰å…¨ç‚¹(GCå…¥å£)æˆ‘ä»¬éƒ½çŸ¥é“GCæ˜¯é˜»å¡æ‰€æœ‰çº¿ç¨‹çš„,â€Stop The Worldâ€è¿™æ ·çš„. ç¨‹åºæ‰§è¡Œæ—¶å¹¶éåœ¨æ‰€æœ‰åœ°æ–¹éƒ½ èƒ½åœé¡¿ä¸‹æ¥å¼€å§‹GC,åªæœ‰åœ¨åˆ°è¾¾å®‰å…¨ç‚¹æ—¶æ‰èƒ½æš‚åœ . è‡³äºå¯¹å®‰å…¨ç‚¹çš„é€‰å®š,ä¹Ÿæ˜¯å¾ˆå¤æ‚,è¿™é‡Œå°±ä¸äº†è§£äº†. æŠ¢å…ˆå¼ä¸­æ–­:GCå‘ç”Ÿæ—¶,æŠŠæ‰€æœ‰çº¿ç¨‹å…¨éƒ¨ä¸­æ–­,å¦‚æœæœ‰å‘ç°çº¿ç¨‹æ–­çš„åœ°æ–¹ä¸åœ¨å®‰å…¨ç‚¹ä¸Š,å°±æ¢å¤çº¿ç¨‹,ç›´åˆ°å®ƒç»§ç»­æ‰§è¡ŒæŒ‡ä»¤åˆ°è¾¾â€å®‰å…¨ç‚¹â€. ä¸»åŠ¨å¼ä¸­æ–­:GCéœ€è¦ä¸­æ–­æ—¶,è®¾ç½®æ ‡è¯†,è€Œæ¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ä¸»åŠ¨è½®è¯¢è¿™ä¸ªæ ‡å¿—,å‘ç°ä¸­æ–­æ ‡è¯†å°±è‡ªå·±ä¸»åŠ¨æŒ‚èµ·.","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"Androidä¸­çš„è´å¡å°”æ›²çº¿","slug":"Android-Bezier","date":"2018-07-05T08:05:12.000Z","updated":"2019-12-22T12:12:59.954Z","comments":true,"path":"2018/07/05/Android-Bezier/","link":"","permalink":"https://www.wangzhumo.com/2018/07/05/Android-Bezier/","excerpt":"ç®€ä»‹è´å¡å°”æ›²çº¿(BÃ©zier curve) æˆ‘ä»¬åœ¨å¾ˆå¤šAppç§éƒ½èƒ½å‘ç°å®ƒçš„å½±å­,æ¯”å¦‚è¯´","text":"ç®€ä»‹è´å¡å°”æ›²çº¿(BÃ©zier curve) æˆ‘ä»¬åœ¨å¾ˆå¤šAppç§éƒ½èƒ½å‘ç°å®ƒçš„å½±å­,æ¯”å¦‚è¯´ QQçš„å°çº¢ç‚¹ ä¸‹æ‹‰åˆ·æ–°çš„ç²˜è¿æ•ˆæœ ä¸ªäººåŠ¨æ€ç­‰é¡µé¢çš„æ³¢æµªæ•ˆæœ é˜…è¯»è½¯ä»¶çš„ç¿»é¡µæ•ˆæœ è´å¡å°”æ›²çº¿æ˜¯ç”¨ä¸€ç³»åˆ—ç‚¹æ¥æ§åˆ¶æ›²çº¿çŠ¶æ€ï¼Œä¸»è¦å°±æ˜¯ï¼šæ•°æ®ç‚¹ã€æ§åˆ¶ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´æ§åˆ¶ç‚¹ï¼Œæ¥ä½¿å¾—è´å¡å°”æ›²çº¿å½¢çŠ¶å˜åŒ– æ•°æ®ç‚¹ æŒ‡å®šäº†èµ·å§‹ä½ç½® æ§åˆ¶ç‚¹ ä¸€æˆ–å¤šä¸ª,å†³å®šäº†æ›²çº¿çš„è½¨è¿¹ è¿™é‡Œæ”¾ä¸¤ä¸ªåœ¨çº¿æŸ¥çœ‹è´å¡å°”æ›²çº¿çš„é“¾æ¥ http://myst729.github.io/bezier-curve/ http://cubic-bezier.com/#.17,.67,.83,.67 è¿™é‡Œæ˜¯ä¸€ä¸ªå¿«é€Ÿç¡®å®šç‚¹ä½ç½®çš„æ•™ç¨‹ https://www.jianshu.com/p/1d766455445b","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"GitHubä½¿ç”¨SSHçš„æ–¹å¼å…å¯†ä¸Šä¼ ","slug":"GitHub-With-SSH","date":"2018-07-05T05:13:25.000Z","updated":"2019-12-22T12:10:10.728Z","comments":true,"path":"2018/07/05/GitHub-With-SSH/","link":"","permalink":"https://www.wangzhumo.com/2018/07/05/GitHub-With-SSH/","excerpt":"å‰è¨€å‰ä¸€æ®µæ—¶é—´æ¢äº†githubè´¦å·,å„ç§è½¬ç§»æ•°æ®,ç´¯æ­»æˆ‘ è€Œå,æˆ‘é¡ºæ‰‹æ·»åŠ äº†githubçš„ssh-key(æ–°åˆ›å»ºäº†ä¸€ä¸ªrsaçš„Key),ç„¶è€Œå½“æˆ‘: # phyooos @ wangzhumo in ~/develop/hexo [12:10:02] C:2 $ hexo d INFO Deploying: git INFO Clearing .deploy_git folder... #... git@github.com: Permission denied (publickey). fatal: Could not read from remote repository. å¾ˆè¿·,å®Œå…¨ä¸çŸ¥é“ä¸ºä»€ä¹ˆ","text":"å‰è¨€å‰ä¸€æ®µæ—¶é—´æ¢äº†githubè´¦å·,å„ç§è½¬ç§»æ•°æ®,ç´¯æ­»æˆ‘ è€Œå,æˆ‘é¡ºæ‰‹æ·»åŠ äº†githubçš„ssh-key(æ–°åˆ›å»ºäº†ä¸€ä¸ªrsaçš„Key),ç„¶è€Œå½“æˆ‘: # phyooos @ wangzhumo in ~/develop/hexo [12:10:02] C:2 $ hexo d INFO Deploying: git INFO Clearing .deploy_git folder... #... git@github.com: Permission denied (publickey). fatal: Could not read from remote repository. å¾ˆè¿·,å®Œå…¨ä¸çŸ¥é“ä¸ºä»€ä¹ˆ æ’é™¤é—®é¢˜æŸ¥çœ‹~/.sshç›®å½•-rw------- 1 phyooos staff 1.6K 6 27 2017 aliyun_rsa -rw-r--r-- 1 phyooos staff 398B 6 27 2017 aliyun_rsa.pub -rw-r--r-- 1 phyooos staff 402B 5 22 2017 authorized_keys -rw-r--r-- 1 phyooos staff 1.1K 6 28 14:48 config -rw------- 1 phyooos staff 3.2K 6 27 18:05 github_rsa -rw-r--r-- 1 phyooos staff 746B 6 27 18:05 github_rsa.pub -rw------- 1 phyooos staff 1.6K 5 17 2017 id_rsa -rw-r--r--@ 1 phyooos staff 402B 5 17 2017 id_rsa.pub -rw-r--r-- 1 phyooos staff 1.3K 7 5 12:33 known_hosts å…¶ä¸­ -rw------- 1 phyooos staff 3.2K 6 27 18:05 github_rsa -rw-r--r-- 1 phyooos staff 746B 6 27 18:05 github_rsa.pub å°±æ˜¯æˆ‘åˆ›å»ºç”¨æ¥ç»™githubç”¨çš„ æŸ¥çœ‹~/.ssh/config# ---- github------------------ Host github HostName github.com User git IdentityFile /Users/phyooos/.ssh/github_rsa # ----------------------------- ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„,è€Œgithubä¸Šçš„keyä¹Ÿå°±ç¡®å®æ˜¯github_rsa.pub Towerä½†æ˜¯æˆ‘çš„Towerä¸Š,ä¹Ÿæœ‰å‡ ä¸ªgithubä¸Šçš„é¡¹ç›®,å´å¯ä»¥æ­£å¸¸çš„ä¸Šä¼ , è€ŒTowerä¸Šçš„ç§é’¥æ˜¯æˆ‘æ‰‹åŠ¨é…ä¸Šå»çš„,æ‰€ä»¥é—®é¢˜åªæœ‰å¯èƒ½æ˜¯ç»ˆç«¯ä¸­æ²¡æœ‰æŒ‰ç…§æˆ‘çš„é…ç½®IdentityFile /Users/phyooos/.ssh/github_rsaæ¥å’Œgithubå»ºç«‹è¿æ¥ æˆ‘å°è¯•æŠŠid_rsa.pubå¯†é’¥åŠ å…¥åˆ°githubä¸Š. To github.com:wangzhumo/wangzhumo.github.io.git c45bbef..6b25311 HEAD -&gt; master Branch &#39;master&#39; set up to track remote branch &#39;master&#39; from &#39;git@github.com:wangzhumo/wangzhumo.github.io.git&#39;. INFO Deploy done: git ç«Ÿç„¶æˆåŠŸäº†. ç»“è®º~/.ssh/configä¸­çš„é…ç½®,è«åæ²¡æœ‰ç”Ÿæ•ˆ,æˆ‘è‡³ä»Šä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ è¿˜æ˜¯è¯´,githubåœ¨ç»ˆç«¯ä¸­ä¸Šä¼ æ—¶,åªä¼šé»˜è®¤å»æ‹¿id_rsa??? é‚£å°±å…ˆè¿™ä¹ˆç”¨å§..è¿·","categories":[{"name":"Tools","slug":"Tools","permalink":"https://www.wangzhumo.com/categories/Tools/"}],"tags":[{"name":"Github","slug":"Github","permalink":"https://www.wangzhumo.com/tags/Github/"}]},{"title":"Androidéé™æ€å†…éƒ¨ç±»ä¸åŒ¿åå†…éƒ¨ç±»å¼•èµ·çš„å†…å­˜æ³„æ¼","slug":"Android-inner-class-leak","date":"2018-07-05T04:06:51.000Z","updated":"2019-12-22T12:03:35.101Z","comments":true,"path":"2018/07/05/Android-inner-class-leak/","link":"","permalink":"https://www.wangzhumo.com/2018/07/05/Android-inner-class-leak/","excerpt":"å†…å­˜å†…å­˜æ³„æ¼ç®€å•çš„è¯´ï¼Œå½“æˆ‘ä»¬çš„å¯¹è±¡åˆ›å»ºæ—¶ï¼Œå°±å ç”¨äº†ä¸€éƒ¨åˆ†å†…å­˜ï¼Œè€Œåœ¨è¿™ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨åä¼šè¿›è¡Œå›æ”¶é”€æ¯ï¼Œ ä»¥é‡Šæ”¾æ‰å ç”¨çš„å†…å­˜ã€‚ä½†æ˜¯å¦‚æœjvmæ²¡æœ‰æˆåŠŸå›æ”¶è¿™ä¸ªå¯¹è±¡ï¼Œå°±ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚ å†…å­˜æº¢å‡ºAndroidä¸­çš„OOMï¼Œç³»ç»Ÿä¼šç»™æ¯ä¸€ä¸ªAndroidç¨‹åºåˆ†é…ä¸€å®šçš„å†…å­˜ã€‚æˆ‘çš„çš„Appå¯èƒ½ä¼šå› ä¸ºå¤§é‡çš„å†…å­˜æ³„æ¼è€Œå¯¼è‡´å†…å­˜è€—å°½ï¼Œå¼•å‘OOMå¯¼è‡´æ•´ä¸ªAppçš„å´©æºƒã€‚ å°±ç®—å†…å­˜æ²¡æœ‰è€—å°½è€Œå´©æºƒï¼Œä¹Ÿä¼šå¯¼è‡´Appå†…å­˜ä¸è¶³ã€‚æ­¤æ—¶æˆ‘ä»¬åˆ›å»ºæ–°çš„å¯¹è±¡æˆ–è€…å…¶ä»–æ–¹å¼éœ€è¦ä½¿ç”¨å†…å­˜æ—¶ï¼ŒGCå°±ä¼šä¸»åŠ¨è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä¸ºä½ çš„æ“ä½œå‡†å¤‡å¥½å†…å­˜ç©ºé—´ï¼Œæ¯æ¬¡GCéƒ½æ˜¯é˜»å¡æ“ä½œï¼Œè¿™å°±ä¼šå¯¼è‡´æˆ‘ä»¬çš„Appå¡é¡¿ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¼˜åŒ–Appå¡é¡¿æ—¶ï¼Œæœ‰ä¸€ç‚¹å°±æ˜¯è¦å…³æ³¨â€œå†…å­˜æŠ–åŠ¨â€ã€‚","text":"å†…å­˜å†…å­˜æ³„æ¼ç®€å•çš„è¯´ï¼Œå½“æˆ‘ä»¬çš„å¯¹è±¡åˆ›å»ºæ—¶ï¼Œå°±å ç”¨äº†ä¸€éƒ¨åˆ†å†…å­˜ï¼Œè€Œåœ¨è¿™ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨åä¼šè¿›è¡Œå›æ”¶é”€æ¯ï¼Œ ä»¥é‡Šæ”¾æ‰å ç”¨çš„å†…å­˜ã€‚ä½†æ˜¯å¦‚æœjvmæ²¡æœ‰æˆåŠŸå›æ”¶è¿™ä¸ªå¯¹è±¡ï¼Œå°±ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚ å†…å­˜æº¢å‡ºAndroidä¸­çš„OOMï¼Œç³»ç»Ÿä¼šç»™æ¯ä¸€ä¸ªAndroidç¨‹åºåˆ†é…ä¸€å®šçš„å†…å­˜ã€‚æˆ‘çš„çš„Appå¯èƒ½ä¼šå› ä¸ºå¤§é‡çš„å†…å­˜æ³„æ¼è€Œå¯¼è‡´å†…å­˜è€—å°½ï¼Œå¼•å‘OOMå¯¼è‡´æ•´ä¸ªAppçš„å´©æºƒã€‚ å°±ç®—å†…å­˜æ²¡æœ‰è€—å°½è€Œå´©æºƒï¼Œä¹Ÿä¼šå¯¼è‡´Appå†…å­˜ä¸è¶³ã€‚æ­¤æ—¶æˆ‘ä»¬åˆ›å»ºæ–°çš„å¯¹è±¡æˆ–è€…å…¶ä»–æ–¹å¼éœ€è¦ä½¿ç”¨å†…å­˜æ—¶ï¼ŒGCå°±ä¼šä¸»åŠ¨è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä¸ºä½ çš„æ“ä½œå‡†å¤‡å¥½å†…å­˜ç©ºé—´ï¼Œæ¯æ¬¡GCéƒ½æ˜¯é˜»å¡æ“ä½œï¼Œè¿™å°±ä¼šå¯¼è‡´æˆ‘ä»¬çš„Appå¡é¡¿ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¼˜åŒ–Appå¡é¡¿æ—¶ï¼Œæœ‰ä¸€ç‚¹å°±æ˜¯è¦å…³æ³¨â€œå†…å­˜æŠ–åŠ¨â€ã€‚ æ¡ˆä¾‹handlerçš„å†…éƒ¨ç±» public class MainActivity extends Activity { private final Handler mHandler = new Handler() { @Override public void handleMessage(Message msg) { // do something } } public void test1(){ // å»¶æ—¶60s mHandler.postDelayed(new Runnable() { @Override public void run() { //run } }, 6000); finish(); } } æˆ‘ä»¬çŸ¥é“åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºçš„Handlerä¼šè¢«å…³è”åˆ° Looperï¼ˆä¸»çº¿ç¨‹çš„ï¼‰ä¸­å»ï¼Œè€Œä¸»çº¿ç¨‹çš„Looperåœ¨åº”ç”¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å­˜åœ¨ ï¼Œæ­¤æ—¶çš„Messageä¼šæŒæœ‰Handlerå¯¹è±¡ï¼Œç”¨æ¥æœ€åå¤„ç†æ¶ˆæ¯ã€‚ ä¹Ÿå°±æ˜¯è°ƒç”¨Handler#handleMessage(Message msg) å½“æˆ‘ä»¬è°ƒç”¨test1()æ–¹æ³• å»¶æ—¶60sæ‰§è¡Œï¼ˆä½†å®é™…ä¸Šï¼Œè¿™ä¸ªmessageå·²ç»å‘é€ï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­äº†ï¼Œåªæ˜¯60såæ‰ handleMessageï¼‰ finish()æ‰è¿™MainActivity new Runnableæ˜¯ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œä¼šæŒæœ‰éšå¼çš„å¤–éƒ¨ç±»å¼•ç”¨ è¿™ä¸‹å°±å¾®å¦™äº†ï¼ŒMainActivityå·²ç»è¢«finishäº†ï¼Œä½†æ˜¯å»¶æ—¶Messageå´è¿˜å­˜åœ¨äºæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°å®ƒè¢«å¤„ç† å»¶æ—¶Message æŒæœ‰ MainActivityçš„Handler(ç”¨æ¥å¤„ç†è¿™ä¸ªæ¶ˆæ¯)ï¼Œè€Œæˆ‘ä»¬çŸ¥é“åœ¨Javaä¸­ï¼Œéé™æ€å†…éƒ¨ç±»å’ŒåŒ¿åç±»ä¼šéšå¼æŒæœ‰ä¸€ä¸ªå¤–éƒ¨ç±»çš„å¼•ç”¨ ï¼Œåœ¨è¿™é‡Œå°±æ˜¯Handleréšå¼æŒæœ‰MainActivity è¿™ä¸‹å°±å¯¼è‡´ï¼ŒMainActivity æ²¡æœ‰è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ è¿˜æœ‰ä¸ªRunnableé‚£â€¦ è§£å†³æ€è·¯ å»é™¤éšå¼å¼•ç”¨ï¼Œå¯ä»¥æŠŠéé™æ€å†…éƒ¨ç±»è½¬åŒ–æˆé™æ€çš„ æ‰‹åŠ¨ç®¡ç†å¤–éƒ¨ç±»ä¾èµ–ï¼Œå¦‚æœä¸€å®šè¦ä½¿ç”¨ï¼Œå¯ä»¥æ‰‹åŠ¨ä¼ å…¥å¤–éƒ¨ç±»ï¼ˆåƒContextè¿™æ ·çš„å®Œå…¨å¯ä»¥ä½¿ç”¨ApplicationContextæ›¿ä»£ï¼‰ æ¡ˆä¾‹å°ç»“éé™æ€çš„å†…éƒ¨ç±»ï¼Œç”±äºå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸èƒ½åŒå¤–éƒ¨ç±»ä¸€è‡´ï¼Œå®ƒçš„ç”Ÿå­˜å‘¨æœŸå·²ç»è¶…è¿‡äº†å®ƒçš„å¤–éƒ¨ç±»ã€‚ æ‰€ä»¥åœ¨å®ƒçš„å¤–éƒ¨ç±»è¢«å›æ”¶æ—¶ï¼Œè¢«å®ƒæ‰“æ–­äº†è¿™ä¸ªæ“ä½œï¼Œå¯¼è‡´å†…å­˜æ³„æ¼äº§ç”Ÿ å†…éƒ¨ç±»Javaä¸­å†…éƒ¨ç±»åˆ†ä¸ºå››ç§ é™æ€å†…éƒ¨ç±» é™æ€åŒ¿åå†…éƒ¨ç±» éé™æ€å†…éƒ¨ç±» éé™æ€å†…éƒ¨åŒ¿åç±» è¯´æ˜ æˆå‘˜å†…éƒ¨ç±» é™æ€å†…éƒ¨ç±» é™æ€æˆå‘˜ é™æ€æˆå‘˜éœ€åŒæ—¶æœ‰finalå…³é”®è¯ä¿®é¥° å¯ä»¥ é™æ€æ–¹æ³• ä¸å¯å®šä¹‰ å¯ä»¥ è®¿é—®å¤–éƒ¨ç±»éstaticå±æ€§/æ–¹æ³• å¤–éƒ¨ç±»å.this.æˆå‘˜æ–¹æ³•/å±æ€§ ä¸å¯ä»¥ å¤–éƒ¨ç±»è®¿é—®å†…éƒ¨ç±» éœ€è¦é€šè¿‡å†…éƒ¨ç±»çš„ä¸€ä¸ªå®ä¾‹æ¥è®¿é—® éœ€è¦é€šè¿‡å†…éƒ¨ç±»çš„ä¸€ä¸ªå®ä¾‹æ¥è®¿é—® åˆ›å»ºå®ä¾‹ å¤–éƒ¨ç±»å.å†…éƒ¨ç±»å å®ä¾‹å = å¤–éƒ¨ç±»å®ä¾‹å.new å†…éƒ¨ç±»æ„é€ æ–¹æ³•(å‚æ•°) å¤–éƒ¨ç±»å.å†…éƒ¨ç±»å å®ä¾‹å = new å¤–éƒ¨ç±»å.å†…éƒ¨ç±»å(å‚æ•°) ç¼–è¯‘åçš„classæ–‡ä»¶ å•ç‹¬çš„classæ–‡ä»¶(soå†…éƒ¨ç±»ä¸­çš„æ–¹æ³•å’Œå˜é‡å¯ä»¥è·Ÿçˆ¶ç±»çš„æ–¹æ³•å’Œå˜é‡åŒå)ï¼Œå¤–éƒ¨ç±»$å†…éƒ¨ç±».class å•ç‹¬çš„classæ–‡ä»¶(soå†…éƒ¨ç±»ä¸­çš„æ–¹æ³•å’Œå˜é‡å¯ä»¥è·Ÿçˆ¶ç±»çš„æ–¹æ³•å’Œå˜é‡åŒå)ï¼Œå¤–éƒ¨ç±»$å†…éƒ¨ç±».class å…¶ä»– ä¸å¤–éƒ¨ç±»å¹³çº§çš„ç±»ç»§æ‰¿å†…éƒ¨ç±»æ—¶ï¼Œå…¶æ„é€ æ–¹æ³•ä¸­éœ€è¦ä¼ å…¥çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ã€‚ä¸”åœ¨æ„é€ æ–¹æ³•çš„ç¬¬ä¸€å¥è°ƒç”¨â€œå¤–éƒ¨ç±»å®ä¾‹å.super(å†…éƒ¨ç±»å‚æ•°)â€ æ—  è¯´æ˜ æˆå‘˜å†…éƒ¨ç±» åŒ¿åå†…éƒ¨ç±» é™æ€æˆå‘˜ é™æ€æˆå‘˜éœ€åŒæ—¶æœ‰finalå…³é”®è¯ä¿®é¥° ä¸å¯å®šä¹‰ é™æ€æ–¹æ³• ä¸å¯å®šä¹‰ ä¸å¯å®šä¹‰ è®¿é—®å¤–éƒ¨ç±»éstaticå±æ€§/æ–¹æ³• å¤–éƒ¨ç±»å.this.æˆå‘˜æ–¹æ³•/å±æ€§ å¤–éƒ¨ç±»å.this.æˆå‘˜æ–¹æ³•/å±æ€§ å¤–éƒ¨ç±»è®¿é—®å†…éƒ¨ç±» éœ€è¦é€šè¿‡å†…éƒ¨ç±»çš„ä¸€ä¸ªå®ä¾‹æ¥è®¿é—® éœ€è¦é€šè¿‡å†…éƒ¨ç±»çš„ä¸€ä¸ªå®ä¾‹æ¥è®¿é—® åˆ›å»ºå®ä¾‹ å¤–éƒ¨ç±»å.å†…éƒ¨ç±»å å®ä¾‹å = å¤–éƒ¨ç±»å®ä¾‹å.new å†…éƒ¨ç±»æ„é€ æ–¹æ³•(å‚æ•°) å¦‚ä¸Šï¼šçˆ¶ç±» å®ä¾‹å = new çˆ¶ç±»ï¼ˆï¼‰{} ç¼–è¯‘åçš„classæ–‡ä»¶ å•ç‹¬çš„classæ–‡ä»¶(soå†…éƒ¨ç±»ä¸­çš„æ–¹æ³•å’Œå˜é‡å¯ä»¥è·Ÿçˆ¶ç±»çš„æ–¹æ³•å’Œå˜é‡åŒå)ï¼Œå¤–éƒ¨ç±»$å†…éƒ¨ç±».class å•ç‹¬çš„classæ–‡ä»¶ï¼Œä½¿ç”¨ç±»$æ•°å­—.class å…¶ä»– ä¸å¤–éƒ¨ç±»å¹³çº§çš„ç±»ç»§æ‰¿å†…éƒ¨ç±»æ—¶ï¼Œå…¶æ„é€ æ–¹æ³•ä¸­éœ€è¦ä¼ å…¥çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ã€‚ä¸”åœ¨æ„é€ æ–¹æ³•çš„ç¬¬ä¸€å¥è°ƒç”¨â€œå¤–éƒ¨ç±»å®ä¾‹å.super(å†…éƒ¨ç±»å‚æ•°)â€ æ—  https://www.cnblogs.com/dorothychai/p/6007709.html å¯ç¤º éé™æ€å†…éƒ¨ç±» æ”¹ä¸º é™æ€éåŒ¿åå†…éƒ¨ç±» ä½¿ç”¨å¼±å¼•ç”¨ åœ¨é€‚å½“çš„æ—¶æœºæ‰‹åŠ¨é”€æ¯ï¼Œåœ¨onDestoryä¸­æ‰‹åŠ¨é”€æ¯ å…»æˆè‰¯å¥½çš„ä¹ æƒ¯ï¼ŒContextã€Handlerã€Timerã€Thread ã€å¹¿æ’­ ã€ IO ç­‰éƒ½è¦æ³¨æ„é”€æ¯","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"Git Submodule å­æ¨¡å—çš„ä½¿ç”¨","slug":"Git-Submodule","date":"2018-07-02T08:41:23.000Z","updated":"2019-12-22T12:10:15.405Z","comments":true,"path":"2018/07/02/Git-Submodule/","link":"","permalink":"https://www.wangzhumo.com/2018/07/02/Git-Submodule/","excerpt":"å‰è¨€Gitæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ,å¤§å®¶å…¬å¸å¯èƒ½éƒ½æ˜¯ä½¿ç”¨çš„Gitæ¥è¿›è¡Œç‰ˆæœ¬æ§åˆ¶. å¯¹äºæˆ‘ä¸ªäºº,æœ¬åœ°é¡¹ç›®ä¹Ÿå–œæ¬¢ä½¿ç”¨git,ä¸‡ä¸€å“ªå¤©æƒ³å›é€€ä¸€ä¸‹,æ²¡æœ‰gitå¯å°±çœŸè´¹åŠ²äº†. å¯¹äºgitçš„å¸¸è§„æ“ä½œä¸ç”¨å¤šè¯´,ä»Šå¤©è´´ä¸€ä¸ªsubmoduleçš„çœŸå®ä½¿ç”¨è¿‡ç¨‹","text":"å‰è¨€Gitæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ,å¤§å®¶å…¬å¸å¯èƒ½éƒ½æ˜¯ä½¿ç”¨çš„Gitæ¥è¿›è¡Œç‰ˆæœ¬æ§åˆ¶. å¯¹äºæˆ‘ä¸ªäºº,æœ¬åœ°é¡¹ç›®ä¹Ÿå–œæ¬¢ä½¿ç”¨git,ä¸‡ä¸€å“ªå¤©æƒ³å›é€€ä¸€ä¸‹,æ²¡æœ‰gitå¯å°±çœŸè´¹åŠ²äº†. å¯¹äºgitçš„å¸¸è§„æ“ä½œä¸ç”¨å¤šè¯´,ä»Šå¤©è´´ä¸€ä¸ªsubmoduleçš„çœŸå®ä½¿ç”¨è¿‡ç¨‹ é¡¹ç›®ç»“æ„å¦‚ä¸Š. ä¸ºäº†æ–¹ä¾¿æˆ‘è‡ªå·±ç©,æˆ‘å¼€äº†ä¸€ä¸ªplaygroundçš„é¡¹ç›® playground . â”œâ”€â”€ app #ä¸»é¡¹ç›® â”œâ”€â”€ lib_common #å­é¡¹ç›®,å…¶ä¸­ä¸»è¦æä¾›ä¸‰æ–¹çš„ä¾èµ–,ä»¥åŠæ•´ä¸ªé¡¹ç›®çš„å…¬å…±ä»£ç éƒ¨åˆ† #å› ä¸ºè¿™ä¸ªé¡¹ç›®éœ€è¦åŠæ—¶æ›´æ–°,æ–¹ä¾¿æ¯ä¸ªäººä½¿ç”¨,æ‰€ä»¥æ˜¯ä¸€ä¸ªsubmoduleæ¥ç®¡ç† â”œâ”€â”€ lib_player â”œâ”€â”€ module_views #ä»Šå¤©è¦æ¼”ç¤ºçš„å­æ¨¡å— å…¶å®Submodule å’ŒAndroidçš„ç»„ä»¶åŒ–æ›´é…å“¦,å±äºå¼ºå¼ºè”åˆ åˆ›å»ºmodule_viewsæ¨¡å—å»ºç«‹moduleåœ¨æˆ‘ä»¬playgroundçš„é¡¹ç›®ä¸Š,åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—,æ€ä¹ˆæ“ä½œå°±ä¸è¯´äº† åœ¨module_viewsä¸­åˆå§‹åŒ–Git æ³¨æ„,å½“module_viewsè¿™ä¸ªæ¨¡å—åˆ›å»ºæ—¶,ä¸€å®šä¸è¦æ‰‹å¿«æŠŠè¿™ä¸ªæ¨¡å—æ·»åŠ åˆ°playgroundæ•´ä¸ªé¡¹ç›®çš„ç‰ˆæœ¬æ§åˆ¶ä¸­ è®°å¾—å¿½ç•¥module_viewsæ•´ä¸ªmodule ç›´æ¥è´´æ“ä½œäº† # phyooos @ wangzhumo in ~ [16:38:01] $ cd ~/workspace/playground # phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:58:48] $ ll | grep &#39;module_views&#39; drwxr-xr-x 11 phyooos staff 352B 7 2 16:31 module_views # phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:59:03] $ cd module_views # phyooos @ wangzhumo in ~/workspace/playground/module_views [16:59:19] $ git init Reinitialized existing Git repository in /Users/phyooos/workspace/playground/module_views/.git/ å› ä¸ºæˆ‘çš„module_viewså·²ç»åˆ›å»ºgitä»“åº“äº†,æ‰€ä»¥æœ€åä¸€æ­¥æç¤º Reinitialized existing Git repository å…³è”è¿œç¨‹ä»“åº“è¿™ä¸€æ­¥éšæ„,æˆ‘æœ¬äººæ˜¯åœ¨githubä¸Šåˆ›å»ºäº†ä¸€ä¸ªåä¸ºmodule_viewsçš„åº“ æ‹¿åˆ°è¿œç¨‹ä»“åº“åœ°å€ git@github.com:wangzhumo/module_views.git # phyooos @ wangzhumo in ~/workspace/playground/module_views [16:59:30] $ git remote add origin git@github.com:wangzhumo/module_views.git # phyooos @ wangzhumo in ~/workspace/playground/module_views on git:master o [16:59:30] $ git push Everything up-to-date # phyooos @ wangzhumo in ~/workspace/playground/module_views on git:master o [17:06:51] $ git status On branch master Your branch is up to date with &#39;origin/master&#39;. nothing to commit, working tree clean æ·»åŠ è¿œç¨‹ä»“åº“,å¹¶push,æŠŠæœ¬åœ°ä»£ç æäº¤åˆ°githubä¸Šå»,å› ä¸ºæˆ‘è‡ªå·±å·²ç»æäº¤è¿‡äº†,æ‰€ä»¥å¯ä»¥çœ‹åˆ° Everything up-to-date æ·»åŠ å­æ¨¡å—åˆ°playgroundä¸­è´´æ“ä½œ # phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:38:12] $ git submodule add git@github.com:wangzhumo/module_views.git ./module_views The following path is ignored by one of your .gitignore files: module_views Use -f if you really want to add it. # phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:38:59] C:1 $ git submodule add -f git@github.com:wangzhumo/module_views.git ./module_views Adding existing repo at &#39;module_views&#39; to the index # phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:39:21] $ git submodule 1616423ab118e2154bcf018c825f6ed3a57cf59b lib_common (heads/master) 55ae43eb327207a456624c69e3c01868f8cf43e3 module_views (heads/master) # phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:39:48] $ git submodule foreach git pull Entering &#39;lib_common&#39; Already up to date. Entering &#39;module_views&#39; Already up to date. ä¸‹é¢è§£é‡Šæ¯ä¸€æ¡å‘½ä»¤ git submodule add git@github.com:wangzhumo/module_views.git ./module_views æ·»åŠ å­æ¨¡å— git submodule add &lt;repository&gt; &lt;path&gt; æ·»åŠ å­æ¨¡å— æç¤ºå¦‚ä¸‹: The following path is ignored by one of your .gitignore files: module_views Use -f if you really want to add it. è¯´æˆ‘å·²ç»æŠŠmodule_viewsæ·»åŠ åˆ°å¿½ç•¥æ–‡ä»¶ä¸­äº†,å¦‚æœç¡®å®æƒ³è¿™æ ·æ“ä½œ,åŠ ä¸Š-få¼ºåˆ¶æ“ä½œ git submodule add -f git@github.com:wangzhumo/module_views.git ./module_views å¯ä»¥çœ‹åˆ°æç¤º,æˆ‘å·²ç»æˆåŠŸçš„æŠŠmodule_viewsä½œä¸ºå­é¡¹ç›®æ·»åŠ åˆ°playgroundä¸­äº† git submodule ä¸€å…±çœ‹åˆ°ä¸¤ä¸ªå­æ¨¡å—,ä¸€ä¸ªæ˜¯åˆšæ·»åŠ çš„module_views,ä¸€ä¸ªæ˜¯æˆ‘ä¹‹å‰æ·»åŠ çš„ git submodule foreach git pull æ‹‰å–æœ€æ–°ä»£ç  å…¶ä»–submoduleæ“ä½œæ–‡æ¡£","categories":[{"name":"Tools","slug":"Tools","permalink":"https://www.wangzhumo.com/categories/Tools/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://www.wangzhumo.com/tags/Git/"}]},{"title":"ServiceLoader ä¸ è´£ä»»é“¾è®¾è®¡æ¨¡å¼","slug":"serviceloader-zerenlian","date":"2018-06-26T10:22:46.000Z","updated":"2019-12-22T12:06:37.946Z","comments":true,"path":"2018/06/26/serviceloader-zerenlian/","link":"","permalink":"https://www.wangzhumo.com/2018/06/26/serviceloader-zerenlian/","excerpt":"å‰å› æœ€è¿‘åœ¨åšäººè„¸è¯†åˆ«çš„ä¸€äº›ä¸œè¥¿ ä¸»è¦æ˜¯ä½¿ç”¨ç™¾åº¦çš„SDKæ¥å®Œæˆé‡‡é›†, è¯†åˆ«. è¿™ä¸ªåŠŸèƒ½æ˜¯ä½¿ç”¨ç™¾åº¦äº‘çš„Apiæ¥å¯¹äººè„¸è¿›è¡Œåˆ†æ,æ‹¿åˆ°å¹´é¾„ é¢œå€¼ ç­‰ç­‰ä¿¡æ¯","text":"å‰å› æœ€è¿‘åœ¨åšäººè„¸è¯†åˆ«çš„ä¸€äº›ä¸œè¥¿ ä¸»è¦æ˜¯ä½¿ç”¨ç™¾åº¦çš„SDKæ¥å®Œæˆé‡‡é›†, è¯†åˆ«. è¿™ä¸ªåŠŸèƒ½æ˜¯ä½¿ç”¨ç™¾åº¦äº‘çš„Apiæ¥å¯¹äººè„¸è¿›è¡Œåˆ†æ,æ‹¿åˆ°å¹´é¾„ é¢œå€¼ ç­‰ç­‰ä¿¡æ¯ ç¬¬ä¸€ç‰ˆè®¾è®¡ç¨¿: é‚£æˆ‘å°±ç›´æ¥æŠŠè¯·æ±‚åˆ°çš„æ•°æ®å±•ç¤ºäº†ä¸€ä¸‹,ç„¶è€Œ ç¬¬äºŒç‰ˆè®¾è®¡ç¨¿: è¿™ä¸€ç‰ˆå°±æ˜¯éœ€è¦æŠŠæ‹¿åˆ°çš„æ•°å€¼æŒ‰ç…§åŒºé—´æ¥å±•ç¤ºæˆæ–‡å­—æè¿° é‚£ä¹ˆ,åº”è¯¥å°±æ˜¯å„ç§switch if else â€¦. æœ¬æ¥ä¹Ÿæ˜¯åšDemo,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é«˜ç‚¹å…¶ä»–çš„ä¸œè¥¿,äºæ˜¯æˆ‘å°±æƒ³èµ·äº†è´£ä»»é“¾æ¨¡å¼,å‹‰å¼ºå¯ä»¥åšåšä¹ˆ å®ç°è´£ä»»é“¾å®šä¹‰æŠ½è±¡ç±»com.baidu.aip.fl.func.service.HandlerFace.java æ¥å£ public abstract class HandlerFace { private HandlerFace nextHandler; //æ¥æ”¶ä¸€ä¸ªå®ä½“ç±» public abstract ResultBean process(ResultBean bean); //è¿”å›ä¸‹ä¸€ä¸ªå¤„ç†ç±» public HandlerFace nextHandler(){ return nextHandler; } //è®¾ç½®ä¸‹ä¸€ä¸ªå¤„ç†ç±» public void setHandler(HandlerFace handler){ this.nextHandler = handler; } } å…·ä½“å®ç°com.baidu.aip.fl.func.service.AgeHandlerFace.java å®ç°ç±»,å¤„ç†å¹´é¾„ä¿¡æ¯ public class AgeHandlerFace extends HandlerFace { @Override public ResultBean process(ResultBean bean) { //1.å¤„ç†è‡ªå·±çš„äº‹æƒ… if (bean != null &amp;&amp; bean.getIntAge() == 0 ){ bean.setResultAge(&quot;-&quot;); }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 5){ bean.setResultAge(&quot;å°æœ‹å‹&quot;); }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 10){ bean.setResultAge(&quot;ä¸­ç­‰æœ‹å‹&quot;); }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 15){ bean.setResultAge(&quot;å¤§æœ‹å‹&quot;); }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 20){ bean.setResultAge(&quot;æˆå¹´äºº&quot;); }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 40){ bean.setResultAge(&quot;ä¸­å¹´äºº&quot;); }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 60){ bean.setResultAge(&quot;è€å¹´äºº&quot;); }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 100){ bean.setResultAge(&quot;å¹´çºªå¥½å¤§&quot;); } //2.æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªäººæ¥å¤„ç† if (nextHandler() != null){ //2.1.å¦‚æœæœ‰ä¸‹ä¸€ä¸ªå¤„ç†ç±»,åˆ™æŠŠä¿¡æ¯äº¤ç»™ä»–ç»§ç»­å¤„ç† return nextHandler().process(bean); } //3.æ²¡æœ‰ä¸‹ä¸€ä¸ªå¤„ç†ç›´æ¥è¿”å› return bean; } } AgeHandlerFaceç±»åªå¤„ç†å¹´çºªç›¸å…³çš„ä¸œè¥¿ com.baidu.aip.fl.func.service.BeautyHandlerFace.java com.baidu.aip.fl.func.service.GenderHandlerFace.java åŒæ ·å®ç°HandlerFace,åˆ†åˆ«å¤„ç†é¢œå€¼å’Œæ€§åˆ« ServiceLoaderä¸Šé¢çš„è´£ä»»é“¾å…¶å®å·²ç»å¯ä»¥ä½¿ç”¨,ä½†æ˜¯éœ€è¦æ‰‹åŠ¨æ¥åˆå§‹åŒ–æ¯ä¸ªå…·ä½“å®ç°ç±», å¹¶ä¸”ä¸€ä¸ªä¸€ä¸ªè®¾ç½® nextHandler ,æœ€åè°ƒç”¨å¤„ç† public class RealProcessFace{ //ä¿å­˜HandlerFaceçš„æ¯ä¸€ä¸ªå®ç°ç±» private static ArrayList&lt;HandlerFace&gt; arraylist; static { arraylist = new ArrayList(); //é€šè¿‡ServiceLoaderæ¥åŠ è½½æ‰€æœ‰HandlerFaceçš„å®ç°ç±» ServiceLoader&lt;HandlerFace&gt; processors = ServiceLoader.load(HandlerFace.class); Iterator iterator = processors.iterator(); while (iterator.hasNext()) { //iterator.next() è¿™é‡Œå…·ä½“å®ç°ç±»æ‰çœŸæ­£çš„åˆå§‹åŒ–äº† arraylist.add((HandlerFace) iterator.next()); } } /** * è·å–ç»„åˆçŸ­è¯­ * @param task äººè„¸ä¿¡æ¯ * @return ç»„åˆçŸ­è¯­ */ public static String process(ResultBean task) { for (int i = 0; i &lt; arraylist.size() - 1 ; i++) { //ä¾æ¬¡è®¾ç½®setHandler //å› ä¸ºæˆ‘å¹¶ä¸éœ€è¦ä»–ä»¬ä¾æ¬¡å¤„ç†,æ‰€ä»¥æˆ‘å¹¶ä¸å…³ç³»ä»–ä»¬å¤„ç†çš„é¡ºåº //å¦‚æœæ˜¯éœ€è¦é¡ºåºæ‰§è¡Œçš„è¯,å»ºè®®è¿˜æ˜¯æ‰‹åŠ¨å¤„ç† arraylist.get(i).setHandler(arraylist.get(i+1)); } //è°ƒç”¨ç¬¬ä¸€ä¸ªå¤„ç†ç±»,å°±ä¼šä¾æ¬¡è°ƒç”¨åé¢çš„å¤„ç†ç±» ResultBean resultBean = arraylist.get(0).process(task); //è¿”å›å¤„ç†ç»“æœ return resultBean.format(); } } ä½¿ç”¨æ–¹æ³• 1.åˆ›å»ºä¸€ä¸ªbaseç±»,å°±æ˜¯æˆ‘ä¸Šé¢å†™è¿‡çš„,å¯ä»¥æ˜¯æ¥å£å’ŒæŠ½è±¡ç±» com.baidu.aip.fl.func.service.HandlerFace 2.ä¸€ä¸ªæˆ–å¤šä¸ªå®ç°ç±» com.baidu.aip.fl.func.service.AgeHandlerFace.java com.baidu.aip.fl.func.service.BeautyHandlerFace.java com.baidu.aip.fl.func.service.GenderHandlerFace.java è¿™é‡Œä¸€å…±æ˜¯3ä¸ª 3.å®šä¹‰resources/META-INF/ â€¦. æ–‡ä»¶ è¯¥æ–‡ä»¶æ— æ‹“å±•å æ–‡ä»¶åå°±æ˜¯ baseç±» æˆ–è€…æ¥å£ çš„å…¨è·¯å¾„( åŒ…å + Filename ) æ–‡ä»¶ä¸­æ¯ä¸€è¡Œå†™ä¸€ä¸ªå®ç°ç±»çš„å…¨è·¯å¾„å( åŒ…å + Filename ) src/main/resources/META-INF/services/com.baidu.aip.fl.func.service.HandlerFace com.baidu.aip.fl.func.service.GenderHandlerFace com.baidu.aip.fl.func.service.AgeHandlerFace com.baidu.aip.fl.func.service.BeautyHandlerFace 4.è·å–æ‰€æœ‰å®ç°ç±» ServiceLoader&lt;HandlerFace&gt; processors = ServiceLoader.load(HandlerFace.class); //æ³¨æ„æ­¤æ—¶å®ç°ç±»éƒ½æ²¡æœ‰å®ä¾‹åŒ– Iterator iterator = processors.iterator(); while (iterator.hasNext()) { //iterator.next() è¿™é‡Œå…·ä½“å®ç°ç±»æ‰çœŸæ­£çš„åˆå§‹åŒ–äº† arraylist.add((HandlerFace) iterator.next()); } è¿™æ ·çš„æ‡’åŠ è½½è¿‡ç¨‹æ˜¯ç”±ServiceLoaderå®ç°çš„ æ€»ç»“è´£ä»»é“¾è¿™æ ·çš„å½¢å¼,ä¸ºåæœŸçš„æ‰©å±•æä¾›äº†å¾ˆå¤§çš„ä¾¿åˆ© AgeHandlerFace ä¸­,æˆ‘å¯ä»¥åˆ†æ›´ç»†çš„ç²’åº¦,ä¹Ÿå¯ä»¥åˆå¹¶. eg: 50 ä»¥ä¸‹éƒ½æ˜¯å¹´è½»äºº 100 - 50 æ˜¯è€å¹´äºº è´£ä»»é“¾è™½ç„¶Androidç«¯æœ€æ˜¾è‘—çš„ç®—æ˜¯ äº‹ä»¶åˆ†å‘æœºåˆ¶ ,å¾ˆå¤šæ¡†æ¶ä¸­ä¹Ÿéƒ½æœ‰ä½¿ç”¨,filterè¿™æ ·çš„ä¸œè¥¿ ServiceLoaderè¿™ä¸ªä¸œè¥¿,å¾ˆå¼ºå¤§ åœ¨æ’ä»¶åŒ–,ä»¥åŠ æœåŠ¡æä¾›ç­‰æ–¹é¢éƒ½æœ‰åº”ç”¨","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://www.wangzhumo.com/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"Androidè‡ªå®šä¹‰ä¸€ä¸ªé®ç½©å¼•å¯¼å±‚","slug":"Android-Shade","date":"2018-05-21T08:53:08.000Z","updated":"2019-12-22T12:03:49.815Z","comments":true,"path":"2018/05/21/Android-Shade/","link":"","permalink":"https://www.wangzhumo.com/2018/05/21/Android-Shade/","excerpt":"åˆ†æéœ€æ±‚é«˜äº®æ˜¾ç¤ºæŒ‡å®šçš„æ§ä»¶(1ä¸ªæˆ–è€…å¤šä¸ª) åªæœ‰ä¸€ä¸ªé«˜äº®æ§ä»¶,åˆ™ç›´æ¥ç»˜åˆ¶å³å¯ å¤šä¸ªé«˜äº®æ§ä»¶,åˆ™åˆ†ä¸¤ç§æ•ˆæœå±•ç¤º é¡ºåºå±•ç¤ºæ¯ä¸€ä¸ªæ§ä»¶ å±•ç¤ºæ‰€æœ‰æ§ä»¶ é«˜äº®éƒ¨åˆ†çš„å½¢çŠ¶ æ–¹å½¢ åœ†å½¢","text":"åˆ†æéœ€æ±‚é«˜äº®æ˜¾ç¤ºæŒ‡å®šçš„æ§ä»¶(1ä¸ªæˆ–è€…å¤šä¸ª) åªæœ‰ä¸€ä¸ªé«˜äº®æ§ä»¶,åˆ™ç›´æ¥ç»˜åˆ¶å³å¯ å¤šä¸ªé«˜äº®æ§ä»¶,åˆ™åˆ†ä¸¤ç§æ•ˆæœå±•ç¤º é¡ºåºå±•ç¤ºæ¯ä¸€ä¸ªæ§ä»¶ å±•ç¤ºæ‰€æœ‰æ§ä»¶ é«˜äº®éƒ¨åˆ†çš„å½¢çŠ¶ æ–¹å½¢ åœ†å½¢ å±•ç¤ºä¸æ¶ˆå¤± è‡ªåŠ¨å±•ç¤º,è‡ªåŠ¨æ¶ˆå¤± ç‚¹å‡»æ¶ˆå¤± ç‚¹å‡»æŒ‡å®šéƒ¨åˆ†æ¶ˆå¤± å®ç°æ–¹å¼é®ç½©å±‚ ç›´æ¥åœ¨æœ¬æ¥çš„é¡µé¢æ˜¯æ·»åŠ ,ä¸ç”¨æ—¶æ¶ˆå¤± ä½¿ç”¨DecorViewçš„æ–¹å¼,æ·»åŠ viewå³å¯ ä½¿ç”¨é€æ˜Activityè¦†ç›– é€‰æ‹©ç¬¬äºŒç§æ–¹å¼æ¥å®ç° ç¬¬ä¸€ç§æ–¹ä¾¿ä½†æ˜¯è€—æ—¶è€—åŠ›,å¹¶ä¸”ä¸èƒ½é€šç”¨ ç¬¬äºŒç§æ˜¯å¤§å®¶éƒ½è®¤å¯çš„ä¸€ç§æ–¹å¼,è€Œä¸”æ”¯æŒé…ç½® ç¬¬ä¸‰ç§,å¯¹åŸç•Œé¢ç”Ÿå‘½å‘¨æœŸé€ æˆå½±å“,ä¸å¤ªå¥½ é«˜äº®çš„å®ç°PorterDuffXfermode :: PorterDuff.Mode.XOR) ä»£ç è®¾è®¡ mask layer View ç”¨æ¥å®ç°é®ç½©å±‚ é«˜äº®æ˜¾ç¤ºç»˜åˆ¶\u0010 æŒ‡ç¤ºè¯­ä½ç½® mask layer Manager ç”¨æ¥ç®¡ç† é®ç½©å±‚ addView Show / hide DecorView æ“ä½œ å…¶ä»–é…ç½®ä¿¡æ¯ mask bean ç”¨æ¥å­˜æ”¾éœ€è¦é«˜äº®çš„Viewä¿¡æ¯(é«˜åº¦,å®½åº¦..) å®ç°mask: MaskGuideView é®ç½©å±‚å®¹å™¨ MaskLayout é«˜äº®æ§ä»¶ä¸æŒ‡ç¤ºè¯­çš„ä½ç½®,ä»¥åŠæ’åˆ—å±•ç¤º MaskManager åŠ è½½ç®¡ç†æ•´ä¸ªé®ç½©å±‚ MaskType é«˜äº®æ§ä»¶çš„å½¢çŠ¶, åœ† æ–¹ TargetInfo é«˜äº®æ§ä»¶çš„ä½ç½®ä¿¡æ¯ TargetInfo.java /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/5/21 ä¸‹åˆ7:20 * * é«˜äº®åŒºåŸŸä¿¡æ¯ */ public class TargetInfo { /* * é«˜äº®åŒºåŸŸèµ·å§‹Xåæ ‡ */ public int startX; /* * é«˜äº®åŒºåŸŸèµ·å§‹Yåæ ‡ */ public int startY; /* * é«˜äº®åŒºåŸŸå®½åº¦ */ public int width; /* * é«˜äº®åŒºåŸŸé«˜åº¦ */ public int height; /* * åç§»é‡ */ public int offset = 10; /** * è·å–åŠå¾„ */ public int getRadius() { return Math.max(width, height) / 2; } } MaskType.java /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/5/21 ä¸‹åˆ7:18 */ public enum MaskType { Rect,Circle } /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/5/21 ä¸‹åˆ11:35 * * è´Ÿè´£ç®¡ç†,å‡†å¤‡,æ“ä½œMaskGuideView */ public class MaskManager { //å±æ€§ private static final String TAG = &quot;MaskManager&quot;; private final ViewGroup mRootView; private final MaskGuideView mMaskGuideView; private final Context mContext; private List&lt;TargetInfo&gt; mTargetInfoList; private List&lt;View&gt; mTargetViewList; private List&lt;MaskLayout&gt; mMaskLayoutList; private MaskType mMaskType; private boolean isShowAll; private int mPadding; /** * è®¡ç®—targetInfo * * @param targetView view * @return TargetInfo */ private TargetInfo generateTargetInfo(View targetView) { int[] location = new int[2]; //æˆ‘ä»¬éœ€è¦çš„æ˜¯,è¿™ä¸ªtargetViewåœ¨æ•´ä¸ªå±å¹•ä¸Šçš„ä½ç½® targetView.getLocationOnScreen(location); TargetInfo targetInfo = new TargetInfo(); //è®¡ç®—startX width ... switch (mMaskType) { case Rect: targetInfo.startX = location[0] - mPadding; targetInfo.startY = location[1] - mPadding; targetInfo.width = targetView.getWidth() + 2 * mPadding; targetInfo.height = targetView.getHeight() + 2 * mPadding; break; case Circle: int diameter = Math.max(targetView.getWidth() + 2 * mPadding, targetView.getHeight() + 2 * mPadding); targetInfo.startX = location[0] - mPadding; targetInfo.startY = location[1] - mPadding - (diameter / 2 - targetView.getHeight() / 2 - mPadding); targetInfo.width = diameter; targetInfo.height = diameter; break; } Log.e(TAG, &quot;generateTargetInfo: &quot; + targetInfo.toString() ); return targetInfo; } /* * builderæ¨¡å¼ */ public static class Builder { private ViewGroup mRootView; private MaskGuideView mMaskGuideView; private Context mContext; private List&lt;TargetInfo&gt; mTargetInfoList; private List&lt;MaskLayout&gt; mMaskLayoutList; private List&lt;View&gt; mTargetViewList; private MaskType mMaskType = MaskType.Circle; private int mPadding = 0; private int mGravity = Gravity.TOP; private boolean isShowAll; ...çœç•¥ public MaskManager build() { this.mMaskGuideView.setOnClickListener(this.mMaskGuideView); return new MaskManager(this); } } } é¢,ä»£ç ä¼ gitå¥½äº†","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"View","slug":"View","permalink":"https://www.wangzhumo.com/tags/View/"}]},{"title":"Android Binderæœºåˆ¶(ä¸€)","slug":"Android-Binder-1","date":"2018-05-11T05:56:25.000Z","updated":"2019-12-22T12:13:09.468Z","comments":true,"path":"2018/05/11/Android-Binder-1/","link":"","permalink":"https://www.wangzhumo.com/2018/05/11/Android-Binder-1/","excerpt":"ServiceManageré¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸‹ServiceManager. ServiceManagerçš„åŠŸèƒ½ä¸»è¦å°±æ˜¯æ³¨å†Œ,æŸ¥è¯¢æœåŠ¡,ä½œä¸ºä¸€ä¸ªå¤§ç®¡å®¶çš„è§’è‰²å‡ºç°.","text":"ServiceManageré¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸‹ServiceManager. ServiceManagerçš„åŠŸèƒ½ä¸»è¦å°±æ˜¯æ³¨å†Œ,æŸ¥è¯¢æœåŠ¡,ä½œä¸ºä¸€ä¸ªå¤§ç®¡å®¶çš„è§’è‰²å‡ºç°. æ³¨å†ŒæœåŠ¡ï¼šè®°å½•æœåŠ¡åå’Œä¿¡æ¯ï¼Œæ”¾åˆ°æœåŠ¡åˆ—è¡¨ æŸ¥è¯¢æœåŠ¡ï¼šæ ¹æ®æœåŠ¡åæŸ¥è¯¢ç›¸åº”çš„çš„ä¿¡æ¯ ServiceManageræ˜¯æœ‰æƒé™æ§åˆ¶çš„ï¼Œåªæœ‰å…·æœ‰ç›¸åº”æƒé™çš„è¿›ç¨‹æ‰èƒ½æ³¨å†Œ,æŸ¥è¯¢æœåŠ¡ http://gityuan.com/2015/11/08/binder-get-sm/ Linuxå†…å­˜å†…æ ¸ç©ºé—´ä¸ºä»€ä¹ˆè¿›ç¨‹é—´ä¸å¯ä»¥ç›´æ¥é€šè®¯é‚£? å› ä¸ºæ¯ä¸ªè¿›ç¨‹çš„å†…å­˜ç©ºé—´éƒ½æ˜¯éš”ç¦»èµ·æ¥çš„,ä¸å¯èƒ½éšæ„å»è®¿é—®å…¶ä»–è¿›ç¨‹çš„å†…å­˜. åœ¨32ä½ç³»ç»Ÿä¸­,å¯»å€ç©ºé—´æœ€å¤§ä¸º4G,é‚£ä¹ˆè¿™4Gå†…å­˜,ä¸€èˆ¬å°†1Gåˆ†é…ç»™å†…æ ¸ç©ºé—´,3Gç”¨æˆ·ç©ºé—´,Linuxå†…æ ¸ç”±ç³»ç»Ÿå†…çš„æ‰€æœ‰è¿›ç¨‹å…±äº«. è¿™ä¹ˆä¸€æ¥,æˆ‘ä»¬å°±å¯ä»¥åœ¨å†…æ ¸ç©ºé—´ä¸ºæ‰€æ¬²ä¸ºäº†,ä¸,å¹¶ä¸èƒ½.ç”¨æˆ·è¿›ç¨‹ä¸èƒ½ç›´æ¥æ“ä½œå†…æ ¸. Androidæ˜¯åœ¨Linuxçš„å†…æ ¸ä¸Šè·‘çš„,é‚£ä¹ˆä¸ºä»€ä¹ˆAndroidè¦è‡ªå·±åšä¸€ä¸ªBinderæ¥å®ç°è¿›ç¨‹é—´çš„é€šè®¯é‚£? æˆ‘ä»¬éƒ½çŸ¥é“Linuxä¸ŠSocket/ç®¡é“/æ¶ˆæ¯é˜Ÿåˆ—éƒ½å¯ä»¥åšåˆ°è¿›ç¨‹é—´çš„é€šè®¯,ä½†æ˜¯é€šè¿‡è¿™äº›éƒ½éœ€è¦2æ¬¡å†…å­˜æ‹·è´, è€ŒBinderåªéœ€è¦ä¸€æ¬¡å°±å¯ä»¥å®Œæˆ,å¤§å¤§çš„æé«˜æ•ˆç‡ BINDER_MMAPmmapå¯ä»¥å°†ä¸€ä¸ªæ–‡ä»¶æˆ–è€…å…¶å®ƒå¯¹è±¡æ˜ å°„è¿›å†…å­˜ åœ¨Binderä¸­,é€šè¿‡åœ¨ç”¨æˆ·ç©ºé—´(å½“å‰è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´)åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿåœ°å€ç©ºé—´,å¹¶åœ¨å†…æ ¸ç©ºé—´åˆ›å»ºç›¸åŒå¤§å°çš„è™šæ‹Ÿåœ°å€ç©ºé—´. æ¥ç€ç”³è¯·ä¸€å—ç‰©ç†å†…å­˜,å°†ç‰©ç†å†…å­˜æ˜ å°„åˆ°å†…æ ¸è™šæ‹Ÿåœ°å€ç©ºé—´å’Œç”¨æˆ·è™šæ‹Ÿå†…å­˜ç©ºé—´,è¿™æ ·å°±å®ç°äº†ç”¨æˆ·æ§ä»¶å’Œå†…æ ¸ç©ºé—´çš„åŒæ­¥. å¤§æ¦‚æµç¨‹ copy_from_user é¦–å…ˆæ˜¯è¦å‘å‡ºæ¶ˆæ¯çš„,é‚£ä¹ˆå…ˆä»ç”¨æˆ·æ§ä»¶from æ‹·è´æ•°æ® binder_thread_write ç¬¬äºŒæ­¥å°±æ˜¯æŠŠåˆšæ‰æ‹·è´çš„æ•°æ®å†™å…¥åˆ°å†…æ ¸ç©ºé—´ binder_thread_read ç¬¬ä¸‰æ­¥å†æ¬¡è¯»å–åˆšæ‰ä»ç”¨æˆ·æ§ä»¶fromè¯»å–å¹¶å†™å…¥å†…æ ¸ç©ºé—´çš„æ•°æ® copy_to_user æœ€åå½“ç„¶æ˜¯ä»å†…æ ¸ç©ºé—´æ‹·è´æ•°æ®åˆ°ç”¨æˆ·ç©ºé—´to(å³ç›®æ ‡) PS:ä»¥ä¸Šå‡å»ºç«‹åœ¨æ¯ä¸€æ¬¡æ“ä½œéƒ½æˆåŠŸçš„åŸºç¡€ä¸Š æ¥è‡ªGityuanå¤§ç¥çš„åˆ†äº«http://gityuan.com/2015/11/01/binder-driver/ è§£é‡Šè¯´æ˜: é¦–å…ˆClientç«¯å‘é€æ¶ˆæ¯,é€šè¿‡copy_from_userä»Clientç«¯æ‹·è´æ•°æ®åˆ°å†…æ ¸ç©ºé—´å» è€Œåè¿˜è®°å¾—BINDER_MMAPä¸­çš„æ“ä½œä¹ˆ,å†…æ ¸ç©ºé—´çš„åœ°å€ä¸Serveræ˜¯åŒä¸€å—ç‰©ç†å†…å­˜, Serverå°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹å¼,ç›´æ¥åŒæ­¥åˆ°Clientå‘é€çš„æ•°æ®. binder_initï¼šåˆå§‹åŒ–å­—ç¬¦è®¾å¤‡ï¼› binder_openï¼šæ‰“å¼€é©±åŠ¨è®¾å¤‡ï¼Œè¿‡ç¨‹éœ€è¦æŒæœ‰binder_main_lockåŒæ­¥é”ï¼› binder_mmapï¼šç”³è¯·å†…å­˜ç©ºé—´ï¼Œè¯¥è¿‡ç¨‹éœ€è¦æŒæœ‰binder_mmap_lockåŒæ­¥é”ï¼› binder_ioctlï¼šæ‰§è¡Œç›¸åº”çš„ioctlæ“ä½œï¼Œè¯¥è¿‡ç¨‹éœ€è¦æŒæœ‰binder_main_lockåŒæ­¥é”ï¼› å½“å¤„äºbinder_thread_readè¿‡ç¨‹ï¼Œread_bufferæ— æ•°æ®åˆ™é‡Šæ”¾åŒæ­¥é”ï¼Œå¹¶å¤„äºwait_event_freezableè¿‡ç¨‹ï¼Œç­‰æœ‰æ•°æ®åˆ°æ¥åˆ™å”¤é†’å¹¶å°è¯•æŒæœ‰åŒæ­¥é”ã€‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Source Code","slug":"Source-Code","permalink":"https://www.wangzhumo.com/tags/Source-Code/"},{"name":"Binder","slug":"Binder","permalink":"https://www.wangzhumo.com/tags/Binder/"}]},{"title":"çº¿ç¨‹ä¸è¿›ç¨‹çš„å¼‚åŒä»¥åŠAndroidä¸­çš„IPCæœºåˆ¶","slug":"Thread-Process-IPC","date":"2018-05-10T09:16:06.000Z","updated":"2019-12-22T12:06:11.987Z","comments":true,"path":"2018/05/10/Thread-Process-IPC/","link":"","permalink":"https://www.wangzhumo.com/2018/05/10/Thread-Process-IPC/","excerpt":"çº¿ç¨‹ä¸è¿›ç¨‹Google Doc (https://developer.android.com/guide/components/processes-and-threads) è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯cpuè°ƒåº¦çš„æœ€å°å•ä½. è¿›ç¨‹æ˜¯åº”ç”¨ç¨‹åºçš„æ‰§è¡Œå®ä¾‹,ä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹, è€Œä¸€ä¸ªè¿›ç¨‹çš„åˆ›å»ºåˆ†é…æ˜¯è¦æ¶ˆè€—è¾ƒå¤§çš„æ€§èƒ½çš„,ç›¸æ¯”æ¥è¯´çº¿ç¨‹å°±è¦æ¯”è¿›ç¨‹çš„å¼€é”€å°. å¯¹äºè¿›ç¨‹æ¥è¯´ä¸å…±äº«èµ„æº,å†…å­˜æ˜¯ç‹¬ç«‹çš„.è€Œçº¿ç¨‹å…±äº«å®ƒæ‰€åœ¨çš„çº¿ç¨‹çš„èµ„æº,å†…å­˜. è¿›ç¨‹é—´çš„é€šä¿¡å°±è¦æ›´åŠ éº»çƒ¦,éœ€è¦ä½¿ç”¨IPC( Inter-Proscess Communication)è¿›ç¨‹é—´çš„é€šè®¯ çº¿ç¨‹æ–¹ä¾¿å¾ˆå¤š,ä½†æ˜¯çº¿ç¨‹é—´çš„åŒæ­¥åˆæ˜¯ä¸€ä¸ªè¾ƒä¸ºå¤§çš„è¯¾é¢˜äº†. æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œçº¿ç¨‹å…³æ³¨çš„æ˜¯ä¸­å¤®å¤„ç†å™¨çš„è¿è¡Œï¼Œè€Œä¸æ˜¯è¿›ç¨‹é‚£æ ·å…³æ³¨å†…å­˜ç­‰èµ„æºçš„ç®¡ç†ã€‚","text":"çº¿ç¨‹ä¸è¿›ç¨‹Google Doc (https://developer.android.com/guide/components/processes-and-threads) è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯cpuè°ƒåº¦çš„æœ€å°å•ä½. è¿›ç¨‹æ˜¯åº”ç”¨ç¨‹åºçš„æ‰§è¡Œå®ä¾‹,ä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹, è€Œä¸€ä¸ªè¿›ç¨‹çš„åˆ›å»ºåˆ†é…æ˜¯è¦æ¶ˆè€—è¾ƒå¤§çš„æ€§èƒ½çš„,ç›¸æ¯”æ¥è¯´çº¿ç¨‹å°±è¦æ¯”è¿›ç¨‹çš„å¼€é”€å°. å¯¹äºè¿›ç¨‹æ¥è¯´ä¸å…±äº«èµ„æº,å†…å­˜æ˜¯ç‹¬ç«‹çš„.è€Œçº¿ç¨‹å…±äº«å®ƒæ‰€åœ¨çš„çº¿ç¨‹çš„èµ„æº,å†…å­˜. è¿›ç¨‹é—´çš„é€šä¿¡å°±è¦æ›´åŠ éº»çƒ¦,éœ€è¦ä½¿ç”¨IPC( Inter-Proscess Communication)è¿›ç¨‹é—´çš„é€šè®¯ çº¿ç¨‹æ–¹ä¾¿å¾ˆå¤š,ä½†æ˜¯çº¿ç¨‹é—´çš„åŒæ­¥åˆæ˜¯ä¸€ä¸ªè¾ƒä¸ºå¤§çš„è¯¾é¢˜äº†. æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œçº¿ç¨‹å…³æ³¨çš„æ˜¯ä¸­å¤®å¤„ç†å™¨çš„è¿è¡Œï¼Œè€Œä¸æ˜¯è¿›ç¨‹é‚£æ ·å…³æ³¨å†…å­˜ç­‰èµ„æºçš„ç®¡ç†ã€‚ Androidä¸­çš„IPCæœºåˆ¶å¦‚ä¸‹å›¾æ‰€ç¤º:(å·²ç»ä¸çŸ¥é“å“ªé‡Œçš„é…å›¾äº†â€¦æ„Ÿè°¢åˆ†äº«) IPCç®€ä»‹IPC(Inter-Process Communication) è¿›ç¨‹é—´é€šä¿¡ ä½¿ç”¨åœºæ™¯: åœ¨Androidç¨‹åºä¸­ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸€ä¸ªç¨‹åºå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ Appé—´çš„é€šä¿¡,å¸¸è§çš„å¦‚éœ€è¦ä½¿ç”¨å…¶ä»–Appçš„æ•°æ® ä¸€ä¸ªAppä½¿ç”¨å¤šè¿›ç¨‹,æ¯”å¦‚æŒ‡å®šè¿è¡Œçº¿ç¨‹android:process=&quot;:name&quot; éœ€è¦æ³¨æ„çš„æ˜¯,å¦‚æœä¸€ä¸ªAppä½¿ç”¨å¤šè¿›ç¨‹,Applicationä¹Ÿä¼šå¤šæ¬¡åˆ›å»º Bundleå¸¸è§äºActivity,serviceä¸­ä¼ é€’æ•°æ® éœ€è¦æ³¨æ„çš„æ˜¯,bundleä¸­çš„æ•°æ®å¿…é¡»æ”¯æŒåºåˆ—åŒ–(Serializable,Parcelable) æ–‡ä»¶å…±äº«SharedPreferenceå°±æ˜¯è¿™ç§å®ç°çš„. é€‚åˆå¯¹åŒæ­¥è¦æ±‚ä¸é«˜çš„ä½¿ç”¨æ–¹å¼,éœ€è¦æ³¨æ„å¤„ç†å¥½å¹¶å‘çš„é—®é¢˜. MessengerMessenger å¯¹ AIDL è¿›è¡Œäº†å°è£…ï¼Œå®ƒå®ç°äº†ä¸€ç§åŸºäºæ¶ˆæ¯çš„è¿›ç¨‹é—´é€šä¿¡çš„æ–¹å¼ frameworks/base/core/java/android/os/IMessenger.aidl å®ƒçš„AIDLæ–‡ä»¶å°±åœ¨è¿™é‡Œä¿å­˜ç€! AIDLAIDLï¼ˆAndroid Interface definition languageï¼‰ æ˜¯ Android æä¾›çš„ä¸€ç§è¿›ç¨‹é—´é€šä¿¡ (IPC) æœºåˆ¶ éœ€è¦æ³¨æ„çš„æ˜¯AIDLæ”¯æŒçš„æ•°æ®ç±»å‹ä¸Javaæ¥å£æ”¯æŒçš„æ•°æ®ç±»å‹æœ‰äº›ä¸åŒ: æ‰€æœ‰åŸºç¡€ç±»å‹ï¼ˆint, charâ€¦ï¼‰ Stringï¼ŒListï¼ŒMap æ‰€æœ‰Parcelableçš„ç±» å¹¶ä¸”è¦æ ¹æ®éœ€è¦æ·»åŠ  in out çš„å…³é”®è¯ ContentProviderä¸»è¦æ˜¯é’ˆå¯¹æ•°æ®åº“ä½¿ç”¨çš„,æœ€å¸¸è§çš„ä¾‹å­å°±æ˜¯Androidä¸­æœ‰å¾ˆå¤šå·²ç»å®šä¹‰å¥½çš„ContentProvider Socketè¯´åˆ°è¿™é‡Œ,å°±ä¸å¾—ä¸æä¸€ä¸‹Binderäº† http://www.wangzhumo.com/Source-Code/Android-Binder%E6%9C%BA%E5%88%B6-%E4%B8%80/","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"Javaä¸­çš„å†…å­˜æ¨¡å‹","slug":"Java-memory-module","date":"2018-05-09T14:26:54.000Z","updated":"2019-12-22T12:09:45.514Z","comments":true,"path":"2018/05/09/Java-memory-module/","link":"","permalink":"https://www.wangzhumo.com/2018/05/09/Java-memory-module/","excerpt":"","text":"1. å †åœ¨JVMä¸­åªæœ‰ä¸€ä¸ª,javaå›æ”¶æœºåˆ¶ä¸»è¦å°±æ˜¯ä½œç”¨äºè¿™ä¸€å— å †ä¸»è¦æ˜¯ç”¨æ¥å­˜æ”¾å­˜å‚¨å¯¹è±¡çš„å†…å®¹åŠå…¶æœ¬èº«çš„. 2. æ–¹æ³•åŒºæ–¹æ³•åŒºä¹Ÿå’Œå †ä¸€æ ·,æ˜¯è¢«çº¿ç¨‹å…±äº«çš„. å­˜æ”¾äº†ç±»çš„ä¿¡æ¯(æ–¹æ³•,å­—æ®µ,åç§°),é™æ€å˜é‡,å¸¸é‡ Java1.7ä¹‹å‰,å­—ç¬¦ä¸²å¸¸é‡æ± ä¹Ÿæ˜¯æ”¾åœ¨è¿™é‡Œçš„,ä½†æ˜¯1.7ä»¥åç§»åŠ¨åˆ°å †é‡Œé¢å»äº† 3. è™šæ‹Ÿæœºæ ˆ æ¯ä¸€ä¸ªæ ˆå¸§çš„å‡ºå…¥æ ˆéƒ½æ˜¯ä¸€ä¸ªæ–¹æ³•è¢«è°ƒèµ·ç›´åˆ°ç»“æŸè¿”å›çš„è¿‡ç¨‹. æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰ä¸€ä¸ªè‡ªå·±çš„Javaæ ˆï¼Œæ ˆå¸§ä¸­åŒ…æ‹¬ å±€éƒ¨å˜é‡è¡¨(Local Variables) æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡,å‡½æ•°çš„å‚æ•°ç­‰.å¯¹äºåŸºç¡€ç±»å‹çš„å˜é‡ç›´æ¥å­˜å‚¨ä»–çš„å€¼,è€Œå¼•ç”¨ç±»å‹çš„å˜é‡ åˆ™å­˜å‚¨çš„æ˜¯æŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ æ“ä½œæ•°æ ˆ(Operand Stack) æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„å¼•ç”¨(Reference to runtime constant pool) ä¿è¯æ–¹æ³•å¯ä»¥ä½¿ç”¨å½“å‰ç±»çš„å¸¸é‡ æ–¹æ³•è¿”å›åœ°å€(Return Address) æ‰§è¡Œä¸€ä¸ªæ–¹æ³•å®Œæˆåéœ€è¦è¿”å›è°ƒç”¨å®ƒçš„åœ°æ–¹ é™„åŠ ä¿¡æ¯ 4. ç¨‹åºè®¡æ•°å™¨Program Counter Register ä¹Ÿç§°ä½œä¸ºPCå¯„å­˜å™¨,ä¿å­˜çš„æ˜¯ç¨‹åºå½“å‰æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ 5.æœ¬åœ°æ–¹æ³•æ ˆæœ¬åœ°æ–¹æ³•æ ˆåˆ™æ˜¯ä¸ºæ‰§è¡Œæœ¬åœ°æ–¹æ³•ï¼ˆNative Methodï¼‰æœåŠ¡çš„","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"Androidçš„å¯åŠ¨æµç¨‹","slug":"Android-App-Launch","date":"2018-05-09T07:00:12.000Z","updated":"2019-12-22T12:12:44.312Z","comments":true,"path":"2018/05/09/Android-App-Launch/","link":"","permalink":"https://www.wangzhumo.com/2018/05/09/Android-App-Launch/","excerpt":"ç³»ç»Ÿç»“æ„ åº”ç”¨å±‚ å³ä¸ºå¼€å‘å‡ºæ¥çš„ä¸€äº›app,å½“ç„¶è¿˜åŒ…æ‹¬äº†ä¸€äº›ç³»ç»ŸApp åº”ç”¨æ¡†æ¶å±‚(Java API Framework) è¿™ä¸€å±‚ç”±javaç¼–å†™,æä¾›ç»™æˆ‘ä»¬å¹³æ—¶å¼€å‘ä½¿ç”¨çš„API,ä¸»è¦çš„ä¸€äº›ç»„ä»¶: Manager Activity Manager , Window Manager , Package Manager ,Location Manager Notification Manager,Resource Manager,Telephony Manager Content Providers View System ç³»ç»Ÿè¿è¡Œåº“å±‚ C/C++ç¨‹åºåº“å’ŒAndroidè¿è¡Œæ—¶åº“ ç¡¬ä»¶æŠ½è±¡å±‚(HAL) Linuxå†…æ ¸å±‚","text":"ç³»ç»Ÿç»“æ„ åº”ç”¨å±‚ å³ä¸ºå¼€å‘å‡ºæ¥çš„ä¸€äº›app,å½“ç„¶è¿˜åŒ…æ‹¬äº†ä¸€äº›ç³»ç»ŸApp åº”ç”¨æ¡†æ¶å±‚(Java API Framework) è¿™ä¸€å±‚ç”±javaç¼–å†™,æä¾›ç»™æˆ‘ä»¬å¹³æ—¶å¼€å‘ä½¿ç”¨çš„API,ä¸»è¦çš„ä¸€äº›ç»„ä»¶: Manager Activity Manager , Window Manager , Package Manager ,Location Manager Notification Manager,Resource Manager,Telephony Manager Content Providers View System ç³»ç»Ÿè¿è¡Œåº“å±‚ C/C++ç¨‹åºåº“å’ŒAndroidè¿è¡Œæ—¶åº“ ç¡¬ä»¶æŠ½è±¡å±‚(HAL) Linuxå†…æ ¸å±‚ Androidçš„å¯åŠ¨ä¸»è¦è¿‡ç¨‹ initè¿›ç¨‹ initè¿›ç¨‹æ˜¯ç”±å†…æ ¸å¯åŠ¨çš„,æ˜¯ç”¨æˆ·ç©ºé—´çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹,å¯ä»¥è¯´æ˜¯ä¸€ä¸ªrootè¿›ç¨‹ å½“initè¿›ç¨‹å¯åŠ¨åä¼šåˆ›å»ºæŒ‚è½½ç³»ç»Ÿç›®å½•,è®¾å¤‡èŠ‚ç‚¹, è§£æinit.rc å’Œ init.hardware.rc,å¯åŠ¨å±æ€§æœåŠ¡ï¼Œä»¥åŠä¸€ç³»åˆ—çš„æœåŠ¡å’Œè¿›ç¨‹ æœ¬åœ°å®ˆæŠ¤è¿›ç¨‹ å¯åŠ¨ servicemanager ç®¡ç†binderçš„é€šè®¯ surfaceflinger UI mediaserver éŸ³è§†é¢‘,ç›¸æœº netd è“ç‰™ã€wifiã€usbç­‰ adbd rild installd éœ€è¦æ³¨æ„çš„æ˜¯è¿™äº›éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„Linuxè¿›ç¨‹ Nativeç³»ç»ŸæœåŠ¡ è¿è¡Œåœ¨æœ¬åœ°å®ˆæŠ¤è¿›ç¨‹ä¸­,æ‰€å±è¿›ç¨‹åˆå§‹åŒ–çš„æ—¶å€™ä¼šå°†Nativeç³»ç»ŸæœåŠ¡æ³¨å†Œåˆ°ServiceManagerä¸­,æ–¹ä¾¿æˆ‘ä»¬é€šè¿‡Binderæœºåˆ¶è°ƒç”¨Nativeç³»ç»ŸæœåŠ¡ JavaæœåŠ¡ å†åˆ›å»ºæœ¬åœ°æœåŠ¡çš„åŒæ—¶,initè¿›ç¨‹è¿˜ä¼šåˆ›å»ºZygoteè¿›ç¨‹ Zygoteä¹Ÿæ˜¯Androidä¸­ç›¸å½“é‡è¦çš„ä¸€ä¸ªè¿›ç¨‹äº†,Zygoteè¿›ç¨‹ä¼šå»ºç«‹ä¸€ä¸ªDalvik VMå¹¶ä¸”å¯åŠ¨ System Serverç³»ç»ŸæœåŠ¡ System Serverå°†å¯åŠ¨Android Service AccessibilityManagerService æˆªè·ç”¨æˆ·è¾“å…¥ï¼Œå¹¶æ ¹æ®è¾“å…¥ç»™ç”¨æˆ·ä¸€äº›é¢å¤–çš„åé¦ˆï¼Œèµ·åˆ°è¾…åŠ©æ•ˆæœçš„æœåŠ¡AccountManagerService ç®¡ç†è®¾å¤‡ä¸­æ‰€æœ‰è´¦å·çš„æœåŠ¡ï¼ŒåŒ…æ‹¬è´¦å·ã€å¯†ç ã€æˆæƒç®¡ç†åŠŸèƒ½ActivityManagerService ç®¡ç†æ‰€æœ‰ç»„ä»¶çš„æœåŠ¡ï¼Œå®‰å“ç³»ç»Ÿçš„æ ¸å¿ƒæœåŠ¡ AlarmManagerService ç®¡ç†é—¹é’Ÿçš„æœåŠ¡AppWidgetService ç®¡ç†APP widgetsçš„å·¥ä½œï¼ŒåŒ…æ‹¬åŠ è½½ã€åˆ é™¤ã€å¸ƒå±€ç­‰AssetAtlasService å°†ä¸€äº›ç³»ç»Ÿå›¾ç‰‡èµ„æºåˆå¹¶æˆä¸€ä¸ªçº¹ç†å›¾ä¼ ç»™GPUè¾¾åˆ°ç¡¬ä»¶åŠ é€Ÿçš„æ•ˆæœçš„æœåŠ¡AudioService ç®¡ç†éŸ³é¢‘çš„æœåŠ¡BackupManagerService ç®¡ç†å¤‡ä»½å’Œåº”ç”¨æ•°æ®çš„æœåŠ¡BatteryService ç®¡ç†ç”µæ± çš„æœåŠ¡BluetoothManagerService ç®¡ç†ç³»ç»Ÿè“ç‰™çš„æœåŠ¡CertBlacklister æ›´æ–°ç³»ç»ŸSSLè¯ä¹¦çš„å…¬å…±ç§˜é’¥å’Œåºåˆ—å·é»‘åå•çš„æœåŠ¡ClipboardService ç®¡ç†ç³»ç»Ÿå‰ªè´´æ¿çš„æœåŠ¡CommonTimeManagementService ç®¡ç†å…¬å…±æ—¶é—´é…ç½®çš„æœåŠ¡ConnectivityService ç®¡ç†ç½‘ç»œè¿æ¥çš„æœåŠ¡ContentService ç®¡ç†ç³»ç»Ÿæ•°æ®æ›´æ–°é€šçŸ¥çš„æœåŠ¡ï¼Œå’ŒContentProviderå¯†åˆ‡ç›¸å…³CountryDetectorService æ£€æµ‹å½“å‰ç³»ç»Ÿæ‰€å±å›½å®¶çš„æœåŠ¡DevicePolicyManagerService ç®¡ç†ç³»ç»Ÿè®¾å¤‡é…ç½®çš„æœåŠ¡DeviceStorageMonitorService ç®¡ç†ç³»ç»Ÿå­˜å‚¨ç©ºé—´çš„æœåŠ¡ï¼Œå½“å­˜å‚¨ç©ºé—´å°äºæŸä¸ªé˜ˆå€¼æ—¶ï¼Œä¼šå‘å‡ºè­¦å‘Šå¹¿æ’­DiskStateService ç®¡ç†ç³»ç»Ÿå­˜å‚¨ç©ºé—´ç»Ÿè®¡çš„æœåŠ¡DisplayManagerService ç®¡ç†æ˜¾ç¤ºè®¾å¤‡çš„æœåŠ¡DreamManagerService ç®¡ç†å±å¹•ä¿æŠ¤çš„æœåŠ¡DropBoxManagerService ç”Ÿæˆå’Œç®¡ç†ç³»ç»Ÿè¿è¡Œä¸­æ—¥å¿—æ–‡ä»¶çš„æœåŠ¡EntropyMixer åŠ è½½å’Œä¿å­˜éšæœºä¿¡æ¯çš„æœåŠ¡IdleMaintenanceService ç®¡ç†ç³»ç»Ÿåœ¨ç©ºé—²æ—¶æ‰§è¡Œç»´æŠ¤ä»»åŠ¡çš„æœåŠ¡InputManagerService ç®¡ç†è§¦å±è¾“å…¥çš„æœåŠ¡InputMethodManagerService ç®¡ç†ç³»ç»Ÿè¾“å…¥æ³•çš„æœåŠ¡LightsService ç®¡ç†å…‰ä¼ æ„Ÿå™¨çš„æœåŠ¡LocationManagerService ç®¡ç†å®šä½å’Œä½ç½®çš„æœåŠ¡LockSettingsService ç®¡ç†ç³»ç»Ÿé”å±è®¾ç½®çš„æœåŠ¡MountService ç®¡ç†ç³»ç»Ÿå­˜å‚¨è®¾å¤‡æŒ‚è½½å’Œå¸è½½çš„æœåŠ¡NetWorkManagementService ç®¡ç†ç³»ç»Ÿç½‘ç»œçš„æœåŠ¡NetWorkPolicyManagerService ç®¡ç†ç½‘ç»œè¿æ¥ç­–ç•¥çš„æœåŠ¡NetWorkStatsService ç®¡ç†ç½‘ç»œè¿æ¥çŠ¶æ€çš„æœåŠ¡NetWorkTimeUpdateService æ ¹æ®ç½‘ç»œæ—¶é—´æ›´æ–°æœ¬åœ°æ—¶é—´çš„æœåŠ¡NotificationManagerService ç®¡ç†ç³»ç»Ÿé€šçŸ¥çš„æœåŠ¡PackageManagerService ç®¡ç†åº”ç”¨åŒ…çš„æœåŠ¡PowerManagerService ç®¡ç†ç³»ç»Ÿç”µæºçš„æœåŠ¡PrintManagerService ç®¡ç†æ‰“å°çš„æœåŠ¡RecognitionManagerService ç®¡ç†èº«ä»½è¯†åˆ«çš„æœåŠ¡SamplingProfilerService è®°å½•å’Œåˆ†æç³»ç»Ÿå¯åŠ¨æ€§èƒ½çš„æœåŠ¡SchedulingPolicyService ç®¡ç†ç³»ç»Ÿè°ƒåº¦ç­–ç•¥çš„æœåŠ¡SearchManagerServcie ç®¡ç†ç³»ç»Ÿæœç´¢åŠŸèƒ½çš„æœåŠ¡SerialServie ç®¡ç†ç³»ç»Ÿä¸²å£è®¾å¤‡çš„æœåŠ¡StatusBarManagerService ç®¡ç†ç³»ç»ŸçŠ¶æ€æ çš„æœåŠ¡TelephonyRegistry ç›‘å¬å’Œç®¡ç†é€šè¯äº‹ä»¶å’ŒçŠ¶æ€çš„æœåŠ¡TextServicesManagerService æ–‡æœ¬æ‹¼å†™æ£€æŸ¥çš„æœåŠ¡UiModeManagerService è®¾ç½®å’Œç®¡ç†ç³»ç»ŸUIæ¨¡å¼çš„æœåŠ¡UsbService ç®¡ç†USBè¿æ¥çš„æœåŠ¡UserManagerService ç®¡ç†ç³»ç»Ÿç”¨æˆ·èº«ä»½ä¿¡æ¯çš„æœåŠ¡VibratorService ç®¡ç†ç³»ç»ŸæŒ¯åŠ¨å™¨çš„æœåŠ¡ï¼·allpaperManagerService ç®¡ç†ç³»ç»Ÿæ¡Œé¢èƒŒæ™¯å¢™çº¸çš„æœåŠ¡WifiP2pService ç®¡ç†Wifiç‚¹å¯¹ç‚¹è¿æ¥çš„æœåŠ¡WifiService ç®¡ç†ç³»ç»ŸWifiè®¾å¤‡çš„æœåŠ¡WindowManagerService ç®¡ç†çª—å£çš„æœåŠ¡ï¼Œå®‰å“ç³»ç»Ÿçš„æ ¸å¿ƒæœåŠ¡ è¿™äº›æœåŠ¡éƒ½ä¼šæ³¨å†Œåˆ°Service Managerä¸­å»,å®ŒæˆServcieManagerå¯¹æœåŠ¡çš„ç®¡ç† éœ€è¦æ³¨æ„çš„æ˜¯,ç”±System Serveråˆ›å»ºçš„è¿™äº›æœåŠ¡,éƒ½æ˜¯å­˜åœ¨äºSystem Serverè¿›ç¨‹ä¸­çš„çº¿ç¨‹ ä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹ servicemanageræ˜¯initçš„å­è¿›ç¨‹ Zygoteæ˜¯initçš„å­è¿›ç¨‹ï¼Œforkå‡ºæ¥æ‰€æœ‰çš„è™šæ‹Ÿæœº system serveræ˜¯Zygoteçš„å­è¿›ç¨‹ Homeå¯åŠ¨ å½“æ‰€æœ‰çš„ä»»åŠ¡å¯åŠ¨å,ä¼šé€šè¿‡ActivityManagerå¯åŠ¨Homeç•Œé¢ åŒæ—¶å‘é€ACTION_BOOT_COMPLETEDå¹¿æ’­","categories":[{"name":"Source Code","slug":"Source-Code","permalink":"https://www.wangzhumo.com/categories/Source-Code/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Source Code","slug":"Source-Code","permalink":"https://www.wangzhumo.com/tags/Source-Code/"}]},{"title":"JVMè™šæ‹Ÿæœºä¸­çš„ç±»åŠ è½½å™¨","slug":"JVM-class-loader","date":"2018-03-11T02:35:47.000Z","updated":"2019-12-22T12:09:14.814Z","comments":true,"path":"2018/03/11/JVM-class-loader/","link":"","permalink":"https://www.wangzhumo.com/2018/03/11/JVM-class-loader/","excerpt":"å‰è¨€å‰ä¸€ç¯‡æ¢³ç†äº†ä¸€ä¸‹ç±»åŠ è½½æœºåˆ¶çš„å¤§æ¦‚æµç¨‹,å…¶ä¸­å°±æ¶‰åŠåˆ°ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸œè¥¿ç±»åŠ è½½å™¨,åœ¨åŠ è½½é˜¶æ®µâ€é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåè·å–æè¿°æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµâ€ æˆ‘ä»¬çŸ¥é“äºŒçº§åˆ¶å­—èŠ‚æµä¸åªæ˜¯æˆ‘ä»¬ç¼–å†™çš„ä»£ç  å¯ä»¥ä»ä¸€äº›jar,waråŒ…ç­‰å‹ç¼©æ–‡ä»¶ä¸­è·å– å·²ç»å‡‰äº†çš„Applet,ä¹Ÿå°±æ˜¯å¯ä»¥ä»ç½‘ç»œä¸­è·å– è¿è¡Œæ—¶ç”Ÿæˆ,å¦‚åŠ¨æ€ä»£ç†,retrofitä¸­ä½¿ç”¨çš„æŠ€æœ¯ä¹‹ä¸€ å…¶ä»–â€¦ é‚£ä¹ˆä¸‹é¢æˆ‘è¦çŸ¥é“çš„æ˜¯: ç±»åŠ è½½å™¨çš„å«ä¹‰å’Œä½œç”¨ ç±»åŠ è½½å™¨çš„ç±»å‹ ç±»åŠ è½½å™¨çš„åº”ç”¨","text":"å‰è¨€å‰ä¸€ç¯‡æ¢³ç†äº†ä¸€ä¸‹ç±»åŠ è½½æœºåˆ¶çš„å¤§æ¦‚æµç¨‹,å…¶ä¸­å°±æ¶‰åŠåˆ°ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸œè¥¿ç±»åŠ è½½å™¨,åœ¨åŠ è½½é˜¶æ®µâ€é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåè·å–æè¿°æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµâ€ æˆ‘ä»¬çŸ¥é“äºŒçº§åˆ¶å­—èŠ‚æµä¸åªæ˜¯æˆ‘ä»¬ç¼–å†™çš„ä»£ç  å¯ä»¥ä»ä¸€äº›jar,waråŒ…ç­‰å‹ç¼©æ–‡ä»¶ä¸­è·å– å·²ç»å‡‰äº†çš„Applet,ä¹Ÿå°±æ˜¯å¯ä»¥ä»ç½‘ç»œä¸­è·å– è¿è¡Œæ—¶ç”Ÿæˆ,å¦‚åŠ¨æ€ä»£ç†,retrofitä¸­ä½¿ç”¨çš„æŠ€æœ¯ä¹‹ä¸€ å…¶ä»–â€¦ é‚£ä¹ˆä¸‹é¢æˆ‘è¦çŸ¥é“çš„æ˜¯: ç±»åŠ è½½å™¨çš„å«ä¹‰å’Œä½œç”¨ ç±»åŠ è½½å™¨çš„ç±»å‹ ç±»åŠ è½½å™¨çš„åº”ç”¨ ç±»åŠ è½½å™¨ç±»åŠ è½½å™¨æœ€åˆæ˜¯ä¸ºäº†Java Appletçš„éœ€æ±‚è€Œç ”å‘çš„,ä¸ºäº†æ–¹ä¾¿åº”ç”¨ç¨‹åºè‡ªå·±å†³å®šå¦‚ä½•å»è·å–æ‰€éœ€è¦çš„ç±»,è€ŒæŠŠè¿™ä¸ªæ“ä½œæ”¾åˆ°äº†JAVAè™šæ‹Ÿæœºå¤–éƒ¨å»å®ç°. å®ç°è¿™ä¸ªåŠ¨ä½œçš„ä»£ç æ¨¡å—è¢«ç§°ä¸ºç±»åŠ è½½å™¨ æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯,åœ¨JVMä¸­,ä»»æ„ä¸€ä¸ªç±»éƒ½éœ€è¦ç”±ç±»åŠ è½½å™¨å’Œå®ƒæœ¬çœå…±åŒç¡®ç«‹å…¶åœ¨JVMä¸­çš„å”¯ä¸€æ€§ æ¯ä¸€ä¸ªç±»åŠ è½½å™¨éƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç±»å‘½åç©ºé—´. å˜ç°ä¸º: å¦‚æœåŒä¸€ä¸ªç±»,è¢«ä¸åŒçš„ä¸¤ä¸ªç±»åŠ è½½å™¨åŠ è½½,é‚£ä¹ˆå®ƒä»¬å°±å¿…ç„¶ä¸ç›¸ç­‰. ç±»åŠ è½½å™¨çš„ç±»å‹ å¯åŠ¨ç±»åŠ è½½å™¨ Bootstrap ClassLoader ,æ˜¯ç”±C++å®ç°çš„,ä½œä¸ºè™šæ‹Ÿæœºçš„ä¸€éƒ¨åˆ† å…¶ä»–ç±»åŠ è½½å™¨,è¿™äº›åŠ è½½å™¨éƒ½æ˜¯ç”±JAVAè¯­è¨€å®ç°çš„,ç‹¬ç«‹äºJVMä¹‹å¤–å¹¶ä¸”éƒ½æ˜¯java.lang.ClassLoaderçš„å­ç±» ä¸Šé¢çš„åˆ†ç±»æ˜¯å¯¹äºJVMè€Œè¨€çš„åˆ†ç±»,åœ¨æˆ‘ä»¬ç¼–ç çš„è¿‡ç¨‹ä¸­,å¯¹ç±»åŠ è½½å™¨åˆ†ä¸º; å¯åŠ¨ç±»åŠ è½½å™¨ Bootstrap ClassLoader, è´Ÿè´£å°†/lib ç›®å½•ä¸­çš„æ–‡ä»¶åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­ æ‰©å±•ç±»åŠ è½½å™¨ Extension ClassLoader è´Ÿè´£åŠ è½½/lib/ext ç›®å½•ä¸­çš„æ–‡ä»¶,æˆ–è€…è¢« java.ext.dirsç³»ç»Ÿå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­æ–‡ä»¶ æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨æ‰©å±•ç±»åŠ è½½å™¨ åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ Application ClassLoader ClassLoader.getSystemClassLoader()æ–¹æ³•å¯ä»¥è¿”å›,ä¸€èˆ¬ç§°ä¸ºç³»ç»Ÿç±»åŠ è½½å™¨ è´Ÿè´£åŠ è½½ç”¨æˆ·è·¯å¾„ä¸­çš„ç±»åº“,å¦‚æœç¨‹åºä¸­æ²¡æœ‰ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨,åˆ™é»˜è®¤æ˜¯ä½¿ç”¨è¯¥ç±»åŠ è½½å™¨çš„ åŒäº²å§”æ´¾æ¨¡å‹#####æ¨¡å‹ç»“æ„ //æˆ‘ä»¬çœ‹çœ‹ä»£ç ä¸­æ˜¯æ€ä¹ˆç»„ç»‡çš„ protected Class&lt;?&gt; loadClass(String name, boolean resolve) throws ClassNotFoundException { // First, check if the class has already been loaded Class&lt;?&gt; c = findLoadedClass(name); if (c == null) { try { if (parent != null) { c = parent.loadClass(name, false); } else { c = findBootstrapClassOrNull(name); } } catch (ClassNotFoundException e) { // ClassNotFoundException thrown if class not found // from the non-null parent class loader } if (c == null) { // If still not found, then invoke findClass in order // to find the class. c = findClass(name); } } return c; } ä¸Šé¢çš„ä»£ç ,æ€»çš„æ¥è¯´æœ‰ findLoadedClass(name) æŸ¥æ‰¾æ˜¯å¦å·²ç»åŠ è½½è¿‡è¿™ä¸ªclassäº†,å¦‚æœä¸ä¸ºç©ºå°±ç›´æ¥è¿”å›äº†è¿™ä¸ªclass åœ¨çœ‹ä¸‹ä¸€æ­¥ try { if (parent != null) { c = parent.loadClass(name, false); } else { c = findBootstrapClassOrNull(name); } } å¦‚æœçˆ¶åŠ è½½å™¨ parentä¸ä¸ºç©º,åˆ™åŠ è½½å·¥ä½œäº¤ç»™çˆ¶åŠ è½½å™¨å»æ‰§è¡Œ, è€Œè¿™ä¸ªçˆ¶åŠ è½½å™¨ä¹Ÿä¼šæœ‰å®ƒçš„çˆ¶åŠ è½½å™¨ æœ€åå¦‚æœè¿™ä¸ªclassè¿˜æ²¡æœ‰åŠ è½½ if (c == null) { // If still not found, then invoke findClass in order // to find the class. c = findClass(name); } æ‰è½®åˆ°è‡ªå·±å»åŠ è½½ è¦æ³¨æ„çš„æ˜¯,è¿™äº›ç±»åŠ è½½å™¨çš„çˆ¶å­å…³ç³»,ä¸æ˜¯ç”±ç»§æ‰¿æ¥å®ç°çš„,è€Œæ˜¯ä½¿ç”¨ç»„åˆ æ¨¡å‹åŠ è½½æµç¨‹ç±»åŠ è½½å™¨æ”¶åˆ°äº†ä¸€ä¸ªç±»åŠ è½½çš„è¯·æ±‚,ä½†æ˜¯ä¸ä¼šç«‹é©¬å»è‡ªå·±åŠ è½½,è€Œæ˜¯å§”æ´¾ç»™çˆ¶åŠ è½½å™¨å»å°è¯•åŠ è½½,ç„¶åå±‚å±‚å§”æ´¾ç›´åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ä¸­.å¦‚æœæ²¡æœ‰æˆåŠŸåŠ è½½,å­åŠ è½½å™¨æ‰ä¼šè‡ªå·±å»åŠ è½½. è¿™æ ·åšæ˜¯æœ‰æ˜æ˜¾çš„å¥½å¤„çš„: è¿™äº›ç±»åŠ è½½å™¨éƒ½å…·æœ‰äº†ä¼˜å…ˆçº§å…³ç³» ä¿è¯äº†æŸäº›ç±»çš„ä¸€è‡´æ€§,å¦‚Object,é€šè¿‡å§”æ´¾,æœ€ç»ˆéƒ½æ˜¯ç”±æœ€é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨å®ŒæˆåŠ è½½çš„. ç±»åŠ è½½å™¨çš„åº”ç”¨å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­,åŠ æ·±ä¸€ä¸‹ç†è§£ //ä¸€ä¸ªç±»,éœ€è¦æ”¾åœ¨é¡¹ç›®ç›®å½•å¤–,é¿å…è¢«ç³»ç»Ÿç±»åŠ è½½å™¨åŠ è½½ public class TestClassLoader{ public void createBy(){ System.out.println(&quot;I&#39;m Batman , Come from &quot; + getClass().getClassLoader().getClass()); } } è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ import java.io.FileInputStream; //è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ public class MarvelStudios extends ClassLoader { //å­˜æ”¾çš„æ˜¯TestClassLoader.classçš„ä½ç½®,è®°å¾—å…ˆç¼–è¯‘æˆclasså†ä½¿ç”¨ private final static String CLASS_FILE_PATH = &quot;/Users/phyooos/workspace/java_workspace/kotlind/soucre/TestClassLoader.class&quot;; private byte[] loadByte(String name) throws Exception { FileInputStream fis = new FileInputStream(CLASS_FILE_PATH); int len = fis.available(); byte[] data = new byte[len]; fis.read(data); fis.close(); return data; } @Override protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException { //è¿™é‡Œè·å–æ–‡ä»¶ try { byte[] data = loadByte(name); return defineClass(name, data, 0, data.length); } catch (Exception e) { e.printStackTrace(); throw new ClassNotFoundException(); } } } æµ‹è¯•ä¸€ä¸‹ public class MainClass { public static void main(String[] args){ MarvelStudios classLoader = new MarvelStudios(); Class clazz = null; try { clazz = classLoader.loadClass(&quot;TestClassLoader&quot;); Object obj = clazz.newInstance(); Method createMethod = clazz.getDeclaredMethod(&quot;createBy&quot;,null); createMethod.invoke(obj, null); } catch (Exception e) { e.printStackTrace(); } } } è¿è¡Œç»“æœä¸º I&#39;m Batman , Come from class MarvelStudios Process finished with exit code 0 è¿™é‡Œæ˜¾è€Œæ˜“è§,ä½¿ç”¨äº†è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨,ä»ç¡¬ç›˜ä¸ŠåŠ è½½äº†ä¸€ä¸ªclassæ–‡ä»¶,å¦‚æœä½ æƒ³åŠ è½½ä¸€ä¸ªjavaæ–‡ä»¶,ä¹Ÿåªéœ€è¦è°ƒç”¨ //defineClassæ–¹æ³•å¯ä»¥æŠŠäºŒè¿›åˆ¶æµå­—èŠ‚ç»„æˆçš„æ–‡ä»¶è½¬æ¢ä¸ºä¸€ä¸ªjava.lang.Class Class&lt;?&gt; c = this.defineClass(name, bytes, 0, bytes.length); è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰ç±»åŠ è½½å™¨ä½¿ç”¨,å¯ä»¥ä»ç¡¬ç›˜ä¸ŠåŠ è½½javaä»£ç . å…¶ä»–å¦‚: ä»£ç åŠ å¯† çƒ­éƒ¨ç½² çƒ­ä¿®å¤","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"JVMè™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶","slug":"JVM-load-class","date":"2018-03-10T03:20:10.000Z","updated":"2019-12-22T12:09:09.261Z","comments":true,"path":"2018/03/10/JVM-load-class/","link":"","permalink":"https://www.wangzhumo.com/2018/03/10/JVM-load-class/","excerpt":"å‰è¨€å…³äºJVMè™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶,å¤§æ¦‚æœ‰å¦‚ä¸‹çš„å‡ ä¸ªé—®é¢˜ ç±»åŠ è½½æœºåˆ¶æ˜¯ä»€ä¹ˆ? ç±»åŠ è½½çš„æµç¨‹","text":"å‰è¨€å…³äºJVMè™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶,å¤§æ¦‚æœ‰å¦‚ä¸‹çš„å‡ ä¸ªé—®é¢˜ ç±»åŠ è½½æœºåˆ¶æ˜¯ä»€ä¹ˆ? ç±»åŠ è½½çš„æµç¨‹ ç±»åŠ è½½æœºåˆ¶æˆ‘ä»¬æ‰€å†™çš„Javaä»£ç ,æœ€ç»ˆéƒ½æ˜¯ç¼–è¯‘æˆclasså­—èŠ‚ç æ–‡ä»¶,è¿™äº›å­—èŠ‚ç æ–‡ä»¶æè¿°äº†å„ç§ä¿¡æ¯ éœ€è¦åŠ è½½åˆ°è™šæ‹Ÿæœºä¸­æ‰èƒ½ä½¿ç”¨è¿è¡Œ è€Œè™šæ‹Ÿæœºå•ŠæŠŠæè¿°ç±»çš„æ•°æ®ä»Classæ–‡ä»¶ä¸­åŠ è½½åˆ°å†…å­˜,å¹¶ä¸”å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒ,è½¬æ¢è§£æå’Œåˆå§‹åŒ–, æœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„Javaç±»å‹,è¿™å°±æ˜¯è™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶. ç±»åŠ è½½æœºåˆ¶çš„æµç¨‹è™šæ‹Ÿæœºä¸­ç±»åŠ è½½çš„å…¨è¿‡ç¨‹: åŠ è½½ , éªŒè¯ ,å‡†å¤‡ , è§£æ , åˆå§‹åŒ–è¿™äº”ä¸ªéƒ¨åˆ† åŠ è½½åœ¨åŠ è½½é˜¶æ®µ,å®Œæˆçš„æ˜¯: é€šè¿‡ç±»çš„å…¨é™å®šå(import * è¿™äº›)æ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ. å°†è¿™ä¸ªäºŒè¿›åˆ¶å­—èŠ‚æµçš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„. åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡,ä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£. å½“æˆ‘ä»¬çš„è™šæ‹Ÿæœºå°†äºŒè¿›åˆ¶å­—èŠ‚æµæ–‡ä»¶åŠ è½½å,ä¼šå­˜æ”¾åœ¨æ–¹æ³•åŒºä¸­,è€Œåå®ä¾‹åŒ–ä¸€ä¸ªClassç±»çš„å¯¹è±¡,(å¯¹äºHotSpotè™šæ‹Ÿæœºè€Œè¨€)ä¼šæ”¾åœ¨æ–¹æ³•åŒºä¸­,è€Œä¸æ˜¯ä¸€èˆ¬å­˜æ”¾å¯¹è±¡,å¼•ç”¨ç±»å‹çš„å †(heap)ä¸­,è¿™ä¸ªClasså¯¹è±¡å°±å¯ä»¥ä½œä¸ºç¨‹åºè®¿é—®æ–¹æ³•åŒºä¸­è¿™äº›ç±»å‹æ•°æ®çš„å¤–éƒ¨æ¥å£. PS:åŠ è½½çš„è¿‡ç¨‹ä¸­,ä¹Ÿå¯èƒ½ä¼šä¼´éšç€ è¿æ¥è¿‡ç¨‹(æ£€æŸ¥,å‡†å¤‡,è§£æ),ä½†æ˜¯å¿…ç„¶æ˜¯å…ˆå‘ç”ŸåŠ è½½,è€Œåæ‰å¯èƒ½å‡ºç°è¿æ¥ éªŒè¯éªŒè¯è¿™ä¸ªé˜¶æ®µéå¸¸çš„é‡è¦ æˆ‘ä»¬çŸ¥é“åœ¨JAVAä»£ç ä¸­,æ˜¯æ— æ³•è¿›è¡Œä¸€äº›ä¸å®‰å…¨çš„æ“ä½œçš„,ä½†æ˜¯classå­—èŠ‚ç æ–‡ä»¶å´å¯ä»¥åšåˆ°,ç±»ä¼¼æ•°ç»„è¶Šç•Œè®¿é—®,è·³è½¬åˆ°ä¸å­˜åœ¨çš„ä»£ç è¡Œâ€¦. é‚£ä¹ˆ,éªŒè¯å°±éå¸¸é‡è¦äº†,ç›´æ¥å†³å®šäº†Javaè™šæ‹Ÿæœºçš„å®‰å…¨æ€§. å¤§æ¦‚åŒ…å«: æ–‡ä»¶æ ¼å¼éªŒè¯åªæœ‰é€šè¿‡äº†æ–‡ä»¶æ ¼å¼éªŒè¯,å­—èŠ‚ç äºŒè¿›åˆ¶æµæ‰ä¼šè¿›å…¥åˆ°æ–¹æ³•åŒºä¸­. æ¯”å¦‚: é­”æ•°CAFEBABE ,ä¸»æ¬¡ç‰ˆæœ¬å·,å¸¸é‡æ± ä¸­å¸¸é‡ç±»å‹,ç¼–ç ç­‰ç­‰â€¦ #####å…ƒæ•°æ®éªŒè¯ ä¸»è¦ç›®çš„æ˜¯å¯¹ç±»çš„å…ƒæ•°æ®è¿›è¡Œè¯­ä¹‰æ£€éªŒ,ç¡®ä¿æè¿°ä¿¡æ¯ç¬¦åˆJAVAçš„è¯­è¨€è§„èŒƒ æ¯”å¦‚:æ˜¯å¦æœ‰çˆ¶ç±»,æ˜¯å¦å®ç°äº†æ‰€ç»§æ‰¿ç±»æˆ–å®ç°æ¥å£çš„å¿…è¦æ–¹æ³•,è¿”å›å€¼ç±»å‹â€¦ #####å­—èŠ‚ç éªŒè¯ åœ¨å…ƒæ•°æ®éªŒè¯å¯¹å…ƒæ•°æ®ä¸­çš„æ•°æ®ç±»å‹åšå®Œæ£€æµ‹å,è¿™ä¸ªé˜¶æ®µä¼šå¯¹ç±»çš„æ–¹æ³•ä½“è¿›è¡Œæ ¡éªŒåˆ†æ,ä¿è¯è¢«éªŒè¯çš„ç±»æ–¹æ³•ä¸ä¼šåœ¨è¿è¡Œæ—¶å¯¹è™šæ‹Ÿæœºåšå‡ºä¸å®‰å…¨æ“ä½œ. ç¬¦å·å¼•ç”¨éªŒè¯å‘ç”Ÿåœ¨è™šæ‹Ÿæœºå°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨çš„æ—¶å€™,è¿™ä¸ªè½¬åŒ–çš„æ“ä½œå°†å‘ç”Ÿåœ¨-è§£æé˜¶æ®µ. ç¬¦å·å¼•ç”¨:ç¬¦å·å¼•ç”¨ä»¥ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡ï¼Œç¬¦å·å¯ä»¥æ˜¯ä»»ä½•å½¢å¼çš„å­—é¢é‡ï¼Œåªè¦ä½¿ç”¨æ—¶èƒ½å¤Ÿæ— æ­§ä¹‰çš„å®šä½åˆ°ç›®æ ‡å³å¯ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œjavaç±»å¹¶ä¸çŸ¥é“æ‰€å¼•ç”¨çš„ç±»çš„å®é™…åœ°å€ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨ç¬¦å·å¼•ç”¨æ¥ä»£æ›¿ã€‚ ç›´æ¥å¼•ç”¨:å¦‚æœæœ‰äº†ç›´æ¥å¼•ç”¨ï¼Œé‚£å¼•ç”¨çš„ç›®æ ‡å¿…å®šå·²ç»è¢«åŠ è½½å…¥å†…å­˜ä¸­äº†.ç›´æ¥å¼•ç”¨æœ‰:1ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆ 2.ç›¸å¯¹åç§»é‡3.ä¸€ä¸ªèƒ½é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ ####å‡†å¤‡ å‡†å¤‡é˜¶æ®µæ˜¯æ­£å¼ä¸ºå˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼çš„é˜¶æ®µ,è¿™äº›å˜é‡çš„å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºè¿›è¡Œåˆ†é…. ç±»å˜é‡:è¢«staticä¿®é¥°çš„å˜é‡,è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„å°±æ˜¯finalä¿®é¥°çš„,è¿™æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µ,ä¼šåœ¨å‡†å¤‡é˜¶æ®µå°±åˆå§‹åŒ–ä¸ºæŒ‡å®šçš„å€¼.(åœ¨å­—æ®µå±æ€§è¡¨ä¸­è¡¨ç°ä¸ºConstantValueå±æ€§) è€Œä¸æ˜¯åƒé€šå¸¸æƒ…å†µä¸‹,ä¼šç»™é™æ€å˜é‡èµ‹é›¶å€¼. è§£æåœ¨ç¬¦å·å¼•ç”¨éªŒè¯ä¸­æåˆ°è¿‡,è¿™ä¸ªé˜¶æ®µæ˜¯è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹. è§£æçš„æ“ä½œä¸€èˆ¬é’ˆå¯¹ç±»,æ¥å£,å­—æ®µ,ç±»æ–¹æ³•,æ¥å£æ–¹æ³•,æ–¹æ³•ç±»å‹,æ–¹æ³•å¥æŸ„å’Œè°ƒç”¨ç‚¹é™å®šç¬¦7ç±»ç¬¦å·å¼•ç”¨ å¤§æ¦‚åˆ†ä¸º: ç±»æˆ–è€…æ¥å£çš„è§£æ,å­—æ®µè§£æ,ç±»æ–¹æ³•è§£æ,æ¥å£æ–¹æ³•è§£æ åˆå§‹åŒ–åˆå§‹åŒ–æ˜¯ç±»åŠ è½½çš„æœ€åä¸€ä¸ªé˜¶æ®µ,ä¹‹å‰çš„é˜¶æ®µ,é™¤äº†åœ¨åŠ è½½é˜¶æ®µå¯ä»¥é€šè¿‡è‡ªå®šä¹‰ç±»åŠ è½½å™¨å‚ä¸ä¹‹å¤–,å…¶ä»–çš„éƒ½æ˜¯ç”±è™šæ‹Ÿæœºä¸»å¯¼å’Œæ§åˆ¶.è€Œåˆ°äº†åˆå§‹åŒ–é˜¶æ®µ,æ‰çœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„JAVAä»£ç ,è¿™ä¸ªé˜¶æ®µæ ¹æ®ä»£ç ä¸­å®šä¹‰å¥½çš„è®¡åˆ’å»åˆå§‹åŒ–ç±»å˜é‡å’Œå…¶ä»–èµ„æº. åˆå§‹åŒ–é˜¶æ®µæ˜¯æ‰§è¡Œç±»æ„é€ å™¨&lt;client&gt;()æ–¹æ³•çš„è¿‡ç¨‹.","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"Androidé€šè®¯æœºåˆ¶åˆ†æ-Handler","slug":"Handler-analyze","date":"2018-03-07T06:13:47.000Z","updated":"2019-12-22T12:09:50.960Z","comments":true,"path":"2018/03/07/Handler-analyze/","link":"","permalink":"https://www.wangzhumo.com/2018/03/07/Handler-analyze/","excerpt":"Handleråœ¨Androidä¸–ç•Œä¸­çš„åœ°ä½ä¸è¨€è€Œå–».è¿™ç¯‡ç¬”è®°ç®—æ˜¯ç®€å•çš„è®°å½•ä¸€ä¸‹æˆ‘å¯¹äºHandlerçš„ç†è§£. å½“æ—¶ç¬¬ä¸€æ¬¡å¯¹Handleräº§ç”Ÿå…´è¶£æ˜¯æˆ‘åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°ä¸€ä¸ªé—®é¢˜: Androidä¸­ä¸ºä»€ä¹ˆä¸»çº¿ç¨‹ä¸ä¼šå› ä¸ºLooper.loop()é‡Œçš„æ­»å¾ªç¯å¡æ­»","text":"Handleråœ¨Androidä¸–ç•Œä¸­çš„åœ°ä½ä¸è¨€è€Œå–».è¿™ç¯‡ç¬”è®°ç®—æ˜¯ç®€å•çš„è®°å½•ä¸€ä¸‹æˆ‘å¯¹äºHandlerçš„ç†è§£. å½“æ—¶ç¬¬ä¸€æ¬¡å¯¹Handleräº§ç”Ÿå…´è¶£æ˜¯æˆ‘åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°ä¸€ä¸ªé—®é¢˜: Androidä¸­ä¸ºä»€ä¹ˆä¸»çº¿ç¨‹ä¸ä¼šå› ä¸ºLooper.loop()é‡Œçš„æ­»å¾ªç¯å¡æ­» Handleræ¶ˆæ¯æœºåˆ¶çš„æ„æˆ Handler ä¸»è¦å°±æ˜¯å‘é€å„ç§æ¶ˆæ¯sendMessageç­‰,ä»¥åŠå¤„ç†æ¶ˆæ¯handleMessage Message å³æ˜¯ä¼ é€’æ¶ˆæ¯çš„è½½ä½“,æœ‰æ—¶å€™ä¹Ÿä¼šæ‰¿è½½ç¡¬ä»¶å‘å‡ºçš„æ¶ˆæ¯. Looper è¿™æ˜¯ä¸€ä¸ªå¾ªç¯Looper.loop,å¹¶è´Ÿè´£å°†æ¶ˆæ¯å‘é€ç»™ç›®æ ‡. MessageQueue æ¶ˆæ¯é˜Ÿè´Ÿè´£å°†æ¶ˆæ¯å‘é€éƒ½æ¶ˆæ¯æ± ä»¥åŠåœ¨æ¶ˆæ¯æ± ä¸­æ‹¿èµ°æ¶ˆæ¯ Messageç±»åˆ†æé¦–å…ˆæˆ‘ä»¬è¦çœ‹åˆ° private static Message sPool; // sometimes we store linked lists of these things /*package*/ Message next; sPoolå£°æ˜ä¸ºstatic ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„Messageå®ä¾‹å…±äº« nextåˆ™ä¸ºæ¯ä¸€ä¸ªå®ä¾‹éƒ½æœ‰çš„ Messageç±»ä¸­,ä¸€ç³»åˆ—çš„obtain,å¦‚ä¸‹: obtain(Handler h) obtain(Handler h, int what) obtain(Handler h, Runnable callback) â€¦ obtain() å¤ç”¨æœºåˆ¶ æˆ‘ä»¬æŸ¥çœ‹æºç å¯çŸ¥,ä»–ä»¬æœ€åéƒ½è°ƒç”¨obtain()è·å¾—ä¸€ä¸ªMessageå®ä½“ android.os.Message#obtain() /** * Return a new Message instance from the global pool. Allows us to * avoid allocating new objects in many cases. */ public static Message obtain() { synchronized (sPoolSync) { if (sPool != null) { Message m = sPool; sPool = m.next; m.next = null; m.flags = 0; // clear in-use flag sPoolSize--; return m; } } return new Message(); } å¯ä»¥çœ‹åˆ°,å½“sPoolä¸ºnullæ—¶æ‰ä¼šnew Message(); å¦‚æœä¸ä¸ºnullåˆ™æŠŠå½“å‰çš„sPoolèµ‹å€¼ç»™Message m è€ŒåæŠŠsPoolèµ‹å€¼ä¸ºm.next()(ä¹Ÿå°±æ˜¯sPoolæ²¡æœ‰èµ‹å€¼å‰å®ƒçš„ä¸‹ä¸€ä¸ªMessageå¯¹è±¡) æŸ¥çœ‹æºç åˆ†æå¯çŸ¥,æœ‰ä¸€ä¸ªMessageçš„æ¶ˆæ¯æ± ,é‡‡ç”¨çš„æ˜¯å•é“¾è¡¨å¤´æ’æ³•,nextæ°¸è¿œæŒ‡å‘çš„æ˜¯ä¸‹ä¸€ä¸ªå¯å¤ç”¨çš„å®ä¾‹åœ°å€ æ‰€ä»¥,å¦‚æœæˆ‘ä»¬åœ¨ä»£ç ä¸­è¦ä½¿ç”¨Messageå®ä¾‹,å°±å°½é‡ä½¿ç”¨obtain()è¿™ä¸€ç³»åˆ—æ–¹æ³•,è€Œä¸è¦ç›´æ¥New åŠ å…¥æ¶ˆæ¯æ±  android.os.Message#recycleUnchecked /** * Recycles a Message that may be in-use. * Used internally by the MessageQueue and Looper when disposing of queued Messages. */ void recycleUnchecked() { // Mark the message as in use while it remains in the recycled object pool. // Clear out all other details. flags = FLAG_IN_USE; what = 0; arg1 = 0; arg2 = 0; obj = null; replyTo = null; sendingUid = -1; when = 0; target = null; callback = null; data = null; synchronized (sPoolSync) { if (sPoolSize &lt; MAX_POOL_SIZE) { next = sPool; sPool = this; sPoolSize++; } } } è¿™é‡Œå…¶å®å°±æ˜¯æŠŠæ— ç”¨çš„Messageå®ä¾‹,åŠ å…¥æ¶ˆæ¯æ± çš„åœ°æ–¹. sPoolSize &lt; MAX_POOL_SIZEåªè¦å½“å‰æ¶ˆæ¯æ± æ²¡æœ‰åˆ°æé™,å°±next = sPool;ä¸”sPool = this; å¯ä»¥ç®€å•ç†è§£ä¸ºæŠŠä¹‹å‰çš„sPoolå¯å¤ç”¨å¯¹è±¡å‘åç§»åŠ¨ä¸€ä½,æŠŠå½“å‰è¿™ä¸ªè¦å›æ”¶çš„Messageç½®ä¸ºç¬¬ä¸€ä¸ªå¯å¤ç”¨å¯¹è±¡ æ‰€ä»¥,Messageä¸»è¦å°±æ˜¯è£…è½½æ•°æ®,å¹¶ä¸”å®ç°äº†Messageçš„å¤ç”¨æœºåˆ¶ MessageQueueç±»åˆ†æ","categories":[{"name":"Source Code","slug":"Source-Code","permalink":"https://www.wangzhumo.com/categories/Source-Code/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Source Code","slug":"Source-Code","permalink":"https://www.wangzhumo.com/tags/Source-Code/"}]},{"title":"RelativeLayoutä¸­Buttonè¦†ç›–å…¶ä»–View","slug":"RelativeLayout-Button-over","date":"2018-03-07T03:53:36.000Z","updated":"2019-12-22T12:07:24.703Z","comments":true,"path":"2018/03/07/RelativeLayout-Button-over/","link":"","permalink":"https://www.wangzhumo.com/2018/03/07/RelativeLayout-Button-over/","excerpt":"å‰è¨€å¸ƒå±€æ–‡ä»¶ä¸­,RelativeLayoutåŒ…è£¹æ—¶,åœ¨RelativeLayoutä¸­çš„View,åº”è¯¥æ˜¯â€å±‚å±‚å‹ä¸Šâ€çš„. è¶Šå¾€åº•ä¸‹å†™çš„Viwe,åœ¨è§†å›¾ä¸Šè¶Šåœ¨ä¸Šå±‚.","text":"å‰è¨€å¸ƒå±€æ–‡ä»¶ä¸­,RelativeLayoutåŒ…è£¹æ—¶,åœ¨RelativeLayoutä¸­çš„View,åº”è¯¥æ˜¯â€å±‚å±‚å‹ä¸Šâ€çš„. è¶Šå¾€åº•ä¸‹å†™çš„Viwe,åœ¨è§†å›¾ä¸Šè¶Šåœ¨ä¸Šå±‚. é—®é¢˜activity_main.xml&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;layout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot; xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt; &lt;data&gt; &lt;variable name=&quot;click&quot; type=&quot;com.wangzhumo.app.single.MainActivity.ClickFunc&quot;/&gt; &lt;/data&gt; &lt;RelativeLayout android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; tools:context=&quot;com.wangzhumo.app.single.MainActivity&quot;&gt; &lt;ImageView android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; android:layout_marginBottom=&quot;50dp&quot; tools:background=&quot;@tools:sample/backgrounds/scenic&quot;/&gt; &lt;Button android:id=&quot;@+id/button_finsh&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_alignParentTop=&quot;true&quot; android:layout_centerHorizontal=&quot;true&quot; android:onClick=&quot;@{(v) -&gt; click.onFinshAct(v)}&quot; android:text=&quot;Finsh&quot; /&gt; &lt;Button android:id=&quot;@+id/button_dis&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_alignParentEnd=&quot;true&quot; android:layout_alignParentTop=&quot;true&quot; android:onClick=&quot;@{(v) -&gt; click.onStartAct(v)}&quot; android:text=&quot;Start&quot; tools:ignore=&quot;MissingConstraints&quot; tools:layout_editor_absoluteX=&quot;88dp&quot; tools:layout_editor_absoluteY=&quot;0dp&quot; /&gt; &lt;Button android:id=&quot;@+id/button_start&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:onClick=&quot;@{(v) -&gt; click.onShowDialog(v)}&quot; android:text=&quot;Dialog&quot; tools:ignore=&quot;MissingConstraints&quot; tools:layout_editor_absoluteX=&quot;176dp&quot; tools:layout_editor_absoluteY=&quot;0dp&quot; /&gt; &lt;Button android:id=&quot;@+id/button2&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_alignParentStart=&quot;true&quot; android:onClick=&quot;@{(v) -&gt; click.onPxActivity(v)}&quot; android:layout_below=&quot;@+id/button_start&quot; android:layout_marginTop=&quot;22dp&quot; android:text=&quot;Pixe&quot; /&gt; &lt;Button android:id=&quot;@+id/button3&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:onClick=&quot;@{(v) -&gt; click.onTralActivity(v)}&quot; android:layout_alignStart=&quot;@+id/button_finsh&quot; android:layout_alignTop=&quot;@+id/button2&quot; android:text=&quot;Tranl&quot; tools:text=&quot;@tools:sample/lorem/random&quot;/&gt; &lt;ImageView android:layout_marginBottom=&quot;100dp&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; tools:background=&quot;@tools:sample/backgrounds/scenic&quot;/&gt; &lt;/RelativeLayout&gt; &lt;/layout&gt; Viewçš„ç»“æ„å¦‚ä¸‹: ç„¶è€Œå®é™…æ•ˆæœå¦‚ä¸‹: åˆ†æå¦‚ä¸‹:é€ æˆè¿™æ ·æ•ˆæœ,æ˜¯Buttonçš„åŸå›  åˆ†æ:æ•´ä¸ªé¡µé¢é™¤äº† 2,3,4,5 è¿™5ä¸ªButtonä¹‹å¤–,å…¶ä»–çš„Viewéƒ½ä¾æ—§éµå¾ªRelativeLayoutçš„è§„åˆ™ è§£å†³æ–¹æ¡ˆåœ¨stackoverflowä¸Šæˆ‘æ‰¾åˆ°äº†Buttoné€ æˆè¿™ä¸ªæ•ˆæœçš„åŸå›  https://stackoverflow.com/questions/27080338/android-5-0-androidelevation-works-for-view-but-not-button/27112143#27112143 æ˜¯å› ä¸ºAndroid5.0ä¹‹å,Buttoné»˜è®¤æ·»åŠ äº†StateListAnimator,å…·ä½“å°±æ˜¯å¯¹ android:elevation android:translationZ ä¸¤ä¸ªå±æ€§è¿›è¡Œäº†ä¿®æ”¹,æˆ‘ä»¬å¦‚ä½•å»æ‰è¿™ä¸ªé»˜è®¤çš„æ•ˆæœé‚£? ##### android:stateListAnimatorè®¾ç½®ä¸ºnullå³å¯ &lt;Button ... android:stateListAnimator=&quot;@null&quot; /&gt; å¦‚æœä½ éœ€è¦æ·»åŠ stateListAnimatoræ•ˆæœçš„è¯ &lt;Button ... android:stateListAnimator=&quot;@anim/you_animator&quot; /&gt;","categories":[{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/categories/Bug/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/tags/Bug/"}]},{"title":"ConfigChangesçš„å±æ€§å€¼","slug":"ConfigChanges","date":"2018-03-05T09:51:12.000Z","updated":"2019-12-22T12:11:40.322Z","comments":true,"path":"2018/03/05/ConfigChanges/","link":"","permalink":"https://www.wangzhumo.com/2018/03/05/ConfigChanges/","excerpt":"","text":"é€šè¿‡è®¾ç½®è¿™ä¸ªå±æ€§å¯ä»¥ä½¿Activityæ•æ‰è®¾å¤‡çŠ¶æ€å˜åŒ– &quot;mcc&quot; å›½é™…ç§»åŠ¨ç”¨æˆ·è¯†åˆ«ç æ‰€å±å›½å®¶ä»£å·æ˜¯æ”¹å˜äº†----- simè¢«ä¾¦æµ‹åˆ°äº†ï¼Œå»æ›´æ–°mcc mccæ˜¯ç§»åŠ¨ç”¨æˆ·æ‰€å±å›½å®¶ä»£å· &quot;mnc&quot; å›½é™…ç§»åŠ¨ç”¨æˆ·è¯†åˆ«ç çš„ç§»åŠ¨ç½‘å·ç æ˜¯æ”¹å˜äº†------ simè¢«ä¾¦æµ‹åˆ°äº†ï¼Œå»æ›´æ–°mnc MNCæ˜¯ç§»åŠ¨ç½‘å·ç ï¼Œæœ€å¤šç”±ä¸¤ä½æ•°å­—ç»„æˆï¼Œç”¨äºè¯†åˆ«ç§»åŠ¨ç”¨æˆ·æ‰€å½’å±çš„ç§»åŠ¨é€šä¿¡ç½‘ &quot;locale&quot; åœ°å€æ”¹å˜äº†-----ç”¨æˆ·é€‰æ‹©äº†ä¸€ä¸ªæ–°çš„è¯­è¨€ä¼šæ˜¾ç¤ºå‡ºæ¥ &quot;touchscreen&quot; è§¦æ‘¸å±æ˜¯æ”¹å˜äº†------é€šå¸¸æ˜¯ä¸ä¼šå‘ç”Ÿçš„ &quot;keyboard&quot; é”®ç›˜å‘ç”Ÿäº†æ”¹å˜----ä¾‹å¦‚ç”¨æˆ·ç”¨äº†å¤–éƒ¨çš„é”®ç›˜ &quot;keyboardHidden&quot; é”®ç›˜çš„å¯ç”¨æ€§å‘ç”Ÿäº†æ”¹å˜ &quot;navigation&quot; å¯¼èˆªå‘ç”Ÿäº†å˜åŒ–-----é€šå¸¸ä¹Ÿä¸ä¼šå‘ç”Ÿ &quot;screenLayout&quot; å±å¹•çš„æ˜¾ç¤ºå‘ç”Ÿäº†å˜åŒ–------ä¸åŒçš„æ˜¾ç¤ºè¢«æ¿€æ´» &quot;fontScale&quot; å­—ä½“æ¯”ä¾‹å‘ç”Ÿäº†å˜åŒ–----é€‰æ‹©äº†ä¸åŒçš„å…¨å±€å­—ä½“ &quot;uiMode&quot; ç”¨æˆ·çš„æ¨¡å¼å‘ç”Ÿäº†å˜åŒ– &quot;orientation&quot; å±å¹•æ–¹å‘æ”¹å˜äº† &quot;screenSize&quot; å±å¹•å¤§å°æ”¹å˜äº† &quot;smallestScreenSize&quot; å±å¹•çš„ç‰©ç†å¤§å°æ”¹å˜äº†ï¼Œå¦‚ï¼šè¿æ¥åˆ°ä¸€ä¸ªå¤–éƒ¨çš„å±å¹•ä¸Š http://www.cnblogs.com/carlo/p/4311010.html","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"Activityä¸Fragmentçš„ç”Ÿå‘½å‘¨æœŸ","slug":"Activity-Fragment-life","date":"2018-03-05T06:02:42.000Z","updated":"2019-12-22T12:12:33.061Z","comments":true,"path":"2018/03/05/Activity-Fragment-life/","link":"","permalink":"https://www.wangzhumo.com/2018/03/05/Activity-Fragment-life/","excerpt":"å‰è¨€åšAndroidå¼€å‘å¥½äº›å¹´äº†,è¿™äº›åŸºç¡€çš„çŸ¥è¯†,å®Œå®Œæ•´æ•´çš„åœ¨åšå®¢ä¸Šå†™ä¸€æ¬¡. Activityç”Ÿå‘½å‘¨æœŸå¿…ä¸å¯å°‘çš„ä¸€å¼ å›¾,æ¥è‡ªGoogle Android developer çš„æ–‡æ¡£ä¸Š","text":"å‰è¨€åšAndroidå¼€å‘å¥½äº›å¹´äº†,è¿™äº›åŸºç¡€çš„çŸ¥è¯†,å®Œå®Œæ•´æ•´çš„åœ¨åšå®¢ä¸Šå†™ä¸€æ¬¡. Activityç”Ÿå‘½å‘¨æœŸå¿…ä¸å¯å°‘çš„ä¸€å¼ å›¾,æ¥è‡ªGoogle Android developer çš„æ–‡æ¡£ä¸Š å›è°ƒæ–¹æ³•ç®€è¿° onCreate() å½“Activityåˆ›å»ºæ—¶,ä¼šå›è°ƒè¯¥æ–¹æ³•,å¸¸ç”¨äºåˆå§‹åŒ–View æˆ–å…¶ä»–çš„ä¸€äº›åŠŸèƒ½çš„åˆå§‹åŒ– onStart() Activityå·²ç»åˆå§‹åŒ–å®Œæ¯•,æ­¤æ—¶çš„é¡µé¢æ˜¯å¯è§çŠ¶æ€,åˆ™å›è°ƒonStart();æ–¹æ³• Activityå¯åŠ¨ï¼šonCreate() -&gt; onStart() -&gt; onResume() onResume() å½“Activityå¯è§,å¹¶ä¸”è·å¾—ç„¦ç‚¹,å¯ä»¥ä¸ç”¨æˆ·äº¤äº’æ—¶å›è°ƒ åœ¨æˆ‘ä»¬å¤„ç†ä¸€äº›è§†å±æ“ä½œ,æˆ–è€…æ˜¯Fragmentæ‡’åŠ è½½ç­‰éƒ½å¯ä»¥ç”¨åˆ° onPause() å½“è°ƒç”¨onPause()æ—¶,è¯´æ˜Activityè¢«é˜»æŒ¡,éƒ¨åˆ†UIå·²ç»ä¸å¯è§äº†,ä½†æ˜¯Activityçš„UIå¹¶æ²¡æœ‰å®Œå…¨æ¶ˆå¤±. onStop() å½“Activityå®Œå…¨ä¸å¯è§,ä¸”åˆ°äº†åå°ä¹‹å,å¦‚æœç³»ç»Ÿå†…å­˜ä¸è¶³,ç³»ç»Ÿå¯èƒ½ä¼šæ€æ­»å½“å‰Activity åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¯ä»¥å–æ¶ˆä¸€äº›åŠ¨ç”»æ•ˆæœç­‰ onDestory() Activityé€€å‡º,é”€æ¯ å¸¸ç”¨äºé”€æ¯,å›æ”¶èµ„æº ç»å…¸åœºæ™¯1.æ­£å¸¸å¯åŠ¨ ç³»ç»Ÿè°ƒç”¨onCreateæ–¹æ³• , ç„¶åè°ƒç”¨onStart() , æœ€åè°ƒç”¨ onResume() ,ç”¨æˆ·å¯æ“ä½œ. E/MainActivity: ---- onCreate ---- E/MainActivity: ---- onStart ---- E/MainActivity: ---- onResume ---- 2.æ­£å¸¸é€€å‡º Activityå…ˆå¤±å»ç„¦ç‚¹ä¸å¯äº¤äº’ E/MainActivity: ---- onPause ---- E/MainActivity: ---- onStop ---- E/MainActivity: ---- onDestroy ---- 2.å¼¹å‡ºDialog MainActivityä»€ä¹ˆlogä¹Ÿæ²¡æœ‰æ‰“å°,è¯´æ˜ä¸å¯¹Activityé€ æˆå½±å“ 3.è·³è½¬ä¸€ä¸ªé€æ˜çš„Activityé¡µé¢(1åƒç´ çš„åŒç†) MainActivityåªè°ƒç”¨äº†onPause() å› ä¸ºMainActivityçš„UIè¢«é®æŒ¡äº† E/MainActivity: ---- onPause ---- 4.ä»è¢«é®æŒ¡çŠ¶æ€æ¢å¤ E/MainActivity: ---- onResume ---- 6.é”å± E/MainActivity: ---- onPause ---- E/MainActivity: ---- onStop ---- æ­¤æ—¶,MainActivityå·²ç»åœ¨åå°äº†. 7.ä»é”å±æ¢å¤ E/MainActivity: ---- onStart ---- E/MainActivity: ---- onResume ---- å¯ä»¥å‘ç°,ä¸ä»…ä»…èµ°äº†onResume() ,è¿˜èµ°äº†ä¸€æ¬¡onStart() 8.æ¨ªç«–å±åˆ‡æ¢ æ­£å¸¸åˆ‡æ¢ E/MainActivity: ---- onPause ---- E/MainActivity: ---- onStop ---- E/MainActivity: ---- onDestroy ---- E/MainActivity: ---- onCreate ---- E/MainActivity: ---- onStart ---- E/MainActivity: ---- onResume ---- å¦‚æœä½ ä»€ä¹ˆéƒ½ä¸è®¾ç½®,ç›´æ¥åˆ‡æ¢æ˜¯è¿™æ ·çš„. ä¿ç•™Activityçš„åˆ‡æ¢ æˆ‘åœ¨manifest.xmlæ–‡ä»¶ä¸­,æ·»åŠ äº† &lt;activity android:name=&quot;.MainActivity&quot; android:configChanges=&quot;orientation|screenSize&quot;&gt; &lt;intent-filter&gt; &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt; &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt; &lt;/intent-filter&gt; &lt;/activity&gt; æ­¤æ—¶: Activityä¸ä¼šè¢«é”€æ¯,ä»è€Œé‡æ–°åˆ›å»º,è€Œæ˜¯è°ƒç”¨onConfigurationChanged @Override public void onConfigurationChanged(Configuration newConfig) { super.onConfigurationChanged(newConfig); //do somethings } Fragmentç”Ÿå‘½å‘¨æœŸæƒ¯ä¾‹,å¦‚å›¾: å›è°ƒæ–¹æ³•ç®€è¿°å…¶ä¸­onAttach() onCreateView() onActivityCreated() onDestroy() onDetach() å’ŒActivityçš„ä¸ä¸€è‡´ onAttach() Fragmentä¸å®ƒæ‰€ä¾èµ–çš„Activityå»ºç«‹å…³è” onCreateView() è¿™é‡Œæ˜¯ç»™Fragmentåˆ›å»ºè§†å›¾ç”¨çš„,åœ¨onCreate()ä¸­åˆå§‹åŒ–Fragment,ä½†æ˜¯è§†å›¾ç­‰è¿˜æ˜¯æ²¡æœ‰åŠ è½½ä¸Šå»çš„ onActivityCreated() å¦‚æœè°ƒç”¨è¯¥æ–¹æ³•,è¯´æ˜Fragmentä¾èµ–çš„Activityä¸­onCreate()å·²ç»æ‰§è¡Œå®Œæ¯• onDestroyView() Fragmentä¸­çš„å¸ƒå±€é”€æ¯,ç§»é™¤ è¦æ³¨æ„çš„æ˜¯,æ­¤æ—¶Fragmentä¸å®ƒæ‰€ä¾èµ–çš„Activityè¿˜æ˜¯å…³è”çš„ onDestroy() æ­¤æ—¶,Fragmentè¢«é”€æ¯ onDetach() è§£é™¤ä¸Activityçš„å…³è” PS: Fragmentä¸­çš„onResume()å¹¶ä¸ååˆ†å‡†ç¡®,æ‰€ä»¥å¦‚æœè¦åšæ‡’åŠ è½½,è¦åˆ¤æ–­fragmentä¸èƒ½ä½¿ç”¨onResumeåˆ¤æ–­ ç»å…¸åœºæ™¯1.æ­£å¸¸å¯åŠ¨ çœŸçš„æ˜¯è¶…çº§å¤šå•Š E/BlankFragment: ---- onAttach ---- å…³è”Activity E/BlankFragment: ---- onCreate ---- Fragmentåˆå§‹åŒ– E/BlankFragment: ---- onCreateView ---- åˆ›å»ºFragmentçš„å¸ƒå±€ E/BlankFragment: ---- onViewCreated ---- onCreateViewæ‰§è¡Œå®Œåè¢«è§¦å‘ E/BlankFragment: ---- onActivityCreated ---- å…³è”çš„Activity OnCreate()æ‰§è¡Œå®Œæ¯•åè§¦å‘ E/BlankFragment: ---- onStart ---- Fragmentå¯è§ E/BlankFragment: ---- onResume ---- Fragmentå¯äº¤äº’,ä¸€èˆ¬ä¸ä½¿ç”¨å®ƒæ¥åˆ¤æ–­ 2.æ­£å¸¸é€€å‡º(æˆ–è€…æ˜¯å®ƒå…³è”çš„Activityè¢«é”€æ¯äº†) E/BlankFragment: ---- onPause ---- E/BlankFragment: ---- onStop ---- E/BlankFragment: ---- onDestroyView ---- E/BlankFragment: ---- onDestroy ---- E/BlankFragment: ---- onDetach ---- 3.è¿›å…¥åå° E/BlankFragment: ---- onPause ---- E/BlankFragment: ---- onStop ---- 4.ä»é”å±åˆ°è§£é” E/BlankFragment: ---- onPause ---- E/BlankFragment: ---- onSaveInstanceState ---- E/BlankFragment: ---- onStop ---- E/BlankFragment: ---- onStart ---- E/BlankFragment: ---- onResume ---- 5.åˆ‡æ¢åˆ°OtherFragment E/BlankFragment: ---- onPause ---- E/BlankFragment: ---- onStop ---- E/BlankFragment: ---- onDestroyView ---- 6.ä»OtherFragmentåˆ‡æ¢å›æœ¬Fragment E/BlankFragment: ---- onCreateView ---- E/BlankFragment: ---- onActivityCreated ---- E/BlankFragment: ---- onStart ---- E/BlankFragment: ---- onResume ----","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Fragment","slug":"Fragment","permalink":"https://www.wangzhumo.com/tags/Fragment/"},{"name":"Activity","slug":"Activity","permalink":"https://www.wangzhumo.com/tags/Activity/"}]},{"title":"Android Studio ä¸­ä½¿ç”¨tools:sample","slug":"Android-Studio-tools-sample","date":"2018-02-26T02:31:28.000Z","updated":"2019-12-22T12:04:17.840Z","comments":true,"path":"2018/02/26/Android-Studio-tools-sample/","link":"","permalink":"https://www.wangzhumo.com/2018/02/26/Android-Studio-tools-sample/","excerpt":"Google å®˜æ–¹æ–‡æ¡£ https://developer.android.com/studio/write/tool-attributes.html#toolssample_resources ä»–æ‰€èƒ½è¾¾åˆ°çš„æ•ˆæœå°±æ˜¯,æä¾›ç»™ä½ ä¸€äº›æ•°æ®,å¹¶ç›´æ¥åœ¨ Preview æˆ–è€… Designé¢æ¿ä¸­æŸ¥çœ‹æ ·å¼","text":"Google å®˜æ–¹æ–‡æ¡£ https://developer.android.com/studio/write/tool-attributes.html#toolssample_resources ä»–æ‰€èƒ½è¾¾åˆ°çš„æ•ˆæœå°±æ˜¯,æä¾›ç»™ä½ ä¸€äº›æ•°æ®,å¹¶ç›´æ¥åœ¨ Preview æˆ–è€… Designé¢æ¿ä¸­æŸ¥çœ‹æ ·å¼ æ•ˆæœä¸å¦‚æ”¾ä¸€ä¸ªå›¾æ¥çš„ç›´è§‚ itemä¸­ä½¿ç”¨ sampleèµ„æº å°†itemåŠ å…¥åˆ°listä¸­æŸ¥çœ‹æ•ˆæœ å‡†å¤‡ä½¿ç”¨toolsAndroid Studioæ³¨æ„è¦ä½¿ç”¨Android Studio 3.0 + çš„ç‰ˆæœ¬ å‘½åç©ºé—´xmlns:tools=&quot;http://schemas.android.com/tools&quot; ç„¶åå°±å¯ä»¥ä½¿ç”¨toolsçš„ç›¸å…³å±æ€§äº† åœ¨googleæ–‡æ¡£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šå…¶ä»–å¯ç”¨çš„,å…·ä½“ä½¿ç”¨æ•ˆæœè¯·è‡ªè¡ŒæŸ¥é˜…æ–‡æ¡£. å¦‚: context showIn layout listitem layoutManager itemCount ä½¿ç”¨æ–¹å¼ä¸º: &lt;layout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt; &lt;RelativeLayout android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; tools:context=&quot;com.wangzhumo.app.tips.page.NearbyFragment&quot;&gt; &lt;com.jcodecraeer.xrecyclerview.XRecyclerView android:id=&quot;@+id/recycleview&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; tools:layoutManager=&quot;GridLayoutManager&quot; tools:itemCount=&quot;5&quot; tools:spanCount=&quot;2&quot; tools:listitem=&quot;@layout/nearby_list_item&quot;&gt; &lt;/com.jcodecraeer.xrecyclerview.XRecyclerView&gt; &lt;/RelativeLayout&gt; &lt;/layout&gt; å¯ç”¨èµ„æºgoogleå·²æä¾›çš„èµ„æº è¿™äº›èµ„æºå¯ä»¥åœ¨xmlä¸­ç›´æ¥ä½¿ç”¨,ä¹Ÿå¯ä»¥åœ¨è‡ªå®šä¹‰çš„èµ„æºä¸­ä½¿ç”¨ ä½¿ç”¨æ–¹å¼ä¸º: &lt;!-- è¿™é‡Œé¢çš„èµ„æºåœ¨ Android Studio/Applications/Android Studio.app/Contents/plugins/android/lib/sampleData/backgrounds/scenic--&gt; &lt;ImageView ... tools:src=&quot;@tools:sample/backgrounds/scenic&quot;&gt; &lt;/ImageView&gt; &lt;!-- è¿™ä¸ªæ˜¯ä¸€æ®µå‡æ–‡ç«  --&gt; &lt;TextView ... tools:text=&quot;@tools:sample/lorem/random&quot;/&gt; &lt;/TextView&gt; è‡ªå®šä¹‰çš„èµ„æº åˆ›å»ºä¸€ä¸ª sampledata æ–‡ä»¶å¤¹ sampledata/images æ–‡ä»¶ä¸­éƒ½æ˜¯äº›å›¾ç‰‡èµ„æº descriptionæ–‡ä»¶ä¸­æ˜¯æè¿°æ€§æ–‡å­—, æ³¨æ„æ¯ä¸€è¡Œä¸ºä¸€é¡¹ä¸ªå…ƒç´  hotels ä¹Ÿæ˜¯ä¸€äº›æ–‡å­—,ä¸è¿‡æ˜¯ä¸€äº›é…’åº—åå­— hotel.json { &quot;data&quot;:[ { &quot;name&quot;:&quot;@sample/hotels&quot;, //è¿™é‡Œä½¿ç”¨çš„æ˜¯è‡ªå·±å®šä¹‰çš„ hotels æ–‡ä»¶ä¸­çš„å­—æ®µ &quot;img&quot;:&quot;@tools:sample/backgrounds/scenic&quot;, &quot;desc&quot;:&quot;@sample/description&quot; //è¿™é‡Œä½¿ç”¨çš„æ˜¯è‡ªå·±å®šä¹‰çš„ description æ–‡ä»¶ä¸­çš„å­—æ®µ }, { &quot;name&quot;:&quot;@sample/hotels&quot;, &quot;img&quot;:&quot;@tools:sample/backgrounds/scenic&quot;, //è¿™é‡Œçš„å°±æ˜¯è‡ªå¸¦çš„èµ„æºäº† &quot;desc&quot;:&quot;@sample/description&quot; }, { &quot;name&quot;:&quot;@sample/hotels&quot;, &quot;img&quot;:&quot;@sample/images&quot;, //è¿™ç§å°±æ˜¯/images æ–‡ä»¶ä¸­çš„èµ„æº &quot;desc&quot;:&quot;@sample/description&quot; }, { &quot;name&quot;:&quot;@sample/hotels&quot;, &quot;img&quot;:&quot;@tools:sample/backgrounds/scenic&quot;, &quot;desc&quot;:&quot;@sample/description&quot; }, { &quot;name&quot;:&quot;@sample/hotels&quot;, &quot;img&quot;:&quot;@tools:sample/backgrounds/scenic&quot;, &quot;desc&quot;:&quot;@sample/description&quot; } ] } ä½¿ç”¨æ–¹å¼ä¸º: &lt;TextView ... tools:text=&quot;@sample/hotels&quot;/&gt; &lt;ImageView ... tools:src=&quot;@sample/images&quot;/&gt;","categories":[{"name":"Android Studio","slug":"Android-Studio","permalink":"https://www.wangzhumo.com/categories/Android-Studio/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Android Studio","slug":"Android-Studio","permalink":"https://www.wangzhumo.com/tags/Android-Studio/"}]},{"title":"Androidé¡¹ç›®ä¸­ä½¿ç”¨Timber + Loggeræ—¥å¿—è¾“å‡º","slug":"Android-Timber-Logger","date":"2018-02-07T09:48:58.000Z","updated":"2019-12-22T12:04:27.316Z","comments":true,"path":"2018/02/07/Android-Timber-Logger/","link":"","permalink":"https://www.wangzhumo.com/2018/02/07/Android-Timber-Logger/","excerpt":"ä¸å•°å—¦äº†,ç›´æ¥å¼€å§‹. æ·»åŠ ä¾èµ– Logger orhanobut/Logger Timber JakeWharton/timber //logger implementation &#39;com.orhanobut:logger:2.1.1&#39; //timber implementation &#39;com.jakewharton.timber:timber:4.6.0&#39;","text":"ä¸å•°å—¦äº†,ç›´æ¥å¼€å§‹. æ·»åŠ ä¾èµ– Logger orhanobut/Logger Timber JakeWharton/timber //logger implementation &#39;com.orhanobut:logger:2.1.1&#39; //timber implementation &#39;com.jakewharton.timber:timber:4.6.0&#39; åˆå§‹åŒ–æˆ‘æ”¾åœ¨äº†æˆ‘çš„Application.javaä¸­åˆå§‹åŒ–çš„ /** * åˆå§‹åŒ–Timber */ private void initTimber() { //é…ç½®Logger FormatStrategy formatStrategy = PrettyFormatStrategy.newBuilder() .showThreadInfo(true) .methodCount(2) .methodOffset(7) .tag(&quot;MY_LOG&quot;) .build(); //é…ç½®Loggeråœ¨Debugæ—¶ä¸æ‰“å° Logger.addLogAdapter(new AndroidLogAdapter(formatStrategy){ @Override public boolean isLoggable(int priority, String tag) { return BuildConfig.DEBUG; } }); //ç»™Timberä¸€ä¸ªæ ‘...å¤§ç¥è¿™ä¹ˆæ‰“æ¯”å–»çš„ ğŸ˜† Timber.plant(new Timber.DebugTree(){ @Override protected void log(int priority, String tag, @NotNull String message, Throwable t) { Logger.log(priority,tag,message,t); } }); } å…¶ä¸­: showThreadInfo(true) æ˜¯å¦æ˜¾ç¤ºThreadInfo methodCount(2) æ—¥å¿—è¾“å‡ºæ—¶æ˜¾ç¤ºå‡ è¡Œ methodOffset(7) æ–¹æ³•åç§»é‡,é»˜è®¤æ˜¯5,è¿™ä¸ªè‡ªå·±è°ƒå¤§,è°ƒå°çœ‹çœ‹å°±æ˜ç™½äº† tag(&quot;MY_LOG&quot;) è‡ªå®šä¹‰çš„Tag,é»˜è®¤å€¼æ˜¯PRETTY_LOGGER ä½¿ç”¨Timber.e(&quot;ä¸‹è½½çŠ¶æ€å‘ç”Ÿæ”¹å˜ = %s&quot;, downLoadInfo.status ) Timber.e(&quot;ä¸‹è½½è¿›åº¦ = %d&quot;, mBindingView.progressBar.progress ) loggerè´Ÿè´£ç”Ÿæˆmessageçš„æ–¹æ³• private String createMessage(String message, Object... args) { return args == null || args.length == 0 ? message : String.format(message, args); } String.format(message, args)è¿™å°±èµ‹äºˆäº†æˆ‘ä»¬åœ¨å†™ä¿¡æ¯çš„æ—¶å€™ä½¿ç”¨å ä½ç¬¦.è®°å¾—è¦ç¬¦åˆformatçš„æ ¼å¼å“¦ æ€»ç»“å…¶å®æŒ‰æˆ‘ç°åœ¨çš„éœ€æ±‚,Loggerå®Œå…¨ç¬¦åˆæˆ‘,ä¸ºä»€ä¹ˆåŠ ä¸ŠTimberé‚£? Timberå¯ä»¥åšåˆ°åˆ†å‘,åˆ°æ—¶å€™æˆ‘å¯ä»¥åŠ ä¸Š DiskFileTree â€¦ ä»€ä¹ˆçš„,æ–¹ä¾¿åæœŸæœ‰å˜åŒ–çš„æ—¶å€™ä¿®æ”¹ ç„¶è€Œ,æˆ‘åœ¨Loggeré‡Œå‘ç°äº†ä¸€ä¸ªç±» com.orhanobut.logger.DiskLogAdapter åŸæ¥å®ƒå·²ç»æ”¯æŒå†™åˆ°æœ¬åœ°äº†.. å®å®å¿ƒé‡Œè‹¦","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"Jenkinsæ­å»ºAndroidè‡ªåŠ¨æ‰“åŒ…","slug":"Jenkins-Android","date":"2018-02-05T01:55:44.000Z","updated":"2019-12-22T12:09:37.553Z","comments":true,"path":"2018/02/05/Jenkins-Android/","link":"","permalink":"https://www.wangzhumo.com/2018/02/05/Jenkins-Android/","excerpt":"ä¸‹è½½å®‰è£… Jenkinsçš„ä¸‹è½½ä¸å®‰è£… ä¸‹è½½ https://jenkins.io/download/ ä¸‹è½½waråŒ… Generic Java package (.war) å› ä¸ºæ‰“ç®—ä½¿ç”¨Tomcatæ¥éƒ¨ç½²,æ‰€ä»¥éœ€è¦ä¸‹è½½waråŒ…,ä¹Ÿå¯ä»¥ç›´æ¥ä¸‹å¯¹åº”ç‰ˆæœ¬çš„å®‰è£…æ–‡ä»¶,ç›´æ¥å®‰è£… **å®‰è£…** waråŒ…æ”¾åˆ°`./apache-tomcat-7.0.77/webapps` Tomcatçš„wabappsåŒ…ä¸‹å³å¯ Tomcat (ç•¥) è®°å¾—é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡,ç­‰ä¼šæ–¹ä¾¿å¯åŠ¨ export TOMCAT_HOME=/Users/phyooos/develop/apache-tomcat-7.0.77 export PATH.....:$TOMCAT/bin","text":"ä¸‹è½½å®‰è£… Jenkinsçš„ä¸‹è½½ä¸å®‰è£… ä¸‹è½½ https://jenkins.io/download/ ä¸‹è½½waråŒ… Generic Java package (.war) å› ä¸ºæ‰“ç®—ä½¿ç”¨Tomcatæ¥éƒ¨ç½²,æ‰€ä»¥éœ€è¦ä¸‹è½½waråŒ…,ä¹Ÿå¯ä»¥ç›´æ¥ä¸‹å¯¹åº”ç‰ˆæœ¬çš„å®‰è£…æ–‡ä»¶,ç›´æ¥å®‰è£… **å®‰è£…** waråŒ…æ”¾åˆ°`./apache-tomcat-7.0.77/webapps` Tomcatçš„wabappsåŒ…ä¸‹å³å¯ Tomcat (ç•¥) è®°å¾—é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡,ç­‰ä¼šæ–¹ä¾¿å¯åŠ¨ export TOMCAT_HOME=/Users/phyooos/develop/apache-tomcat-7.0.77 export PATH.....:$TOMCAT/bin åˆå§‹åŒ–Jenkins å¯åŠ¨Jenkins,å³å¯åŠ¨tomcat $ startup.sh Using CATALINA_BASE: /Users/phyooos/develop/apache-tomcat-7.0.77 Using CATALINA_HOME: /Users/phyooos/develop/apache-tomcat-7.0.77 Using CATALINA_TMPDIR: /Users/phyooos/develop/apache-tomcat-7.0.77/temp Using JRE_HOME: /Library/Java/JavaVirtualMachines/jdk1.8.0/Contents/Home Using CLASSPATH: /Users/phyooos/develop/apache-tomcat-7.0.77/bin/bootstrap.jar:/Users/phyooos/develop/apache-tomcat-7.0.77/bin/tomcat-juli.jar Tomcat started. çœ‹åˆ°è¿™ä¸ªå°±è¯´æ˜,å·²ç»æ­£å¸¸å¯åŠ¨ è®¿é—®http://localhost:8080/jenkins/ æ‰“å¼€åéœ€è¦è¾“å…¥ä¸€ä¸ªå¯†é’¥,macçš„åœ¨jenkins/secrets/initialAdminPassword ~ âŒš 10:11:03 $ cat ~/.jenkins/secrets/initialAdminPassword 55ad44431f6d4ebdb53a7c1971d12df4 è¾“å…¥æ­¤å¯†é’¥å³å¯. åˆ›å»ºç”¨æˆ· é…ç½®Jenkins1.å®‰è£…æ’ä»¶ Build Timeout build-name-setter Credentials Binding Plugin description setter plugin Dynamic Parameter Plug-in(è¿™ä¸ªæ’ä»¶,æœä¸åˆ°äº†,å› ä¸ºå®‰å…¨é—®é¢˜è¢«å±è”½äº†) Environment Injector Plugin Git plugin GitHub Branch Source Plugin Gitlab Authentication plugin GitLab Plugin Gradle Plugin Pipeline SSH Slaves plugin SSH plugin Timestamper Upload to pgyer(ä¸Šä¼ åˆ°è’²å…¬è‹±,æ²¡æœ‰éœ€è¦çš„ä¸ç”¨å®‰è£…) Workspace Cleanup Plugin ä»¥ä¸Šæ’ä»¶,æ˜¯å¸¸ç”¨çš„æ’ä»¶,å°½é‡å…¨éƒ¨å®‰è£… 2.é…ç½®ç¯å¢ƒå˜é‡ç³»ç»Ÿç®¡ç† - å…¨å±€å·¥å…·é…ç½® éœ€è¦é…ç½® Java Git Gradle é…ç½®å¥½ä¿å­˜å³å¯ ç³»ç»Ÿç®¡ç† - ç³»ç»Ÿè®¾ç½® è®°å¾—é…ç½®gitlabæˆ–è€… githubè´¦å· 3.åˆå§‹åŒ–é¡¹ç›®åˆ›å»ºé¡¹ç›® General é€‰æ‹©å‚æ•°åŒ–æ„å»ºè¿‡ç¨‹ IS_JENKINS æ˜¯å¦Jenkinsæ‰“åŒ…,è¿™é‡Œè‚¯å®šæ˜¯ä¸€ç›´trueçš„ PRODUCT_FLAVORS ç¯å¢ƒ BUILD_TYPE æ„å»ºç‰ˆæœ¬ VERSION_NAME ç‰ˆæœ¬åå­— JENKINS_OUTPUT Apkç”Ÿæˆç›®å½• JENKINS_TIME æ—¶é—´æˆ³ è¿™äº›å‚æ•°å®šä¹‰å®Œå°±å¯ä»¥ä½¿ç”¨äº† ${å‚æ•°å} çš„å½¢å¼,è¿™äº›å‚æ•°ä¼šå†™å…¥åˆ° Appé¡¹ç›®ä¸­çš„ gradle.propertiesæ–‡ä»¶ Appé¡¹ç›®ä¸­çš„ gradle.propertiesæ–‡ä»¶ # When configured, Gradle will run in incubating parallel mode. # This option should only be used with decoupled projects. More details, visit # http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects # org.gradle.parallel=true org.gradle.jvmargs=-Xmx4608M VERSION_NAME=1.4.0 VERSION_CODE=12 IS_JENKINS=false JENKINS_OUTPUT=&#39;output/&#39; JENKINS_TIME=&#39;201802021231&#39; è¿›å…¥ä¸‹ä¸€ä¸ªé…ç½®é¡µé¢,åˆ°æºç ç®¡ç†é‚£å— åªè¦ä½ èƒ½ä¸‹è½½åˆ°æºç å³å¯,æ— æ‰€è°“éè¦å’Œæˆ‘è¿™ä¸ªä¸€è‡´,branch å°±æ˜¯æŒ‡å®šåˆ†æ”¯äº†,æˆ‘è¿™å„¿æ˜¯ dev åˆ†æ”¯ ä¸‹ä¸€ä¸ªé…ç½®æ„å»º é€‰æ‹© Invoke Gradle Tasks é‡Œé¢çš„å‘½ä»¤,æˆ‘æ¥è§£é‡Šä¸€ä¸‹ #æ¸…ç† clean #æ‰“åŒ… assemble${PRODUCT_FLAVORS}${BUILD_TYPE} #è¿™é‡Œçš„æ„æ€æ˜¯ æ‰“åŒ…æŒ‡å®šçš„ä¸€ä¸ªFLAVORç‰ˆæœ¬(Release + ç‰ˆæœ¬) #å…³äºassemble ... çš„,è¯·æœ gradle æ‰“åŒ…å‘½ä»¤ #å…¶ä»–å‚æ•° -PVERSION_NAME=${VERSION_NAME} -PVERSION_CODE=${VERSION_CODE} -PJENKINS_OUTPUT=${JENKINS_OUTPUT} -PJENKINS_TIME=${JENKINS_TIME} -PIS_JENKINS=${IS_JENKINS} #-Pæ„å‘³ç€å‚æ•° #-Påé¢æ˜¯å‚æ•°å #=${} åˆ™ä¸ºå‚æ•°å€¼,å°±æ˜¯ä¸Šé¢Generalé‡Œé¢é…ç½®çš„ æ„å»ºåæ“ä½œ å‚è€ƒ https://www.pgyer.com/doc/view/jenkins_plugin ä¿å­˜å³å¯ æ”¹é€ App ./gradle.propertiesæ–‡ä»¶ VERSION_NAME=1.4.0 VERSION_CODE=12 IS_JENKINS=false JENKINS_OUTPUT=&#39;output/&#39; JENKINS_TIME=&#39;201802021231&#39; ä»¥ä¸Šæ–‡ä»¶,å†™å®Œè¯·buildä¸€æ¬¡,ä¾¿äºbuild.gradleä¸­ä½¿ç”¨ ä½¿ç”¨jenkinsæ—¶,jenkinsä¼šæŠŠå®šä¹‰çš„å€¼æ³¨å…¥åˆ°è¿™é‡Œ,è¦†ç›–è¿™é‡Œå®šä¹‰çš„å€¼ app/build.gradle android{ defaultConfig { ... //æ­¤å¤„ä½¿ç”¨gradle.propertiesä¸­çš„å€¼ VERSION_CODEå’ŒVERSION_NAME versionCode VERSION_CODE as Integer versionName VERSION_NAME } //è‡ªå®šä¹‰apkåå­— android.applicationVariants.all { variant -&gt; //è·å–æ—¶é—´æˆ³ def timeNow = getDate() //å¦‚æœæ˜¯IS_JENKINSæ„å»º,åˆ™ä¿®æ”¹æ‰“åŒ…apkçš„ç›®å½• if (&#39;true&#39;.equals(IS_JENKINS)) { //ä½¿ç”¨JENKINS_OUTPUTçš„ç›®å½• def outputFile = JENKINS_OUTPUT //ä½¿ç”¨JENKINS_TIMEçš„æ—¶é—´æˆ³ timeNow = JENKINS_TIME //å®šä¹‰apkç›®å½• variant.getPackageApplication().outputDirectory = new File(outputFile) } variant.getPackageApplication().outputScope.apkDatas.forEach { apkData -&gt; //è¿™ä¸ªä¿®æ”¹è¾“å‡ºAPKçš„æ–‡ä»¶å apkData.outputFileName = &quot;ä¸€å·è½¦å¸‚_${variant.versionName}_${timeNow}.apk&quot; } } flavorDimensions &#39;env&#39; productFlavors { envapp { dimension &#39;env&#39; //æ­¤å¤„ä½¿ç”¨jenkinsä¼ çš„VERSION_NAME versionName VERSION_NAME manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;app&quot;] buildConfigField &quot;String&quot;, &quot;SERVER_HOST&quot;, &#39;&quot;https://app.wangzhumo.com/&quot;&#39; } envtest { dimension &#39;env&#39; //ä¸ºäº†æ–¹ä¾¿æµ‹è¯•çœ‹å‡ºå½“å‰appç¯å¢ƒ,å°±ä¸ç”¨VERSION_NAMEäº† versionName &quot;Test&quot; manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;app&quot;] buildConfigField &quot;String&quot;, &quot;SERVER_HOST&quot;, &#39;&quot;http://app-test.wangzhumo.com/&quot;&#39; } envpre { dimension &#39;env&#39; versionName &quot;Pre&quot; manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;app&quot;] buildConfigField &quot;String&quot;, &quot;SERVER_HOST&quot;, &#39;&quot;https://app-pre.wangzhumo.com/&quot;&#39; } envdev { dimension &#39;env&#39; versionName &quot;Dev&quot; manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;app&quot;] buildConfigField &quot;String&quot;, &quot;SERVER_HOST&quot;, &#39;&quot;http://192.168.1.16:8080/app2c/&quot;&#39; } //å…¶å®UMENG_CHANNEL_VALUE SERVER_HOST ä¹Ÿéƒ½å¯ä»¥ä½¿ç”¨jenkinså®šä¹‰å‚æ•°,å¹¶ä½¿ç”¨ } //ä¸€ä¸ªè·å–æ—¶é—´æˆ³çš„æ–¹æ³• static def getDate() { def date = new Date() def formattedDate = date.format(&#39;yyyyMMddHHmm&#39;) return formattedDate } } è®°å¾—æ”¹å®Œapp,ä¸Šä¼ ä»£ç å“¦ Jenkinsæ‰“åŒ… OKäº†,å¯ä»¥æ„‰å¿«çš„æ‰“åŒ…äº†,æ‰“åŒ…å®Œå°±ä¼šè‡ªåŠ¨ä¸Šä¼ åˆ°è’²å…¬è‹±.","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/tags/Server/"},{"name":"Jenkins","slug":"Jenkins","permalink":"https://www.wangzhumo.com/tags/Jenkins/"}]},{"title":"Javaä¸­String.format()çš„ä½¿ç”¨æŒ‡åŒ—","slug":"Java-String-format","date":"2018-02-04T10:16:12.000Z","updated":"2019-12-22T12:30:26.644Z","comments":true,"path":"2018/02/04/Java-String-format/","link":"","permalink":"https://www.wangzhumo.com/2018/02/04/Java-String-format/","excerpt":"æœ¬æ–‡éåŸåˆ›,æ¥è‡ªhttp://blog.csdn.net/lonely_fireworks/article/details/7962171/ è¿™é‡Œåšä¸€ä¸ªå¤‡ä»½,æ–¹ä¾¿éšæ—¶æŸ¥è¯¢","text":"æœ¬æ–‡éåŸåˆ›,æ¥è‡ªhttp://blog.csdn.net/lonely_fireworks/article/details/7962171/ è¿™é‡Œåšä¸€ä¸ªå¤‡ä»½,æ–¹ä¾¿éšæ—¶æŸ¥è¯¢ å¸¸è§„ç±»å‹çš„æ ¼å¼åŒ–Stringç±»çš„format()æ–¹æ³•ç”¨äºåˆ›å»ºæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ä»¥åŠè¿æ¥å¤šä¸ªå­—ç¬¦ä¸²å¯¹è±¡,format()æ–¹æ³•æœ‰ä¸¤ç§é‡è½½å½¢å¼ã€‚ format(String format, Objectâ€¦ args) æ–°å­—ç¬¦ä¸²ä½¿ç”¨æœ¬åœ°è¯­è¨€ç¯å¢ƒï¼Œåˆ¶å®šå­—ç¬¦ä¸²æ ¼å¼å’Œå‚æ•°ç”Ÿæˆæ ¼å¼åŒ–çš„æ–°å­—ç¬¦ä¸²ã€‚ format(Locale locale, String format, Objectâ€¦ args) ä½¿ç”¨æŒ‡å®šçš„è¯­è¨€ç¯å¢ƒï¼Œåˆ¶å®šå­—ç¬¦ä¸²æ ¼å¼å’Œå‚æ•°ç”Ÿæˆæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ã€‚ æ˜¾ç¤ºä¸åŒè½¬æ¢ç¬¦å®ç°ä¸åŒæ•°æ®ç±»å‹åˆ°å­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚ è½¬ æ¢ ç¬¦ è¯´ æ˜ ç¤º ä¾‹ %s å­—ç¬¦ä¸²ç±»å‹ â€œmingrisoftâ€ %c å­—ç¬¦ç±»å‹ â€˜mâ€™ %b å¸ƒå°”ç±»å‹ true %d æ•´æ•°ç±»å‹ï¼ˆåè¿›åˆ¶ï¼‰ 99 %x æ•´æ•°ç±»å‹ï¼ˆåå…­è¿›åˆ¶ï¼‰ FF %o æ•´æ•°ç±»å‹ï¼ˆå…«è¿›åˆ¶ï¼‰ 77 %f æµ®ç‚¹ç±»å‹ 99.99 %a åå…­è¿›åˆ¶æµ®ç‚¹ç±»å‹ FF.35AE %e æŒ‡æ•°ç±»å‹ 9.38e+5 %g é€šç”¨æµ®ç‚¹ç±»å‹ï¼ˆfå’Œeç±»å‹ä¸­è¾ƒçŸ­çš„ï¼‰ %h æ•£åˆ—ç  %% ç™¾åˆ†æ¯”ç±»å‹ ï¼… %n æ¢è¡Œç¬¦ %tx æ—¥æœŸä¸æ—¶é—´ç±»å‹ï¼ˆxä»£è¡¨ä¸åŒçš„æ—¥æœŸä¸æ—¶é—´è½¬æ¢ç¬¦ æµ‹è¯•ç”¨ä¾‹ public static void main(String[] args) { String str=null; str=String.format(&quot;Hi,%s&quot;, &quot;ç‹åŠ›&quot;); System.out.println(str); str=String.format(&quot;Hi,%s:%s.%s&quot;, &quot;ç‹å—&quot;,&quot;ç‹åŠ›&quot;,&quot;ç‹å¼ &quot;); System.out.println(str); System.out.printf(&quot;å­—æ¯açš„å¤§å†™æ˜¯ï¼š%c %n&quot;, &#39;A&#39;); System.out.printf(&quot;3&gt;7çš„ç»“æœæ˜¯ï¼š%b %n&quot;, 3&gt;7); System.out.printf(&quot;100çš„ä¸€åŠæ˜¯ï¼š%d %n&quot;, 100/2); System.out.printf(&quot;100çš„16è¿›åˆ¶æ•°æ˜¯ï¼š%x %n&quot;, 100); System.out.printf(&quot;100çš„8è¿›åˆ¶æ•°æ˜¯ï¼š%o %n&quot;, 100); System.out.printf(&quot;50å…ƒçš„ä¹¦æ‰“8.5æŠ˜æ‰£æ˜¯ï¼š%f å…ƒ%n&quot;, 50*0.85); System.out.printf(&quot;ä¸Šé¢ä»·æ ¼çš„16è¿›åˆ¶æ•°æ˜¯ï¼š%a %n&quot;, 50*0.85); System.out.printf(&quot;ä¸Šé¢ä»·æ ¼çš„æŒ‡æ•°è¡¨ç¤ºï¼š%e %n&quot;, 50*0.85); System.out.printf(&quot;ä¸Šé¢ä»·æ ¼çš„æŒ‡æ•°å’Œæµ®ç‚¹æ•°ç»“æœçš„é•¿åº¦è¾ƒçŸ­çš„æ˜¯ï¼š%g %n&quot;, 50*0.85); System.out.printf(&quot;ä¸Šé¢çš„æŠ˜æ‰£æ˜¯%d%% %n&quot;, 85); System.out.printf(&quot;å­—æ¯Açš„æ•£åˆ—ç æ˜¯ï¼š%h %n&quot;, &#39;A&#39;); } è¾“å‡ºç»“æœ Hi,ç‹åŠ› Hi,ç‹å—:ç‹åŠ›.ç‹å¼  å­—æ¯açš„å¤§å†™æ˜¯ï¼šA 3&gt;7çš„ç»“æœæ˜¯ï¼šfalse 100çš„ä¸€åŠæ˜¯ï¼š50 100çš„16è¿›åˆ¶æ•°æ˜¯ï¼š64 100çš„8è¿›åˆ¶æ•°æ˜¯ï¼š144 50å…ƒçš„ä¹¦æ‰“8.5æŠ˜æ‰£æ˜¯ï¼š42.500000 å…ƒ ä¸Šé¢ä»·æ ¼çš„16è¿›åˆ¶æ•°æ˜¯ï¼š0x1.54p5 ä¸Šé¢ä»·æ ¼çš„æŒ‡æ•°è¡¨ç¤ºï¼š4.250000e+01 ä¸Šé¢ä»·æ ¼çš„æŒ‡æ•°å’Œæµ®ç‚¹æ•°ç»“æœçš„é•¿åº¦è¾ƒçŸ­çš„æ˜¯ï¼š42.5000 ä¸Šé¢çš„æŠ˜æ‰£æ˜¯85% å­—æ¯Açš„æ•£åˆ—ç æ˜¯ï¼š41 æ­é…è½¬æ¢ç¬¦çš„æ ‡å¿— æ ‡ å¿— è¯´ æ˜ ç¤º ä¾‹ ç»“ æœ + ä¸ºæ­£æ•°æˆ–è€…è´Ÿæ•°æ·»åŠ ç¬¦å· (â€œ%+dâ€,15) +15 âˆ’ å·¦å¯¹é½ (â€œ%-5dâ€,15) \\ 15 \\ 0 æ•°å­—å‰é¢è¡¥0 (â€œ%04dâ€, 99) 0099 ç©ºæ ¼ åœ¨æ•´æ•°ä¹‹å‰æ·»åŠ æŒ‡å®šæ•°é‡çš„ç©ºæ ¼ (â€œ% 4dâ€, 99) \\ 99\\ , ä»¥â€œ,â€å¯¹æ•°å­—åˆ†ç»„ (â€œ%,fâ€, 9999.99) 9,999.990000 ( ä½¿ç”¨æ‹¬å·åŒ…å«è´Ÿæ•° (â€œ%(fâ€, -99.99) (99.990000) # å¦‚æœæ˜¯æµ®ç‚¹æ•°åˆ™åŒ…å«å°æ•°ç‚¹ï¼Œå¦‚æœæ˜¯16è¿›åˆ¶æˆ–8è¿›åˆ¶åˆ™æ·»åŠ 0xæˆ–0 (â€œ%#xâ€, 99)(â€œ%#oâ€, 99) 0x630143 &lt; æ ¼å¼åŒ–å‰ä¸€ä¸ªè½¬æ¢ç¬¦æ‰€æè¿°çš„å‚æ•° (â€œ%få’Œ%&lt;3.2fâ€, 99.45) 99.450000å’Œ99.45 $ è¢«æ ¼å¼åŒ–çš„å‚æ•°ç´¢å¼• (â€œ%1$d,%2$sâ€, 99,â€abcâ€) 99,abc æµ‹è¯•ç”¨ä¾‹ public static void main(String[] args) { String str=null; //$ä½¿ç”¨ str=String.format(&quot;æ ¼å¼å‚æ•°çš„ä½¿ç”¨ï¼š%1d,%2$s&quot;, 99,&quot;abc&quot;); System.out.println(str); //+ä½¿ç”¨ System.out.printf(&quot;æ˜¾ç¤ºæ­£è´Ÿæ•°çš„ç¬¦å·ï¼š%+dä¸%d%n&quot;, 99,-99); //è¡¥Oä½¿ç”¨ System.out.printf(&quot;æœ€ç‰›çš„ç¼–å·æ˜¯ï¼š%03d%n&quot;, 7); //ç©ºæ ¼ä½¿ç”¨ System.out.printf(&quot;Tabé”®çš„æ•ˆæœæ˜¯ï¼š% 8d%n&quot;, 7); //.ä½¿ç”¨ System.out.printf(&quot;æ•´æ•°åˆ†ç»„çš„æ•ˆæœæ˜¯ï¼š%,d%n&quot;, 9989997); //ç©ºæ ¼å’Œå°æ•°ç‚¹åé¢ä¸ªæ•° System.out.printf(&quot;ä¸€æœ¬ä¹¦çš„ä»·æ ¼æ˜¯ï¼š% 50.5få…ƒ%n&quot;, 49.8); } è¾“å‡ºç»“æœ æ ¼å¼å‚æ•°$çš„ä½¿ç”¨ï¼š99,abc æ˜¾ç¤ºæ­£è´Ÿæ•°çš„ç¬¦å·ï¼š+99ä¸-99 æœ€ç‰›çš„ç¼–å·æ˜¯ï¼š007 Tabé”®çš„æ•ˆæœæ˜¯ï¼š 7 æ•´æ•°åˆ†ç»„çš„æ•ˆæœæ˜¯ï¼š9,989,997 ä¸€æœ¬ä¹¦çš„ä»·æ ¼æ˜¯ï¼š 49.80000å…ƒ æ—¥æœŸå’Œäº‹ä»¶å­—ç¬¦ä¸²æ ¼å¼åŒ–å­—ç¬¦ä¸²æ ¼å¼ä¸­è¿˜æœ‰%txè½¬æ¢ç¬¦æ²¡æœ‰è¯¦ç»†ä»‹ç»ï¼Œå®ƒæ˜¯ä¸“é—¨ç”¨æ¥æ ¼å¼åŒ–æ—¥æœŸå’Œæ—¶ é—´çš„ã€‚%txè½¬æ¢ç¬¦ä¸­çš„xä»£è¡¨å¦å¤–çš„å¤„ç†æ—¥æœŸå’Œæ—¶é—´æ ¼å¼çš„è½¬æ¢ç¬¦ï¼Œå®ƒä»¬çš„ç»„åˆèƒ½å¤Ÿå°†æ—¥æœŸå’Œæ—¶é—´æ ¼å¼åŒ–æˆå¤šç§æ ¼å¼ã€‚ å¸¸è§æ—¥æœŸå’Œæ—¶é—´ç»„åˆçš„æ ¼å¼ è½¬ æ¢ ç¬¦ è¯´ æ˜ ç¤º ä¾‹ c åŒ…æ‹¬å…¨éƒ¨æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ æ˜ŸæœŸå…­ åæœˆ 27 14:21:20 CST 2007 F â€œå¹´-æœˆ-æ—¥â€æ ¼å¼ 2007-10-27 D â€œæœˆ/æ—¥/å¹´â€æ ¼å¼ 10/27/07 r â€œHH:MM:SS PMâ€æ ¼å¼ï¼ˆ12æ—¶åˆ¶ï¼‰ 02:25:51 ä¸‹åˆ T â€œHH:MM:SSâ€æ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ 14:28:16 R â€œHH:MMâ€æ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ 14:28 æµ‹è¯•ç”¨ä¾‹ public static void main(String[] args) { Date date=new Date(); //cçš„ä½¿ç”¨ System.out.printf(&quot;å…¨éƒ¨æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ï¼š%tc%n&quot;,date); //fçš„ä½¿ç”¨ System.out.printf(&quot;å¹´-æœˆ-æ—¥æ ¼å¼ï¼š%tF%n&quot;,date); //dçš„ä½¿ç”¨ System.out.printf(&quot;æœˆ/æ—¥/å¹´æ ¼å¼ï¼š%tD%n&quot;,date); //rçš„ä½¿ç”¨ System.out.printf(&quot;HH:MM:SS PMæ ¼å¼ï¼ˆ12æ—¶åˆ¶ï¼‰ï¼š%tr%n&quot;,date); //tçš„ä½¿ç”¨ System.out.printf(&quot;HH:MM:SSæ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ï¼š%tT%n&quot;,date); //Rçš„ä½¿ç”¨ System.out.printf(&quot;HH:MMæ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ï¼š%tR&quot;,date); } è¾“å‡ºç»“æœ å…¨éƒ¨æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ï¼šæ˜ŸæœŸä¸€ ä¹æœˆ 10 10:43:36 CST 2012 å¹´-æœˆ-æ—¥æ ¼å¼ï¼š2012-09-10 æœˆ/æ—¥/å¹´æ ¼å¼ï¼š09/10/12 HH:MM:SS PMæ ¼å¼ï¼ˆ12æ—¶åˆ¶ï¼‰ï¼š10:43:36 ä¸Šåˆ HH:MM:SSæ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ï¼š10:43:36 HH:MMæ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ï¼š10:43 å®šä¹‰æ—¥æœŸæ ¼å¼çš„è½¬æ¢ç¬¦å¯ä»¥ä½¿æ—¥æœŸé€šè¿‡æŒ‡å®šçš„è½¬æ¢ç¬¦ç”Ÿæˆæ–°å­—ç¬¦ä¸²ã€‚è¿™äº›æ—¥æœŸè½¬æ¢ç¬¦å¦‚å›¾æ‰€ç¤ºã€‚ public static void main(String[] args) { Date date=new Date(); //bçš„ä½¿ç”¨ï¼Œæœˆä»½ç®€ç§° String str=String.format(Locale.US,&quot;è‹±æ–‡æœˆä»½ç®€ç§°ï¼š%tb&quot;,date); System.out.println(str); System.out.printf(&quot;æœ¬åœ°æœˆä»½ç®€ç§°ï¼š%tb%n&quot;,date); //Bçš„ä½¿ç”¨ï¼Œæœˆä»½å…¨ç§° str=String.format(Locale.US,&quot;è‹±æ–‡æœˆä»½å…¨ç§°ï¼š%tB&quot;,date); System.out.println(str); System.out.printf(&quot;æœ¬åœ°æœˆä»½å…¨ç§°ï¼š%tB%n&quot;,date); //açš„ä½¿ç”¨ï¼Œæ˜ŸæœŸç®€ç§° str=String.format(Locale.US,&quot;è‹±æ–‡æ˜ŸæœŸçš„ç®€ç§°ï¼š%ta&quot;,date); System.out.println(str); //Açš„ä½¿ç”¨ï¼Œæ˜ŸæœŸå…¨ç§° System.out.printf(&quot;æœ¬åœ°æ˜ŸæœŸçš„ç®€ç§°ï¼š%tA%n&quot;,date); //Cçš„ä½¿ç”¨ï¼Œå¹´å‰ä¸¤ä½ System.out.printf(&quot;å¹´çš„å‰ä¸¤ä½æ•°å­—ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š%tC%n&quot;,date); //yçš„ä½¿ç”¨ï¼Œå¹´åä¸¤ä½ System.out.printf(&quot;å¹´çš„åä¸¤ä½æ•°å­—ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š%ty%n&quot;,date); //jçš„ä½¿ç”¨ï¼Œä¸€å¹´çš„å¤©æ•° System.out.printf(&quot;ä¸€å¹´ä¸­çš„å¤©æ•°ï¼ˆå³å¹´çš„ç¬¬å‡ å¤©ï¼‰ï¼š%tj%n&quot;,date); //mçš„ä½¿ç”¨ï¼Œæœˆä»½ System.out.printf(&quot;ä¸¤ä½æ•°å­—çš„æœˆä»½ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š%tm%n&quot;,date); //dçš„ä½¿ç”¨ï¼Œæ—¥ï¼ˆäºŒä½ï¼Œä¸å¤Ÿè¡¥é›¶ï¼‰ System.out.printf(&quot;ä¸¤ä½æ•°å­—çš„æ—¥ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š%td%n&quot;,date); //eçš„ä½¿ç”¨ï¼Œæ—¥ï¼ˆä¸€ä½ä¸è¡¥é›¶ï¼‰ System.out.printf(&quot;æœˆä»½çš„æ—¥ï¼ˆå‰é¢ä¸è¡¥0ï¼‰ï¼š%te&quot;,date); } è¾“å‡ºç»“æœ è‹±æ–‡æœˆä»½ç®€ç§°ï¼šSep æœ¬åœ°æœˆä»½ç®€ç§°ï¼šä¹æœˆ è‹±æ–‡æœˆä»½å…¨ç§°ï¼šSeptember æœ¬åœ°æœˆä»½å…¨ç§°ï¼šä¹æœˆ è‹±æ–‡æ˜ŸæœŸçš„ç®€ç§°ï¼šMon æœ¬åœ°æ˜ŸæœŸçš„ç®€ç§°ï¼šæ˜ŸæœŸä¸€ å¹´çš„å‰ä¸¤ä½æ•°å­—ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š20 å¹´çš„åä¸¤ä½æ•°å­—ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š12 ä¸€å¹´ä¸­çš„å¤©æ•°ï¼ˆå³å¹´çš„ç¬¬å‡ å¤©ï¼‰ï¼š254 ä¸¤ä½æ•°å­—çš„æœˆä»½ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š09 ä¸¤ä½æ•°å­—çš„æ—¥ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š10 æœˆä»½çš„æ—¥ï¼ˆå‰é¢ä¸è¡¥0ï¼‰ï¼š10 å’Œæ—¥æœŸæ ¼å¼è½¬æ¢ç¬¦ç›¸æ¯”ï¼Œæ—¶é—´æ ¼å¼çš„è½¬æ¢ç¬¦è¦æ›´å¤šã€æ›´ç²¾ç¡®ã€‚å®ƒå¯ä»¥å°†æ—¶é—´æ ¼å¼åŒ–æˆæ—¶ã€åˆ†ã€ç§’ç”šè‡³æ—¶æ¯«ç§’ç­‰å•ä½ã€‚æ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„è½¬æ¢ç¬¦å¦‚å›¾æ‰€ç¤ºã€‚ è½¬ æ¢ ç¬¦ è¯´ æ˜ ç¤º ä¾‹ H 2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰ 15 I 2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰ 03 k 2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰ 15 l 2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰ 3 M 2ä½æ•°å­—çš„åˆ†é’Ÿï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰ 03 S 2ä½æ•°å­—çš„ç§’ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰ 09 L 3ä½æ•°å­—çš„æ¯«ç§’ï¼ˆä¸è¶³3ä½å‰é¢è¡¥0ï¼‰ 015 N 9ä½æ•°å­—çš„æ¯«ç§’æ•°ï¼ˆä¸è¶³9ä½å‰é¢è¡¥0ï¼‰ 562000000 p å°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®° ä¸­ï¼šä¸‹åˆè‹±ï¼špm z ç›¸å¯¹äºGMTçš„RFC822æ—¶åŒºçš„åç§»é‡ +0800 Z æ—¶åŒºç¼©å†™å­—ç¬¦ä¸² CST s 1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•° 1193468128 Q 1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ¯«ç§’æ•° 1193468128984 æµ‹è¯•ä»£ç  public static void main(String[] args) { Date date = new Date(); //Hçš„ä½¿ç”¨ System.out.printf(&quot;2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:%tH%n&quot;, date); //Içš„ä½¿ç”¨ System.out.printf(&quot;2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:%tI%n&quot;, date); //kçš„ä½¿ç”¨ System.out.printf(&quot;2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰:%tk%n&quot;, date); //lçš„ä½¿ç”¨ System.out.printf(&quot;2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰:%tl%n&quot;, date); //Mçš„ä½¿ç”¨ System.out.printf(&quot;2ä½æ•°å­—çš„åˆ†é’Ÿï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:%tM%n&quot;, date); //Sçš„ä½¿ç”¨ System.out.printf(&quot;2ä½æ•°å­—çš„ç§’ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:%tS%n&quot;, date); //Lçš„ä½¿ç”¨ System.out.printf(&quot;3ä½æ•°å­—çš„æ¯«ç§’ï¼ˆä¸è¶³3ä½å‰é¢è¡¥0ï¼‰:%tL%n&quot;, date); //Nçš„ä½¿ç”¨ System.out.printf(&quot;9ä½æ•°å­—çš„æ¯«ç§’æ•°ï¼ˆä¸è¶³9ä½å‰é¢è¡¥0ï¼‰:%tN%n&quot;, date); //pçš„ä½¿ç”¨ String str = String.format(Locale.US, &quot;å°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®°(è‹±)ï¼š%tp&quot;, date); System.out.println(str); System.out.printf(&quot;å°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®°ï¼ˆä¸­ï¼‰ï¼š%tp%n&quot;, date); //zçš„ä½¿ç”¨ System.out.printf(&quot;ç›¸å¯¹äºGMTçš„RFC822æ—¶åŒºçš„åç§»é‡:%tz%n&quot;, date); //Zçš„ä½¿ç”¨ System.out.printf(&quot;æ—¶åŒºç¼©å†™å­—ç¬¦ä¸²:%tZ%n&quot;, date); //sçš„ä½¿ç”¨ System.out.printf(&quot;1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•°ï¼š%ts%n&quot;, date); //Qçš„ä½¿ç”¨ System.out.printf(&quot;1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ï¼š%tQ%n&quot;, date); } è¾“å‡ºç»“æœ 2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:11 2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:11 2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰:11 2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰:11 2ä½æ•°å­—çš„åˆ†é’Ÿï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:03 2ä½æ•°å­—çš„ç§’ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:52 3ä½æ•°å­—çš„æ¯«ç§’ï¼ˆä¸è¶³3ä½å‰é¢è¡¥0ï¼‰:773 9ä½æ•°å­—çš„æ¯«ç§’æ•°ï¼ˆä¸è¶³9ä½å‰é¢è¡¥0ï¼‰:773000000 å°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®°(è‹±)ï¼šam å°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®°ï¼ˆä¸­ï¼‰ï¼šä¸Šåˆ ç›¸å¯¹äºGMTçš„RFC822æ—¶åŒºçš„åç§»é‡:+0800 æ—¶åŒºç¼©å†™å­—ç¬¦ä¸²:CST 1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•°ï¼š1347246232 1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ï¼š1347246232773","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"Room --AppDatabase_Impl does not existçš„å¼‚å¸¸è§£å†³","slug":"Room-AppDatabase-Impl-does-not-exist","date":"2018-01-17T09:08:28.000Z","updated":"2019-12-22T12:07:03.590Z","comments":true,"path":"2018/01/17/Room-AppDatabase-Impl-does-not-exist/","link":"","permalink":"https://www.wangzhumo.com/2018/01/17/Room-AppDatabase-Impl-does-not-exist/","excerpt":"Bugå¦‚ä¸‹: Caused by: java.lang.RuntimeException: cannot find implementation for com.wangzhumo.app.datasource.database.AppDB. AppDB_Impl does not exist","text":"Bugå¦‚ä¸‹: Caused by: java.lang.RuntimeException: cannot find implementation for com.wangzhumo.app.datasource.database.AppDB. AppDB_Impl does not exist å¯»æ‰¾åŸå› debugä¾æ¬¡å‘ç°: getInstance()ä¸ºç©º public static AppDB getInstance(Context context) { if (sInstance == null) { synchronized (AppDB.class) { if (sInstance == null) { //æ­¤å¤„è¿”å›ä¸ºç©º sInstance = buildDatabase(context); sInstance.updateDatabaseCreated(context); } } } return sInstance; } buildDatabase(context) è¿”å›ä¸ºç©º /** * Build the database. * creates a new instance of the database. */ private static AppDB buildDatabase(final Context appContext) { AppDB appDB = Room.databaseBuilder(appContext, AppDB.class, DATABASE_NAME) .addCallback(new Callback() { @Override public void onCreate(@NonNull SupportSQLiteDatabase db) { super.onCreate(db); AppDB database = AppDB.getInstance(appContext); database.setDatabaseCreated(); } @Override public void onOpen(@NonNull SupportSQLiteDatabase db) { super.onOpen(db); Log.e(TAG, &quot;onOpen: &quot; + db.getPath()); } }).build(); return appDB; } databaseBuilderæ˜¯åˆ›å»ºæ•°æ®åº“çš„æ–¹æ³•,ä½†æ˜¯å®ƒæ„å»ºå¤±è´¥äº†,é‚£ä¹ˆå‰©ä¸‹çš„å°±æ˜¯æºç äº† Debugæºç  databaseBuilder æ–¹æ³• @SuppressWarnings(&quot;WeakerAccess&quot;) @NonNull public static &lt;T extends RoomDatabase&gt; RoomDatabase.Builder&lt;T&gt; databaseBuilder( @NonNull Context context, @NonNull Class&lt;T&gt; klass, @NonNull String name) { //noinspection ConstantConditions if (name == null || name.trim().length() == 0) { throw new IllegalArgumentException (&quot;Cannot build a database with null or empty name.&quot; + &quot; If you are trying to create an in memory database, use Room&quot; + &quot;.inMemoryDatabaseBuilder&quot;); } return new RoomDatabase.Builder&lt;&gt;(context, klass, name); } æˆ‘ä»¬å¯ä»¥æ˜æ˜¾çš„çœ‹å‡º,æ­¤å¤„æŠ›å‡ºçš„å¼‚å¸¸ä¸æ˜¯AppDB_Impl does not exist çš„æç¤º,å¯ä»¥è‚¯å®šå¹¶ä¸æ˜¯æ­¤å¤„çš„é—®é¢˜ åº”è¯¥æ˜¯æ­£å¸¸è¿”å›çš„ return new RoomDatabase.Builder&lt;&gt;(context, klass, name); RoomDatabase.Builder é‚£ä¹ˆå‡ºé—®é¢˜çš„å°±å¯ä»¥è‚¯å®šæ˜¯ build()æ–¹æ³• @NonNull public T build() { //noinspection ConstantConditions if (mContext == null) { throw new IllegalArgumentException (&quot;Cannot provide null context for the database.&quot;); } //noinspection ConstantConditions if (mDatabaseClass == null) { throw new IllegalArgumentException (&quot;Must provide an abstract class that&quot; + &quot; extends RoomDatabase&quot;); } if (mFactory == null) { mFactory = new FrameworkSQLiteOpenHelperFactory(); } DatabaseConfiguration configuration = new DatabaseConfiguration(mContext, mName, mFactory, mMigrationContainer, mCallbacks, mAllowMainThreadQueries, mRequireMigration); T db = Room.getGeneratedImplementation(mDatabaseClass, DB_IMPL_SUFFIX); db.init(configuration); return db; } æ­¤å¤„,debugå‘ç°,æ˜¯åˆ° T db = Room.getGeneratedImplementation(mDatabaseClass, DB_IMPL_SUFFIX); æŠ›å‡ºå¼‚å¸¸çš„. é”å®šé—®é¢˜getGeneratedImplementation @NonNull static &lt;T, C&gt; T getGeneratedImplementation(Class&lt;C&gt; klass, String suffix) { final String fullPackage = klass.getPackage().getName(); String name = klass.getCanonicalName(); final String postPackageName = fullPackage.isEmpty() ? name : (name.substring(fullPackage.length() + 1)); final String implName = postPackageName.replace(&#39;.&#39;, &#39;_&#39;) + suffix; //noinspection TryWithIdenticalCatches try { @SuppressWarnings(&quot;unchecked&quot;) final Class&lt;T&gt; aClass = (Class&lt;T&gt;) Class.forName( fullPackage.isEmpty() ? implName : fullPackage + &quot;.&quot; + implName); return aClass.newInstance(); } catch (ClassNotFoundException e) { //**å¾ˆæ˜æ˜¾,å°±æ˜¯è¿™ä¸ªåœ°æ–¹äº†** throw new RuntimeException(&quot;cannot find implementation for &quot; + klass.getCanonicalName() + &quot;. &quot; + implName + &quot; does not exist&quot;); } catch (IllegalAccessException e) { throw new RuntimeException(&quot;Cannot access the constructor&quot; + klass.getCanonicalName()); } catch (InstantiationException e) { throw new RuntimeException(&quot;Failed to create an instance of &quot; + klass.getCanonicalName()); } } å…¶å®å°±æ˜¯,ç”Ÿæˆç±»å¤±è´¥äº† å…¶ä»–å‚æ•°éƒ½æ­£å¸¸,ååç”Ÿæˆå¤±è´¥,æ‰€ä»¥å°±æ€€ç–‘åˆ° Java -&gt; apt çš„é—®é¢˜ Kotlin -&gt; kaptçš„é—®é¢˜ è¿™ä¸¤ä¸ªå°±æ˜¯ç”¨æ¥ç”Ÿæˆä»£ç çš„,è¿™é‡Œçš„ç”Ÿæˆå¤±è´¥,æœ‰å¾ˆå¤§æ¦‚ç‡æ˜¯è¿™ä¸ªé—®é¢˜ è§£å†³é—®é¢˜æŸ¥çœ‹é¡¹ç›®çš„ä¾èµ– lib_opensource -&gt; build.gradle //arch api deps.archLibs.archExtensions api deps.archLibs.archLifecycleCommon api deps.archLibs.archRoomRuntime kapt deps.archLibs.archRoomCompiler æŸ¥çœ‹å‘ç°,æˆ‘å·²ç»æ·»åŠ äº†,é‚£ä¹ˆä»€ä¹ˆé¬¼é—®é¢˜å‘¢? æ€€ç–‘æ˜¯libraryçš„é—®é¢˜,æ‰“å¼€æˆ‘ä½¿ç”¨Roomçš„library ,æŸ¥çœ‹ lib_datasource -&gt; build.gradle apply plugin: &#39;com.android.library&#39; ... dependencies { implementation fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;]) api project(&#39;:lib_opensource&#39;) // kapt deps.archLibs.archRoomCompiler } æœç„¶å¿˜äº†åŠ  apply plugin: &#39;com.android.library&#39; apply plugin: &#39;kotlin-android&#39; apply plugin: &#39;kotlin-kapt&#39; ... dependencies { implementation fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;]) api project(&#39;:lib_opensource&#39;) // kapt deps.archLibs.archRoomCompiler } å°±Okäº†,æˆ‘åˆå¯ä»¥æ„‰å¿«çš„ç©è€äº† è®°å¾—: kapt","categories":[{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/categories/Bug/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/tags/Bug/"},{"name":"Room","slug":"Room","permalink":"https://www.wangzhumo.com/tags/Room/"}]},{"title":"ä½¿ç”¨CharlesæŠ“Httpsçš„æ•°æ®è¯·æ±‚","slug":"Charles-Https","date":"2018-01-11T08:09:46.000Z","updated":"2019-12-22T12:11:44.185Z","comments":true,"path":"2018/01/11/Charles-Https/","link":"","permalink":"https://www.wangzhumo.com/2018/01/11/Charles-Https/","excerpt":"ä¹‹å‰çš„æ–‡ç« ä¸­ç»™é¡¹ç›®ä¸­åŠ å…¥äº†Https,æ­¤æ—¶ä½¿ç”¨charlesæŠ“åŒ…å°±æ˜¯ä¸€å †ä¹±ç , ä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦å¸¸å¸¸ä½¿ç”¨Charles,è°ƒè¯•æ¥å£,æŸ¥æ‰¾é—®é¢˜ç­‰,æ‰€ä»¥å°±è¦è®©Charlesä½œä¸ºä¸€ä¸ªä¸­é—´äºº,å¸®æˆ‘ä»¬æ¥æ”¶è½¬å‘è¯·æ±‚ ä»¥è¾¾åˆ°æŠ“åŒ…çš„æ•ˆæœ,å…¶å®æ­¤æ—¶å·²ç»å®Œå…¨æ˜¯Charlesä¸æœåŠ¡å™¨ä¹‹é—´çš„äº‹äº†.","text":"ä¹‹å‰çš„æ–‡ç« ä¸­ç»™é¡¹ç›®ä¸­åŠ å…¥äº†Https,æ­¤æ—¶ä½¿ç”¨charlesæŠ“åŒ…å°±æ˜¯ä¸€å †ä¹±ç , ä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦å¸¸å¸¸ä½¿ç”¨Charles,è°ƒè¯•æ¥å£,æŸ¥æ‰¾é—®é¢˜ç­‰,æ‰€ä»¥å°±è¦è®©Charlesä½œä¸ºä¸€ä¸ªä¸­é—´äºº,å¸®æˆ‘ä»¬æ¥æ”¶è½¬å‘è¯·æ±‚ ä»¥è¾¾åˆ°æŠ“åŒ…çš„æ•ˆæœ,å…¶å®æ­¤æ—¶å·²ç»å®Œå…¨æ˜¯Charlesä¸æœåŠ¡å™¨ä¹‹é—´çš„äº‹äº†. å¯¼å‡ºè¯ä¹¦1.æ‰“å¼€Charles 2.Help -&gt; SSL Proxying -&gt; Save Charles Root Certificateâ€¦ 3.ä¿å­˜åˆ°~/Downloads/charles-ssl-proxying-certificate.pem å®‰è£…è¯ä¹¦åˆ°è®¾å¤‡1.æŠŠè¯ä¹¦æ¨é€åˆ°è®¾å¤‡ $ adb push charles-ssl-proxying-certificate.pem /sdcard/Download/ charles-ssl-proxying-certificate.pem: 1 file pushed. 0.1 MB/s (1921 bytes in 0.012s) 2.å®‰è£…è¯ä¹¦ è®¾ç½® -&gt; å®‰å…¨ -&gt; è®¾å¤‡ç®¡ç†ä¸å‡­è¯ -&gt; ä»å­˜å‚¨å®‰è£… -&gt; charles-ssl-proxying-certificate.pemâ€™ è®¾ç½®Charles1.Proxy -&gt; SSL Proxying Settings 2.æ‰“å¼€æ‰‹æœº,å¼€å§‹è¯·æ±‚","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Https","slug":"Https","permalink":"https://www.wangzhumo.com/tags/Https/"}]},{"title":"Androidå¼€å‘ä¸­å¸¸ç”¨çš„Adbå‘½ä»¤","slug":"Android-shell-Adb","date":"2018-01-11T04:07:40.000Z","updated":"2019-12-22T12:12:27.503Z","comments":true,"path":"2018/01/11/Android-shell-Adb/","link":"","permalink":"https://www.wangzhumo.com/2018/01/11/Android-shell-Adb/","excerpt":"åœ¨åšè¿™äº›ä¹‹å‰,å…ˆé…ç½®å¥½adbç¯å¢ƒå˜é‡,ä»¥æˆ‘çš„é…ç½®ä¸ºä¾‹ $ vim ~/.bash_profile export ANDROID_HOME=/Users/phyooos/Library/Android/sdk ... export PATH={çœç•¥}:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools $ source ~/.bas $ adb Android Debug Bridge version 1.0.39 Version 0.0.1-4500957 Installed as /Users/phyooos/Library/Android/sdk/platform-tools/adb ... è¡¥å…… adb shell pm list packages å½“å‰æ‰‹æœºå®‰è£…çš„æ‰€æœ‰appåŒ…åadb shell pm list packages | grep â€˜googleâ€™ åœ¨æ‰€æœ‰åŒ…åä¸­æŸ¥æ‰¾å¸¦â€™googleâ€™çš„","text":"åœ¨åšè¿™äº›ä¹‹å‰,å…ˆé…ç½®å¥½adbç¯å¢ƒå˜é‡,ä»¥æˆ‘çš„é…ç½®ä¸ºä¾‹ $ vim ~/.bash_profile export ANDROID_HOME=/Users/phyooos/Library/Android/sdk ... export PATH={çœç•¥}:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools $ source ~/.bas $ adb Android Debug Bridge version 1.0.39 Version 0.0.1-4500957 Installed as /Users/phyooos/Library/Android/sdk/platform-tools/adb ... è¡¥å…… adb shell pm list packages å½“å‰æ‰‹æœºå®‰è£…çš„æ‰€æœ‰appåŒ…åadb shell pm list packages | grep â€˜googleâ€™ åœ¨æ‰€æœ‰åŒ…åä¸­æŸ¥æ‰¾å¸¦â€™googleâ€™çš„ è¿æ¥è®¾å¤‡æ‰“å¼€å¼€å‘è€… -&gt; æ‰“å¼€è°ƒè¯• -&gt; å…è®¸è°ƒè¯• é€šè¿‡usbè¿æ¥ é€šè¿‡wifiè¿æ¥ ä¿è¯Androidè®¾å¤‡ä¸ç”µè„‘åœ¨å±€åŸŸç½‘ä¸­,ç½‘æ®µå¥½åƒä¹Ÿè¦ä¸€è‡´ eg: 192.168.2.98 , 192.168.2.111 ~ âŒš 9:44:55 $ adb connect 192.168.6.51 unable to connect to 192.168.6.51:5555: Connection refused æ­¤æ—¶æ˜¯è¿æ¥ä¸ä¸Šçš„,è¦å…ˆtcpip 5555,å¦‚ä¸‹: #ä½¿ç”¨Tcpå¹¶ç›‘å¬ç«¯å£5555 adb tcpip 5555 #è¿æ¥è®¾å¤‡ adb connect 192.168.6.51 å¦‚æœä½ æƒ³ç”¨usbè°ƒè¯• #ä½¿ç”¨usbè°ƒè¯• adb usb PS:æœ‰çš„è®¾å¤‡ç›´æ¥adb connect å³å¯,æ‰€ä»¥ä¸å¦¨å…ˆè¯•è¯• æŸ¥çœ‹è®¾å¤‡ æŸ¥çœ‹æ‰€æœ‰è¿æ¥çš„è®¾å¤‡ $ adb devices List of devices attached 3080b82d device 860BCML228J8 device æŒ‡å®š\bè®¾å¤‡(adb å‘½ä»¤å¿…é¡»æŒ‡å®šä¸€ä¸ªè®¾å¤‡ä½¿ç”¨) abd -s ç¼–å· å‘½ä»¤ æ¯”å¦‚æˆ‘è¦è¿æ¥3080b82d device è¿™ä¸ªè®¾å¤‡,å®‰è£…ä¸€ä¸ªapk eg: $ adb -s 3080b82d install Test.apk Success å®‰è£…,å¸è½½apk å®‰è£…$ adb -s 3080b82d install Users/phyooos/develop/Test.apk Success install è·Ÿä¸Šapkçš„pathå³å¯ install å¯ä»¥æ­é…å‡ ä¸ªå‚æ•°ä½¿ç”¨,æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ install -r æ›¿æ¢æ‰åŸæ¥çš„apk.(è¢«ç§°ä¸ºå¼ºåˆ¶å®‰è£…) è‡³äºå…¶ä»–çš„å‚æ•°å»googleå®˜ç½‘çœ‹å§ install -t å¯ä»¥å®‰è£…æµ‹è¯•åŒ… å¸è½½ adb uninstall [è½¯ä»¶åŒ…å] adb uninstall -k [è½¯ä»¶åŒ…å] -k å‚æ•°,å¸è½½è½¯ä»¶ä½†æ˜¯ä¿ç•™é…ç½®å’Œç¼“å­˜æ–‡ä»¶. åŒ…åä½¿ç”¨æ–‡ç« å¼€å§‹çš„å‘½ä»¤æŸ¥æ‰¾å³å¯(å½“å‰æœ‰ä¸¤ä¸ªæ‰‹æœº,è¿˜è¦æŒ‡å®šè®¾å¤‡) $ adb -s 3080b82d shell pm list packages | grep &#39;miui&#39; package:com.miui.screenrecorder package:com.miui.contentextension package:com.miui.powerkeeper ... æ‹‰å–,æ¨é€æ–‡ä»¶ å‘é€æ–‡ä»¶åˆ°Androidè®¾å¤‡ adb push [æœ¬åœ°è·¯å¾„] [è¿œç¨‹è·¯å¾„] ä»Androidè®¾å¤‡ä¸­ä¸‹è½½æ–‡ä»¶ adb pull [è¿œç¨‹è·¯å¾„] [æœ¬åœ°è·¯å¾„] æˆªå›¾å½•å± æˆªå›¾adb shell screencap [path] adb shell screencap /sdcard/screen.png #æˆªå›¾å¹¶ä¿å­˜åˆ°/sdcard/screen.png å½•å±adb shell screenrecord [path] adb shell screenrecord /sdcard/demo.mp4 #å½•å± æ³¨æ„: æŒ‰Ctrl-C ç»“æŸå½•åˆ¶ adb shell screenrecord --size &lt;WIDTHxHEIGHT&gt; adb shell screenrecord --bit-rate &lt;RATE&gt; adb shell screenrecord --bit-rate 5000000 /sdcard/demo.mp4 adb shell screenrecord --time-limit &lt;TIME&gt; adb shell screenrecord --rotate adb shell screenrecord --verbose Package æŸ¥çœ‹ç³»ç»Ÿå†…appä¿¡æ¯ adb shell pm list packages æŸ¥çœ‹å½“å‰æ‰€æœ‰åŒ… adb shell pm list packages $ adb shell pm list packages package:com.flyme.roamingpay package:com.android.cts.priv.ctsshim package:com.meizu.pps package:com.meizu.net.pedometer package:com.android.providers.telephony ç³»ç»Ÿåº”ç”¨ adb shell pm list packages -s $ adb shell pm list packages -s package:com.miui.screenrecorder package:com.android.cts.priv.ctsshim package:com.qualcomm.qti.auth.sampleextauthservice package:com.qualcomm.qti.perfdump ... æ™®é€šå¤–æ¥åº”ç”¨ adb shell pm list packages -3 $ adb shell pm list packages -3 package:com.google.android.youtube package:com.hpbr.bosszhipin package:de.blinkt.openvpn package:org.iggymedia.periodtracker package:com.daimajia.gold å…¶ä»–å‚æ•° #See their associated file. adb shell pm list packages -f #Filter to only show disabled packages. adb shell pm list packages -d #Filter to only show enabled packages. adb shell pm list packages -e #See the installer for the packages. adb shell pm list packages -i #Also include uninstalled packages. adb shell pm list packages -u é€šè¿‡åŒ…åæŸ¥æ‰¾appä½ç½® adb shell pm path [packagename] $ adb shell pm path com.miui.screenrecorder package:/system/app/MiuiScreenRecorder/MiuiScreenRecorder.apk æ¸…é™¤ç¼“å­˜adb shell pm clear [packageName] æ¸…é™¤äº†è¯¥appçš„ data cache $ adb shell pm clear com.yhcs.carmart Success shellæˆ‘ä»¬çŸ¥é“androidå…¶å®ç²¾ç®€äº†linuxçš„å‘½ä»¤,æœ‰ä¸€å¤§éƒ¨åˆ†linuxå‘½ä»¤æ²¡æ³•ç”¨çš„ $ adb shell #å³å¯è¿›å…¥ å¦‚æœè¦rootæƒé™,å›½å†…æ‰‹æœºå¥½åƒä¸ä¸€è‡´,æˆ‘æ˜¯ç”¨è¿‡çš„ä¸º $ adb root $ adb shell æ­¤æ—¶æƒé™å°±æ˜¯root è¿›å…¥shellå,å°±å¯ä»¥ä¸ºæ‰€æ¬²ä¸º,ä¸€èˆ¬å’Œlinuxä¸€è‡´ ä¸è¿‡è¿™äº›,è¿˜æ˜¯ç®¡ç”¨çš„ ls , cd , rm , mkdir , touch , pwd ,cp , mv ,netstat , ping, ip ä¸¾ä¸€ä¸ªä¾‹å­,æˆ‘æƒ³æŸ¥çœ‹å½“å‰wifiçš„ipæ˜¯å¤šå°‘. $ adb shell sagit:/ $ ip -f inet addr show wlan0 23: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 3000 inet 192.168.6.51/23 brd 192.168.7.255 scope global wlan0 valid_lft forever preferred_lft forever sagit:/ $ #ip inet 192.168.6.51 è¿™ä¸ªå°±æ˜¯ Logcatadb logcat [option] [filter] æŸ¥çœ‹log adb logcat é€šè¿‡ control + c é€€å‡º æŸ¥çœ‹Debugçš„log adb logcat *:D Logcat,è¿˜æ˜¯Android studio çœ‹èµ·æ¥æ–¹ä¾¿,æ‰€ä»¥æ²¡æœ‰ç»§ç»­å»çœ‹,ä¹Ÿå°±ä¸è¯´äº† dumpsysè¿™æ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„å‘½ä»¤ ç”µé‡ adb shell dumpsys battery æœåŠ¡åˆ—è¡¨ adb shell dumpsys ä¸‹é¢çš„å‘½ä»¤ | more æ˜¯ä¸ºäº†æ˜¾ç¤ºæ‰€æœ‰çš„æ•°æ® $ adb shell dumpsys | more Currently running services: DockObserver MiuiBackup MiuiInit SurfaceFlinger accessibility account activity alarm ... è¿™ä¸ªCurrently running services æ‰€æœ‰çš„é¡¹ç›®,éƒ½å¯ä»¥è¯¦ç»†æŸ¥è¯¢ æŸ¥è¯¢å•ä¸ªservice adb shell dumpsys [service name] æå‡ ä¸ªä¾‹å­çœ‹çœ‹: å±å¹•åˆ†è¾¨ç‡adb shell dumpsys window displays $ adb shell dumpsys window displays WINDOW MANAGER DISPLAY CONTENTS (dumpsys window displays) Display: mDisplayId=0 init=1080x1920 480dpi cur=1080x1920 app=1080x1920 rng=1080x1020-1920x1860 deferred=false mLayoutNeeded=false å…¶ä¸­: init=1080x1920 åˆ†è¾¨ç‡ 480dpi dpiå€¼ activityä¿¡æ¯adb shell dumpsys activity æ¯”å¦‚æˆ‘æƒ³çœ‹çœ‹æˆ‘activityçš„ä¿¡æ¯adb shell dumpsys activity | grep &#39;com.yhcs.carmart&#39; $ adb shell dumpsys activity | grep &quot;com.yhcs.carmart&quot; * com.yhcs.carmart: 2 items #0: PendingIntentRecord{c526be3 com.yhcs.carmart startService} #1: PendingIntentRecord{8949e0 com.yhcs.carmart broadcastIntent} -&gt; 8161:com.yhcs.carmart/u0a460 s1/1 u0/0 +44s372ms -&gt; 8556:com.yhcs.carmart:channel/u0a460 s1/1 u0/0 +33s684ms ... * Recent #0: TaskRecord{6019b81 #14799 A=com.yhcs.carmart U=0 StackId=1 sz=1} packageName=com.yhcs.carmart processName=com.yhcs.carmart launchedFromUid=10460 launchedFromPackage=com.yhcs.carmart userId=0 app=ProcessRecord{3c52934 8161:com.yhcs.carmart/u0a460} Intent { cmp=com.yhcs.carmart/.ui.main.MainActivity } frontOfTask=true task=TaskRecord{6019b81 #14799 A=com.yhcs.carmart U=0 StackId=1 sz=1} taskAffinity=com.yhcs.carmart realActivity=com.yhcs.carmart/.ui.main.MainActivity ç°åœ¨æŒ‡å®šæŸ¥çœ‹è¿™ä¸ªactivity $ adb shell dumpsys activity com.yhcs.carmart/.ui.main.MainActivity TASK com.yhcs.carmart id=14799 userId=0 ACTIVITY com.yhcs.carmart/.ui.main.MainActivity a99200b pid=8161 Local Activity 90efa41 State: mResumed=false mStopped=true mFinished=false mChangingConfigurations=false mCurrentConfig={1.0 460mcc11mnc [zh_CN] ldltr sw360dp w360dp h620dp 480dpi nrml long port finger -keyb/v/h -nav/h appBounds=Rect(0, 0 - 1080, 1920) s.12 themeChanged=0 themeChangedFlags=0} ... View Hierarchy: DecorView@ce71c9e[MainActivity] android.widget.LinearLayout{6106377 V.E...... ......ID 0,0-1080,1920} ... Active Fragments ... é‡Œé¢æœ‰å¾ˆå¤šä¿¡æ¯","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"OkHttpä¸­æ·»åŠ httpsæ”¯æŒ","slug":"OkHttp-support-https","date":"2018-01-10T08:43:57.000Z","updated":"2019-12-22T12:08:02.765Z","comments":true,"path":"2018/01/10/OkHttp-support-https/","link":"","permalink":"https://www.wangzhumo.com/2018/01/10/OkHttp-support-https/","excerpt":"åŸºç¡€çŸ¥è¯† æ„Ÿè§‰å°±æ˜¯ä¸€å †æœ‰ä¿¡èª‰çš„æœºæ„,è¯´: æˆ‘ä»¬è¿™äº›æœºæ„çš„å…¬é’¥æ˜¯å¯ä¿¡çš„,æˆ‘ä»¬ä¸‹é¢çš„å°å¼Ÿå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥ä¿¡ä»»çš„å•¦ ç„¶åå¤§å®¶å°±å»å½“äººå®¶å°å¼Ÿ,å°±æ˜¯å¯ä¿¡çš„äº†â€¦. å½“ç„¶è¿™é‡Œé¢æœ‰çš„å¤§ä½¬ä¸é«˜å…´,å°±è‡ªå·±æä¸€å¥—è¯ä¹¦,æ¯”å¦‚12306","text":"åŸºç¡€çŸ¥è¯† æ„Ÿè§‰å°±æ˜¯ä¸€å †æœ‰ä¿¡èª‰çš„æœºæ„,è¯´: æˆ‘ä»¬è¿™äº›æœºæ„çš„å…¬é’¥æ˜¯å¯ä¿¡çš„,æˆ‘ä»¬ä¸‹é¢çš„å°å¼Ÿå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥ä¿¡ä»»çš„å•¦ ç„¶åå¤§å®¶å°±å»å½“äººå®¶å°å¼Ÿ,å°±æ˜¯å¯ä¿¡çš„äº†â€¦. å½“ç„¶è¿™é‡Œé¢æœ‰çš„å¤§ä½¬ä¸é«˜å…´,å°±è‡ªå·±æä¸€å¥—è¯ä¹¦,æ¯”å¦‚12306 Httpsä¸­,å€¼å¾—æ³¨æ„çš„å¯†é’¥æœ‰: æœåŠ¡å™¨ç«¯çš„å…¬é’¥å’Œç§é’¥ å®¢æˆ·ç«¯çš„éšæœºå¯†é’¥ å€¼å¾—æ³¨æ„çš„æ˜¯ä¸€ä¸ªHTTPSè¯·æ±‚å®é™…ä¸Šå°±æ˜¯ä¸¤æ¬¡HTTPä¼ è¾“. 1.å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·HTTPSè¯·æ±‚ï¼Œè¿æ¥åˆ°æœåŠ¡å™¨çš„443ç«¯å£ã€‚ 2.æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚,å‘å®¢æˆ·ç«¯å‘é€è‡ªå·±çš„å…¬é’¥ 3.å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨å…¬é’¥,å¼€å§‹éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§,æˆ‘ä»¬çŸ¥é“ç³»ç»Ÿå†…ç½®äº†ä¸€äº›è¯ä¹¦,åº”è¯¥æ˜¯å«é¡¶çº§è¯ä¹¦å§ æˆ‘ä»¬çš„è¯ä¹¦å¹¶ä¸æ˜¯å•¥å¤§æœºæ„å‘çš„,è‚¯å®šä¸åœ¨é‡Œé¢,é‚£ä¹ˆå°±æ²¡æ³•éªŒè¯åˆæ³•. åˆæ³• &gt; ç»§ç»­ ä¸åˆæ³• &gt; æ­¤æ¬¡Httpsè¯·æ±‚ç»ˆæ­¢ 4.å®¢æˆ·ç«¯éªŒè¯å…¬é’¥åˆæ ¼å(ä¹Ÿå°±æ˜¯ç»™ä½ å‘æ¶ˆæ¯çš„æœåŠ¡å™¨æ˜¯æ­£ç»æœåŠ¡å™¨)ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯ä¼šç”Ÿæˆä¸€ä¸ª éšæœºå¯†ç ,å®¢æˆ·ç«¯ä¼šæ‹¿ç€è¿™ä¸ªéšæœºå¯†ç å’Œåˆšæ‰æ”¶åˆ°çš„æœåŠ¡å™¨å¯†é’¥åšéå¯¹ç§°åŠ å¯† &gt;&gt; å¾—åˆ°å¯†æ–‡çš„å¯†ç  â€”â€”â€“ä»¥ä¸Šç¬¬ä¸€æ¬¡httpè¯·æ±‚ç»“æŸäº†â€”â€”â€“ 5.å®¢æˆ·ç«¯ä¼šå‘èµ·HTTPSä¸­çš„ç¬¬äºŒä¸ªHTTPè¯·æ±‚,å‘é€å®¢æˆ·ç«¯å¯†é’¥(å¯†æ–‡)ç»™æœåŠ¡å™¨ã€‚ 6.æœåŠ¡å™¨æ”¶åˆ°å¯†æ–‡ï¼Œä¼šç”¨è‡ªå·±çš„ç§é’¥å¯¹å…¶è¿›è¡Œéå¯¹ç§°è§£å¯†,å¾—åˆ°å®¢æˆ·ç«¯åˆšæ‰ç”Ÿæˆçš„å®¢æˆ·ç«¯éšæœºå¯†ç . æ­¤æ—¶æœåŠ¡å™¨ä½¿ç”¨å®¢æˆ·ç«¯éšæœºå¯†ç ,å¯¹æ•°æ®è¿›è¡Œå¯¹ç§°åŠ å¯† 7.æŠŠå¯¹ç§°åŠ å¯†åçš„æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯,å®¢æˆ·ç«¯å¯¹ç§°è§£å¯†,OK æ­¤æ¬¡Httpså®Œç¾ç»“æŸ â€”â€”â€“æ•´ä¸ªhttpsè¯·æ±‚ç»“æŸäº†â€”â€”â€“ å…¶ä¸­ , å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†, å„å¸å…¶èŒ,å…±åŒå®Œæˆæ•´ä¸ªè¯·æ±‚. å¯¹ç§°åŠ å¯†: æœ€å¿«é€Ÿ,æœ€ç®€å• éå¯¹ç§°åŠ å¯†:é€Ÿåº¦æ…¢,å¾ˆå®‰å…¨,ä¸éœ€è¦æŠŠç§˜é’¥åˆ†å‘,å®¢æˆ·ç«¯åˆ©ç”¨å…¬é’¥åŠ å¯†çš„æ•°æ®,åªèƒ½æ˜¯æ‹¥æœ‰ç§˜é’¥çš„æœåŠ¡å™¨è§£å¯† åˆ©ç”¨éå¯¹ç§°åŠ å¯†çš„ç‰¹æ€§ä¼ é€’ å®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºå¯†é’¥ ,è¾¾åˆ°åªæœ‰æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯äº’ç›¸çŸ¥é“çš„å¯†é’¥,ä»è€Œä½¿ç”¨å¯†é’¥è¿›è¡Œ(é«˜é€Ÿç®€å•çš„)å¯¹ç§°åŠ å¯†æ•°æ®. ç¬¬ä¸€éƒ¨åˆ†:ä¿¡ä»»æ‰€æœ‰ è¿™å°±æ˜¯,æˆ‘ä¸ç®¡æ˜¯è°ä¼ é€’çš„æ¶ˆæ¯,ä¸æ˜¯ä½ å®¶æœåŠ¡å™¨ä¼ é€’çš„æ¶ˆæ¯,ä½ ä¹Ÿä¼šä¿¡ Api.java (æä¾›okhttpå®ä¾‹,å¹¶åˆ›å»ºRetroitæœåŠ¡) OkHttpClient okHttpClient = new OkHttpClient.Builder() .hostnameVerifier(new HostnameVerifier() { @Override public boolean verify(String hostname, SSLSession session) { return true; } }) .sslSocketFactory(createSSLSocketFactory()) .build(); ... //è¿™é‡Œæ˜¯åˆ›å»ºä¸€ä¸ªSSLSocketFactory,æä¾›ç»™ä¸Šé¢çš„ .sslSocketFactory() private SSLSocketFactory createSSLSocketFactory() { SSLSocketFactory ssfFactory = null; try { SSLContext sc = SSLContext.getInstance(&quot;TLS&quot;); sc.init(null, new TrustManager[]{new TrustAllCerts()}, new SecureRandom()); ssfFactory = sc.getSocketFactory(); } catch (Exception e) { } return ssfFactory; } å…¶ä¸­æ¶‰åŠåˆ°TrustAllCerts.java,å¯ä»¥çœ‹åˆ°åªæ˜¯å®ç°X509TrustManager,æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯é»˜è®¤å®ç° /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/8 ä¸‹åˆ2:25 */ public class TrustAllCerts implements X509TrustManager { @Override public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException {} @Override public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException {} @Override public X509Certificate[] getAcceptedIssuers() { return new X509Certificate[0]; } } è¿™é‡Œå°±ä»¥åŠå¯ä»¥äº†,ä¿¡ä»»æ‰€æœ‰çš„è¿æ¥ ç¬¬äºŒéƒ¨åˆ†:(å¼ºéªŒè¯) æˆ‘åªä¿¡ä»»è¯ä¹¦åˆæ³•çš„æœåŠ¡å™¨ä¼ é€’çš„æ•°æ®. æŸ¥çœ‹Httpsçš„è¯ä¹¦ åœ¨æµè§ˆå™¨ä¸Šçœ‹åˆ°è¿™ä¸ª,è¿™ä¸ªå·²ç»æ˜¯æˆ‘æŠŠè¯ä¹¦æ·»åŠ ä¸ºä¿¡ä»»äº†,æ‰€ä»¥ä»–æ˜¯ä¸€ä¸ª å®‰å…¨ çš„æ ‡å¿— åˆ†æ è¿™é‡Œæ˜¯æˆ‘æŸ¥çœ‹å½“å‰ç½‘ç«™è¯ä¹¦çš„ç»“æ„ æœ€é¡¶â€”æ˜¯æ ¹è¯ä¹¦,åˆ°æœŸæ—¶é—´æ˜¯2028å¹´ æœ€åº•â€”æ˜¯æˆ‘å¸è¯ä¹¦,åˆ°æœŸæ—¶é—´æ˜¯2018.12.9æ—¥ è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°,æˆ‘ä»¬ç½‘ç«™çš„è¯ä¹¦æ˜¯æœ‰æ—¶é—´é™åˆ¶çš„,é‚£ä¹ˆå°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜,åˆ°äº†2018.12.9è¿™ä¸€å¤©æ€ä¹ˆåŠ. æˆ‘ä¹Ÿä¸çŸ¥é“ä¼šæ€ä¹ˆæ ·,åº”è¯¥æ˜¯ç»­ç­¾å§!é‚£ä¹ˆä¸‡ä¸€è¿™ä¸ªè¯ä¹¦å˜åŒ–äº†æ€ä¹ˆåŠ? æ‰€ä»¥,æˆ‘ä»¬åº”è¯¥æŠŠæ ¹è¯ä¹¦ç½®ä¸ºä¿¡ä»». ä¸‹è½½ä¿å­˜ Macçš„åœ¨ é’¥åŒ™ä¸²è®¿é—® ä¸­ Windows æ²¡æ³•æ”¾å›¾,åœ¨chromeä¸ŠæŸ¥çœ‹è¯ä¹¦çš„æ—¶å€™åº”è¯¥å°±èƒ½ä¿å­˜. HttpsUtils.java /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/10 ä¸‹åˆ5:07 * æ”¯æŒhttpsçš„å·¥å…·ç±» */ public class HttpsUtils { private static final String TAG = &quot;OkHttp&quot;; /** * åˆ›å»ºä¸€ä¸ªç©ºç™½çš„KeyStore * @return KeyStore * @throws GeneralSecurityException */ private static KeyStore createEmptyKeyStore() throws GeneralSecurityException { try { KeyStore keystore = KeyStore.getInstance(KeyStore.getDefaultType()); //æ­¤å¤„å¯†ç éšæ„,ä¸ä¼šäº§ç”Ÿé—®é¢˜ keystore.load(null, &quot;password&quot;.toCharArray()); return keystore; } catch (IOException e) { return null; } } /** * TrustManager ç”Ÿæˆ * @return * @throws GeneralSecurityException */ private static TrustManager[] generateTrustManager() throws GeneralSecurityException { //åˆ›å»ºä¸€ä¸ªX.509æ ¼å¼çš„CertificateFactory CertificateFactory certificateFactory = CertificateFactory.getInstance(&quot;X.509&quot;); Certificate ca; //è¯ä¹¦å·¥å‚æ ¹æ®è¯ä¹¦æ–‡ä»¶çš„æµç”Ÿæˆè¯ä¹¦Certificate InputStream assets = App.getContext().getResources().openRawResource(R.raw.rootca); ca = certificateFactory.generateCertificate(assets); Log.e(TAG, &quot;trustManager: ca = &quot; + ((X509Certificate) ca).getSubjectDN() ); //åˆ›å»ºKeyStoreï¼Œç”¨æ¥å­˜å‚¨ä¿¡ä»»è¯ä¹¦ KeyStore keyStor = createEmptyKeyStore(); keyStor.setCertificateEntry(&quot;ca&quot;,ca); //åˆ›å»ºä¸€ä¸ªé»˜è®¤ç±»å‹çš„TrustManagerFactory String defaultAlgorithm = TrustManagerFactory.getDefaultAlgorithm(); TrustManagerFactory tmf = TrustManagerFactory.getInstance(defaultAlgorithm); //ç”¨keyStoreå®ä¾‹åˆå§‹åŒ–TrustManagerFactory,æ­¤æ—¶TrustManagerFactoryä¼šä¿¡ä»»æˆ‘ä»¬ä¿å­˜çš„è¯ä¹¦ tmf.init(keyStor); //é€šè¿‡tmfè·å–TrustManageræ•°ç»„ï¼ŒTrustManagerä¹Ÿä¼šä¿¡ä»»keyStorä¸­çš„è¯ä¹¦ return tmf.getTrustManagers(); } /** * æä¾›ä¸€ä¸ªä¸€ä¸ªSSLSocketFactory * @return SSLSocketFactoryå®ä¾‹ */ public static SSLSocketFactory generateSSLSocketFactory() { try { SSLContext sc = SSLContext.getInstance(&quot;TLS&quot;); sc.init(null, generateTrustManager(), new SecureRandom()); Log.e(TAG, &quot;generateSSLSocketFactory &quot;); return sc.getSocketFactory(); } catch (GeneralSecurityException e) { return null; } } } æ³¨é‡Šå¾ˆæ¸…æ¥šäº†. å…³é”®: 1.æ‹¿åˆ°å¸§æ•°çš„æµ InputStream assets = App.getContext().getResources().openRawResource(R.raw.rootca); 2.ä¿å­˜åˆ°keystore KeyStore keyStor = createEmptyKeyStore(); keyStor.setCertificateEntry(&quot;ca&quot;,ca); 3.åˆå§‹åŒ–å¹¶æ‹¿åˆ°TrustManager[] tmf.init(keyStor); tmf.getTrustManagers() ä½¿ç”¨å³å¯: //è¿™æ ·å°±Ok OkHttpClient okHttpClient = new OkHttpClient.Builder() .hostnameVerifier((hostname, session) -&gt; true) .sslSocketFactory(HttpsUtils.generateSSLSocketFactory()) .build(); è¶…å¥½çš„ä¸¤ç¯‡ http://blog.csdn.net/lmj623565791/article/details/48129405 http://blog.csdn.net/iispring/article/details/51615631","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"WebViewæ’­æ”¾H5è§†å±æ²¡æœ‰ç”»é¢,åªæœ‰å£°éŸ³","slug":"webview-video-without-image","date":"2018-01-04T03:03:45.000Z","updated":"2019-12-22T12:05:35.253Z","comments":true,"path":"2018/01/04/webview-video-without-image/","link":"","permalink":"https://www.wangzhumo.com/2018/01/04/webview-video-without-image/","excerpt":"","text":"æè¿°:ç‚¹å‡»æ’­æ”¾æŒ‰é’®å,åªèƒ½å¬åˆ°å£°éŸ³,è€Œç”»é¢æ˜¯ç™½çš„â€¦.ä¸€ç›´ç™½â€¦æƒ³åˆ°åº”è¯¥æ˜¯ç¡¬ä»¶åŠ é€Ÿçš„é—®é¢˜ 1.ç¡®è®¤ç¡¬ä»¶åŠ é€Ÿ(éæ­¤å› ç´ ) åœ¨WebViewActivity.javaä¸­å‘ç° webView.setLayerType(View.LAYER_TYPE_HARDWARE, null); 2.ç¡®è®¤AndroidManifest.xml(éæ­¤å› ç´ ) applicationèŠ‚ç‚¹ä¸‹å¹¶æ²¡æœ‰å‘ç° android:hardwareAccelerated=&quot;true&quot; åœ¨WebViewActivityä¸­,ä¹Ÿæ— è¯¥é…ç½® å°è¯•: WebViewActivity.javaä¸­,æ³¨é‡Š #webView.setLayerType(View.LAYER_TYPE_HARDWARE, null); åœ¨AndroidManifest.xmlèŠ‚ç‚¹ä¸‹åŠ å…¥android:hardwareAccelerated=&quot;true&quot; ç»“æœâ€¦â€¦æ²¡ç”¨ 3.æ£€æŸ¥activity_web_view.xml &lt;WebView android:id=&quot;@+id/webView&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; android:scrollbars=&quot;none&quot; android:visibility=&quot;@{showError?View.GONE:View.VISIBLE}&quot; /&gt; æ²¡é—®é¢˜. BUTâ€¦. &lt;LinearLayout android:layerType=&quot;software&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; android:orientation=&quot;vertical&quot;&gt; &lt;include layout=&quot;@layout/layout_toolbar&quot; /&gt; &lt;ProgressBar android:id=&quot;@+id/web_load_progress&quot; style=&quot;?android:attr/progressBarStyleHorizontal&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;2dp&quot; android:indeterminateOnly=&quot;false&quot; android:max=&quot;100&quot; android:progress=&quot;@{progress}&quot; android:progressDrawable=&quot;@drawable/progress_bar_states&quot; android:visibility=&quot;gone&quot; /&gt; &lt;WebView android:id=&quot;@+id/webView&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; android:scrollbars=&quot;none&quot; android:visibility=&quot;@{showError?View.GONE:View.VISIBLE}&quot; /&gt; &lt;/LinearLayout&gt; ####çˆ¶å¸ƒå±€ç«Ÿç„¶android:layerType=&quot;software&quot; è§£å†³,åˆ æ‰è¯¥å±æ€§å³å¯","categories":[{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/categories/Bug/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/tags/Bug/"}]},{"title":"Roomä¸­List<>ä½¿ç”¨è¯¦è§£","slug":"room-list","date":"2018-01-03T07:03:38.000Z","updated":"2019-12-22T12:06:54.087Z","comments":true,"path":"2018/01/03/room-list/","link":"","permalink":"https://www.wangzhumo.com/2018/01/03/room-list/","excerpt":"æ‰‹æ‘¸æ‰‹æ•™ä½ åœ¨Roomä¸­ä½¿ç”¨List. å®é™…é¡¹ç›®æœ‰å¾ˆå¤šè¿™æ ·çš„ç»“æ„: { &quot;id&quot;: &quot;001&quot;, &quot;name&quot;: &quot;ç‹è¯›é­”&quot;, &quot;age&quot;: 2018, &quot;books&quot;: [ { &quot;bookId&quot;: 10081, &quot;userId&quot;: 1, &quot;book&quot;: &quot;æ–­ç½ªå°å­¦&quot;, &quot;desc&quot;: &quot;æ¼«ç”»è®²è¿°äº†ææ€ç¥ã€ç‹è¯›é­”å’Œåˆ˜æ–©ä»™ä¸‰ä½å°‘å¹´ï¼Œä¸ºäº†åä¸‡å°å­¦ç”Ÿçš„æœªæ¥ã€ä¸ºäº†æ”¹å˜è¢«è¯…å’’çš„å‘½è¿ï¼Œç›¸èšåœ¨ç‹¼ç‰™åŒºé£è™è·¯ç§ç«‹æ–­ç½ªå°å­¦ï¼Œèª“æ­»æ‰“è´¥å››å¹´çº§çš„é­”ç¥èµµæ—¥å¤©çš„æ•…äº‹ã€‚&quot; }, { &quot;bookId&quot;: 10088, &quot;userId&quot;: 1, &quot;book&quot;: &quot;ç‹‚éœ¸å¤©ä¸‹ä¹‹æ–­ç½ªå­¦å›­&quot;, &quot;desc&quot;: &quot;ã€Šç‹‚éœ¸å¤©ä¸‹ä¹‹æ–­ç½ªå­¦å›­ã€‹ï¼Œåæ¥å› ä¸ºåå­—å¤ªé•¿ï¼Œè€Œä¸”â€œå­¦å›­â€å’Œâ€œå­¦é™¢â€å®¹æ˜“æ··æ·†çš„åŸå› è€Œæ”¹åã€‚&quot; } ] }","text":"æ‰‹æ‘¸æ‰‹æ•™ä½ åœ¨Roomä¸­ä½¿ç”¨List. å®é™…é¡¹ç›®æœ‰å¾ˆå¤šè¿™æ ·çš„ç»“æ„: { &quot;id&quot;: &quot;001&quot;, &quot;name&quot;: &quot;ç‹è¯›é­”&quot;, &quot;age&quot;: 2018, &quot;books&quot;: [ { &quot;bookId&quot;: 10081, &quot;userId&quot;: 1, &quot;book&quot;: &quot;æ–­ç½ªå°å­¦&quot;, &quot;desc&quot;: &quot;æ¼«ç”»è®²è¿°äº†ææ€ç¥ã€ç‹è¯›é­”å’Œåˆ˜æ–©ä»™ä¸‰ä½å°‘å¹´ï¼Œä¸ºäº†åä¸‡å°å­¦ç”Ÿçš„æœªæ¥ã€ä¸ºäº†æ”¹å˜è¢«è¯…å’’çš„å‘½è¿ï¼Œç›¸èšåœ¨ç‹¼ç‰™åŒºé£è™è·¯ç§ç«‹æ–­ç½ªå°å­¦ï¼Œèª“æ­»æ‰“è´¥å››å¹´çº§çš„é­”ç¥èµµæ—¥å¤©çš„æ•…äº‹ã€‚&quot; }, { &quot;bookId&quot;: 10088, &quot;userId&quot;: 1, &quot;book&quot;: &quot;ç‹‚éœ¸å¤©ä¸‹ä¹‹æ–­ç½ªå­¦å›­&quot;, &quot;desc&quot;: &quot;ã€Šç‹‚éœ¸å¤©ä¸‹ä¹‹æ–­ç½ªå­¦å›­ã€‹ï¼Œåæ¥å› ä¸ºåå­—å¤ªé•¿ï¼Œè€Œä¸”â€œå­¦å›­â€å’Œâ€œå­¦é™¢â€å®¹æ˜“æ··æ·†çš„åŸå› è€Œæ”¹åã€‚&quot; } ] } ä¹Ÿå°±æ˜¯,ç±»ä¼¼booksè¿™æ ·çš„,Listä½œä¸ºä¸€ä¸ªå…ƒç´ å­˜åœ¨. ä¸‹é¢å°±ä»¥ä¸Šé¢çš„ç»“æ„ä¸ºä¾‹,åšä¸€ä¸ªç®€å•çš„æ¼”ç¤º,æŒ‰ç…§æœ€ç®€ç­”çš„æ–¹æ³•å®ç°. 1.æ·»åŠ ä¾èµ– https://developer.android.google.cn/topic/libraries/architecture/adding-components.html å€¼å¾—æ³¨æ„çš„æ˜¯,å¦‚æœä½ åœ¨kotlinä¸­ä½¿ç”¨ apply plugin: &#39;kotlin-kapt&#39; ... dependencies{ ... //è¿™ä¸ªæ— æ³•ç”Ÿæˆä»£ç ,è¦ç”¨ä¸‹é¢çš„é‚£ä¸€æ¡,ä¸è¦ç–å¿½å¿˜æ‰äº†. //annotationProcessor &quot;android.arch.persistence.room:compiler:1.0.0&quot; kapt &quot;android.arch.persistence.room:compiler:1.0.0&quot; } ä¸€å®šè®°å¾—ä½¿ç”¨kapt,è¦ä¸ç„¶å°±ä¼šé‡åˆ°è¿™ä¸ªBUG. 2.åˆ›å»ºè¡¨ User.javaè¡¨ /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/3 ä¸‹åˆ1:31 */ @Entity(tableName = &quot;users&quot;) public class User { @PrimaryKey public int id; public String name; public int age; } @Entity ä¸­æŒ‡å®šäº†è¡¨å @PrimaryKey ä¸»é”® è¿™å¼ è¡¨users ç”¨äºä¿å­˜ç”¨æˆ·æ•°æ® Book.javaè¡¨ /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/3 ä¸‹åˆ1:30 */ @Entity(foreignKeys = { @ForeignKey( entity = User.class, parentColumns ={&quot;id&quot;}, childColumns = {&quot;userId&quot;}) },tableName = &quot;books&quot;) public class Book { @PrimaryKey public int bookId; public int userId;//åŒUser.javaä¸­çš„id public String book; public String desc; } @Entity ä¸­ foreignKeys = {} ä¸­å¤–é”®,å¯ä»¥æ˜¯å¤šä¸ª,è¿™é‡Œåªå…³è”äº†Userè¡¨ tableName = â€œbooksâ€ æŒ‡å®šäº†è¡¨å @PrimaryKey è¯¥è¡¨ä¸»é”® UserAndBook.javaè¡¨ â€”-UserAndBookåªæ˜¯è¾…åŠ©,ä¸ä½œä¸ºä¸€å¼ è¡¨å­˜åœ¨. /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/3 ä¸‹åˆ1:43 */ public class UserAndBook { @Embedded //è¯·çœ‹ä¹‹å‰çš„æ–‡ç« ,è¿™æ˜¯æŒ‡æŠŠUserä¸­æ‰€æœ‰å…ƒç´ å¸¦å…¥åˆ°è¿™é‡Œä½œä¸ºå…ƒç´ å­˜åœ¨ public User userEntity; //@Relation @Relation(parentColumn = &quot;id&quot;,entityColumn = &quot;userId&quot;,entity = Book.class) public List&lt;Book&gt; books; } @Embedded è¯·çœ‹å¦ä¸€ç¯‡,æœ‰è§£é‡Š @Relation ç‚¹è¿™é‡Œå»çœ‹å®˜æ–¹æ–‡æ¡£ A convenience annotation which can be used in a Pojo to automatically fetch relation entities. When the Pojo is returned from a query, all of its relations are also fetched by Room. ä¸ªäººä»¥ä¸ºå°±æ˜¯ä¸€æ³¨è§£,æŒ‡æ˜å…³ç³»,å¯ä»¥æŠŠå®ä½“å…³è”èµ·æ¥,ç„¶åè‡ªåŠ¨ç»„è£…èµ·æ¥. å¹¶ä¸”åœ¨æ–‡æ¡£ä¸­è¿˜å±•ç¤ºäº†ä¸€ç§é«˜ç«¯çš„åŠŸèƒ½,ç”¨ä¸Šé¢åšä¾‹ //@Relation @Relation(parentColumn = &quot;id&quot;,entityColumn = &quot;userId&quot;, entity = Book.class ,projection = {&quot;book&quot;}) public List&lt;String&gt; bookNames; è§£é‡Šä¸€ä¸‹,projectionæŒ‡å®šäº†è¦å–å‡ºçš„å€¼,å½“å‰æŒ‡æ˜è¦åœ¨ booksè¡¨ä¸­å¯»æ‰¾ç¬¦åˆæ¡ä»¶parentColumn = â€œidâ€,entityColumn = â€œuserIdâ€ çš„é¡¹,æ‰¾åˆ°ä¹‹åä¼šæ‹¿åˆ°bookè¿™ä¸ªå€¼å¹¶è¿”å›. 3.Daoå®ç° /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/3 ä¸‹åˆ4:20 */ @Dao public abstract class UserAndBookDao { @Insert(onConflict = OnConflictStrategy.REPLACE) public abstract void insert(User user); @Insert(onConflict = OnConflictStrategy.REPLACE) public abstract void insert(List&lt;Book&gt; books); @Transaction public void insert(UserAndBook userAndBook){ insert(userAndBook.userEntity); insert(userAndBook.books); } @Query(&quot;SELECT * FROM users&quot;) public abstract List&lt;UserAndBook&gt; getAll(); } insert(User user); ,insert(List&lt;Book&gt; books); ä¸¤ä¸ªæ–¹æ³•,ä¹Ÿå¯ä»¥ç§æœ‰åŒ–,åªå¯¹å¤–æä¾›insert(UserAndBook userAndBook) æœ€è¿‘æ¢å…¬å¸é¡¹ç›®çš„æ•°æ®åº“,ç”¨sql,çœŸçš„æœ‰æ„æ€,å¯ä»¥å¾ˆæ–¹ä¾¿çš„å®ç°å¾ˆå¤šåŠŸèƒ½ 4.å»ºç«‹æ•°æ®åº“ /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/24 ä¸Šåˆ10:13 * æ•°æ®åº“ */ @Database(entities = {Book.class, User.class}, version = 1, exportSchema = false) public abstract class AppDB extends RoomDatabase { private static final String TAG = &quot;AppDB&quot;; /** * æ•°æ®åº“å®ä¾‹ */ private static AppDB sInstance; private static String DATABASE_NAME = &quot;developer.db&quot;; private ObservableBoolean mIsDatabaseCreated = new ObservableBoolean(false); public abstract UserAndBookDao userbook(); /** * å•ä¾‹ * @param context * @return */ public static AppDB getInstance(Context context) { if (sInstance == null) { synchronized (AppDB.class) { if (sInstance == null) { sInstance = buildDatabase(context); sInstance.updateDatabaseCreated(context); } } } return sInstance; } /** * Build the database. * creates a new instance of the database. */ private static AppDB buildDatabase(Context appContext) { AppDB appDB = Room.databaseBuilder(appContext, AppDB.class, DATABASE_NAME) .addCallback(new Callback() { @Override public void onCreate(@NonNull SupportSQLiteDatabase db) { super.onCreate(db); AppDB database = AppDB.getInstance(appContext); database.setDatabaseCreated(); } @Override public void onOpen(@NonNull SupportSQLiteDatabase db) { super.onOpen(db); Log.e(TAG, &quot;onOpen: &quot; + db.getPath()); } }).build(); return appDB; } /** * Check whether the database already exists and expose it via */ private void updateDatabaseCreated(final Context context) { if (context.getDatabasePath(DATABASE_NAME).exists()) { setDatabaseCreated(); } } private void setDatabaseCreated() { mIsDatabaseCreated.set(true); } public ObservableBoolean getDatabaseCreated() { return mIsDatabaseCreated; } } ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨,åœ¨Applicationä¸­æ·»åŠ äº† public static AppDB getDatabase() { return AppDB.getInstance(context); } 5.ä½¿ç”¨ è¿™é‡Œçš„ä½¿ç”¨æ–¹å¼,ä¸å»ºè®®ä½¿ç”¨,å¤ªç²—æš´äº†. å¯ä»¥å­¦å­¦Demo,Googleå‡ºçš„googlesamples/android-architecture-components class RoomActivity : BindingActivity&lt;ActivityRoomBinding, RoomViewModel&gt;() { val gson = Gson() override fun getBundle(extras: Bundle) { } override fun layoutID(): Int = R.layout.activity_room override fun initViews(savedInstanceState: Bundle?) { //ç‚¹å‡»äº‹ä»¶ ADDæŒ‰é’®,æ·»åŠ æ•°æ®åˆ°æ•°æ®åº“ mBindingView.button.setOnClickListener({ val userBook = UserAndBook() val jsonStr = FileUtils.getJson(this, &quot;data.txt&quot;) val objectJson = JsonParser().parse(jsonStr).asJsonObject //è·å–ç”¨æˆ· val user = objectJson.get(&quot;user&quot;) userBook.userEntity = gson.fromJson&lt;User&gt;(user, User::class.java) //ä¿å­˜ç”¨æˆ· Observable .empty&lt;Any&gt;() .observeOn(Schedulers.io()) .subscribe(object : EmptyObserver&lt;Any?&gt;() { override fun onComplete() { App.getDatabase().userbook().insert(userBook.userEntity) } }) //è·å–ä¹¦ç± val books = objectJson.get(&quot;books&quot;) userBook.books = gson.fromJson&lt;ArrayList&lt;Book&gt;&gt; (books, object : TypeToken&lt;List&lt;Book&gt;&gt;() {}.type) //ä¿å­˜ä¹¦ç± Observable .empty&lt;Any&gt;() .observeOn(Schedulers.io()) .subscribe(object : EmptyObserver&lt;Any?&gt;() { override fun onComplete() { App.getDatabase().userbook().insert(userBook.books) } }) }) //ç‚¹å‡»äº‹ä»¶,æŒ‰é’®QUERY æŸ¥è¯¢æ•°æ® mBindingView.button2.setOnClickListener { Flowable.create(FlowableOnSubscribe&lt;List&lt;UserAndBook&gt;&gt; { e -&gt; val userBook = App.getDatabase().userbook().all e.onNext(userBook) e.onComplete() }, BackpressureStrategy.DROP) .compose(DatabaseTransformer()) .subscribe(object : DatabaseSubscriber&lt;List&lt;UserAndBook&gt;&gt;() { override fun onNext(userAndBooks: List&lt;UserAndBook&gt;) { mBindingView.data = userAndBooks[0] } }) } } } &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;layout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt; &lt;data&gt; &lt;import type=&quot;com.wangzhumo.app.data.UserAndBook&quot;/&gt; &lt;import type=&quot;com.wangzhumo.app.data.User&quot;/&gt; &lt;import type=&quot;com.wangzhumo.app.data.Book&quot;/&gt; &lt;variable name=&quot;data&quot; type=&quot;com.wangzhumo.app.data.UserAndBook&quot;/&gt; &lt;/data&gt; &lt;RelativeLayout android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot;&gt; &lt;Button android:id=&quot;@+id/button&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_alignParentLeft=&quot;true&quot; android:layout_alignParentStart=&quot;true&quot; android:layout_alignParentTop=&quot;true&quot; android:layout_marginLeft=&quot;57dp&quot; android:layout_marginStart=&quot;57dp&quot; android:layout_marginTop=&quot;125dp&quot; android:text=&quot;Add&quot; /&gt; &lt;Button android:id=&quot;@+id/button2&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_alignBaseline=&quot;@+id/button&quot; android:layout_alignBottom=&quot;@+id/button&quot; android:layout_alignParentEnd=&quot;true&quot; android:layout_alignParentRight=&quot;true&quot; android:layout_marginEnd=&quot;56dp&quot; android:layout_marginRight=&quot;56dp&quot; android:text=&quot;Query&quot; /&gt; &lt;RelativeLayout android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; android:layout_alignParentLeft=&quot;true&quot; android:layout_alignParentStart=&quot;true&quot; android:layout_below=&quot;@+id/button&quot; android:layout_marginTop=&quot;68dp&quot;&gt; &lt;TextView android:id=&quot;@+id/textView&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_alignParentLeft=&quot;true&quot; android:layout_alignParentStart=&quot;true&quot; android:layout_alignParentTop=&quot;true&quot; android:layout_marginLeft=&quot;36dp&quot; android:layout_marginStart=&quot;36dp&quot; android:layout_marginTop=&quot;32dp&quot; android:text=&quot;@{data.userEntity.name}&quot; /&gt; &lt;TextView android:id=&quot;@+id/textView2&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_alignLeft=&quot;@+id/textView&quot; android:layout_alignStart=&quot;@+id/textView&quot; android:layout_below=&quot;@+id/textView&quot; android:layout_marginTop=&quot;41dp&quot; android:text=&quot;@{data.books.get(0).book}&quot; /&gt; &lt;TextView android:id=&quot;@+id/textView3&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_alignLeft=&quot;@+id/textView2&quot; android:layout_alignStart=&quot;@+id/textView2&quot; android:layout_centerVertical=&quot;true&quot; android:text=&quot;@{data.books.get(0).desc}&quot; /&gt; &lt;/RelativeLayout&gt; &lt;/RelativeLayout&gt; &lt;/layout&gt; â€‹ â€‹","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Room","slug":"Room","permalink":"https://www.wangzhumo.com/tags/Room/"}]},{"title":"Androidå­—ä½“ä¸è·Ÿéšç³»ç»Ÿå˜åŒ–","slug":"Android-Font-Size","date":"2017-12-28T07:30:11.000Z","updated":"2019-12-22T12:03:29.720Z","comments":true,"path":"2017/12/28/Android-Font-Size/","link":"","permalink":"https://www.wangzhumo.com/2017/12/28/Android-Font-Size/","excerpt":"","text":"å·²çŸ¥çš„æ–¹æ³•æœ‰ä¸¤ç§: ç¬¬ä¸€ç§ ä¸ä½¿ç”¨sp è€Œä½¿ç”¨ dp ç¬¬äºŒç§ åœ¨Applicationä¸­åŠ å…¥ @Override public void onConfigurationChanged(Configuration newConfig) { if (newConfig.fontScale != 1) getResources(); super.onConfigurationChanged(newConfig); } @Override public Resources getResources() { Resources res = super.getResources(); if (res.getConfiguration().fontScale != 1) { Configuration newConfig = new Configuration(); newConfig.setToDefaults(); res.updateConfiguration(newConfig, res.getDisplayMetrics()); } return res; }","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"Apk Install çš„å„ç§é—®é¢˜","slug":"Apk-Install-Error","date":"2017-12-28T06:48:09.000Z","updated":"2019-12-22T12:04:38.048Z","comments":true,"path":"2017/12/28/Apk-Install-Error/","link":"","permalink":"https://www.wangzhumo.com/2017/12/28/Apk-Install-Error/","excerpt":"","text":"[INSTALL_FAILED_TEST_ONLY: installPackageLI] æ–¹æ³•1ï¼šAndroidManifest.xml åŠ å…¥android:testOnly=â€falseâ€ã€‚ æ–¹æ³•2ï¼šadb install -t *.apk","categories":[{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/categories/Bug/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/tags/Bug/"}]},{"title":"Android StudioæŠ¥é”™ cannot debug application","slug":"cannot-debug-application","date":"2017-12-26T07:26:29.000Z","updated":"2019-12-22T12:23:38.234Z","comments":true,"path":"2017/12/26/cannot-debug-application/","link":"","permalink":"https://www.wangzhumo.com/2017/12/26/cannot-debug-application/","excerpt":"Android StudioæŠ¥é”™Error Running app: cannot debug application","text":"Android StudioæŠ¥é”™Error Running app: cannot debug application è¿™é‡Œæœ‰ä¸€ä½ä»å…„å¸®å¿™ç¿»è¯‘äº†. http://blog.csdn.net/yishichangan1/article/details/77451486 Cannot debug application xx.xxx.xxx.app on device lge_nexus_5x(æ­¤å¤„è¡¨ç¤ºä½ çš„æ‰‹æœºå‹å·). ä½ çš„xxxappä¸èƒ½åœ¨å‹å·ä¸ºNexus 5xçš„LGEæ‰‹æœºä¸Šè°ƒè¯•ã€‚ This application does not have the debuggable attribute enabled in its manifest. è¿™ä¸ªé¡¹ç›®åœ¨æ¸…å•æ–‡ä»¶ï¼ˆAndroidManifest.xmlï¼‰ä¸­æ²¡æœ‰è®¾ç½®å¯ä»¥è°ƒè¯•çš„å‚æ•°ã€‚ If you have manually set it in the manifest, then remove it and let the IDE automatically assign it. å¦‚æœä½ å·²ç»æ‰‹åŠ¨åœ¨æ¸…å•æ–‡ä»¶ç§è®¾ç½®äº†è¿™ä¸ªå±æ€§ï¼Œè¯·removeæ‰ï¼Œè®©IDEè‡ªåŠ¨ç”Ÿæˆã€‚ If you are using Gradle, make sure that your current variant is debuggable. å¦‚æœä½ ä½¿ç”¨Gradleï¼Œç¡®è®¤ä½ ç°åœ¨çš„å˜ä½“æ˜¯å¯è°ƒè¯•çš„ã€‚ ####æˆ‘å°±çŸ¥é“æ˜¯æˆ‘è‡ªå·±é€‰äº†releaseâ€¦.æœç„¶","categories":[{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/categories/Bug/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Bug","slug":"Bug","permalink":"https://www.wangzhumo.com/tags/Bug/"}]},{"title":"Centos åˆ›å»ºç”¨æˆ·å¹¶å®ç°å…å¯†ç ç™»å½•","slug":"Centos-Login-SSH","date":"2017-12-25T08:25:04.000Z","updated":"2019-12-22T12:11:50.315Z","comments":true,"path":"2017/12/25/Centos-Login-SSH/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Centos-Login-SSH/","excerpt":"æ¯”å¦‚,åˆ›å»ºä¸€ä¸ªåä¸ºwzmçš„è´¦å· ####åˆ›å»ºè´¦å· 1.åˆ›å»º [root@localhost ~]# adduser wzm [root@localhost ~]# passwd wzm #æ­¤æ—¶,è¾“å…¥ä¸¤æ¬¡å¯†ç å³å¯","text":"æ¯”å¦‚,åˆ›å»ºä¸€ä¸ªåä¸ºwzmçš„è´¦å· ####åˆ›å»ºè´¦å· 1.åˆ›å»º [root@localhost ~]# adduser wzm [root@localhost ~]# passwd wzm #æ­¤æ—¶,è¾“å…¥ä¸¤æ¬¡å¯†ç å³å¯ 2.èµ‹äºˆsudo #æ‰¾åˆ°sudoers [root@localhost ~]# whereis sudoers #ä¿®æ”¹sudoersçš„è¯»å†™æƒé™ [root@localhost ~]# chmod -v u+w /etc/sudoers #åŠ å…¥æ–°ç”¨æˆ· ## Allow root to run any commands anywher root ALL=(ALL) ALL linuxidc ALL=(ALL) ALL #è¿™ä¸ªæ˜¯æ–°å¢çš„ç”¨æˆ· #æŠŠsudoersæƒé™è¿˜ç»™ä»– [root@localhost ~]# chmod -v u-w /etc/sudoers 3.å°½æƒ…äº«ç”¨å§ ####sshå…å¯†ç ç™»å½• 1.ä¿®æ”¹é…ç½®æ–‡ä»¶sudo vim /etc/ssh/sshd_config 2.é‡å¯sshæœåŠ¡service sshd restart 3.ç”Ÿæˆå¯†é’¥ ssh-keygen -t rsa é»˜è®¤åœ¨ ~/.sshç›®å½•ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š id_rsa ï¼šç§é’¥ id_rsa.pub ï¼šå…¬é’¥ 4.å¯¼å…¥æœ¬æœºcat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys 5.ä¸‹è½½åˆ°å®¢æˆ·ç«¯å¹¶è®¾ç½® scp [-r] ç”¨æˆ·å@ip:æ–‡ä»¶è·¯å¾„ æœ¬åœ°è·¯å¾„ #ä¸‹è½½æ–‡ä»¶ scp [-r] æœ¬åœ°æ–‡ä»¶ ç”¨æˆ·å@ip:ä¸Šä¼ è·¯å¾„ eg: ~/.ssh âŒš 16:27:33 $ scp id_rsa.pub root@45.XX.XX.XX:/home/ id_rsa.pub 6.æ”¹æƒé™å¦‚æœå¸Œæœ›sshå…¬é’¥ç”Ÿæ•ˆéœ€æ»¡è¶³è‡³å°‘ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ï¼š 1) .sshç›®å½•çš„æƒé™å¿…é¡»æ˜¯7002) .ssh/authorized_keysæ–‡ä»¶æƒé™å¿…é¡»æ˜¯600 eg: ~ âŒš 16:33:21 $ ssh wzm@45.XX.XX.XX Last login: Mon Dec 25 16:21:11 2017 from 118.102.XXX.XXX [wzm@wangzhumo ~]$","categories":[{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/categories/Server/"}],"tags":[{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/tags/Server/"},{"name":"Linux","slug":"Linux","permalink":"https://www.wangzhumo.com/tags/Linux/"}]},{"title":"Androidé¡¹ç›®ä¸­ä½¿ç”¨RxBusè¿›è¡Œé€šè®¯","slug":"Android-RxBus","date":"2017-12-25T06:50:16.000Z","updated":"2019-12-22T12:03:46.403Z","comments":true,"path":"2017/12/25/Android-RxBus/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Android-RxBus/","excerpt":"åŠ å…¥JakeWhartonå¤§ç¥çš„RxRelay JakeWharton/RxRelay compile &#39;com.jakewharton.rxrelay2:rxrelay:2.0.0&#39;","text":"åŠ å…¥JakeWhartonå¤§ç¥çš„RxRelay JakeWharton/RxRelay compile &#39;com.jakewharton.rxrelay2:rxrelay:2.0.0&#39; RxBus.java /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/11/30 ä¸‹åˆ6:09 * */ public class RxBus { private Relay&lt;Object&gt; mBus = null; private static volatile RxBus mDefaultInstance; public RxBus() { mBus = PublishRelay.create().toSerialized(); } public static RxBus getDefault() { if (mDefaultInstance == null) { synchronized (RxBus.class) { if (mDefaultInstance == null) { mDefaultInstance = new RxBus(); } } } return mDefaultInstance; } /** * å‘é€äº‹ä»¶ */ public void post(Object event) { mBus.accept(event); } /** * æ ¹æ®ä¼ é€’çš„ eventType ç±»å‹è¿”å›ç‰¹å®šç±»å‹(eventType)çš„ è¢«è§‚å¯Ÿè€… */ public &lt;T&gt; Observable&lt;T&gt; toObservable(Class&lt;T&gt; eventType) { return mBus.ofType(eventType); } /** * åˆ¤æ–­æ˜¯å¦æœ‰è®¢é˜…è€… */ public boolean hasObservers() { return mBus.hasObservers(); } /** * å–æ¶ˆè®¢é˜… * @param disposable */ public void unregister(Disposable disposable) { if (disposable != null &amp;&amp; !disposable.isDisposed()) { disposable.dispose(); } } public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext) { return toObservable(eventType).observeOn(scheduler).subscribe(onNext); } public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete, Consumer onSubscribe) { return toObservable(eventType).observeOn(scheduler).subscribe(onNext, onError, onComplete, onSubscribe); } public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete) { return toObservable(eventType).observeOn(scheduler).subscribe(onNext, onError, onComplete); } public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext, Consumer onError) { return toObservable(eventType).observeOn(scheduler).subscribe(onNext, onError); } public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext) { return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext); } public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete, Consumer onSubscribe) { return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext, onError, onComplete, onSubscribe); } public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete) { return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext, onError, onComplete); } public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext, Consumer onError) { return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext, onError); } } è¿˜æœ‰ä¸€ä¸ªé€šç”¨çš„Event.javaä¾æ®è‡ªå·±çš„éœ€è¦åˆ¶å®šå³å¯ /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/19 ä¸‹åˆ5:38 * * å‘é€äº‹ä»¶åŒ…è£…ç±» */ public class Event&lt;T&gt; { public static final int EVENT_CLOSE_ALL_ACTIVITY = 10001; /** * reserved data */ private T data; /** * this code distinguish between different events */ private int eventCode = -1; public Event(int eventCode) { this(eventCode, null); } public Event(int eventCode, T data) { this.eventCode = eventCode; this.data = data; } /** * get event code * * @return */ public int getCode() { return this.eventCode; } /** * get event reserved data * * @return */ public T getData() { return this.data; } } RxBusçš„ä½¿ç”¨ æ³¨å†Œ æœ€å¥½æ˜¯å†åŸºç±»ä¸­,åŠ ä¸Š. if (useEventBus()) { //æ³¨å†Œeventbus Disposable disposable = RxBus.getDefault() .register(Event.class, new Consumer&lt;Event&gt;() { @Override public void accept(Event event) { int eventCode = event.getCode(); Log.e(&quot;RxBus&quot;, event.toString()); switch (eventCode) { case Event.EVENT_CLOSE_ALL_ACTIVITY: break; default: onEvent(event); break; } } }); addDispose(disposable); } å…¶ä¸­: useEventBus()ç”±å­ç±»å®ç°,æ˜¯å¦å¼€å¯RxBus,é¿å…æµªè´¹ addDispose(disposable);addDispose æ˜¯åŸºç±»çš„æ–¹æ³• /** * RxJava æ·»åŠ è®¢é˜… */ protected void addDispose(Disposable disposable) { if (mDisposables == null) { mDisposables = new CompositeDisposable(); } //å°†æ‰€æœ‰disposableæ”¾å…¥,é›†ä¸­å¤„ç† mDisposables.add(disposable); } ç»Ÿä¸€ç®¡ç†,é”€æ¯æ—¶ä¸€èµ·é”€æ¯,é¿å…çˆ†å†…å­˜ onEvent(event);æ˜¯ä¸€ä¸ªç©ºæ–¹æ³•,å¦‚æœå­ç±»é‡å†™å°±æŠŠäº‹ä»¶äº¤ç»™å­ç±»å¤„ç† å‘é€ RxBus.getDefault().post(new Event(100,&quot;message&quot;)) //codeæœ€å¥½åœ¨Event.javaä¸­ç»Ÿä¸€å®šä¹‰,æ–¹ä¾¿ç®¡ç† å¤„ç† override fun onEvent(event: Event&lt;*&gt;?) { super.onEvent(event) } è¿™ä¸€éƒ¨åˆ†,å…¶å®åœ¨ æ³¨å†Œ ä¸­å·²ç»å®Œæˆ,åªè¦å­ç±»è‡ªå·±é‡å†™æ–¹æ³•,å°±èƒ½å–åˆ°æ•°æ®","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Rxjava","slug":"Rxjava","permalink":"https://www.wangzhumo.com/tags/Rxjava/"}]},{"title":"Nginxå®‰è£…åŠå…¶ç®€å•é…ç½®","slug":"Nginx-install-config","date":"2017-12-25T05:39:40.000Z","updated":"2019-12-22T12:08:11.438Z","comments":true,"path":"2017/12/25/Nginx-install-config/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Nginx-install-config/","excerpt":"ç¯å¢ƒ: centos7 1.ä¸‹è½½å®‰è£… ä¸‹è½½nginx-1.12.0,å®˜ç½‘sudo wget http://nginx.org/download/nginx-1.12.0.tar.gz è§£å‹sudo tar -zxvf nginx-1.12.0.tar.gz å…¶ä»–çš„åº“,nginxä¾èµ–çš„åº“ å®‰è£…gccyum -y install gcc å®‰è£…pcreyum -y install pcre pcre-devel å®‰è£…zlibyum -y install zlib zlib-devel å®‰è£…opensslyum -y install openssl openssl-devel å®‰è£… sudo ./configure sudo make sudo make install é»˜è®¤ä½ç½® /usr/local/nginx å¦‚æœå®‰è£…è¿‡ç¨‹ä¸­å‡ºç°æ–‡ä»¶ç›®å½•æƒé™é—®é¢˜,ç™¾åº¦å³å¯è§£å†³.","text":"ç¯å¢ƒ: centos7 1.ä¸‹è½½å®‰è£… ä¸‹è½½nginx-1.12.0,å®˜ç½‘sudo wget http://nginx.org/download/nginx-1.12.0.tar.gz è§£å‹sudo tar -zxvf nginx-1.12.0.tar.gz å…¶ä»–çš„åº“,nginxä¾èµ–çš„åº“ å®‰è£…gccyum -y install gcc å®‰è£…pcreyum -y install pcre pcre-devel å®‰è£…zlibyum -y install zlib zlib-devel å®‰è£…opensslyum -y install openssl openssl-devel å®‰è£… sudo ./configure sudo make sudo make install é»˜è®¤ä½ç½® /usr/local/nginx å¦‚æœå®‰è£…è¿‡ç¨‹ä¸­å‡ºç°æ–‡ä»¶ç›®å½•æƒé™é—®é¢˜,ç™¾åº¦å³å¯è§£å†³. 2.ç³»ç»Ÿä¸­é…ç½® 1.åœ¨ç³»ç»ŸæœåŠ¡ç›®å½•é‡Œåˆ›å»ºnginx.serviceæ–‡ä»¶ vim /lib/systemd/system/nginx.service [Unit] Description=nginx After=network.target [Service] Type=forking ExecStart=/usr/local/nginx/sbin/nginx ExecReload=/usr/local/nginx/sbin/nginx -s reload ExecStop=/usr/local/nginx/sbin/nginx -s quit PrivateTmp=true [Install] WantedBy=multi-user.target 2.è®¾ç½®å¼€æœºå¯åŠ¨ systemctl enable nginx.service 3.å…¶ä»–å‘½ä»¤ å¯åŠ¨nginxæœåŠ¡systemctl start nginx.service è®¾ç½®å¼€æœºè‡ªå¯åŠ¨systemctl enable nginx.service åœæ­¢å¼€æœºè‡ªå¯åŠ¨systemctl disable nginx.service æŸ¥çœ‹æœåŠ¡å½“å‰çŠ¶æ€systemctl status nginx.service é‡æ–°å¯åŠ¨æœåŠ¡systemctl restart nginx.service æŸ¥çœ‹æ‰€æœ‰å·²å¯åŠ¨çš„æœåŠ¡ systemctl list-units --type=service 3.nginx.confçš„é…ç½® [root@wangzhumo hooks]# cd /usr/local/nginx/ [root@wangzhumo nginx]# ll total 96 drwx------ 2 root root 4096 Dec 24 20:57 client_body_temp drwxr-xr-x 3 root root 4096 Dec 24 23:24 conf drwx------ 2 root root 4096 Dec 24 20:57 fastcgi_temp drwxr-xr-x 2 root root 4096 Dec 23 10:38 html drwxr-xr-x 2 root root 4096 Dec 24 22:43 logs -rw-r--r-- 1 root root 53861 Dec 25 13:37 on drwx------ 2 root root 4096 Dec 24 20:57 proxy_temp drwxr-xr-x 2 root root 4096 Dec 23 10:38 sbin drwx------ 2 root root 4096 Dec 24 20:57 scgi_temp drwx------ 2 root root 4096 Dec 24 20:57 uwsgi_temp å…¶ä¸­/confå­˜æ”¾é…ç½®æ–‡ä»¶/conf/nginx.confvim /conf/nginx.conf ä»€ä¹ˆéƒ½ä¸è¦åŠ¨,åœ¨nginx.confç¬¬ä¸€æ¡serveré…ç½®ä¸‹é¢å†™å…¥:include vhost/*.conf; } #æ­¤å¤„æ˜¯ç¬¬ä¸€æ¡å¯ç”¨çš„serverçš„ç»“æŸ #åŠ å…¥è¿™å¥,å…¶å®æ˜¯æŠŠå…¶ä»–åœ°æ–¹é…ç½®çš„é…ç½®æ–‡ä»¶åŠ è½½åˆ°é‡Œé¢æ¥ #ä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ç®¡ç†,ä¿®æ”¹ include vhost/*.conf; # another virtual host using mix of IP-, name-, and port-based configuration # #server { # listen 8000; # listen somename:8080; # server_name somename alias another.alias; # location / { # root html; # index index.html index.htm; # } #} 3.1 /vhost/*.confçš„é…ç½® å½“å‰ç›®å½•åˆ°cd /usr/local/nginx/conf åˆ›å»ºç›®å½•vhostmkdir /usr/local/nginx/conf/vhost åˆ›å»º.confæ–‡ä»¶(æˆ‘åªç”¨åˆ°hexoçš„é…ç½®,æ‰€ä»¥åªæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶)vim /usr/local/nginx/conf/vhost/hexo.conf server { listen 80; #listen [::]:80; server_name www.phyooos.top phyooos.top; index index.html index.htm index.php default.html default.htm default.php; #web root path root /home/wzm/hexo; #error_page 404 /404.html; location ~ .*\\.(ico|gif|jpg|jpeg|png|bmp|swf)$ { access_log on; expires 1d; } location ~ .*\\.(js|css|txt|xml)?$ { access_log on; expires 12h; } location / { try_files $uri $uri/ =404; } access_log /usr/local/nginx/logs/hexo.log combined; } 4.é‡å¯systemctl reload nginx åœ¨å¤–é¢è®¿é—®å³å¯","categories":[{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/categories/Server/"}],"tags":[{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/tags/Server/"},{"name":"Linux","slug":"Linux","permalink":"https://www.wangzhumo.com/tags/Linux/"}]},{"title":"Roomæ•°æ®åº“ä½¿ç”¨æŒ‡åŒ—List<>çš„é—®é¢˜","slug":"room-list-object","date":"2017-12-25T05:08:10.000Z","updated":"2019-12-22T12:06:58.015Z","comments":true,"path":"2017/12/25/room-list-object/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/room-list-object/","excerpt":"Roomä¾èµ– implementation &quot;android.arch.persistence.room:runtime:1.0.0&quot; annotationProcessor &quot;android.arch.persistence.room:compiler:1.0.0&quot;","text":"Roomä¾èµ– implementation &quot;android.arch.persistence.room:runtime:1.0.0&quot; annotationProcessor &quot;android.arch.persistence.room:compiler:1.0.0&quot; æŸ¥æ‰¾** æŸ¥æ‰¾è¡¨ä¸­æ‰€æœ‰æ•°æ® /** * æŸ¥æ‰¾user * @return */ @Query(&quot;SELECT * FROM banners&quot;) List&lt;BannerModel&gt; findBanners(); æŒ‰æ¡ä»¶æŸ¥æ‰¾ /** * filters * @return * @param typeSort */ @Query(&quot;SELECT * FROM filters WHERE type != :typeSort&quot;) List&lt;FilterItemModel&gt; findFilters(String typeSort); é™åˆ¶æ¡æ•°çš„æ¡ä»¶æŸ¥æ‰¾ /** * è·å–æ’åº * @return */ @Query(&quot;SELECT * FROM filters WHERE type = :name LIMIT 0,1&quot;) FilterItemModel findSort(String name); ç°åœ¨è·å–çš„æ˜¯ç¬¬ä¸€æ¡æ•°æ® //æ–‡æ¡£ä¸­çš„ä¾‹å­ @Dao public interface MyDao { @Query(&quot;SELECT first_name, last_name FROM user WHERE region IN (:regions)&quot;) public List&lt;NameTuple&gt; loadUsersFromRegions(List&lt;String&gt; regions); } åœ¨userè¡¨ä¸­æŸ¥æ‰¾æ»¡è¶³é›†åˆList regionsä¸­æ¡ä»¶çš„å…ƒç´  è·å–æ€»è¡Œæ•° /** * è·å–æ•°æ®åº“è¡¨ä¸­æ€»æ¡æ•° * @return */ @Query(&quot;SELECT count(*) FROM search_history&quot;) long findHistoryCount(); è·å–æŸä¸€åˆ—çš„å’Œ /** * æ±‚å’Œ * @return */ @Query(&quot;SELECT sum(count) FROM status_stock&quot;) long findStatusStockCount(); æŒ‰ç…§é™åºæ’åˆ—(ASCå‡åº DESCé™åº) /** * æŸ¥æ‰¾user * @return */ @Query(&quot;SELECT * FROM search_history ORDER BY time DESC&quot;) List&lt;SearchHistoryModel&gt; findSearchHistory(); æ–‡æ¡£ä¸­çš„ä¾‹å­: @Dao public interface MyDao { //æ­£å¸¸çš„æŸ¥è¯¢ @Query(&quot;SELECT * FROM user WHERE age != :minAge&quot;) public User[] loadAllUsersOlderThan(int minAge); } @Dao public interface MyDao { //åŒºé—´ä¸­çš„å€¼ @Query(&quot;SELECT * FROM user WHERE age BETWEEN :minAge AND :maxAge&quot;) public User[] loadAllUsersBetweenAges(int minAge, int maxAge); //æˆ–å…³ç³»çš„æŸ¥è¯¢ @Query(&quot;SELECT * FROM user WHERE first_name LIKE :search &quot; + &quot;OR last_name LIKE :search&quot;) public List&lt;User&gt; findUserWithName(String search); } å¦‚æœ,ä½ ä¸æƒ³æŸ¥åˆ°è¡¨ è¡Œä¸­æ‰€æœ‰å­—æ®µ,åˆ™1.å®šä¹‰ä¸€ä¸ªå®ä½“ public class NameTuple { @ColumnInfo(name=&quot;first_name&quot;) public String firstName; @ColumnInfo(name=&quot;last_name&quot;) public String lastName; } 2.æŸ¥è¯¢ @Dao public interface MyDao { @Query(&quot;SELECT first_name, last_name FROM user&quot;) public List&lt;NameTuple&gt; loadFullName(); } å¤šè¡¨æŸ¥è¯¢Querying multiple tables @Dao public interface MyDao { @Query(&quot;SELECT user.name AS userName, pet.name AS petName &quot; + &quot;FROM user, pet &quot; + &quot;WHERE user.id = pet.user_id&quot;) public LiveData&lt;List&lt;UserPet&gt;&gt; loadUserAndPetNames(); // You can also define this class in a separate file, as long as you add the // &quot;public&quot; access modifier. //æ³¨æ„ public static class UserPet { public String userName; public String petName; } } æ›´æ–° æ›´æ–°æŒ‡å®šæ¡ç›® /** * æ›´æ–°æ—¶é—´ * @param time */ @Query(&quot;UPDATE search_history SET time = :time WHERE content = :content&quot;) void updateSearchHistory(String content,long time); åˆ é™¤æ•°æ® åˆ é™¤æ‰€æœ‰æ•°æ® /** * åˆ é™¤è¡¨ * @return */ @Query(&quot;DELETE FROM filters&quot;) void delectFilters(); åˆ é™¤æœ€åä¸€æ¡ /** * åˆ é™¤æœ€åä¸€ä¸ª * @return */ @Query(&quot;DELETE FROM search_history WHERE time in(SELECT time FROM search_history ORDER BY time ASC LIMIT 1 )&quot;) void delectLastHistory(); æŒ‰æ¡ä»¶åˆ é™¤ /** * åˆ é™¤è¡¨by listtype * @return */ @Query(&quot;DELETE FROM vehicle_model WHERE listType = :type&quot;) void delectVehicleByType(String type); ####è¡¥å…… 1.List&lt;String&gt;è¿™æ ·çš„å…ƒç´  private ArrayList&lt;String&gt; tags; è¿™æ ·çš„å…ƒç´ ,å¯ä»¥é€šè¿‡Converteræå®š /** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2017/12/27 ä¸Šåˆ11:51 */ public class TagsConverter { @TypeConverter public static ArrayList&lt;String&gt; fromString(String value) { Type listType = new TypeToken&lt;ArrayList&lt;String&gt;&gt;() {}.getType(); return new Gson().fromJson(value, listType); } @TypeConverter public static String fromArrayList(ArrayList&lt;String&gt; list) { Gson gson = new Gson(); String json = gson.toJson(list); return json; } } åœ¨dbä¸­,ä¼šå­˜ä¸º [&quot;ç²¾é€‰&quot;] [&quot;ç²¾é€‰&quot;,&quot;æ€¥å”®&quot;] [&quot;å‡†æ–°&quot;,&quot;SUV&quot;] 3.@Embedded ä½œç”¨æ˜¯,æŠŠå·²ç»å†™å¥½çš„æ™®é€šçš„ç±»æ·»åŠ åˆ°æ•°æ®è¡¨ä¸­.ç”¨Roomçš„æ–‡æ¡£åšè¯´æ˜: //è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„æ•°æ®è¡¨ @Entity class User { @PrimaryKey public int id; public String firstName; } å…¶ä¸­åªæœ‰id , firstName è€Œæˆ‘æƒ³æ·»åŠ  street; state; city; postCode;åˆšå¥½ä¹‹å‰å†™äº†ä¸€ä¸ªç±»å«Address class Address { public String street; public String state; public String city; @Ignore public String nothing; @ColumnInfo(name = &quot;post_code&quot;) public int postCode; } é‚£ä¹ˆæˆ‘é€šè¿‡ @Embedded @Entity class User { @PrimaryKey public int id; public String firstName; @Embedded public Address address; } è¡¨ä¸­å°±ä¼šæœ‰:names: id, firstName, street, state, city, and post_code å¦‚æœä½ æƒ³ç»™@Embeddedçš„ç±»ä¸­æ‰€æœ‰å…ƒç´ å‰é¢åŠ ä¸Šç»Ÿä¸€çš„æ ‡å¿— @Embedded(prefix = &quot;address_&quot;) è¡¨ä¸­å°±ä¼šæœ‰: names: id, firstName, address_street, address_state, address_city, and address_post_code 3.List&lt;Object&gt;è¿™æ ·çš„æ•°æ® è§£å†³æ–¹æ³•google developer çœŸçš„ç»™è°·æ­Œè·ªäº†,ä»€ä¹ˆé¬¼æ–‡æ¡£ @Entity public class User { // è¿™é‡Œæ˜¯ç”¨æˆ·çš„ Id @PrimaryKey public int id; //çœç•¥ ... } @Entity public class Book { //ä¹¦çš„id @PrimaryKey public int bookId; //è¿™é‡Œå°±æ˜¯è¿™æœ¬ä¹¦ä¸ \bUser\bçš„å…³ç³»,è¿™é‡Œçš„æ˜¯User.id public int userId; public String name; public String desc; } //æ³¨æ„,ä»€ä¹ˆæ³¨è§£ä¹Ÿä¸è¦åŠ  public class UserAndBooks { //åŠ å…¥æ‰€æœ‰çš„userçš„å±æ€§ @Embedded public User user; //è¿™é‡Œå®šä¹‰User å’Œ Bookçš„å…³ç³» @Relation(parentColumn = &quot;id&quot;, entityColumn = &quot;userId&quot;, entity = Book.class) public List&lt;Book&gt; books; } //æ–‡æ¡£ä¸Šè¿˜è®²äº†ä¸€ä¸ªæ¯”è¾ƒç‰›é€¼çš„åŠŸèƒ½,è¿™é‡Œä¸è®¨è®º public class UserAndAllPets { @Embedded public User user; @Relation(parentColumn = &quot;id&quot;, entityColumn = &quot;userId&quot;, entity = Book.class, projection = {&quot;name&quot;}) public List&lt;String&gt; bookNames; } //ç„¶å,daoæ˜¯è¿™æ ·çš„ @Dao public interface UserDao { @Query(&quot;SELECT * FROM User&quot;) public List&lt;UserAndBooks&gt; loadUserWithBooks(); } PS:å½“ç„¶ä½ å­˜çš„æ—¶å€™,åˆ†è¾¨åˆ«å­˜User å’Œ Book å³å¯","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Room","slug":"Room","permalink":"https://www.wangzhumo.com/tags/Room/"}]},{"title":"Retrofit2 + Okhttp3 + Rxjava2 ç½‘ç»œè¯·æ±‚å°è£…(ä¸‹)","slug":"Retrofit2-Okhttp3-Rxjava2-2","date":"2017-12-25T04:51:47.000Z","updated":"2019-12-22T12:07:18.654Z","comments":true,"path":"2017/12/25/Retrofit2-Okhttp3-Rxjava2-2/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Retrofit2-Okhttp3-Rxjava2-2/","excerpt":"","text":"//è¯·æ±‚: RetrofitApis.getNetworkApis().getFriendsCircle(userBean.token, String.valueOf(45),null,lastId) .compose(new DefaultTransformer&lt;&gt;()) .subscribe(new Defaultubscriber&lt;List&lt;FriendItem&gt;&gt;() { @Override protected void onError(ApiException ex) { //è¯·æ±‚é”™è¯¯,exä¸­å¯ä»¥æ‹¿åˆ°code å’Œ msg ä¾¿äºå±•ç¤ºç»™ç”¨æˆ· } @Override public void onNext(List&lt;FriendItem&gt; friends) { //è¯·æ±‚æˆåŠŸ,friendså°±æ˜¯æ•°æ® } @Override public void onComplete() { //æ²¡æœ‰é”™è¯¯çš„è¯,\bæœ€åä¼šèµ°ç€ } }); compose() è½¬åŒ–subscribe() è®¢é˜… DefaultTransformer.java /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/11/3 ä¸‹åˆ5:06 * * é»˜è®¤çš„åˆ‡æ¢çº¿ç¨‹,å¹¶è¿”å›å®ä½“ç±» */ public class DefaultTransformer&lt;T extends ResultResponse&lt;RP&gt;, RP&gt; implements FlowableTransformer&lt;T, RP&gt; { @Override public Publisher&lt;RP&gt; apply(Flowable&lt;T&gt; upstream) { return upstream .map(t -&gt; t.getResult()) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()); } } 1.map å°†è¿”å›çš„ResultResponse&lt;&gt; è½¬åŒ–,ç›´æ¥å–ResultResponseçš„æ³›å‹å®ä½“ {&quot;result&quot;:{} &quot;code&quot;:&quot;&quot;, &quot;msg&quot;:&quot;&quot;} ä¸­çš„result 2.subscribeOn(Schedulers.io()) ç½‘ç»œè¯·æ±‚çš„è€—æ—¶æ“ä½œ,æ”¾åœ¨æ–¹ä¾¿ioæ“ä½œçš„çº¿ç¨‹é‡Œé¢3.observeOn(AndroidSchedulers.mainThread()) åé¢çš„æ“ä½œ,éƒ½åœ¨ä¸»çº¿ç¨‹è¿›è¡Œ Defaultubscriber.java /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/24 ä¸Šåˆ10:36 * * ç”¨äºæ²¡æœ‰ç½‘ç»œæ—¶åœæ­¢ç½‘ç»œè¯·æ±‚ */ public abstract class Defaultubscriber&lt;T&gt; extends DisposableSubscriber&lt;T&gt; { @CallSuper @Override public void onError(Throwable e) { if (e instanceof ApiException) { onError((ApiException) e); } else { onError(new ApiException(&quot;&quot;,&quot;&quot;)); } } @Override protected void onStart() { if (!SystemUtils.isNetworkConnected()) { onError(new ApiException(Utils.getString(R.string.net_error_title),&quot;999&quot;)); cancel(); return; } super.onStart(); } /** * é”™è¯¯å›è°ƒ * * @param ex å¼‚å¸¸ä¿¡æ¯ */ protected abstract void onError(ApiException ex); } 1.extends DisposableSubscriber ä¾¿äºé€šè¿‡CompositeDisposableç®¡ç†è¯·æ±‚,æ­¤å¤„æ²¡æœ‰å±•ç¤º,ä¸ç”¨ç®¡2.onStart() ä¸­,åˆ¤æ–­æ˜¯å¦æœ‰ç½‘ç»œ æ²¡æœ‰ç½‘ç»œ onError(new ApiException(Utils.getString(R.string.net_error), false));æŠ›å‡ºæ²¡æœ‰ç½‘ç»œçš„é”™è¯¯,ç”±å„ä¸ªé¡µé¢è‡ªè¡Œå¤„ç† cancel(); å–æ¶ˆ \bæœ‰ç½‘ç»œåˆ™ç»§ç»­ 3.é‡å†™çš„ onError()ä¸­. æ˜¯ApiExceptionå®ä¾‹çš„,æ˜¯è‡ªå·±æŠ›å‡ºçš„å¼‚å¸¸,å·²ç»å¤„ç†è¿‡äº†,ç›´æ¥onErrorç»™å„ä¸ªé¡µé¢å¤„ç† ä¸æ˜¯çš„å†å¤„ç†ä¸€æ¬¡,åœ¨åˆ†å‘ç»™å„ä¸ªé¡µé¢å¤„ç† ####æœªå®Œå¾…ç»­â€¦","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Okhttp","slug":"Okhttp","permalink":"https://www.wangzhumo.com/tags/Okhttp/"},{"name":"Rxjava","slug":"Rxjava","permalink":"https://www.wangzhumo.com/tags/Rxjava/"}]},{"title":"Retrofit2 + Okhttp3 + Rxjava2 ç½‘ç»œè¯·æ±‚å°è£…(ä¸Š)","slug":"Retrofit2-Okhttp3-Rxjava2-1","date":"2017-12-25T04:14:04.000Z","updated":"2019-12-22T12:07:17.028Z","comments":true,"path":"2017/12/25/Retrofit2-Okhttp3-Rxjava2-1/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Retrofit2-Okhttp3-Rxjava2-1/","excerpt":"\bæœ€ç»ˆç»“æ„ net â”œâ”€â”€ RequestBuilder.java â”œâ”€â”€ RetrofitApis.java â”œâ”€â”€ base â”‚ â”œâ”€â”€ ApiException.java â”‚ â”œâ”€â”€ CustomGsonConverter.java â”‚ â”œâ”€â”€ DefaultSubscriber.java â”‚ â””â”€â”€ DefaultTransformer.java â””â”€â”€ response â”œâ”€â”€ BaseResponse.java â””â”€â”€ ResultResponse.java NetworkApis.java","text":"\bæœ€ç»ˆç»“æ„ net â”œâ”€â”€ RequestBuilder.java â”œâ”€â”€ RetrofitApis.java â”œâ”€â”€ base â”‚ â”œâ”€â”€ ApiException.java â”‚ â”œâ”€â”€ CustomGsonConverter.java â”‚ â”œâ”€â”€ DefaultSubscriber.java â”‚ â””â”€â”€ DefaultTransformer.java â””â”€â”€ response â”œâ”€â”€ BaseResponse.java â””â”€â”€ ResultResponse.java NetworkApis.java 1.æ·»åŠ ä¾èµ– implementation &quot;io.reactivex.rxjava2:rxjava:2.1.7&quot; implementation &quot;io.reactivex.rxjava2:rxandroid:2.0.1&quot; implementation &quot;com.squareup.okhttp3:okhttp:3.9.0&quot; implementation &quot;com.squareup.okhttp3:logging-interceptor:3.9.0&quot; implementation &quot;com.squareup.retrofit2:retrofit:2.3.0&quot; implementation &quot;com.squareup.retrofit2:converter-gson:2.3.0&quot; implementation &quot;com.squareup.retrofit2:adapter-rxjava2:2.3.0&quot; 2.è¯·æ±‚æœåŠ¡æ„å»º /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/11/1 ä¸‹åˆ11:13 * */ public class RetrofitApis { private static OkHttpClient okHttpClient = null; private static NetworkApis networkApis = null; private static Gson gson = new Gson(); private static final String TAG = &quot;RetrofitApis&quot;; /** * ä¸ºHOSTåˆ›å»ºä¸€ä¸ªè¯·æ±‚å®¢æˆ·ç«¯ * @return */ public static NetworkApis getNetworkApis() { initOkhttp(); if (networkApis == null) { Retrofit retrofit = new Retrofit.Builder() .client(okHttpClient) .baseUrl(Constants.HOST) .addConverterFactory(CustomGsonConverter.create(gson)) .addCallAdapterFactory(RxJava2CallAdapterFactory.create()) .build(); networkApis = retrofit.create(NetworkApis.class); } return networkApis; } /** * åˆå§‹åŒ–ä¸€ä¸ªOkHttpClient */ private static void initOkhttp(){ //æ²¡æœ‰åˆ›å»ºå°±å®ä¾‹ä¸€ä¸ª if(okHttpClient == null){ final OkHttpClient.Builder builder = new OkHttpClient.Builder(); //è®¾ç½®logç­‰çº§ if(BuildConfig.DEBUG){ HttpLoggingInterceptor interceptor = new HttpLoggingInterceptor(); //BODY åŒ…å«è¯·æ±‚url å‚æ•° response ,ä¼šæ‰“å°åœ¨logcat interceptor.setLevel(HttpLoggingInterceptor.Level.BODY); builder.addInterceptor(interceptor); } //æ‰“å¼€ä¸€ä¸ªFileç”¨äºç¼“å­˜ File cacheFile = new File(Constants.PATH_CACHE); Cache cache = new Cache(cacheFile,1024*1024*50); //ä¸€ä¸ªæ‹¦æˆªå™¨ Interceptor cacheInterceptor = new Interceptor() { @Override public Response intercept(Chain chain) throws IOException { Request.Builder builder = chain.request().newBuilder(); if(SystemUtils.isNetworkConnected()){ int maxAge = 0 ; //æœ‰ç½‘ç»œ,ä¸ç¼“å­˜,æœ€é•¿ä¿å­˜æ—¶é—´ä¸º0 builder.removeHeader(&quot;Pragma&quot;) .header(&quot;Cache-Control&quot;, &quot;public, max-age=&quot; + maxAge) .build(); } else { // æ— ç½‘ç»œæ—¶ï¼Œè®¾ç½®è¶…æ—¶ä¸º2å‘¨ int maxStale = 60 * 60 * 24 * 14; builder.removeHeader(&quot;Pragma&quot;) .header(&quot;Cache-Control&quot;, &quot;public, only-if-cached, max-stale=&quot; + maxStale) .build(); throw new ApiException(false); } return chain.proceed(builder.build()); } }; //è®¾ç½®ç¼“å­˜æ‹¦æˆªå™¨ builder.addInterceptor(cacheInterceptor); builder.addNetworkInterceptor(cacheInterceptor); //è¿™é‡Œé€šè¿‡Interceptor å¯ä»¥å®ç°æ·»åŠ å…¬å…±å‚æ•°,ä¸è¯¦ç»†è¯´æ˜äº† //stetho,å¦‚æœä½¿ç”¨åˆ™éœ€è¦æ·»åŠ  //builder.addNetworkInterceptor(new StethoInterceptor()); builder.cache(cache); //é”™è¯¯é‡è¿ builder.retryOnConnectionFailure(true); //è®¾ç½®è¶…æ—¶ builder.connectTimeout(15, TimeUnit.SECONDS); builder.readTimeout(15, TimeUnit.SECONDS); builder.writeTimeout(15, TimeUnit.SECONDS); okHttpClient = builder.build(); } } } ä»¥ä¸Š; ä½¿ç”¨ CustomGsonConverter.java / NetworkApis.javaé€šè¿‡getNetworkApis()æ–¹æ³•,å‘å¤–æä¾›äº†ä¸€ä¸ªè¯·æ±‚æœåŠ¡.å…¶ä¸­ .addConverterFactory(CustomGsonConverter.create(gson))æ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„Converteræ›¿ä»£äº†é»˜è®¤æä¾›çš„ CustomGsonConverter.java /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/24 ä¸Šåˆ10:31 * * GsonConverter ç”¨äºåœ¨ä¸è§£æè¿”å›æ­£æ–‡çš„å‰æä¸‹è·å–è¯·æ±‚æˆåŠŸå¤±è´¥å’Œ è¿”å›ä¿¡æ¯ */ public class CustomGsonConverter extends Converter.Factory { private final Gson gson; private CustomGsonConverter(Gson gson) { if (gson == null) { throw new NullPointerException(&quot;gson == null&quot;); } this.gson = gson; } public static CustomGsonConverter create() { return create(new Gson()); } public static CustomGsonConverter create(Gson gson) { return new CustomGsonConverter(gson); } @Override public Converter&lt;ResponseBody, ?&gt; responseBodyConverter(Type type, Annotation[] annotations, Retrofit retrofit) { TypeAdapter&lt;?&gt; adapter = gson.getAdapter(TypeToken.get(type)); return new CustomGsonResponseBodyConverter&lt;&gt;(gson, adapter); } private class CustomGsonResponseBodyConverter&lt;T&gt; implements Converter&lt;ResponseBody, T&gt; { private final Gson gson; private final TypeAdapter&lt;T&gt; adapter; public CustomGsonResponseBodyConverter(Gson gson, TypeAdapter&lt;T&gt; adapter) { this.gson = gson; this.adapter = adapter; } @Override public T convert(ResponseBody value) throws IOException { String response = value.string(); BaseResponse baseResponse = gson.fromJson(response,BaseResponse.class); if (!baseResponse.isCodeSuccess()) { value.close(); throw new ApiException(baseResponse.error); } MediaType contentType = value.contentType(); Charset charset = contentType != null ? contentType.charset(UTF_8) : UTF_8; InputStream inputStream = new ByteArrayInputStream(response.getBytes()); Reader reader = new InputStreamReader(inputStream, charset); JsonReader jsonReader = gson.newJsonReader(reader); try { return adapter.read(jsonReader); } finally { value.close(); } } } @Nullable @Override public Converter&lt;?, RequestBody&gt; requestBodyConverter(Type type, Annotation[] parameterAnnotations, Annotation[] methodAnnotations, Retrofit retrofit) { return super.requestBodyConverter(type,parameterAnnotations,methodAnnotations,retrofit); } } requestBodyConverteræ²¡æœ‰é‡å†™,åé¢å‘ç°äº†ä¸€ä¸ªbug,ä¸Šä¼ æ–‡ä»¶+æ–‡å­—å‚æ•°æ—¶,å¯èƒ½ä¼šé€ æˆ Lengthå‡ºé”™.responseBodyConverter é‡å†™,å…ˆæŠŠresponseè§£æ,å¦‚æœæœ‰é—®é¢˜åˆ™throw new ApiException(baseResponse.error);ä¼šä¸»åŠ¨èµ°RxJavaçš„ onError() å¦‚æœæ²¡æœ‰é—®é¢˜,åˆ™ç»§ç»­,å¥½åƒæœ‰ç‚¹å¤šä½™â€¦â€¦ ApiException.java å°±æ˜¯ç”¨äºå°è£…å¼‚å¸¸ /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/24 ä¸Šåˆ10:29 * * æ­¤ç±»ä½œä¸ºç½‘ç»œè¯·æ±‚å¼‚å¸¸çš„åŸº */ public class ApiException extends IOException { String code; String msg; public ApiException(String code){ this.code = code; } public ApiException(String msg, String code){ super(msg); this.msg = msg; this.code = code; } public boolean getCode() { return code; } @Override public String getMessage() { return msg; } } 3.Responseè¿”å›æ•°æ®çš„å°è£… è¿™é‡Œæ ¹æ®åå°è¿”å›æ•°æ®ç»“æ„ æˆ‘ä»¬çš„è¿”å›æ˜¯ { &quot;result&quot;:{ }, &quot;msg&quot;:&quot;è¯·æ±‚æˆåŠŸ&quot;, &quot;code&quot;:&quot;0000&quot; } BaseResponse.java /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/19 ä¸‹åˆ5:41 * */ public class BaseResponse{ public String code; public String msg; /** * APIæ˜¯å¦è¯·æ±‚å¤±è´¥ * * @return å¤±è´¥è¿”å›true, æˆåŠŸè¿”å›false */ public boolean isCodeSuccess() { return &quot;0000&quot;.equals(code); } } æ‰€æœ‰çš„è¿”å›æ•°æ®ç±»,éƒ½è¦ç»§æ‰¿å®ƒ,ä¾¿äºCustomGsonConverter ä¸­åˆ¤æ–­è¿”å›æ•°æ®çš„æ­£ç¡®æ€§ ResultResponse.java /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/19 ä¸‹åˆ5:37 */ public class ResultResponse&lt;T&gt; extends BaseResponse { private T result; public T getResult() { return result; } } é€šè¿‡T\bæ³›å‹,æŒ‡å®šè¿”å›resultçš„ç»“æ„,è®©gsonè§£ææˆå®ä½“å¯¹è±¡ T å¯èƒ½æ˜¯ å®ä½“å¯¹è±¡ å¯èƒ½æ˜¯ \bList&lt;å®ä½“å¯¹è±¡&gt; â€¦. 4.è¯·æ±‚æ•°æ® NetworkApis.java /** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/19 ä¸‹åˆ5:40 * * æ‰€æœ‰ç½‘ç»œè¯·æ±‚ */ public interface NetworkApis { /** * è·å–æœ‹å‹åœˆåˆ—è¡¨ * @param token * @return */ @POST(&quot;QCRL/qcrl?command=getFriendsCircle&quot;) @FormUrlEncoded Flowable&lt;ResultResponse&lt;List&lt;FriendItem&gt;&gt;&gt; getFriendsCircle( @Field(&quot;token&quot;) String token, @Field(&quot;number&quot;) String number, @Field(&quot;userId&quot;) String userId, @Field(&quot;lastDate&quot;) String lastId); /** * åˆ é™¤ * @param token * @param circleId * @return */ @POST(&quot;QCRL/qcrl?command=updateFriendsCircle&quot;) @FormUrlEncoded Flowable&lt;ResultResponse&lt;String&gt;&gt; updateFriendsCircle( @Field(&quot;token&quot;) String token, @Field(&quot;circleId&quot;) String circleId); /** * èµ * @param token * @param circleId * @param userId * @return */ @POST(&quot;QCRL/qcrl?command=addFavor&quot;) @FormUrlEncoded Flowable&lt;ResultResponse&lt;Object&gt;&gt; addFavor( @Field(&quot;token&quot;) String token, @Field(&quot;circleId&quot;) String circleId, @Field(&quot;toId&quot;) String userId); ... } æ ¹æ®è‡ªå·±çš„æ¥å£ç¼–å†™å³å¯@POST() æŒ‡è¯·æ±‚æ–¹å¼ä¸º POST æ³¨æ„,æ‹¬å·ä¸­çš„ç½‘å€,å¼€å¤´ä¸å¯ä»¥ä½¿ç”¨/QCRL/â€¦å¦åˆ™ä¼šç›´æ¥æ‹¼åˆ°HOSTåé¢,urlå¯èƒ½ä¼šé”™è¯¯ @FormUrlEncoded è¡¨ç¤ºformè¡¨å•æäº¤,ä¼šEncodedç¼–ç å‚æ•° @Field æ¯ä¸€ä¸ªå‚æ•°","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Okhttp","slug":"Okhttp","permalink":"https://www.wangzhumo.com/tags/Okhttp/"},{"name":"Rxjava","slug":"Rxjava","permalink":"https://www.wangzhumo.com/tags/Rxjava/"}]},{"title":"Androidé¡¹ç›®çš„build.gradleé€šç”¨è®¾ç½®","slug":"Android-build-gradle-config","date":"2017-12-25T03:57:59.000Z","updated":"2019-12-22T12:03:23.407Z","comments":true,"path":"2017/12/25/Android-build-gradle-config/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Android-build-gradle-config/","excerpt":"","text":"apply plugin: &#39;com.android.application&#39; android { //å¼€å¯dataBinding dataBinding{ enabled = true } defaultConfig { //å¼€å¯multiDex multiDexEnabled true //ä½¿ç”¨jni ndk { //è®¾ç½®æ”¯æŒçš„SOåº“æ¶æ„,è¿™é‡Œçš„æ„æ€æ˜¯åªæ”¯æŒ&#39;armeabi&#39;, &#39;armeabi-v7a&#39;, &#39;x86&#39; //è¿™ä¸‰ç§æ¶æ„ abiFilters &#39;armeabi&#39;, &#39;armeabi-v7a&#39;, &#39;x86&#39; } } //è®¾ç½®ä¸€ä¸ªç¼–è¯‘çš„é…ç½® signingConfigs { //åä¸ºrelease\b\bçš„é…ç½®é¡¹ release { //ç­¾åæ–‡ä»¶çš„ä½ç½®,å½“å‰ä½ç½®æ˜¯æ ¹ç›®å½• storeFile file(&quot;/keyfile.jks&quot;) //storePassword storePassword &quot;xxxxxxxx&quot; //keyAlias keyAlias &quot;wangzhumo&quot; //keyPassword keyPassword &quot;xxxxxxxx&quot; //æ˜¯å¦ä½¿ç”¨v2Signing v2SigningEnabled false } } //ç¼–è¯‘çš„ç‰ˆæœ¬ buildTypes { //debugæ—¶çš„é…ç½® debug { minifyEnabled false //è¿™é‡Œä½¿ç”¨ä¸Šé¢é…ç½®çš„ç­¾å,å¯ä»¥åšåˆ°debugæ—¶,ä¹Ÿä½¿ç”¨çš„æ˜¯æ­£å¼ç­¾å,è€Œä¸æ˜¯debugçš„ keystore signingConfig signingConfigs.release //buildConfig çš„ä¸€ä¸ªå‚æ•°,æ˜¯å¦å¼€å¯log buildConfigField &quot;boolean&quot;, &quot;LOG_DEBUG&quot;, &quot;true&quot; proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39; } release { // æ˜¾ç¤ºLog minifyEnabled false signingConfig signingConfigs.release buildConfigField &quot;boolean&quot;, &quot;LOG_DEBUG&quot;, &quot;false&quot; proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39; } } //adbçš„é…ç½®é¡¹ adbOptions { //è¶…æ—¶æ—¶é—´ timeOutInMs = 5 * 1000 //adb install -r /path..apk installOptions &#39;-r&#39; } flavorDimensions &#39;env&#39; productFlavors { //æ­£å¼ç‰ˆæœ¬ envydemo{ dimension &#39;env&#39; //æ­¤å¤„æ˜¯versionName versionName &quot;V1.1&quot; //manifestPlaceholders //æ˜¯manifestå·²ç»å®šä¹‰çš„å‚æ•°,è¿™é‡Œç»™è¯¥å‚æ•°èµ‹å€¼ manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;wangzhumoo&quot;] //buildConfig çš„å‚æ•°,Appå½“å‰çš„HOSTåœ°å€ buildConfigField &quot;String&quot;,&quot;SERVER_HOST&quot;,&#39;&quot;http://app....com/&quot;&#39; } envtest { dimension &#39;env&#39; versionName &quot;Test&quot; manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;wangzhumoo&quot;] buildConfigField &quot;String&quot;,&quot;SERVER_HOST&quot;,&#39;&quot;http://app.test....com/&quot;&#39; } } //è‡ªå®šä¹‰apkåå­— android.applicationVariants.all { variant -&gt; variant.outputs.all { //apkçš„åå­— outputFileName = &quot;App_${variant.versionName}.apk&quot; } } android { //æ’é™¤ configurations.all { resolutionStrategy.force &#39;com.google.code.findbugs:jsr305:1.3.9&#39; } } //ä½¿ç”¨java8 compileOptions { sourceCompatibility JavaVersion.VERSION_1_8 targetCompatibility JavaVersion.VERSION_1_8 } } ä»¥ä¸Šä»£ç ,åˆ é™¤äº†å¸¸è§çš„éƒ¨åˆ†. buildConfigField /** * å¸¸é‡ç±» */ public class Constants { //å–åˆ°åœ¨productFlavors.envyhcsé…ç½®çš„å‚æ•° //buildConfigField &quot;String&quot;,&quot;SERVER_HOST&quot;,&#39;&quot;http://app....com/&quot;&#39; public static final String BASE_URL = BuildConfig.SERVER_HOST; } manifestPlaceholders &lt;manifest&gt; &lt;application&gt; //å–åˆ°åœ¨productFlavors.envyhcsé…ç½®çš„å‚æ•° //manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;wangzhumo&quot;] &lt;meta-data android:name=&quot;UMENG_CHANNEL&quot; android:value=&quot;${UMENG_CHANNEL_VALUE}&quot; /&gt; &lt;/application&gt; &lt;/manifest&gt; Build Variantsåœ¨build.gradleä¸­é…ç½®äº†productFlavors{ envdemo{} , envtest{}} å…¶ä¸­dimensionä¸€ä¸ªç»´åº¦å…¶ä¸­buildTypesä¸€ä¸ªç»´åº¦ debug + evndemodebug + evntestrelease + evndemerelease + evntest å…±4ç§,å…¶ä»–çš„å¹¶æ²¡æœ‰ä½¿ç”¨åˆ°,æ‰€ä»¥ä¸åšè¯´æ˜ å¯ä»¥\bé€‰æ‹©debugé»˜è®¤çš„ç‰ˆæœ¬â€¦","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Gradle","slug":"Gradle","permalink":"https://www.wangzhumo.com/tags/Gradle/"}]},{"title":"Android é¡¹ç›®ç»Ÿä¸€ç®¡ç†ä¾èµ–ç‰ˆæœ¬","slug":"Android-dependent-config","date":"2017-12-25T03:39:45.000Z","updated":"2019-12-22T12:03:26.464Z","comments":true,"path":"2017/12/25/Android-dependent-config/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Android-dependent-config/","excerpt":"å‡†å¤‡å¼•å…¥Arouter,åšä¸€ä¸ªç»„ä»¶çš„demo,å°±å¼€å§‹æ…¢æ…¢çš„æ”¹é€ é¡¹ç›® . |-- app | |-- build.gradle | |-- libs | |-- src | | |-- androidTest | | |-- main | | `-- test | |-- opensource | |-- build.gradle | |-- libs | `-- src | `-- main |-- build.gradle |-- settings.gradle `-- versions.gradle app ä¸ºä¸»é¡¹ç›®opensource ä½œä¸ºlibraryå­˜åœ¨,å°†æ¥ä¼šæˆä¸ºbaseLibçš„ä¾èµ–,å…¶ä¸­æ˜¯æ‰€æœ‰çš„ä¸‰æ–¹ä¾èµ–,å¼€æºä»£ç ç­‰ç­‰","text":"å‡†å¤‡å¼•å…¥Arouter,åšä¸€ä¸ªç»„ä»¶çš„demo,å°±å¼€å§‹æ…¢æ…¢çš„æ”¹é€ é¡¹ç›® . |-- app | |-- build.gradle | |-- libs | |-- src | | |-- androidTest | | |-- main | | `-- test | |-- opensource | |-- build.gradle | |-- libs | `-- src | `-- main |-- build.gradle |-- settings.gradle `-- versions.gradle app ä¸ºä¸»é¡¹ç›®opensource ä½œä¸ºlibraryå­˜åœ¨,å°†æ¥ä¼šæˆä¸ºbaseLibçš„ä¾èµ–,å…¶ä¸­æ˜¯æ‰€æœ‰çš„ä¸‰æ–¹ä¾èµ–,å¼€æºä»£ç ç­‰ç­‰ 1.æ ¹ç›®å½•åˆ›å»ºversions.gradle /versions.gradle ext.deps = [:] def versions = [:] versions.arch = &quot;1.0.0&quot; versions.support = &quot;27.0.1&quot; versions.dagger = &quot;2.13&quot; versions.stetho = &quot;1.5.0&quot; versions.dialogs = &quot;0.9.6.0&quot; versions.glide = &quot;4.3.1&quot; versions.gradle = &quot;3.0.1&quot; versions.rxJava = &quot;2.1.7&quot; versions.rxAndroid = &quot;2.0.1&quot; versions.rxRelay = &quot;2.0.0&quot; versions.rxBinding = &quot;2.0.0&quot; versions.paging = &quot;1.0.0-alpha3&quot; versions.okhttp = &quot;3.9.0&quot; versions.retrofit = &quot;2.3.0&quot; versions.kotlin = &quot;1.2.0&quot; versions.kotlinBind = &quot;3.0.1&quot; versions.gson = &quot;2.8.2&quot; versions.arouterVersion = &quot;1.2.4&quot; versions.arouterProcessor = &quot;1.1.4&quot; versions.atslRunner = &quot;1.0.1&quot; versions.atslRules = &quot;1.0.1&quot; versions.hamcrest = &quot;1.3&quot; versions.timber = &quot;4.5.1&quot; versions.mockwebserver = &quot;3.8.1&quot; versions.apache_commons = &quot;2.5&quot; versions.mockito = &quot;2.7.19&quot; versions.mockito_all = &quot;1.10.19&quot; versions.dexmaker = &quot;2.2.0&quot; versions.constraint = &quot;1.0.2&quot; versions.junit = &quot;4.12&quot; versions.espresso = &quot;3.0.1&quot; def deps = [:] def rxLib = [:] rxLib.rxJava = &quot;io.reactivex.rxjava2:rxjava:$versions.rxJava&quot; rxLib.rxAndroid = &quot;io.reactivex.rxjava2:rxandroid:$versions.rxAndroid&quot; rxLib.rxBinding = &quot;com.jakewharton.rxbinding2:rxbinding:$versions.rxBinding&quot; rxLib.rxBingingV4 = &quot;com.jakewharton.rxbinding2:rxbinding-support-v4:$versions.rxBinding&quot; rxLib.rxBingingRecycler = &quot;com.jakewharton.rxbinding2:rxbinding-recyclerview-v7:$versions.rxBinding&quot; rxLib.rxBingingV7 = &quot;com.jakewharton.rxbinding2:rxbinding-appcompat-v7:$versions.rxBinding&quot; rxLib.rxBingingDesign = &quot;com.jakewharton.rxbinding2:rxbinding-design:$versions.rxBinding&quot; rxLib.rxRelay = &quot;com.jakewharton.rxrelay2:rxrelay:$versions.rxRelay&quot; deps.rxLibs = rxLib def support = [:] support.annotations = &quot;com.android.support:support-annotations:$versions.support&quot; support.appCompat = &quot;com.android.support:appcompat-v7:$versions.support&quot; support.recyclerview = &quot;com.android.support:recyclerview-v7:$versions.support&quot; support.cardview = &quot;com.android.support:cardview-v7:$versions.support&quot; support.design = &quot;com.android.support:design:$versions.support&quot; support.v4 = &quot;com.android.support:support-v4:$versions.support&quot; support.coreUtils = &quot;com.android.support:support-core-utils:$versions.support&quot; deps.support = support def archLib = [:] archLib.archExtensions = &quot;android.arch.lifecycle:extensions:$versions.arch&quot; archLib.archRoomRuntime = &quot;android.arch.persistence.room:runtime:$versions.arch&quot; archLib.archRoomCompiler = &quot;android.arch.persistence.room:compiler:$versions.arch&quot; archLib.archLifecycleCommon = &quot;android.arch.lifecycle:common-java8:$versions.arch&quot; deps.archLibs = archLib def glide = [:] glide.glide = &quot;com.github.bumptech.glide:glide:$versions.glide&quot; glide.glideCompiler = &quot;com.github.bumptech.glide:compiler:$versions.glide&quot; deps.glide = glide def stethos = [:] stethos.stetho = &quot;com.facebook.stetho:stetho:$versions.stetho&quot; stethos.stethoHttp = &quot;com.facebook.stetho:stetho-okhttp3:$versions.stetho&quot; deps.stetho = stethos def okhttp = [:] okhttp.okhttp = &quot;com.squareup.okhttp3:okhttp:$versions.okhttp&quot; okhttp.okhttpLogging = &quot;com.squareup.okhttp3:logging-interceptor:$versions.okhttp&quot; deps.okhttp = okhttp def retrofit = [:] retrofit.retrofit = &quot;com.squareup.retrofit2:retrofit:$versions.retrofit&quot; retrofit.converterGson = &quot;com.squareup.retrofit2:converter-gson:$versions.retrofit&quot; retrofit.adapterRxjava = &quot;com.squareup.retrofit2:adapter-rxjava2:$versions.retrofit&quot; deps.retrofit = retrofit def arouter = [:] arouter.runtime = &quot;com.alibaba:arouter-api:$versions.arouterVersion&quot; arouter.compiler = &quot;com.alibaba:arouter-compiler:$versions.arouterProcessor&quot; deps.arouter = arouter def dagger = [:] dagger.dagger = &quot;com.google.dagger:dagger:$versions.dagger&quot; dagger.daggerAndroid = &quot;com.google.dagger:dagger-android:$versions.dagger&quot; dagger.daggerAndroidSupport = &quot;com.google.dagger:dagger-android-support:$versions.dagger&quot; dagger.daggerCompiler = &quot;com.google.dagger:dagger-compiler:$versions.dagger&quot; dagger.daggerAndroidCompiler = &quot;com.google.dagger:dagger-android-processor:$versions.dagger&quot; deps.dagger = dagger def kotlin = [:] kotlin.kotlinStdlib = &quot;org.jetbrains.kotlin:kotlin-stdlib-jre8:$versions.kotlin&quot; kotlin.kotlinPlugin = &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$versions.kotlin&quot; kotlin.kotlinDatabind = &quot;com.android.databinding:compiler:$versions.kotlinBind&quot; deps.kotlin = kotlin def espresso = [:] espresso.core = &quot;com.android.support.test.espresso:espresso-core:$versions.espresso&quot; espresso.contrib = &quot;com.android.support.test.espresso:espresso-contrib:$versions.espresso&quot; espresso.intents = &quot;com.android.support.test.espresso:espresso-intents:$versions.espresso&quot; deps.espresso = espresso def atsl = [:] atsl.runner = &quot;com.android.support.test:runner:$versions.atsl_runner&quot; atsl.rules = &quot;com.android.support.test:rules:$versions.atsl_runner&quot; deps.atsl = atsl deps.multidex = &quot;com.android.support:multidex:1.0.1&quot; deps.dialog = &quot;com.afollestad.material-dialogs:core:$versions.dialogs&quot; deps.gson = &quot;com.google.code.gson:gson:$versions.gson&quot; deps.paging = &quot;android.arch.paging:runtime:$versions.paging&quot; deps.dexmaker = &quot;com.linkedin.dexmaker:dexmaker-mockito:$versions.dexmaker&quot; deps.constraint = &quot;com.android.support.constraint:constraint-layout:$versions.constraint&quot; deps.timber = &quot;com.jakewharton.timber:timber:$versions.timber&quot; deps.gradlePlugin = &quot;com.android.tools.build:gradle:$versions.gradle&quot; deps.kotlinPlugin = &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$versions.kotlin&quot; ext.deps = deps def buildVersions = [:] buildVersions.minSDK = 14 buildVersions.targetSDK = 26 buildVersions.compileSDK = 27 buildVersions.buildTools = &quot;26.0.2&quot; ext.buildVersion = buildVersions def addRepos(RepositoryHandler handler) { handler.google() handler.jcenter() handler.mavenCentral() handler.maven { url &#39;https://oss.jfrog.org/libs-snapshot&#39; } handler.maven { url &#39;https://jitpack.io&#39; } } ext.addRepos = this.&amp;addRepos å…¶ä¸­å£°æ˜äº†æ‰€æœ‰å·²ç»ç”¨åˆ°,æˆ–è€…å¯èƒ½ä½¿ç”¨çš„Libç‰ˆæœ¬,ä»¥åŠAndroid sdk tools çš„ç‰ˆæœ¬. 2.å°†å£°æ˜çš„ç‰ˆæœ¬,æ·»åŠ åˆ°é¡¹ç›®ä¸­,æ–¹ä¾¿å¼•ç”¨ /build.gradle é¡¹ç›®çš„build.gradleä¸­ buildscript { //åŠ å…¥å¼•ç”¨ apply from: &#39;versions.gradle&#39; //æ·»åŠ rep addRepos(repositories) dependencies { //ç”±versions.gradleç®¡ç†çš„ç‰ˆæœ¬ classpath deps.gradlePlugin classpath deps.kotlinPlugin // NOTE: Do not place your application dependencies here; they belong // in the individual module build.gradle files } } allprojects { //æ·»åŠ rep addRepos(repositories) } 3.å¯¹Android Tools,SDKç‰ˆæœ¬çš„æ§åˆ¶é¡¹ç›®/app/build.gradle android { //sdkçš„ç‰ˆæœ¬ compileSdkVersion buildVersion.compileSDK //toolsçš„ç‰ˆæœ¬ buildToolsVersion buildVersion.buildTools defaultConfig { //sdkç‰ˆæœ¬ minSdkVersion buildVersion.minSDK targetSdkVersion buildVersion.targetSDK versionCode 1 //ä¹Ÿå¯ä»¥ä½¿ç”¨ versionName &quot;1.0&quot; } // } 4.å…¶ä»–Libçš„ä¾èµ–æŒ‰ç…§è¿™æ ·çš„æ ¼å¼å³å¯ dependencies { //support api deps.support.appCompat api deps.support.recyclerview api deps.support.cardview api deps.support.design api deps.multidex api deps.constraint //rxjava api deps.rxLibs.rxJava api deps.rxLibs.rxAndroid api deps.rxLibs.rxRelay //http api deps.okhttp.okhttp api deps.okhttp.okhttpLogging api deps.retrofit.retrofit api deps.retrofit.converterGson api deps.retrofit.adapterRxjava api deps.gson //arch api deps.archLibs.archExtensions api deps.archLibs.archRoomRuntime api deps.archLibs.archLifecycleCommon annotationProcessor deps.archLibs.archRoomCompiler //stetho api deps.stetho.stetho api deps.stetho.stethoHttp //dialog api deps.dialog //glide api deps.glide.glide annotationProcessor deps.glide.glideCompiler }","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Gradle","slug":"Gradle","permalink":"https://www.wangzhumo.com/tags/Gradle/"},{"name":"ç»„ä»¶åŒ–","slug":"ç»„ä»¶åŒ–","permalink":"https://www.wangzhumo.com/tags/ç»„ä»¶åŒ–/"}]},{"title":"å¸¸ç”¨çš„Google Chrome æµè§ˆå™¨æ’ä»¶","slug":"Google-Chrome-Plug-In","date":"2017-12-25T02:35:02.000Z","updated":"2019-12-22T12:09:55.172Z","comments":true,"path":"2017/12/25/Google-Chrome-Plug-In/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Google-Chrome-Plug-In/","excerpt":"###å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„Chromeæ’ä»¶ 1.AdBlock æœ€å—æ¬¢è¿çš„Chromeæ‰©å±•ï¼Œæ‹¥æœ‰è¶…è¿‡4000ä¸‡ç”¨æˆ·ï¼å±è”½æ•´ä¸ªäº’è”ç½‘ä¸Šçš„å¹¿å‘Šã€‚ æ¨è: â˜…â˜…â˜…","text":"###å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„Chromeæ’ä»¶ 1.AdBlock æœ€å—æ¬¢è¿çš„Chromeæ‰©å±•ï¼Œæ‹¥æœ‰è¶…è¿‡4000ä¸‡ç”¨æˆ·ï¼å±è”½æ•´ä¸ªäº’è”ç½‘ä¸Šçš„å¹¿å‘Šã€‚ æ¨è: â˜…â˜…â˜… 2.Insight.io for Github Improve GitHub code browsing experienc.é€šè¿‡æ’ä»¶å¯ä»¥åœ¨githubçš„é¡¹ç›®é¡µé¢ä¸Š,ç»“æ„åŒ–çš„æŸ¥çœ‹ä»£ç ,ç”šè‡³è¿˜æœ‰â€å¼•ç”¨â€,â€æŸ¥æ‰¾â€ç­‰ç­‰åŠŸèƒ½.å°±åƒæ˜¯æŠŠgithubé¡¹ç›®é¡µ,å˜æˆäº†ä¸€ä¸ªåªèƒ½æŸ¥çœ‹çš„ide.å¯¹äº†,è¿˜èƒ½å¾ˆæ–¹ä¾¿çš„ä¸‹è½½å•ä¸ªæ–‡ä»¶ æ¨è: \b\b\bâ˜…â˜…â˜…â˜…â˜… 3.Infinityæ–°æ ‡ç­¾é¡µ é‡æ–°å®šä¹‰äº†æ–°æ ‡ç­¾é¡µï¼Œä¸€ä¸ªè¿½æ±‚æç®€ç¾å­¦å’Œä¸€ç«™å¼æœåŠ¡ä½“éªŒæ›´å°‘çš„ä¸œè¥¿ä½“éªŒæ›´å¤šçš„åŠŸèƒ½ã€‚ ç®€æ´,æ–¹ä¾¿,å®ç”¨ æ¨è:â˜…â˜…â˜…â˜… 4.PostmanPostman makes API development faster, easier, and better. æ›´å¿«â€¦..å“ˆå“ˆè¶…çº§æ–¹ä¾¿,æ¨¡æ‹Ÿè¯·æ±‚çš„App,æ”¯æŒpost get,å¯ä»¥æµ‹è¯•æ–‡ä»¶ä¸Šä¼ ç­‰è¿˜æœ‰æ¯”è¾ƒæ–¹ä¾¿çš„ä¸€ç‚¹æ˜¯,å¯ä»¥ç”Ÿæˆå½“å‰è¯·æ±‚çš„okhttp\bä»£ç ,è™½ç„¶åªèƒ½ä½œå‚è€ƒâ€¦.. æ¨è:â˜…â˜…â˜…â˜…â˜… å’Œå®ƒä¸€æ ·çš„è¿˜æœ‰Restlet Client - REST API Testing 5.BaiduExporterå¯ä»¥æ–¹ä¾¿çš„æŠŠç½‘ç›˜çš„ä¸‹è½½åœ°å€å¯¼å‡ºåˆ°aria2/aria2-rpcï¼Œæ”¯æŒYAAWã€‚é…åˆAria2GUI,å¯ä»¥é«˜é€Ÿä¸‹è½½ç™¾åº¦äº‘é™é€Ÿçš„æ–‡ä»¶.. è™½ç„¶è¿˜èƒ½ç”¨,ä½†æ˜¯ä½œè€…è¯´ä¸ç»´æŠ¤äº†,è¿˜æœ‰æ›¿ä»£å“:Aria2c Integrationæ²¡æœ‰ç”¨è¿‡,ä¸çŸ¥é“æ˜¯å¦å¯ç”¨. Aria2GUIGithub : https://github.com/aria2/aria2 æ¨è:â˜…â˜…â˜…â˜…â˜… å…¶ä»–æ¨è:â˜…â˜…â˜… SingleFileArchive a complete page into a single HTML fileå¯ä»¥å°†ç½‘é¡µä¿å­˜ä¸ºå•æ–‡ä»¶,æ–¹ä¾¿ä¿å­˜ å°è±¡ç¬”è®°Â·å‰ªè—ä½¿ç”¨å°è±¡ç¬”è®°æ‰©å±•ç¨‹åºä¸€é”®ä¿å­˜ç²¾å½©ç½‘é¡µå†…å®¹åˆ°å°è±¡ç¬”è®°å¸æˆ·ã€‚ JSON FormatterChrome extension for printing JSON and JSONP nicely when you visit it â€˜directlyâ€™ in a browser tab.Github : https://github.com/callumlocke/json-formatter","categories":[{"name":"Tools","slug":"Tools","permalink":"https://www.wangzhumo.com/categories/Tools/"}],"tags":[{"name":"tools","slug":"tools","permalink":"https://www.wangzhumo.com/tags/tools/"}]},{"title":"Jniä½¿ç”¨æŒ‡å—,å…³äº.soä½ åº”è¯¥çŸ¥é“çš„","slug":"jni-with-so","date":"2017-12-25T02:12:59.000Z","updated":"2019-12-22T12:09:28.265Z","comments":true,"path":"2017/12/25/jni-with-so/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/jni-with-so/","excerpt":"å…¶å®è¿™äº›éƒ½æ˜¯Androidè®¾å¤‡CPUçš„: armeabi: æ—©æœŸçš„æ‰‹æœºç”¨çš„æ¯”è¾ƒå¤š,é’ˆå¯¹æ™®é€šçš„æˆ–æ—§çš„arm v5 cpu,ã€‚ armeabiv-v7a:ç›®å‰ä¸»æµç‰ˆæœ¬ 2011å¹´ä»¥åçš„ç”Ÿäº§çš„å¤§éƒ¨åˆ†è®¾å¤‡,é’ˆå¯¹æœ‰æµ®ç‚¹è¿ç®—æˆ–é«˜çº§æ‰©å±•åŠŸèƒ½çš„arm v7 cpu. arm64-v8a: 8ä»£ã€64ä½ARMå¤„ç†å™¨ï¼Œ64ä½æ”¯æŒ. x86: æˆ‘ä»¬è§åˆ°çš„æ¨¡æ‹Ÿå™¨å¤§å¤šå°±æ˜¯è¿™ä¸ªã€‚ x86_64: 64ä½çš„å¹³æ¿ã€‚ ç„¶åç‰¹æ„è¯´ä¸€ä¸‹x86ç³»åˆ—çš„,æ˜¯å…¼å®¹armçš„,ä½†æ˜¯æ€§èƒ½æŸå¤±ç‰¹åˆ«å¤§.","text":"å…¶å®è¿™äº›éƒ½æ˜¯Androidè®¾å¤‡CPUçš„: armeabi: æ—©æœŸçš„æ‰‹æœºç”¨çš„æ¯”è¾ƒå¤š,é’ˆå¯¹æ™®é€šçš„æˆ–æ—§çš„arm v5 cpu,ã€‚ armeabiv-v7a:ç›®å‰ä¸»æµç‰ˆæœ¬ 2011å¹´ä»¥åçš„ç”Ÿäº§çš„å¤§éƒ¨åˆ†è®¾å¤‡,é’ˆå¯¹æœ‰æµ®ç‚¹è¿ç®—æˆ–é«˜çº§æ‰©å±•åŠŸèƒ½çš„arm v7 cpu. arm64-v8a: 8ä»£ã€64ä½ARMå¤„ç†å™¨ï¼Œ64ä½æ”¯æŒ. x86: æˆ‘ä»¬è§åˆ°çš„æ¨¡æ‹Ÿå™¨å¤§å¤šå°±æ˜¯è¿™ä¸ªã€‚ x86_64: 64ä½çš„å¹³æ¿ã€‚ ç„¶åç‰¹æ„è¯´ä¸€ä¸‹x86ç³»åˆ—çš„,æ˜¯å…¼å®¹armçš„,ä½†æ˜¯æ€§èƒ½æŸå¤±ç‰¹åˆ«å¤§. AndroidåŠ è½½.soçš„åŸåˆ™åŒä¸€ç›®å½•ä¸‹è¦ä¹ˆæ‰€æœ‰ä½¿ç”¨jniçš„é¡¹ç›®éƒ½ç»™åŠ ä¸Š.soæ–‡ä»¶,è¦ä¹ˆä½ å°±åˆ«ç»™è¿™ä¸ªç›®å½•,ä¹Ÿå°±æ˜¯åªè¦ä¸é½å…¨å°±éƒ½å¹²æ‰æ¯”å¦‚ä½ çš„libç»“æ„æ˜¯è¿™æ ·çš„ libs -armeabi -aaa.so -bbb.so -arm64-v8a -aaa.so å…¶å®è¿™ç§æƒ…å†µå°±æ˜¯å±äºåŒä¸€ç›®å½•ä¸‹,æä¾›çš„.soæ–‡ä»¶ä¸å…¨â€¦ç„¶è€Œå¾ˆå®¹æ˜“å‡ºç°,æ¯•ç«Ÿæœ‰äº›ä¸‰æ–¹å•Šä»€ä¹ˆçš„,æä¾›çš„.soæ–‡ä»¶å¹¶ä¸é½å…¨,è¿™æ ·çš„è¯åŒä¸€ä¸ªæ¶æ„ç›®å½•ä¸‹ä¼šç¼ºå°‘ä¸€ä¸ªæˆ–å¤šä¸ª.soæ–‡ä»¶. Androidåœ¨åŠ è½½æŸä¸ªä½¿ç”¨jniçš„åŠŸèƒ½æ—¶,ä½ å¹¶æ²¡æœ‰æä¾›x86çš„.soæ–‡ä»¶,ä½†æ˜¯ä½ æœ‰x86è¿™ä¸ªç›®å½•,é‚£å°±ä¼šå»x86ç›®å½•ä¸‹å»æ‰¾,æ²¡æœ‰å•Šç„¶åå°±å¼‚å¸¸äº†. AndroidåŠ è½½.soçš„ç›®å½•1.æˆ‘è‡ªå·±ç”¨çš„æ˜¯ ä¹Ÿå°±æ˜¯è‡ªå·±åœ¨app -&gt; src -&gt; main ä¸‹è‡ªå·±å»ºç«‹ä¸€ä¸ªç›®å½•: jniLibsç„¶åæ”¾è¿›å»å³å¯. 2.å°±æ˜¯é€šå¸¸æ”¾åœ¨libsç›®å½•ä¸‹äº†åˆ«å¿˜äº†åœ¨build.gradleæ–‡ä»¶ä¸­è®¾ç½® jniLibs.srcDir Androidæ’é™¤æŸæ¶æ„çš„.so android { ... defaultConfig { ... ndk { // è®¾ç½®æ”¯æŒçš„ SO åº“æ„æ¶ abiFilters &#39;armeabi&#39;, &#39;armeabi-v7a&#39; // &#39;arm64-v8a&#39;, &#39;x86&#39;, &#39;x86_64&#39;, &#39;mips&#39;, &#39;mips64&#39; } } } å¦‚æœç¼–è¯‘æŠ¥ NDK integration is deprecated in the current plugin. gradle.properties æ–‡ä»¶ä¸­æ·»åŠ ï¼š android.useDeprecatedNdk=true åº”è¯¥è¿˜æœ‰å…¶ä»–æ–¹æ³•æ’é™¤,æˆ‘ä¹Ÿå°±çŸ¥é“è¿™ä¸€ç§,å¦‚æœæœ‰çŸ¥é“å…¶ä»–æ–¹æ³•çš„,è¯·å‘ŠçŸ¥ä¸€ä¸‹,è°¢è°¢","categories":[],"tags":[{"name":"JNIï¼ŒAndroid","slug":"JNIï¼ŒAndroid","permalink":"https://www.wangzhumo.com/tags/JNIï¼ŒAndroid/"}]},{"title":"EditTextçš„è¾“å…¥å±æ€§InputTypeä»¥åŠimeOptions","slug":"EditText-InputType-imeOptions","date":"2017-12-25T02:11:15.000Z","updated":"2019-12-22T12:10:37.765Z","comments":true,"path":"2017/12/25/EditText-InputType-imeOptions/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/EditText-InputType-imeOptions/","excerpt":"EditTextçš„è¾“å…¥å±æ€§ android:imeOptions=&quot;flagNoExtractUi&quot; //ä½¿è½¯é”®ç›˜ä¸å…¨å±æ˜¾ç¤ºï¼Œåªå ç”¨éƒ¨åˆ†å±å¹• android:imeOptions=&quot;actionNone&quot; //è¾“å…¥æ¡†å³ä¾§ä¸å¸¦ä»»ä½•æç¤º android:imeOptions=&quot;actionGo&quot; //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;å¼€å§‹&#39; android:imeOptions=&quot;actionSearch&quot; //å³ä¸‹è§’æŒ‰é”®ä¸ºæœç´¢ android:imeOptions=&quot;actionSend&quot; //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;å‘é€&#39; android:imeOptions=&quot;actionNext&quot; //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;ä¸‹ä¸€æ­¥&#39; android:imeOptions=&quot;actionDone&quot; //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;å®Œæˆ&#39;","text":"EditTextçš„è¾“å…¥å±æ€§ android:imeOptions=&quot;flagNoExtractUi&quot; //ä½¿è½¯é”®ç›˜ä¸å…¨å±æ˜¾ç¤ºï¼Œåªå ç”¨éƒ¨åˆ†å±å¹• android:imeOptions=&quot;actionNone&quot; //è¾“å…¥æ¡†å³ä¾§ä¸å¸¦ä»»ä½•æç¤º android:imeOptions=&quot;actionGo&quot; //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;å¼€å§‹&#39; android:imeOptions=&quot;actionSearch&quot; //å³ä¸‹è§’æŒ‰é”®ä¸ºæœç´¢ android:imeOptions=&quot;actionSend&quot; //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;å‘é€&#39; android:imeOptions=&quot;actionNext&quot; //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;ä¸‹ä¸€æ­¥&#39; android:imeOptions=&quot;actionDone&quot; //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;å®Œæˆ&#39; EditTextçš„inputTypeå±æ€§ &lt;EditText android:inputType=&quot;phone&quot; //ç”µè¯å·ç  android:inputType=&quot;none&quot; android:inputType=&quot;text&quot; //æ–‡æœ¬ç±»å‹ android:inputType=&quot;textCapCharacters&quot; //å­—æ¯å¤§å†™ android:inputType=&quot;textCapWords&quot; //é¦–å­—æ¯å¤§å†™ android:inputType=&quot;textCapSentences&quot; //ä»…ç¬¬ä¸€ä¸ªå­—æ¯å¤§å†™ android:inputType=&quot;textAutoCorrect&quot; //è‡ªåŠ¨å®Œæˆ android:inputType=&quot;textAutoComplete&quot; //è‡ªåŠ¨å®Œæˆ android:inputType=&quot;textMultiLine&quot; //å¤šè¡Œè¾“å…¥ android:inputType=&quot;textImeMultiLine&quot; //è¾“å…¥æ³•å¤šè¡Œ android:inputType=&quot;textNoSuggestions&quot; //ä¸æç¤º android:inputType=&quot;textUri&quot; //ç½‘å€ android:inputType=&quot;textEmailAddress&quot; //ç”µå­é‚®ä»¶åœ°å€ android:inputType=&quot;textEmailSubject&quot; //é‚®ä»¶ä¸»é¢˜ android:inputType=&quot;textShortMessage&quot; //çŸ­è®¯ android:inputType=&quot;textLongMessage&quot; //é•¿ä¿¡æ¯ android:inputType=&quot;textPersonName&quot; //äººå android:inputType=&quot;textPostalAddress&quot; //åœ°å€ android:inputType=&quot;textPassword&quot; //å¯†ç  android:inputType=&quot;textVisiblePassword&quot; //å¯è§å¯†ç  android:inputType=&quot;textWebEditText&quot; //ä½œä¸ºç½‘é¡µè¡¨å•çš„æ–‡æœ¬ android:inputType=&quot;textFilter&quot; //æ–‡æœ¬ç­›é€‰è¿‡æ»¤ android:inputType=&quot;textPhonetic&quot; //æ‹¼éŸ³è¾“å…¥ android:inputType=&quot;number&quot; //æ•°å­— android:inputType=&quot;numberSigned&quot; //å¸¦ç¬¦å·æ•°å­—æ ¼å¼ android:inputType=&quot;numberDecimal&quot; //å¸¦å°æ•°ç‚¹çš„æµ®ç‚¹æ ¼å¼ android:inputType=&quot;datetime&quot; //æ—¶é—´æ—¥æœŸ android:inputType=&quot;date&quot; //æ—¥æœŸé”®ç›˜ android:inputType=&quot;time&quot; //æ—¶é—´é”®ç›˜ /&gt;","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"TextViewä¸­çš„æ–‡å­—é¢œè‰²,ç‚¹å‡»,æ–œä½“ç­‰å®ç°--SpannableString","slug":"textview-span","date":"2017-12-25T02:06:03.000Z","updated":"2019-12-22T12:20:46.923Z","comments":true,"path":"2017/12/25/textview-span/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/textview-span/","excerpt":"ä¸€èˆ¬å®ç°æ–¹å¼å¦‚ä¸‹: String html = &quot;æ–‡å­—&lt;font color=\\&quot;red\\&quot;&gt;å˜è‰²&lt;/font&gt;çš„æ•ˆæœ&quot;; tvMainShow.setText(Html.fromHtml(html)); ä½¿ç”¨Htmlçš„æ–¹å¼æ¥å®ç°,ç®€å•çš„è¿˜å¥½,å¤æ‚ä¸€ç‚¹çš„çœŸçš„å¾ˆä¸æ–¹ä¾¿","text":"ä¸€èˆ¬å®ç°æ–¹å¼å¦‚ä¸‹: String html = &quot;æ–‡å­—&lt;font color=\\&quot;red\\&quot;&gt;å˜è‰²&lt;/font&gt;çš„æ•ˆæœ&quot;; tvMainShow.setText(Html.fromHtml(html)); ä½¿ç”¨Htmlçš„æ–¹å¼æ¥å®ç°,ç®€å•çš„è¿˜å¥½,å¤æ‚ä¸€ç‚¹çš„çœŸçš„å¾ˆä¸æ–¹ä¾¿ Googleæ˜¾ç„¶æ—©å°±å·²ç»æƒ³åˆ°äº†è¿™æ ·çš„é—®é¢˜,æ‰€ä»¥ SpannedString &amp; SpannableStringBuilder å°±æ˜¯å¹²è¿™ä¸ªçš„ ä»–ä»¬éƒ½å®ç°äº† CharSequence,çœ¼ç†Ÿä¹ˆ? setText(CharSequence text).ä¹Ÿå°±æ˜¯è¯´,ä½ å¯ä»¥ç›´æ¥èµ‹å€¼ç»™TextView ä»–ä»¬ä¸¤ä¸ªçš„åŒºåˆ«å°±æ˜¯This is the class for text whose content is immutable but to which markup objects can be attached and detached. For mutable text, see SpannableStringBuilderæ–‡æ¡£è¯´çš„å¾ˆæ¸…æ¥šäº†,å°±æ˜¯CharSequenceæ˜¯å›ºå®šé•¿åº¦çš„,ä¸€æ—¦é€šè¿‡ new SpannableString(â€œè®¾ç½®æ–‡å­—â€);åˆ™ä¸å¯ä»¥æ›´æ”¹æ–‡å­—å†…å®¹,è€ŒSpannableStringBuilderæ˜¯å¯ä»¥çš„,ä¸ªäººç†è§£æ¯”è¾ƒåƒString å’Œ StringBuilder çš„å…³ç³» ###ä¸å¤šè¯´äº†,å¼€æ:1.è®¾ç½®æ–‡å­— SpannableString spannableString = new SpannableString(&quot;æ–‡å­—çš„å‰æ™¯è‰²ä¸èƒŒæ™¯è‰²&quot;); 2.é€šè¿‡setSpanæ¥ä¿®æ”¹æ–‡å­—çš„æ ·å¼ setSpan [Object what, int start, int end, int flags) flags:Spannable.SPAN_EXCLUSIVE_EXCLUSIVEï¼šå‰åéƒ½ä¸åŒ…æ‹¬Spannable.SPAN_EXCLUSIVE_INCLUSIVE ï¼šå‰é¢ä¸åŒ…æ‹¬Spannable.SPAN_INCLUSIVE_EXCLUSIVE ï¼šå‰é¢åŒ…æ‹¬Spannable.SPAN_INCLUSIVE_INCLUSIVE ï¼šå‰åéƒ½åŒ…æ‹¬ ä¸ºäº†è¯´æ˜è¿™å››ä¸ªå‚æ•°,æœ‰ä¾‹å­å¦‚ä¸‹: ä»£ç å¦‚ä¸‹: /* * * @author ç‹è¯›é­” 2017/1/21 ä¸Šåˆ11:31 * @e-mail phyooos@163.com */ public class MainActivity extends AppCompatActivity { @BindView(R.id.edit_show) EditText etMainShow; @BindView(R.id.tab_view) TabLayout tabLayout; @Override public void onCreate(@Nullable Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); ButterKnife.bind(this); showText(Spannable.SPAN_EXCLUSIVE_EXCLUSIVE); tabLayout.setOnTabSelectedListener(new TabLayout.OnTabSelectedListener() { @Override public void onTabSelected(TabLayout.Tab tab) { switch (tab.getPosition()) { case 0: showText(Spannable.SPAN_EXCLUSIVE_EXCLUSIVE); break; case 1: showText(Spannable.SPAN_EXCLUSIVE_INCLUSIVE); break; case 2: showText(Spannable.SPAN_INCLUSIVE_EXCLUSIVE); break; case 3: showText(Spannable.SPAN_INCLUSIVE_INCLUSIVE); break; } } @Override public void onTabUnselected(TabLayout.Tab tab) { } @Override public void onTabReselected(TabLayout.Tab tab) { } }); } /** * å±•ç¤ºæ–‡å­— */ private void showText(int type) { //æ„é€ SpannableString SpannableString spanString = new SpannableString(&quot;è¿™é‡Œæ˜¯ç‹è¯›é­”çš„ç®€ä¹¦æ–‡ç« &quot;); //å­—ä½“é¢œè‰²çš„Span ForegroundColorSpan span = new ForegroundColorSpan(Color.RED); //æŒ‡å®šèŒƒå›´ spanString.setSpan(span, 3, 6, type); //è®¾ç½®ç»™EditTextæ˜¾ç¤ºå‡ºæ¥ etMainShow.setText(spanString); } } ä¸Šé¢çš„ä»£ç ä¸­: //å­—ä½“é¢œè‰²çš„Span ForegroundColorSpan span = new ForegroundColorSpan(Color.RED); ForegroundColorSpanå°±æ˜¯è®¾ç½®çš„æ–‡å­—æ ·å¼,,è¿™ä¸ªæ˜¯å‰æ™¯è‰²,,ä¹Ÿå°±æ˜¯å­—ä½“çš„é¢œè‰² //æŒ‡å®šèŒƒå›´ spanString.setSpan(span, 3, 6, type); è¿™é‡Œçš„ä¸‰ä¸ªå‚æ•°å·²ç»åœ¨ä¸Šé¢è¯´è¿‡äº†,é€šè¿‡ä¸Šé¢çš„ä»£ç ä¹Ÿä¼šå‘ç°,å…¶å®3,6 å…¶ä¸­ä¸‹æ ‡3æ˜¯åŒ…å«çš„,è€Œä¸‹æ ‡6å°±ä¸ä¼šæ”¹å˜ 3.è‡³äºSpançš„è¿™äº›ä¸ªæ ·å¼åœ¨å“ªé‡Œæ‰¾,è¯·çœ‹æ–‡æ¡£:å…³é”®è¯:CharacterStyle https://developer.android.com/reference/android/text/style/CharacterStyle.html è¯´å‡ ä¸ªå¸¸ç”¨çš„å§: ForegroundColorSpan å­—ä½“é¢œè‰² BackgroundColorSpan å­—ä½“èƒŒæ™¯è‰²è®¾ç½® AbsoluteSizeSpan å­—ä½“å¤§å° StyleSpan ç²—ä½“ç­‰ //å­—ä½“ç”±Typefaceæ¥æ§åˆ¶ StyleSpan span = new StyleSpan(Typeface.BOLD_ITALIC); UnderlineSpan ä¸‹åˆ’çº¿ ImageSpan å›¾ç‰‡ç½®æ¢ ImageSpan https://developer.android.com/reference/android/text/style/ImageSpan.html è¿™ä¸ªæœ‰ä¸€ç‚¹ä¸åŒ,å®ƒæ˜¯å°†æ–‡å­—ä¸­çš„æŒ‡å®šéƒ¨åˆ†æ›¿æ¢ä¸ºä¸€ä¸ªå›¾ç‰‡,è‡³äºå¦‚ä½•æ„é€ è¯·å‚è€ƒæ–‡æ¡£è®©æˆ‘æƒ³èµ·æ¥äº†é‚£ä¸ªEmojiEditTextçš„åº“,å…¶å®å¯ä»¥ç”¨è¿™ä¸ªImageSpanå®ç°ä¸€ä¸ªç®€å•çš„å¯ä»¥æ˜¾ç¤ºè¡¨æƒ…çš„TextView ClickableSpan ç‚¹å‡» //è¿™ä¸ªæœ‰äº›ä¸åŒ,éœ€è¦ class CustomClickable extends ClickableSpan { @Override public void updateDrawState(TextPaint ds) { //è¿™é‡Œå…¶å®è¿˜å¯ä»¥å¯¹å¯ç‚¹å‡»éƒ¨åˆ†è®¾ç½®ä¸€äº›ä¸œè¥¿ } @Override public void onClick(View widget) { ...do something } } //å¯¹äº†,åŠ ä¸Šè¿™è¡Œä»£ç  TextView.setMovementMethod(LinkMovementMethod.getInstance()); //è¦ä¸ç‚¹ä¸åŠ¨å“¦ URLSpan è¿™ä¸ªå®Œå…¨å¯ä»¥ç”¨ClickableSpanå®ç° SpannableStringBuilder SpannableStringéƒ½è¯´çš„è¿™ä¹ˆæ˜ç™½äº†,SpannableStringBuilderå°±çœäº† ####End","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"Flutter å®‰è£…","slug":"Flutter-install-net-error","date":"2017-12-25T02:03:55.000Z","updated":"2019-12-22T12:10:22.150Z","comments":true,"path":"2017/12/25/Flutter-install-net-error/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Flutter-install-net-error/","excerpt":"ä½¿ç”¨ç³»ç»ŸMac OS å·²ç»æ²¡åŠæ³•ç»™å¤§å®¶çœ‹é—®é¢˜äº†,æˆ‘åœ¨githubä¸Šæäº†é—®é¢˜. github issue ä½¿ç”¨å‘½ä»¤ command `flutter doctor` å¼‚å¸¸: exception SocketException: SocketException: Connection failed (OS Error: No route to host, errno = 65), address = android.googlesource.com, port = 443 æ€»çš„æ¥è¯´å°±æ˜¯ä¸‹è½½ Downloading Gradle Wrapperâ€¦çš„æ—¶å€™è¿æ¥ä¸åˆ°å¤–ç½‘,ä»¥è‡³äºå¤±è´¥","text":"ä½¿ç”¨ç³»ç»ŸMac OS å·²ç»æ²¡åŠæ³•ç»™å¤§å®¶çœ‹é—®é¢˜äº†,æˆ‘åœ¨githubä¸Šæäº†é—®é¢˜. github issue ä½¿ç”¨å‘½ä»¤ command `flutter doctor` å¼‚å¸¸: exception SocketException: SocketException: Connection failed (OS Error: No route to host, errno = 65), address = android.googlesource.com, port = 443 æ€»çš„æ¥è¯´å°±æ˜¯ä¸‹è½½ Downloading Gradle Wrapperâ€¦çš„æ—¶å€™è¿æ¥ä¸åˆ°å¤–ç½‘,ä»¥è‡³äºå¤±è´¥ githubä¸Šçš„è¿™ä½å°å“¥æé†’äº†æˆ‘@lishuhao @eseidelGoogleitâ€™s reachable via https from ChromeMaybe his chrome use proxy but terminal not use proxy. æˆ‘ç¡®å®å¼€äº†ss,ä½†æ˜¯ç»ˆç«¯ç¡®å®è¿æ¥ä¸åˆ°ä»£ç†çš„,ä¸èµ°ä»£ç†,é‚£å½“ç„¶æ— è§£ ##è§£å†³: ####1.Macä¸‹ä½¿ç”¨Homebrewå®‰è£… brew install polipo ####2.ä¿®æ”¹é…ç½® ln -sfv /usr/local/opt/polipo/*.plist ~/Library/LaunchAgents vim /usr/local/opt/polipo/homebrew.mxcl.polipo.plist åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ &lt;string&gt;socksParentProxy=localhost:1086&lt;/string&gt; å…¶ä¸­1086è¿™ä¸ªç«¯å£å·,è‡ªå·±å»çœ‹ ####3.å¯åŠ¨ launchctl load ~/Library/LaunchAgents/homebrew.mxcl.polipo.plist ####4.ä½¿ç”¨ $ http_proxy=http://localhost:8123 curl ip.gs Current IP / å½“å‰ IP: 47.90.88.133 ISP / è¿è¥å•†: ALIYUN City / åŸå¸‚: Hong Kong Country / å›½å®¶: China IP.GS is now IP.SB, please visit https://ip.sb/ for more IP information, ip.gs will only use for curl purpose. / IP.GS å·²æ›´æ–°è‡³ IP.SB è¯·è®¿é—® https://ip.sb/ è·å–æ›´å¤šä¿¡æ¯, ip.gs åŸŸåä»…ä½œ curl ä½¿ç”¨ Please join Telegram group https://t.me/sbfans if you have any issues. / å¦‚æœ‰é—®é¢˜ï¼Œè¯·åŠ å…¥ Telegram ç¾¤ https://t.me/sbfans å¯ä»¥çœ‹åˆ°,ç°åœ¨æˆ‘æ˜¯é¦™æ¸¯çš„IPäº†,http_proxy=http://localhost:8123è¿™ä¸ªæ˜¯æä¾›é»˜è®¤çš„,è‡³äºæ€ä¹ˆä¿®æ”¹æˆ‘æ²¡æœ‰çœ‹,ä¹Ÿä¸çŸ¥é“ æŠŠä»£ç†è®¾ç½®ä¸ºå…¨å±€çš„ ~ âŒš 11:42:51 $ export http_proxy=http://localhost:8123 ~ âŒš 11:43:02 $ export https_proxy=http://localhost:8123 ~ âŒš 11:43:09 $ curl https://www.google.com &lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt; &lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt; &lt;H1&gt;302 Moved&lt;/H1&gt; The document has moved &lt;A HREF=&quot;https://www.google.com.hk/?gfe_rd=cr&amp;ei=5FaaWZDNOMLU8Af_nriwDw&quot;&gt;here&lt;/A&gt;. &lt;/BODY&gt;&lt;/HTML&gt; ~ âŒš 11:43:33 $ curl www.google.com &lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt; &lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt; &lt;H1&gt;302 Moved&lt;/H1&gt; The document has moved &lt;A HREF=&quot;http://www.google.com.hk/?gfe_rd=cr&amp;ei=6laaWZqEO8_U8AeLlID4CA&quot;&gt;here&lt;/A&gt;. &lt;/BODY&gt;&lt;/HTML&gt; ####5.End ##è§è¯å¥‡è¿¹çš„æ—¶åˆ»åˆ°äº† ~/develop/flutter on î‚  alpha! âŒš 11:44:11 $ flutter doctor Downloading Gradle Wrapper... 1.3s [âœ“] Flutter (on Mac OS X 10.12.6 16G29, locale zh-Hans-CN, channel alpha) â€¢ Flutter at /Users/phyooos/develop/flutter â€¢ Framework revision b156a0f054 (9 days ago), 2017-08-11 22:01:40 -0700 â€¢ Engine revision fef7d827d6 â€¢ Tools Dart version 1.25.0-dev.9.0 [âœ“] Android toolchain - develop for Android devices (Android SDK 26.0.1) â€¢ Android SDK at /Users/phyooos/Library/Android/sdk â€¢ Platform android-26, build-tools 26.0.1 â€¢ ANDROID_HOME = /Users/phyooos/Library/Android/sdk â€¢ Java binary at: /Applications/Android Studio.app/Contents/jre/jdk/Contents/Home/bin/java â€¢ Java version OpenJDK Runtime Environment (build 1.8.0_112-release-b06) [-] iOS toolchain - develop for iOS devices âœ— Xcode installation is incomplete; a full installation is necessary for iOS development. Download at: https://developer.apple.com/xcode/download/ Or install Xcode via the App Store. Once installed, run: sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer âœ— libimobiledevice and ideviceinstaller are not installed or require updating. To update, run: brew uninstall --ignore-dependencies libimobiledevice brew install --HEAD libimobiledevice brew install ideviceinstaller âœ— ios-deploy not installed. To install: brew install ios-deploy âœ— CocoaPods not installed. CocoaPods is used to retrieve the iOS platform side&#39;s plugin code that responds to your plugin usage on the Dart side. Without resolving iOS dependencies with CocoaPods, plugins will not work on iOS. For more info, see https://flutter.io/platform-plugins To install: brew install cocoapods pod setup [âœ“] Android Studio (version 2.3) â€¢ Android Studio at /Applications/Android Studio.app/Contents â€¢ Java version OpenJDK Runtime Environment (build 1.8.0_112-release-b06) [âœ“] IntelliJ IDEA Ultimate Edition (version 2017.1.3) â€¢ Flutter plugin version 16.0 â€¢ Dart plugin version 171.4424.63 [âœ“] Connected devices â€¢ None æˆ‘çš„Flutterå°±okäº†","categories":[{"name":"Flutter","slug":"Flutter","permalink":"https://www.wangzhumo.com/categories/Flutter/"}],"tags":[{"name":"Flutter","slug":"Flutter","permalink":"https://www.wangzhumo.com/tags/Flutter/"}]},{"title":"BottomNavigationViewä½¿ç”¨æŒ‡å—","slug":"BottomNavigationView","date":"2017-12-25T01:40:44.000Z","updated":"2019-12-22T12:05:14.354Z","comments":true,"path":"2017/12/25/BottomNavigationView/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/BottomNavigationView/","excerpt":"æœ€ç»ˆæ•ˆæœ: Android Support Library 25 \bä»¥ä¸Šçš„supportåŒ…ä¸­å¢åŠ äº† BottomNavigationViewæ‰€ä»¥ä½ å¿…é¡»ä½¿ç”¨com.android.support:design:25.0.0ä»¥ä¸Šçš„ç‰ˆæœ¬æ‰èƒ½ç©","text":"æœ€ç»ˆæ•ˆæœ: Android Support Library 25 \bä»¥ä¸Šçš„supportåŒ…ä¸­å¢åŠ äº† BottomNavigationViewæ‰€ä»¥ä½ å¿…é¡»ä½¿ç”¨com.android.support:design:25.0.0ä»¥ä¸Šçš„ç‰ˆæœ¬æ‰èƒ½ç© 1.åœ¨ build.gradle æ–‡ä»¶ä¸­å¢åŠ ä¾èµ–ï¼š compile &#39;com.android.support:design:25.0.0&#39; 2.åœ¨main_activity.xmlä¸­æ·»åŠ : &lt;android.support.design.widget.BottomNavigationView android:id=&quot;@+id/bottom_nav&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;@dimen/title_height&quot; android:layout_alignParentBottom=&quot;true&quot; app:menu=&quot;@menu/menu_tab_button&quot; app:itemIconTint=&quot;@color/nav_color_select&quot; app:itemTextColor=&quot;@color/nav_color_select&quot; app:itemBackground=&quot;@color/text_white_color&quot;&gt; &lt;/android.support.design.widget.BottomNavigationView&gt; å…¶ä¸­app:menu=&quot;@menu/menu_tab_button&quot;å†³å®šäº†å±•ç¤ºå‡ ä¸ªitem,éƒ½é•¿ä»€ä¹ˆæ · å…¶ä¸­,åˆ†åˆ«å†³å®šå›¾æ ‡å’Œæ–‡å­—é€‰ä¸­å’Œæœªé€‰ä¸­itemçš„çŠ¶æ€,é¢œè‰² app:itemIconTint=&quot;@color/nav_color_select&quot; app:itemTextColor=&quot;@color/nav_color_select&quot; å…¶ä¸­app:itemBackground=&quot;@color/text_white_color&quot;åˆ™æ˜¯æ•´ä¸ªviewçš„èƒŒæ™¯é¢œè‰² 3.menu_tab_button.xmlçš„ä»£ç å¦‚ä¸‹: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&gt; &lt;item android:id=&quot;@+id/mian_tab_statistics&quot; android:enabled=&quot;true&quot; android:checked=&quot;true&quot; //é»˜è®¤é€‰ä¸­ android:title=&quot;@string/nav_tongji&quot; android:icon=&quot;@drawable/tongji&quot;/&gt; &lt;item android:id=&quot;@+id/mian_tab_paidui&quot; android:enabled=&quot;true&quot; android:title=&quot;@string/nav_paidui&quot; //æ–‡å­—å†…å®¹ android:icon=&quot;@drawable/paidui&quot;/&gt; //iconå›¾æ ‡ &lt;item android:id=&quot;@+id/mian_tab_find&quot; android:enabled=&quot;true&quot; android:title=&quot;@string/nav_faxiang&quot; android:icon=&quot;@drawable/faxian&quot;/&gt; &lt;item android:id=&quot;@+id/mian_tab_more&quot; android:enabled=&quot;true&quot; android:title=&quot;@string/nav_more&quot; android:icon=&quot;@drawable/more&quot;/&gt; &lt;/menu&gt; ###ç„¶è€Œ,ä½ ä»¥ä¸ºä¼šè¿™ä¹ˆç®€å•?? shiftingModeæ•™ä½ åšäºº() ###è¿™ä¸ªåªä¼šåœ¨itemä¸ªæ•°è¶…è¿‡3ä¸ªæ‰ä¼šå‡ºç°. 4.è¿™è®©æˆ‘å¦‚ä½•æ˜¯å¥½?çœ‹äº†åŠå¤©,åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€ä¸ªæ–¹æ³•. /** * ä¸€ä¸ªå…³äºBottomNavigationViewçš„å¸®åŠ©ç±»,ç”¨æ¥å…³é—­shiftingMode * @author ç‹è¯›é­” 2017/2/10 ä¸‹åˆ6:35 * @e-mail phyooos@163.com */ public class BNVHelper { public static void disableShiftMode(BottomNavigationView navigationView) { BottomNavigationMenuView menuView = (BottomNavigationMenuView) navigationView.getChildAt(0); try { Field shiftingMode = menuView.getClass().getDeclaredField(&quot;mShiftingMode&quot;); shiftingMode.setAccessible(true); shiftingMode.setBoolean(menuView, false); shiftingMode.setAccessible(false); for (int i = 0; i &lt; menuView.getChildCount(); i++) { BottomNavigationItemView itemView = (BottomNavigationItemView) menuView.getChildAt(i); itemView.setShiftingMode(false); itemView.setChecked(itemView.getItemData().isChecked()); } } catch (NoSuchFieldException e) { // Log } catch (IllegalAccessException e) { // Log } } } åŸä½œè€…@ChristmasJason:http://www.jianshu.com/p/e2a8791e80d6 ç„¶åæˆ‘çœ‹äº†ä¸€ä¸‹æºç mShiftingMode è¿™ä¸ªå¸ƒå°”å€¼å†³å®šäº†æ˜¯å¦å¯ç”¨shiftingMode,æ‰€ä»¥ä¸Šé¢çš„æ–¹æ³•å°±æ˜¯shiftingMode.setBoolean(menuView, false); ç„¶åå°±å¥½äº†â€¦â€¦ æç¤º:googleè¯´é€‰ä¸­å›¾æ ‡çš„é¢œè‰²æ˜¯è¿™ä¹ˆæ”¹çš„,ç„¶è€Œéƒ½æ˜¯éª—äººçš„,è¿™ä¸ªåº”è¯¥æ˜¯é»˜è®¤çš„è®¾ç½®,æˆ‘ä¹Ÿå·æ‡’æ²¡æœ‰éªŒè¯ app:itemIconTint=&quot;@color/nav_color_select&quot; app:itemTextColor=&quot;@color/nav_color_select&quot; å…¶å®ä½ é…ç½®äº†ä¹‹å,å°±æ˜¯è¿™ä¸ªä¸œè¥¿æ¥å†³å®šçš„,è€Œä¸æ˜¯appâ€™s primary colornav_color_select.xmlè¿™å°±æ˜¯ä¸ªé€‰æ‹©å™¨,ä»£ç å¦‚ä¸‹: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt; &lt;item android:state_checked=&quot;true&quot; android:color=&quot;@color/colorPrimary&quot; /&gt; &lt;item android:state_pressed=&quot;true&quot; android:color=&quot;@color/colorPrimary&quot; /&gt; &lt;item android:color=&quot;@color/gray_light&quot; /&gt; &lt;/selector&gt; ####End,åˆ°è¿™é‡Œä½ çš„å¯¼èˆªæ¡ä¹Ÿåº”è¯¥okäº†","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"View","slug":"View","permalink":"https://www.wangzhumo.com/tags/View/"}]},{"title":"Android Studio ä½¿ç”¨æ­£å¼ç­¾ådebugè°ƒè¯•","slug":"Android-Studio-signature-debug","date":"2017-12-25T01:38:59.000Z","updated":"2019-12-22T12:27:17.282Z","comments":true,"path":"2017/12/25/Android-Studio-signature-debug/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Android-Studio-signature-debug/","excerpt":"è§£å†³é—®é¢˜: å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä½¿ç”¨ç¬¬ä¸‰æ–¹ç™»å½•ä»€ä¹ˆçš„ä¸œè¥¿,éœ€è¦æˆ‘ä»¬æä¾›æ­£å¼ç­¾å,ä½†æ˜¯æˆ‘ä»¬æ€»æ˜¯éœ€è¦è°ƒè¯•çš„.ä¸€èˆ¬æƒ…å†µ,æˆ‘ä»¬ä¸å¯èƒ½ä¸€æ¬¡æ€§OK,é‚£ä¹ˆæ¯ä¸€æ¬¡è°ƒè¯•éƒ½éœ€è¦æ­£å¼ç­¾åæ‰“åŒ…,å¹¶å®‰è£…,ç„¶åå†è°ƒè¯•,è¿™ä¹Ÿå¤ªéº»çƒ¦äº†,.","text":"è§£å†³é—®é¢˜: å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä½¿ç”¨ç¬¬ä¸‰æ–¹ç™»å½•ä»€ä¹ˆçš„ä¸œè¥¿,éœ€è¦æˆ‘ä»¬æä¾›æ­£å¼ç­¾å,ä½†æ˜¯æˆ‘ä»¬æ€»æ˜¯éœ€è¦è°ƒè¯•çš„.ä¸€èˆ¬æƒ…å†µ,æˆ‘ä»¬ä¸å¯èƒ½ä¸€æ¬¡æ€§OK,é‚£ä¹ˆæ¯ä¸€æ¬¡è°ƒè¯•éƒ½éœ€è¦æ­£å¼ç­¾åæ‰“åŒ…,å¹¶å®‰è£…,ç„¶åå†è°ƒè¯•,è¿™ä¹Ÿå¤ªéº»çƒ¦äº†,. æ‰€ä»¥,ç›´æ¥ä¸Šä»£ç : signingConfigs { release { keyAlias &#39;phyooos&#39; keyPassword &#39;phyooos&#39; storeFile file(&#39;phyooos.jks&#39;) storePassword &#39;phyooos&#39; } } buildTypes { release { minifyEnabled false signingConfig signingConfigs.release proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39; } debug{ minifyEnabled false signingConfig signingConfigs.release proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39; } } è§£é‡Šä¸€ä¸‹: signingConfigs { release { keyAlias &#39;phyooos&#39; keyPassword &#39;phyooos&#39; storeFile file(&#39;phyooos.jks&#39;) storePassword &#39;phyooos&#39; } } è¿™ä¸€æ®µä»£ç å†™åœ¨é¡¹ç›®appç›®å½•ä¸‹&gt;gradleé…ç½®æ–‡ä»¶ä¸­&gt;androidèŠ‚ç‚¹ä¸‹,æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸€ä¸ªé…ç½® keyAlias â€˜phyooosâ€™ è¿™æ˜¯ç­¾åæ–‡ä»¶çš„Alias keyPassword â€˜phyooosâ€™ è¿™æ˜¯ç­¾åæ–‡ä»¶çš„å¯†ç  storeFile file(â€˜phyooos.jksâ€™) è¿™ä¸ªå°±æ˜¯ç­¾åæ–‡ä»¶çš„åœ°å€,æˆ‘æ”¾åœ¨appç›®å½•ä¸‹äº† storePassword â€˜phyooosâ€™ è¿™æ˜¯storeå¯†ç  buildTypes { release { minifyEnabled false signingConfig signingConfigs.release proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39; } debug{ minifyEnabled false signingConfig signingConfigs.release proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39; } } è¿™ä¸€æ®µçš„æ„æ€å°±æ˜¯debugè°ƒè¯•ä»¥åŠæ­£å¼æ‰“åŒ…éƒ½ä½¿ç”¨ä¸Šé¢è‡ªå®šä¹‰çš„é…ç½® The End å¥½äº†,æ„‰å¿«çš„ç©è€å§","categories":[{"name":"Android Studio","slug":"Android-Studio","permalink":"https://www.wangzhumo.com/categories/Android-Studio/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Android Studio","slug":"Android-Studio","permalink":"https://www.wangzhumo.com/tags/Android-Studio/"}]},{"title":"ä½åŠŸè€—è“ç‰™iBeaconçš„å¼€å‘ç¬”è®°","slug":"Bluetooth-iBeacon","date":"2017-12-25T01:37:23.000Z","updated":"2019-12-22T12:26:25.044Z","comments":true,"path":"2017/12/25/Bluetooth-iBeacon/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Bluetooth-iBeacon/","excerpt":"1.æŒ£æ‰çš„å¼€å§‹å„ç§ç™¾åº¦,google,å‘ç°å›½å†…èµ„æ–™å¾ˆå°‘,æœ‰çš„ä¹Ÿæ˜¯å•†ä¸šå…¬å¸æä¾›çš„sdk,è¿™å¹¶ä¸ç¬¦åˆæˆ‘éœ€è¦,googleå€’æ˜¯ä¸å°‘,ç„¶è€Œä»¥æˆ‘çš„è‹±è¯­æ°´å¹³,æœ›æ´‹å…´å¹ç½¢äº†","text":"1.æŒ£æ‰çš„å¼€å§‹å„ç§ç™¾åº¦,google,å‘ç°å›½å†…èµ„æ–™å¾ˆå°‘,æœ‰çš„ä¹Ÿæ˜¯å•†ä¸šå…¬å¸æä¾›çš„sdk,è¿™å¹¶ä¸ç¬¦åˆæˆ‘éœ€è¦,googleå€’æ˜¯ä¸å°‘,ç„¶è€Œä»¥æˆ‘çš„è‹±è¯­æ°´å¹³,æœ›æ´‹å…´å¹ç½¢äº† é¦–å…ˆä½ éœ€è¦äº†è§£è¿™äº›èµ„æ–™1ã€profile rofileå¯ä»¥ç†è§£ä¸ºä¸€ç§è§„èŒƒï¼Œä¸€ä¸ªæ ‡å‡†çš„é€šä¿¡åè®®ï¼Œå®ƒå­˜åœ¨äºä»æœºä¸­ã€‚è“ç‰™ç»„ç»‡è§„å®šäº†ä¸€äº›æ ‡å‡†çš„profileï¼Œä¾‹å¦‚ HID OVER GATT ï¼Œé˜²ä¸¢å™¨ ï¼Œå¿ƒç‡è®¡ç­‰ã€‚æ¯ä¸ªprofileä¸­ä¼šåŒ…å«å¤šä¸ªserviceï¼Œæ¯ä¸ªserviceä»£è¡¨ä»æœºçš„ä¸€ç§èƒ½åŠ›ã€‚ 2ã€serviceserviceå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæœåŠ¡ï¼Œåœ¨bleä»æœºä¸­ï¼Œé€šè¿‡æœ‰å¤šä¸ªæœåŠ¡ï¼Œä¾‹å¦‚ç”µé‡ä¿¡æ¯æœåŠ¡ã€ç³»ç»Ÿä¿¡æ¯æœåŠ¡ç­‰ï¼Œæ¯ä¸ªserviceä¸­åˆåŒ…å«å¤šä¸ªcharacteristicç‰¹å¾å€¼ã€‚æ¯ä¸ªå…·ä½“çš„characteristicç‰¹å¾å€¼æ‰æ˜¯bleé€šä¿¡çš„ä¸»é¢˜ã€‚æ¯”å¦‚å½“å‰çš„ç”µé‡æ˜¯80%ï¼Œæ‰€ä»¥ä¼šé€šè¿‡ç”µé‡çš„characteristicç‰¹å¾å€¼å­˜åœ¨ä»æœºçš„profileé‡Œï¼Œè¿™æ ·ä¸»æœºå°±å¯ä»¥é€šè¿‡è¿™ä¸ªcharacteristicæ¥è¯»å–80%è¿™ä¸ªæ•°æ® 3ã€characteristiccharacteristicç‰¹å¾å€¼ï¼Œbleä¸»ä»æœºçš„é€šä¿¡å‡æ˜¯é€šè¿‡characteristicæ¥å®ç°ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ ‡ç­¾ï¼Œé€šè¿‡è¿™ä¸ªæ ‡ç­¾å¯ä»¥è·å–æˆ–è€…å†™å…¥æƒ³è¦çš„å†…å®¹ã€‚ 4ã€UUIDUUIDï¼Œç»Ÿä¸€è¯†åˆ«ç ï¼Œæˆ‘ä»¬åˆšæ‰æåˆ°çš„serviceå’Œcharacteristicï¼Œéƒ½éœ€è¦ä¸€ä¸ªå”¯ä¸€çš„uuidæ¥æ ‡è¯†S: ç™¾åº¦åˆ°çš„,æˆ‘ä»¥ä¸€ä¸ªè¿‡æ¥äººçš„èº«ä»½ä¿è¯è¿™ä¸ªå¾ˆé‡è¦ 2.èµ„æ–™,å‡†å¤‡èµ„æ–™çœ‹è¿™é‡Œ: è¿™ä¹Ÿæ˜¯æœ€é‡è¦çš„èµ„æ–™æ¥æº,è°·æ­ŒSDKçš„ä¾‹å­é‡Œé¢æœ‰çš„é¡¹ç›® æ¥ä¸Šæ–‡,è¯´å®Œèµ„æ–™, è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„demosdk\\samples\\android-22\\connectivity\\BluetoothLeGatt è¯¥ç›®å½•ä¸‹ä¸ºè°·æ­Œæä¾›çš„demo,æˆ‘çš„åº”ç”¨ä¹Ÿæ˜¯åœ¨å®ƒçš„åŸºç¡€ä¸Šæ”¹è¿›è€Œæˆçš„.ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆ: ä¸€ä¸ªæœåŠ¡ BluetoothLeService,ä¸»è´Ÿè´£ä¸è“ç‰™è®¾å¤‡è¿›è¡Œæ•°æ®äº¤æ¢ ä¸¤ä¸ªactivity:DeviceControlActivity,DeviceScanActivity è§åçŸ¥æ„,ä¸€ä¸ªè´Ÿè´£æ‰«æè®¾å¤‡,è€Œä¸¤å¤–ä¸€ä¸ªä¸è®¾å¤‡è¿›è¡Œäº¤äº’ ä¸€ä¸ªSampleGattAttributes ä¸»è¦æ˜¯å­˜å‚¨äº†ä¸€äº›UUID,æˆ‘å¯¹å®ƒè¿›è¡Œäº†åŠ å¼º 3.BLEè®¾å¤‡çš„ä½¿ç”¨æ­¥éª¤æ¦‚å†µ é¦–å…ˆè¦è¯´æ˜çš„ä¸€ç‚¹æ˜¯,è¦æ±‚Androidç‰ˆæœ¬ä¸º4.3åŠå…¶ä»¥ä¸Š æ¥ç€ç¡®è®¤è®¾å¤‡æ”¯æŒ /** * æ”¯æŒBLE * check to determine whether BLE is supported on the device */ public void isSupported(){ if (!getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH_LE)) { Toast.makeText(this, &quot;è®¾å¤‡ä¸æ”¯æŒBLEåŠŸèƒ½&quot;, Toast.LENGTH_SHORT).show(); } } ç¡®è®¤æ‰‹æœºæ”¯æŒå¹¶æ‰“å¼€è“ç‰™çš„çŠ¶æ€ä¸‹,ä½ å°±å¯ä»¥è¿›è¡Œè®¾å¤‡çš„æœç´¢äº† æœ‰ä¸¤ç§æ¨¡å¼ //ç¬¬ä¸€ç§ //serviceUuids æŒ‡å®šè®¾å¤‡çš„UUID //callback æœç´¢çš„å›è°ƒ startLeScan(final UUID[] serviceUuids, final LeScanCallback callback) //ç¬¬äºŒç§ //å…¶å®å°±æ˜¯ä¸ä¼ å…¥serviceUuidsçš„,å°±æ˜¯è¯´æœç´¢èŒƒå›´å†…æ‰€æœ‰è“ç‰™è®¾å¤‡ public boolean startLeScan(LeScanCallback callback) { return startLeScan(null, callback); } åŒæ—¶è®°å¾—åœæ­¢æœç´¢,å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸€ç›´æœPSï¼šå…¶å®æˆ‘è§åˆ°çš„appå¤§éƒ¨åˆ†æ˜¯ä¸åœçš„æœç´¢ï¼Œè¿™æ ·çš„è¯ä¼šæœ‰ä¸€ä¸ªå¹¿æ’­æ•°æ®æŒç»­åˆ·æ–°çš„æ•ˆæœ,é‚£ä¹ˆå¾ˆå¤šçš„è·ç¦»åˆ¤æ–­ä»€ä¹ˆçš„éƒ½æ˜¯é€šè¿‡è¿™ç§ä¸åœæœç´¢çš„å½¢å¼æ¥å·¥ä½œçš„ //mBluetoothAdapter è¯·è‡ªè¡ŒæŸ¥çœ‹è°·æ­Œæ–‡æ¡£ //mLeScanCallback è¿™å°±æ˜¯ä¸Šé¢æè¿‡çš„LeScanCallbackçš„å®ä¾‹ mBluetoothAdapter.stopLeScan(mLeScanCallback); æ¥ç€å°±æ˜¯åœ¨å›è°ƒä¸­æ‹¿åˆ°å„ä¸ªè®¾å¤‡æ•°æ®äº† /** * æœç´¢è®¾å¤‡å›è°ƒ */ private BluetoothAdapter.LeScanCallback mLeScanCallback = new BluetoothAdapter.LeScanCallback() { @Override public void onLeScan(final BluetoothDevice device, int rssi, byte[] scanRecord) { } }; è¿™é‡Œæœ‰å‡ ä¸ªå€¼å¾—è¯´ä¸€ä¸‹çš„ä¸œè¥¿ BluetoothDevice device è¯¥å¯ä»¥çœ‹çš„å¾ˆæ¸…æ¥š, deviceä¸­åŒ…å«äº†è®¾å¤‡çš„åŸºæœ¬ä¿¡æ¯ rssiä¿¡å·è´¨é‡,ä¹Ÿæœ‰äººå‘Šè¯‰æˆ‘æ˜¯è´¨é‡ä¸è¿‡æˆ‘è¿™æ¬¡å¹¶æ²¡æœ‰ä½¿ç”¨åˆ° byte[] scanRecord (é‡å¤´æˆ)å¹¿æ’­å“åº”åŒ…æ•°æ®ä¸€èˆ¬åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†,æˆ‘ä½¿ç”¨çš„ä¸»è¦æ˜¯ServiceDataåŸŸåœ¨è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªéƒ¨åˆ†éƒ½å­˜åœ¨äºå¹¿æ’­æ•°æ®ï¼Œè€Œä¸”å¹¶ä¸æ˜¯ä¸¤éƒ¨åˆ†éƒ½æœ‰ï¼Œæœ‰å¯èƒ½æ˜¯åªæœ‰ä¸€ä¸ªéƒ¨åˆ†ï¼Œæ‰€ä»¥ä¸€å®šè¦çœ‹æƒ…è®¾å¤‡çš„ç¡¬ä»¶è§„èŒƒï¼Œå› ä¸ºè¿™æ¶‰åŠåˆ°åé¢è§£æå¹¿æ’­æ•°æ® è¦çŸ¥é“ï¼Œæˆ‘ä»¬éƒ½æ˜¯æ‹¿byte[]æ•°ç»„ä¸­çš„æŸäº›éƒ¨åˆ†å¯¹åº”ç‰¹å®šå€¼,ä¸€æ—¦å¯¹åº”å…³ç³»æ‰“ä¹±ï¼Œé‚£ä¹ˆæ•°æ®è§£æå°±æ²¡ä»€ä¹ˆæ­£ç¡®æ€§å¯è¨€äº†è¿™äº›å¹¿æ’­æ•°æ®éƒ½æ˜¯ä¾æ®ä¸€å®šçš„è§„åˆ™æŒ‡å®š çš„,æ‰€ä»¥è¿™æ—¶å€™ä½ éœ€è¦è®¾å¤‡å‚å•†çš„æ–‡æ¡£æ¥æŸ¥çœ‹å¯¹åº”çš„æ•°æ®,ä»¥åŠå…¶ç»“æ„PS:éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯,è¿™äº›æ•°æ®éƒ½æ˜¯byte[],ä½ éœ€è¦å°†å®ƒä»¬è½¬åŒ–(ä¸€èˆ¬å¸¸ç”¨çš„åšæ³•æ˜¯,å…ˆè½¬åŒ–ä¸º16è¿›åˆ¶çš„å­—ç¬¦ä¸²,è€Œåå†è¿›è¡Œè¯»å–è§£æ) 4.è¯»å–è“ç‰™è®¾å¤‡å†…éƒ¨æ•°æ®è¿™é‡Œæ¶‰åŠåˆ°ä¸¤ä¸ªé‡è¦éƒ¨åˆ†service ä»¥åŠ characteristic ä¸€èˆ¬æ¥è¯´ ä¸€ä¸ªService eg: FF01-XXXXXXXXXXX-XXXXX ä¸‹é¢å¯èƒ½æœ‰å¾ˆå¤šçš„characteristicMarjor : FF16 -XXXXXXPower : FF17 - XXXâ€¦.ä¸€å †çš„characteristic å¦‚æœéœ€è¦ç»™æŒ‡å®šçš„é¡¹ç›®å†™å…¥ä¸€ä¸ªæ•°æ® æ¡ä»¶ï¼š 1.æ­¤ç‰¹å¾åœ¨å“ªä¸ªServiceä¸‹ï¼Œå³è¯¥serviceçš„UUID 2.è¯¥ç‰¹å¾çš„UUID 3.è¯¥ç‰¹å¾çš„å†™å…¥æ ¼å¼ï¼Œ16è¿›åˆ¶è¿˜æ˜¯å…¶ä»–çš„ä¸œè¥¿ //ä»£ç ç‰‡æ®µ1 //æ­¤æ–¹æ³•è·å–å¯¹åº”ç‰¹å¾å€¼çš„å¯¹è±¡BluetoothGattCharacteristicçš„å®ä½“ public BluetoothGattCharacteristic getCharacteristic(String service,String charact) { if (mBluetoothGatt == null) return null; if(mBluetoothGatt.getService(UUID.fromString(service))==null){return null ;} return mBluetoothGatt.getService(UUID.fromString(service)).getCharacteristic(UUID.fromString(charact)); } //ä»£ç ç‰‡æ®µ2 if(!TextUtils.isEmpty(value)){//è¾“å…¥éç©º byte[] arrayOfByte= new byte[2];//ä¼ å…¥æ•°æ®è§„å®šä¸º2ä¸ªbyte arrayOfByte[0] = ((byte)Integer.parseInt((value).substring(0, 2), 16)); arrayOfByte[1] = ((byte)Integer.parseInt((value).substring(2, 4), 16)); //ä¸Šé¢æ“ä½œï¼Œå…ˆåˆ‡ï¼Œå†è½¬ä¸º16è¿›åˆ¶ characteristic.setValue(arrayOfByte); //characteristicå®ä½“å°±æ˜¯ç‰‡æ®µ1ä»£ç è·å–åˆ°çš„ gattServer.writeCharacteristic(characteristic); //æ‰€æœ‰çš„æ“ä½œéƒ½å°è£…åœ¨ä¸€ä¸ªserviceä¸­ï¼ŒgattServerä¸ºå…¶å®ä½“å¯¹è±¡ } //ç‰‡æ®µ3å°±æ˜¯æœåŠ¡ä¸­çš„å†™å…¥æ–¹æ³• /** * å†™å…¥ä¸€ä¸ªæ•°æ® * @param characteristic */ public void writeCharacteristic(BluetoothGattCharacteristic characteristic) { mBluetoothGatt.setCharacteristicNotification(characteristic, true); mBluetoothGatt.writeCharacteristic(characteristic); } //ä»£ç ç‰‡æ®µ4 è¿™æ˜¯å›è°ƒï¼Œ //åœ¨è¿æ¥æ—¶å°±ä½œä¸ºå‚æ•°ä¼ å…¥äº† mBluetoothGatt = device.connectGatt(this, false, mGattCallback); private final BluetoothGattCallback mGattCallback = new BluetoothGattCallback() { @Override public void onConnectionStateChange(BluetoothGatt gatt, int status, int newState) { if (newState == BluetoothProfile.STATE_CONNECTED) { Log.e(TAG, &quot;è¿æ¥è‡³ GATT server.&quot;); } else if (newState == BluetoothProfile.STATE_DISCONNECTED) { Log.e(TAG, &quot;æ–­å¼€ GATT server.&quot;); } } @Override public void onServicesDiscovered(BluetoothGatt gatt, int status) { if (status == BluetoothGatt.GATT_SUCCESS) { Log.e(TAG, &quot;å»ºç«‹è¿æ¥æˆåŠŸ&quot;); } else { Log.e(TAG, &quot;è¿æ¥çŠ¶æ€å¼‚å¸¸: &quot; + status); } } @Override public void onCharacteristicWrite(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) { if (status == BluetoothGatt.GATT_SUCCESS) { Log.e(TAG, &quot;å†™å…¥æ•°æ®æˆåŠŸ&quot;); } } @Override public void onCharacteristicRead(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) { if (status == BluetoothGatt.GATT_SUCCESS) { Log.e(TAG, &quot;è¯»å–æ•°æ®æˆåŠŸ&quot;); } } @Override public void onCharacteristicChanged(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic) { Log.e(TAG, &quot;è¿æ¥çŠ¶æ€å‘ç”Ÿæ”¹å˜&quot;); }; } PS:è¿™é‡Œçš„ä¾‹å­æ˜¯å†™å…¥ï¼Œå…¶å®è¯»å–çš„æ“ä½œä¸æ­¤ç±»ä¼¼ï¼Œæ“ä½œå®Œæˆååœ¨å›è°ƒé‡Œé¢åˆ¤æ–­çŠ¶æ€ä»¥åŠè¯»å–æ•°æ®å³å¯","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"Android Studio åŸºæœ¬è®¾ç½®","slug":"Android-Studio-Config","date":"2017-12-25T01:35:39.000Z","updated":"2019-12-22T12:27:52.727Z","comments":true,"path":"2017/12/25/Android-Studio-Config/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Android-Studio-Config/","excerpt":"","text":"1.å¸¸ç”¨çš„å¿«æ·é”® ALT + Enter è‡ªåŠ¨æç¤º ALT + Ins get set æ„é€ æ–¹æ³• é‡å†™æ–¹æ³•ä»¥åŠä¸€äº›æ’ä»¶å¦‚è¿™é‡Œçš„ GsonFormat ä»¥åŠ Butterknife Ctrl + Alt + F å…¨å±€å˜é‡ Ctrl +Shift + Enter åŠ ; ä»¥åŠif çš„(){} Ctrl + P ä»¥åŠ Ctrl + Q æ–¹æ³•å‚æ•°ä»¥åŠæ–‡æ¡£ Ctrl +O ç»§æ‰¿é‡å†™çš„æ–¹æ³• Ctrl + / Ctrl +Shift + / æ³¨é‡Š Ctrl + Alt + L æ ¼å¼åŒ– Ctrl + D Ctrl + Y å¤åˆ¶ åˆ é™¤è¡Œ Ctrl + Shift + U å¤§å°å†™ Shift Shift Ctrl + F å…¨å±€ å½“å‰ æœç´¢ Ctrl + U åˆ°çˆ¶ç±» Ctrl + Alt + B æ‰¾åˆ°å­ç±» Ctrl + H ç±»ç»“æ„ Ctrl+Shift + H æ–¹æ³•å±‚æ¬¡ Ctrl + Alt + H è°ƒç”¨å±‚æ¬¡ Alt + F7 find use éå¸¸å¥½ç”¨çš„åŠŸèƒ½ Shift + F6 é‡å‘½å logt + Enter Tag loge logd â€¦ æ‰“å°log 2.è‡ªåŠ¨ç”Ÿæˆä»£ç  Ctrl + J é‡Œé¢ç›¸å½“å¤šçš„æ¨¡ç‰ˆä»£ç  if åˆ¤ç©º ifn for å¾ªç¯ for foreach foreach setVisibility gone findViewById fbc instanceof inst è¿™äº›æ¯”è¾ƒå¸¸ç”¨ 3.è‡ªåŠ¨å¯¼å…¥åŒ…Settings&gt;Editor&gt;General&gt;Auto import 4.å…¶ä»–è®¾ç½®å·²ç»å¯¼å‡º ps : åœ¨ç™¾åº¦äº‘é‡Œæœ‰","categories":[{"name":"Android Studio","slug":"Android-Studio","permalink":"https://www.wangzhumo.com/categories/Android-Studio/"}],"tags":[{"name":"Android Studio","slug":"Android-Studio","permalink":"https://www.wangzhumo.com/tags/Android-Studio/"}]},{"title":"Android Studio å¯¼å…¥ VitamioåŠæ¨ªç«–å±åˆ‡æ¢","slug":"Android-Studio-Vitamio","date":"2017-12-25T01:28:42.000Z","updated":"2019-12-22T12:04:24.525Z","comments":true,"path":"2017/12/25/Android-Studio-Vitamio/","link":"","permalink":"https://www.wangzhumo.com/2017/12/25/Android-Studio-Vitamio/","excerpt":"##å»ºè®®ä¸è¦ä½¿ç”¨Vitamio,å„ç§æ·±å‘ https://github.com/Bilibili/ijkplayerçœ‹çœ‹bilibiliçš„å¼€æºæ’­æ”¾å™¨ ##Vitamioå®˜æ–¹:https://www.vitamio.org/GitHub:https://github.com/yixia/VitamioBundle Vitamio èƒ½å¤Ÿæµç•…æ’­æ”¾720Pç”šè‡³1080Pé«˜æ¸…MKVï¼ŒFLVï¼ŒMP4ï¼ŒMOVï¼ŒTSï¼ŒRMVBç­‰å¸¸è§æ ¼å¼çš„è§†é¢‘ï¼Œæ”¯æŒ MMS, RTSP, RTMP, HLS(m3u8) ç­‰å¸¸è§çš„å¤šç§è§†é¢‘æµåª’ä½“åè®®ï¼ŒåŒ…æ‹¬ç‚¹æ’­ä¸ç›´æ’­ã€‚","text":"##å»ºè®®ä¸è¦ä½¿ç”¨Vitamio,å„ç§æ·±å‘ https://github.com/Bilibili/ijkplayerçœ‹çœ‹bilibiliçš„å¼€æºæ’­æ”¾å™¨ ##Vitamioå®˜æ–¹:https://www.vitamio.org/GitHub:https://github.com/yixia/VitamioBundle Vitamio èƒ½å¤Ÿæµç•…æ’­æ”¾720Pç”šè‡³1080Pé«˜æ¸…MKVï¼ŒFLVï¼ŒMP4ï¼ŒMOVï¼ŒTSï¼ŒRMVBç­‰å¸¸è§æ ¼å¼çš„è§†é¢‘ï¼Œæ”¯æŒ MMS, RTSP, RTMP, HLS(m3u8) ç­‰å¸¸è§çš„å¤šç§è§†é¢‘æµåª’ä½“åè®®ï¼ŒåŒ…æ‹¬ç‚¹æ’­ä¸ç›´æ’­ã€‚ ###ä¸‹è½½Vitamio åœ°å€https://www.vitamio.org/Download/ ###è§£å‹å¹¶å¯¼å…¥Android æ‰¾åˆ°åˆ°æ–‡ä»¶å¤¹VitamioBundle File &gt; New &gt; New Module å¯¼å…¥å®Œæˆåæ˜¯è¿™æ ·çš„ ###å¯¼å…¥åˆ°è‡ªå·±çš„é¡¹ç›® (å³ä¸ä½¿ç”¨Vitamioçš„libiary,å¼ºè¿«ç—‡ä¸“å±) ####A.åœ¨è‡ªå·±çš„ç›®å½•ä¸‹å»ºç«‹io.vov.vitamio å¹¶å¯¼å…¥æ‰€æœ‰çš„ç±»,ä»¥åŠå°†jniLibsç›®å½•æ‹·è´åˆ°mainç›®å½•ä¸‹,è¿˜æœ‰ç›¸å…³çš„èµ„æºæ–‡ä»¶ ####B.åœ¨AndroidManifest.xmlæ–‡ä»¶ä¸­å†™å…¥ &lt;activity android:name=&quot;io.vov.vitamio.activity.InitActivity&quot; android:configChanges=&quot;orientation|screenSize|smallestScreenSize|keyboard|keyboardHidden|navigation&quot; android:launchMode=&quot;singleTop&quot; android:theme=&quot;@android:style/Theme.NoTitleBar&quot; android:windowSoftInputMode=&quot;stateAlwaysHidden&quot;/&gt; å¹¶åŠ å…¥ç›¸åº”çš„æƒé™ ####C.åœ¨ä½ å–œæ¬¢çš„åœ°æ–¹åˆå§‹åŒ–Vitamio å¼€ç©ç¬‘çš„,æ”¾åœ¨activityæˆ–è€…æ˜¯Applicationçš„onCreateä¸­ Vitamio.isInitialized(application.getApplicationContext()); ###Vatimioçš„ä½¿ç”¨ ####A.ç•Œé¢çš„æ­å»º å¯ä»¥çœ‹åˆ° æ•´ä¸ªé¡µé¢ä¸»è¦åˆ†ä¸Šä¸‹ä¸¤å±‚,ä¸»è¦æ˜¯ä¸ºäº†è§†å±å…¨å±çš„æ—¶å€™èƒ½æ–¹ä¾¿çš„éšè—æ•´ä¸ªä¸‹é¢çš„å¸ƒå±€ ####B.ä½¿ç”¨åœ¨æ­¤ä¹‹å‰ä¸ºäº†æ–¹ä¾¿çš„ä½¿ç”¨è§†å±å…¨å±æ’­æ”¾,å¯¹MediaController(package io.vov.vitamio.widget)åšä¸€ä¸ªå°å°çš„æ”¹é€ :æ·»åŠ ä¸€ä¸ªæ„é€ :ä¸»è¦ç”¨äºæŠŠè§†å±,è¿›åº¦æ¡ç­‰æ”¾åˆ°ä¸€ä¸ªViewä¸­,ä¾¿äºå…¨å±å±•ç¤º //è¿™ä¸ªå…¨å±çš„æ“ä½œå¯æŠŠæˆ‘éš¾åäº†,çœ‹åˆ°è¿™ä¸ªçœŸçš„æ˜¯ä¸ºåŸä½œè€…çš„æœºæ™ºç‚¹èµ public MediaController(Context context,boolean fromXml,View container) { super(context); initController(context); mFromXml = fromXml; mRoot = makeControllerView(); //è¿™ä¸ªåœ°æ–¹çš„FrameLayout.LayoutpParamsæ˜¯å› ä¸ºå¸ƒå±€æ–‡ä»¶ä¸­è¦æŠŠMediaControllerçš„è§†å›¾ä½œä¸ºchildViewåŠ åˆ°ä¸€ä¸ªFrameLayoutä¸­å» LayoutParams p = new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT); //æƒ³æ€æ ·å¸ƒå±€MediaControllerå°±å°½æƒ…çš„å‘æŒ¥è¿™ä¸ªLayoutParamså§ p.gravity = Gravity.BOTTOM; mRoot.setLayoutParams(p); ((FrameLayout)container).addView(mRoot); } æ¥ç€ä½ å°±å¯ä»¥æ„‰å¿«çš„ç©è€äº†:åœ¨oncreateä¸­è°ƒç”¨ initVitamioView(); //åˆå§‹åŒ–æ§ä»¶ private void initVitamioView() { //VideoView mVideoView = (VideoView) findViewById(R.id.buffer); //è¿™ä¸ªå°±æ˜¯åŒ…è£¹æ•´ä¸ªè§†å±æ¨¡å—çš„FrameLayout fl_controller = (FrameLayout) findViewById(R.id.fl_controller); //ç¼“å†²æ—¶å‡ºç°çš„è¿›åº¦æ¡ pb = (ProgressBar) findViewById(R.id.probar); //æ’­æ”¾è¿›åº¦,å¹¶å¯ä»¥æ‹–åŠ¨è°ƒèŠ‚è§†å±æ’­æ”¾ä½ç½® downloadRateView = (TextView) findViewById(R.id.download_rate); loadRateView = (TextView) findViewById(R.id.load_rate); //è®¾ç½®è§†å±setVideoURIå¯ä»¥ç¼“å†²å¹¶æ’­æ”¾ //setVideoPath()ç¼“å†²å®Œå†æ’­æ”¾ mVideoView.setVideoURI(Uri.parse(TextUtils.isEmpty(path)?defaultPath:path)); //è¿™é‡Œä½¿ç”¨è‡ªå®šä¹‰çš„é‚£ä¸ªMediaControlleræ„é€  mMediaController= new MediaController(this, true, fl_controller); //è¿™é‡Œçš„ç›‘å¬å…¶å®æ˜¯åœ¨MediaControllerä¸­è‡ªå·±å®šä¹‰çš„,ä¸»è¦å°±æ˜¯å…¨å±çš„åˆ‡æ¢æŒ‰é’® mMediaController.setOnControllerClick(new MediaController.OnControllerClick() { @Override public void OnClick(int type) { if (type == 0) { //è¡¨ç¤ºç‚¹å‡»åˆ‡æ¢å…¨å±æŒ‰é’® if (isPortrait) { //ä¸æ˜¯å…¨å±,åˆ‡æ¢ä¸ºå…¨å± //ä»£ç å—1 } else { //æ˜¯å…¨å±,è¿‘æ¥å°±åˆ‡ä¸ºåŸæ¥çš„å¤§å° //ä»£ç å—2 } } } }); //ç±»ä¼¼ç»‘å®š mVideoView.setMediaController(mMediaController); //éšè—æ§åˆ¶æ¨¡å— mMediaController.setVisibility(View.GONE); mVideoView.requestFocus(); //è®¾ç½®å¯¹è§†å±ä¿¡æ¯çš„ç›‘å¬ mVideoView.setOnInfoListener(this); //è§†å±ç¼“å†²çš„ç›‘å¬ mVideoView.setOnBufferingUpdateListener(this); //è§†å±OK mVideoView.setOnPreparedListener(new MediaPlayer.OnPreparedListener() { @Override public void onPrepared(MediaPlayer mediaPlayer) { //è®¾ç½®æ’­æ”¾é€Ÿåº¦ mediaPlayer.setPlaybackSpeed(1.0f); } }); } è¡¥å……ä»£ç å—1 RelativeLayout.LayoutParams fl_lp = new RelativeLayout.LayoutParams(displayheight, displayWidth); fl_controller.setLayoutParams(fl_lp); //è®¾ç½®æ¨ªå± setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE); //è¿™æ ·mVideoViewä¼šè‡ªå·±å……æ»¡å…¨å± mVideoView.setVideoLayout(VideoView.VIDEO_LAYOUT_SCALE, 0); isPortrait = false; ä»£ç å—2 RelativeLayout.LayoutParams fl_lp = new RelativeLayout.LayoutParams( LinearLayout.LayoutParams.MATCH_PARENT, DensityUtils.dip2px(ClassRoomActivity.this,200) ); fl_controller.setLayoutParams(fl_lp); setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); isPortrait = true; /* * æ¨ªç«–å±åˆ‡æ¢çš„æ—¶å€™å›èµ°è¿™ä¸ªå›è°ƒ * */ @Override public void onConfigurationChanged(Configuration newConfig) { //å±å¹•åˆ‡æ¢æ—¶ï¼Œè®¾ç½®å…¨å± if (this.getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) { //éšè—ä¸‹é¢çš„å¸ƒå±€å’Œæ ‡é¢˜ tLBelow.setVisibility(View.GONE); mTitlebar.setVisibility(View.GONE); } if (this.getResources().getConfiguration().orientation == Configuration.ORIENTATION_PORTRAIT) { //æ˜¾ç¤ºä¸‹é¢çš„å¸ƒå±€å’Œæ ‡é¢˜ tLBelow.setVisibility(View.VISIBLE); mTitlebar.setVisibility(View.VISIBLE); } super.onConfigurationChanged(newConfig); } ####C.ä¸¤ä¸ªé‡è¦çš„ç›‘å¬(ä¸Šé¢å·²ç»æ³¨å†Œè¿‡äº†) //ç¼“å†²çš„ç›‘å¬ @Override public void onBufferingUpdate(MediaPlayer mp, int percent) { //æ˜¾ç¤ºç¼“å†²è¿›åº¦ loadRateView.setText(percent + &quot;%&quot;); } //è§†å±ä¿¡æ¯ç›‘å¬ @Override public boolean onInfo(MediaPlayer mp, int what, int extra) { switch (what) { //å¼€å§‹ç¼“å†² case MediaPlayer.MEDIA_INFO_BUFFERING_START: if (mVideoView.isPlaying()) { mVideoView.pause(); pb.setVisibility(View.VISIBLE); downloadRateView.setText(&quot;&quot;); loadRateView.setText(&quot;&quot;); downloadRateView.setVisibility(View.VISIBLE); loadRateView.setVisibility(View.VISIBLE); } break; //åœæ­¢ç¼“å†²,è¿™é‡Œè‡ªåŠ¨å¼€å§‹æ’­æ”¾ case MediaPlayer.MEDIA_INFO_BUFFERING_END: mVideoView.start(); pb.setVisibility(View.GONE); downloadRateView.setVisibility(View.GONE); loadRateView.setVisibility(View.GONE); break; case MediaPlayer.MEDIA_INFO_DOWNLOAD_RATE_CHANGED: //ç¼“å†²çš„...é‚£ä¸ªå•¥ change downloadRateView.setText(&quot;&quot; + extra + &quot;kb/s&quot; + &quot; &quot;); break; } return true; } ###4.å°±è¿™æ · å¯¹äº†,å®Œäº‹è®°å¾— @Override protected void onDestroy() { mVideoView.stopPlayback(); super.onDestroy(); } åŸºæœ¬å°±æ˜¯è¿™æ ·äº†,å…¶ä»–çš„é—®é¢˜è‡ªå·±è§£å†³ä¸€ä¸‹å°±å¥½äº†â€¦","categories":[{"name":"Android Studio","slug":"Android-Studio","permalink":"https://www.wangzhumo.com/categories/Android-Studio/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"},{"name":"Android Studio","slug":"Android-Studio","permalink":"https://www.wangzhumo.com/tags/Android-Studio/"}]},{"title":"Linux å­¦ä¹ ç¬”è®°","slug":"Linux-learn","date":"2017-12-24T15:50:59.000Z","updated":"2019-11-07T10:54:11.315Z","comments":true,"path":"2017/12/24/Linux-learn/","link":"","permalink":"https://www.wangzhumo.com/2017/12/24/Linux-learn/","excerpt":"netstat -an æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¿æ¥ moreå‘½ä»¤ é€‰é¡¹ -num æŒ‡å®šå±å¹•çš„è¡Œæ•°ï¼ˆä»¥æ•´æ•°è¡¨ç¤ºï¼‰ +num ä»è¡Œå·numå¼€å§‹æ˜¾ç¤º -d è®©moreç»™ç”¨æˆ·æ˜¾ç¤ºä¿¡æ¯[Press space to continue, &#39;q&#39; to quit.] -f ä½¿moreè®¡æ•°é€»è¾‘è¡Œï¼Œè€Œä¸æ˜¯å±å¹•è¡Œï¼ˆé•¿è¡Œä¸ä¼šæ–­åˆ°ä¸‹ä¸€è¡Œï¼‰ -s æŠŠé‡å¤çš„ç©ºè¡Œå‹ç¼©æˆä¸€ä¸ªç©ºè¡Œ -u é˜²æ­¢ä¸‹åˆ’çº¿ äº¤äº’åŸºäºVIM","text":"netstat -an æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¿æ¥ moreå‘½ä»¤ é€‰é¡¹ -num æŒ‡å®šå±å¹•çš„è¡Œæ•°ï¼ˆä»¥æ•´æ•°è¡¨ç¤ºï¼‰ +num ä»è¡Œå·numå¼€å§‹æ˜¾ç¤º -d è®©moreç»™ç”¨æˆ·æ˜¾ç¤ºä¿¡æ¯[Press space to continue, &#39;q&#39; to quit.] -f ä½¿moreè®¡æ•°é€»è¾‘è¡Œï¼Œè€Œä¸æ˜¯å±å¹•è¡Œï¼ˆé•¿è¡Œä¸ä¼šæ–­åˆ°ä¸‹ä¸€è¡Œï¼‰ -s æŠŠé‡å¤çš„ç©ºè¡Œå‹ç¼©æˆä¸€ä¸ªç©ºè¡Œ -u é˜²æ­¢ä¸‹åˆ’çº¿ äº¤äº’åŸºäºVIM å­—ç¬¦ç•Œé¢ 1.å­—ç¬¦ç•Œé¢å ç”¨èµ„æºå°‘ 2.å‡å°‘äº†å‡ºé”™,è¢«æ”»å‡»çš„å¯èƒ½ ä¸€åˆ‡çš†æ–‡ä»¶ ç”¨æˆ· ç¡¬ä»¶ æ–‡ä»¶â€¦. åˆ†åŒº swap å†…å­˜çš„ä¸¤å€ / æ ¹åˆ†åŒº /boot bootåˆ†åŒº 200må³å¯ (ä½œä¸ºå¯åŠ¨ç›˜ä½¿ç”¨,å¯åŠ¨éœ€è¦ç©ºé—´) /home /etc â€¦ å®‰è£…æ—¥å¿— /root/install.log è®°å½•äº†å®‰è£…åœ¨ç³»ç»Ÿä¸­çš„è½¯ä»¶åŒ…å’Œç‰ˆæœ¬ä¿¡æ¯ /root/install.log.syslog å®‰è£…è¿‡ç¨‹çš„è®°å½• /root/anaconda-ks.cfg è®°å½•å®‰è£…è¿‡ç¨‹ä¸­çš„é…ç½®ä¿¡æ¯(ç”¨äºç½‘ç»œæ‰¹é‡å®‰è£…) linuxèµ·å§‹ç¬¦ [root@hadoop ~]# root ç”¨æˆ·å hadoop å½“å‰ç”¨æˆ·çš„ä¸»æœºå &quot;~&quot; å½“å‰çš„ç›®å½•, &quot;~&quot;è¡¨ç¤ºå®¶ç›®å½• &quot;#&quot; è¶…çº§ç”¨æˆ·çš„æç¤ºç¬¦ &quot;$&quot; æ™®é€šç”¨æˆ·çš„æç¤ºç¬¦ -rw-râ€“râ€“ drwxr-xr-x. 2 wzm wzm 4096 6æœˆ 21 16:19 Desktop #ä¸€å…±10ä½ drwxr-xr-x #d ç¬¬ä¸€ä½ æ–‡ä»¶ç±»å‹( -æ–‡ä»¶ dç›®å½• |è½¯é“¾æ¥æ–‡ä»¶ c b ) #rwx r-x r-x åé¢çš„æ¯ä¸‰ä½æ˜¯ä¸€ç»„ ç¬¬ä¸€ä¸ªä¸‰ä½ æ‰€å±è€…u ç¬¬äºŒä¸ªä¸‰ä½ æ‰€å±ç»„g ç¬¬ä¸‰ä¸ªä¸‰ä½ å…¶ä»–äººo #acfæƒé™ rè¯» wå†™ xæ‰§è¡Œ ç›®å½• / æ ¹ç›®å½• /etc é…ç½®æ–‡ä»¶ç›®å½• /bin ç³»ç»Ÿå‘½ä»¤çš„ç›®å½• (æ™®é€šç”¨æˆ·å³å¯è¯»å–) /sbin ç³»ç»Ÿå‘½ä»¤çš„ç›®å½• (è¶…çº§ç”¨æˆ·å³å¯è¯»å–) /usr/bin ç³»ç»Ÿå‘½ä»¤çš„ç›®å½• (æ™®é€šç”¨æˆ·å³å¯è¯»å–) /usr/sbinç³»ç»Ÿå‘½ä»¤çš„ç›®å½• (è¶…çº§ç”¨æˆ·å³å¯è¯»å–) /home æ™®é€šç”¨æˆ·çš„å®¶ç›®å½• /root è¶…çº§ç”¨æˆ·çš„å®¶ç›®å½• /usr ç³»ç»Ÿè½¯ä»¶èµ„æºç›®å½• /boot å¯åŠ¨ç›®å½• /var ç³»ç»Ÿç›¸å…³æ–‡æ¡£ /sys ç›´æ¥å†™å…¥å†…å­˜ /proc ç›´æ¥å†™å…¥å†…å­˜ /dev è®¾å¤‡æ–‡ä»¶ç›®å½• /lib ç³»ç»Ÿåº“ ä¿å­˜ç›®å½• /mnt ç³»ç»ŸæŒ‚è½½ç›®å½• /media æŒ‚è½½ç›®å½• linux å¸¸ç”¨å‘½ä»¤ control + L æ¸…å± æ–‡ä»¶å‘½ä»¤ åŸºæœ¬å‘½ä»¤æ ¼å¼ å‘½ä»¤ [é€‰é¡¹] [å‚æ•°] #ls ls -a æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ -l æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯,ç›®å½•ä¸‹æ‰€æœ‰å†…å®¹ -d æŸ¥çœ‹ç›®å½•å±æ€§,ç›®å½•æœ¬èº« -h äººæ€§åŒ–æ˜¾ç¤ºæ–‡ä»¶å¤§å° -i æ˜¾ç¤ºinode æ–‡ä»¶çš„idå· ll ll -l # ç›®å½•æ–‡ä»¶å¤„ç† #mkdir åˆ›å»ºç›®å½• mkdir -p é€’å½’åˆ›å»º,åˆ›å»ºå¤šçº§ç›®å½• #cd åˆ‡æ¢ç›®å½• cd ~ å½“å‰ç”¨æˆ·çš„å®¶ç›®å½• - è¿›å…¥ä¸Šæ¬¡è¿›å…¥çš„ç›®å½• .. è¿›å…¥ä¸Šçº§ç›®å½• . è¿›å…¥å½“å‰ç›®å½• #pwd pwd æ˜¾ç¤ºå½“å‰ç›®å½•å…¨è·¯å¾„ #rm -rf [æ–‡ä»¶æˆ–ç›®å½•] rm -f å¼ºåˆ¶åˆ é™¤ -r åˆ é™¤ç›®å½• #cp cp -r å¤åˆ¶ç›®å½• -p è¿å¸¦æ–‡ä»¶çš„å±æ€§ä¸€èµ·å¤åˆ¶ -d å¦‚æœæ–‡ä»¶ä¸ºé“¾æ¥æ–‡ä»¶,åˆ™å¤åˆ¶é“¾æ¥å±æ€§ -a ç›¸å½“äº-pdr #mv mv [æºåœ°å€] [ç›®æ ‡åœ°å€] è½¯é“¾æ¥å‘½ä»¤(æºæ–‡ä»¶ä¸€å®šå†™å·¨ç»å¯¹è·¯å¾„) #ln [æº] [ç›®æ ‡] ln ä¸èƒ½è·¨åˆ†åŒº,ä¸èƒ½æ˜¯ä¸€ä¸ªç›®å½• ç›¸å½“äºä¸€ä¸ªæ–‡ä»¶ æ–‡ä»¶idå·ç›¸åŒ -s è½¯é“¾æ¥ ç±»ä¼¼windowsé‡Œé¢çš„å¿«æ·æ–¹å¼ æœ‰è‡ªå·±çš„idå· å…¶å®æ˜¯å»æŸ¥çœ‹è‡ªå·±çš„å­˜å‚¨ç‚¹, å­˜å‚¨ç‚¹é‡Œé¢æ˜¯æºæ–‡ä»¶çš„idå·, ç„¶ååˆç”¨æºæ–‡ä»¶idå·å»æ‰¾æºæ–‡ä»¶çš„å­˜å‚¨ç‚¹ æœç´¢å‘½ä»¤ locate æ–‡ä»¶æœç´¢å‘½ä»¤ whereis ä¸ which find æ–‡ä»¶æœç´¢å‘½ä»¤ grep å­—ç¬¦ä¸²æœç´¢å‘½ä»¤ locate #locate locate [æ–‡ä»¶å] åœ¨åå°æ•°æ®åº“ä¸­æŒ‰æ–‡ä»¶åæœç´¢ ä½ç½®åœ¨: /var/lib/mlocate #updatedb updatedb æ›´æ–°æ•°æ®åº“ whereis #whereis whereis [å‘½ä»¤å] -b ä¹‹æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ -m åªæŸ¥æ‰¾å¸®åŠ©æ–‡ä»¶ which æŸ¥çœ‹ #which which [æ–‡ä»¶å] æœç´¢å‘½ä»¤æ‰€åœ¨ç›®å½•è·¯å¾„å·²ç»åˆ«å find #find #é¿å¤§èŒƒå›´æœç´¢,ä¼šéå¸¸æ¶ˆè€—ç³»ç»Ÿèµ„æº #å¦‚æœä¸ç”¨é€šé…ç¬¦,åˆ™ä¼šæœç´¢ä¸æ–‡ä»¶åå®Œå…¨ä¸€è‡´çš„æ–‡ä»¶ find [æœç´ èŒƒå›´] [æœç´¢æ¡ä»¶] find [æœç´ èŒƒå›´] -name [åå­—] -iname [åå­—] ä¸åŒºåˆ†å¤§å°å†™ -user [æ‰€æœ‰è€…] æŒ‰æ‰€æœ‰è€…æœç´¢ -nouser æŸ¥æ‰¾æ²¡æœ‰æ‰€æœ‰è€…çš„æ–‡ä»¶ -mtime [] ä¿®æ”¹æ–‡ä»¶å†…å®¹çš„æ—¶é—´ -atime [] æ–‡ä»¶è®¿é—®æ—¶é—´ -ctime [] æ”¹å˜æ–‡ä»¶å±æ€§çš„æ—¶é—´ [-10 10 +10 10å¤©å†… 10å¤©å½“å¤© +10å¤©å‰] -size [å¤§å°] å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾å¤§å°æ˜¯ 25kçš„æ–‡ä»¶ [-25k 25k +25k] [-2M 2M +2M] -inum [idå·] -a and é€»è¾‘ä¸,åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ eg find /etc -size +25k -a -size -50k -o or é€»è¾‘æˆ–,ä¸¤ä¸ªæ¡ä»¶æ»¡è¶³ä¸€ä¸ªæ¡ä»¶å³å¯ -exec [ä¸€ä¸ªå‘½ä»¤] {} \\; æœç´¢å‡ºæ¥çš„ç»“æœå†æ‰§è¡Œä¸€æ¬¡å‘½ä»¤ eg find /etc -size +25k -a -size -50k -exec ls -lh {} \\; #é€šé…ç¬¦ * åŒ¹é…ä»»ä½•å†…å®¹ ? åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦ [] åŒ¹é…ä»»æ„ä¸€ä¸ªä¸­å£å·å†…çš„å­—ç¬¦ eg: abc abd find /home -name ab[cd] grep #grep grep &quot;size&quot; system.log grepæ˜¯åŒ…å«åŒ¹é… åœ¨ system.log ä¸­æŸ¥æ‰¾&quot;size&quot; å¸®åŠ©å‘½ä»¤ man [å‘½ä»¤] whatis [å‘½ä»¤] man -f [å‘½ä»¤] å‘½ä»¤çš„å¸®åŠ©çº§åˆ« man -k [å‘½ä»¤] æ¨¡ç³ŠåŒ¹é… apropos [å‘½ä»¤] æ¨¡ç³ŠåŒ¹é… [å‘½ä»¤] --help å†…æ ¸çš„å‘½ä»¤æŸ¥çœ‹å¸®åŠ© help [å‘½ä»¤] å‹ç¼©ä¸è§£å‹ç¼© å¸¸ç”¨å‹ç¼©æ ¼å¼ .zip .gz .bz2 .tar.gz .tar.bz2 zip zip [å‹ç¼©æ–‡ä»¶åå­—] [æºæ–‡ä»¶] zip -r [å‹ç¼©æ–‡ä»¶åå­—] [æºç›®å½•] #è§£å‹ç¼© unzip [zipæ–‡ä»¶] gz gzip [æºæ–‡ä»¶] #å‹ç¼©ä¸º.gzæ ¼å¼çš„å‹ç¼©æ–‡ä»¶,æºæ–‡ä»¶ä¼šæ¶ˆå¤± gzip -c [æºæ–‡ä»¶] &gt; å‹ç¼©æ–‡ä»¶ #å‹ç¼©ä¸º.gzæ ¼å¼ ,æºæ–‡ä»¶ä¿ç•™ gzip -r [æºç›®å½•] #å‹ç¼©ç›®å½•ä¸‹æ‰€æœ‰çš„å­æ–‡ä»¶,ä½†æ˜¯ä¸èƒ½å‹ç¼©ç›®å½• #è§£å‹ç¼© gzip -d [å‹ç¼©æ–‡ä»¶] gunzip [å‹ç¼©æ–‡ä»¶] gzp -d -r [ç›®å½•] è§£å‹ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ tar #tar tar -cvf [æ‰“åŒ…æ–‡ä»¶å] [æºæ–‡ä»¶] -c æ‰“åŒ… -v æ˜¾ç¤ºè¿‡ç¨‹ -f æŒ‡å®šæ‰“åŒ…åçš„æ–‡ä»¶å eg tar -cvf jp.tar jp #è§£å‹ç¼© tar -xvf [å‹ç¼©æ–‡ä»¶] .tar.gz tar -zcvf [å‹ç¼©æ–‡ä»¶å] [æºæ–‡ä»¶] #è§£å‹ç¼© tar -zxvf [å‹ç¼©åŒ…å.tar.gz] å…³æœºå’Œé‡å¯ shutdown [é€‰é¡¹] æ—¶é—´ -c å–æ¶ˆå‰ä¸€ä¸ªå…³æœºå‘½ä»¤ -h å…³æœº -r é‡å¯ logout é€€å‡ºç™»å½• å…¶ä»–çš„å‘½ä»¤ w æ˜¾ç¤ºæ‰€æœ‰çš„ç™»å½•ç”¨æˆ· last æ‰€æœ‰ç™»å½•ä¿¡æ¯ lastlog æ‰€æœ‰ç”¨æˆ·ç™»å½•ä¿¡æ¯ å…¶ä»–å¿«æ·é”® control + c å¼ºåˆ¶ç»ˆæ­¢å½“å‰å‘½ä»¤ control + l æ¸…å± control + a å…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦– control + e å…‰æ ‡ç§»åŠ¨åˆ°è¡Œå°¾ control + u ä»å…‰æ ‡ä½ç½®åˆ é™¤åˆ°è¡Œé¦– control + z æŠŠå‘½ä»¤æ”¾å…¥åˆ°åå° control + r åœ¨å†å²è®°å½•ä¸­æœç´¢ è¾“å‡ºé‡å®šå‘ #æ ‡å‡†çš„è¾“å‡ºé‡å®šå‘ å‘½ä»¤ &gt; æ–‡ä»¶ è¦†ç›–çš„æ–¹å¼å†™å…¥ å‘½ä»¤ &gt;&gt; æ–‡ä»¶ è¿½åŠ çš„æ–¹å¼å†™å…¥ #é”™è¯¯è¾“å‡ºé‡å®šå‘ é”™è¯¯å‘½ä»¤ 2&gt; æ–‡ä»¶ è¦†ç›–çš„æ–¹å¼å†™å…¥é”™è¯¯æç¤º é”™è¯¯å‘½ä»¤ 2&gt;&gt; æ–‡ä»¶ è¿½åŠ çš„æ–¹å¼å†™å…¥é”™è¯¯æç¤º #æ­£ç¡®å’Œé”™è¯¯çš„åŒæ—¶è¾“å‡º å‘½ä»¤ &gt;&gt; æ–‡ä»¶ 2&gt;&amp;1 å‘½ä»¤ &amp;&gt;&gt; æ–‡ä»¶ #æ­£ç¡®é”™è¯¯åˆ†å¼€è¾“å‡º å‘½ä»¤ &gt;&gt; æ–‡ä»¶ 2&gt;&gt; æ–‡ä»¶ -è¾“å…¥é‡å®šå‘ wc [é€‰é¡¹] [æ–‡ä»¶å] -c ç»Ÿè®¡å­—èŠ‚æ•° -w ç»Ÿè®¡å•è¯æ•° -l ç»Ÿè®¡è¡Œæ•° wc åœ¨ç»ˆç«¯è¾“å…¥æ–‡å­— control + D ç»Ÿè®¡ç»“æœ wc [æ–‡ä»¶å] æ–‡ä»¶å†…å®¹è¾“å…¥åˆ°ç»ˆç«¯ ç®¡é“ç¬¦ å¤šå‘½ä»¤æ‰§è¡Œ(å‰ä¸€æ¡å‘½ä»¤çš„ç»“æœä¸ä¼šä¼ å…¥) [å‘½ä»¤1] ; [å‘½ä»¤2] é¡ºåºæ‰§è¡Œ [å‘½ä»¤1] &amp;&amp; [å‘½ä»¤2] å‘½ä»¤1æ‰§è¡Œæ­£ç¡® å‘½ä»¤2æ‰§è¡Œ å‘½ä»¤1æ‰§è¡Œé”™è¯¯ å‘½ä»¤2ä¸ä¼šæ‰§è¡Œ [å‘½ä»¤1] || [å‘½ä»¤2] å½“å‘½ä»¤1æ‰§è¡Œä¸æ­£ç¡® å‘½ä»¤2æ‰§è¡Œ å‘½ä»¤1æ‰§è¡Œæ­£ç¡® å‘½ä»¤2å°±ä¸ä¼šæ‰§è¡Œ ç®¡é“ç¬¦(å‰ä¸€æ¡å‘½ä»¤çš„ç»“æœä¼ å…¥ä¸‹ä¸€ä¸ªå‘½ä»¤) # | [å‘½ä»¤1] | [å‘½ä»¤2] å‘½ä»¤2ä¼šå»æ“ä½œå‘½ä»¤1æ‰§è¡Œçš„ç»“æœ é€šé…ç¬¦ ? ä»»æ„ä¸€ä¸ªå­—ç¬¦ * ä»»æ„å†…å®¹ [] åŒ¹é…æ‹¬å·ä¸­çš„æŸä¸€ä¸ªå­—ç¬¦ [-] åŒ¹é…æ‹¬å·ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ - ä»£è¡¨ä¸€ä¸ªèŒƒå›´ [a-z] [1-3] [^] è¡¨ç¤ºåŒ¹é…ä¸æ˜¯æ‹¬å·ä¸­çš„å­—ç¬¦ æ¯”å¦‚[^0-9] æŒ‡åŒ¹é…ä¸æ˜¯æ•°å­—çš„å­—ç¬¦ &#39;&#39; å•å¼•å· åœ¨å•å¼•å·ä¸­æ‰€æœ‰å­—ç¬¦éƒ½æ²¡æœ‰ç‰¹æ®Šå«ä¹‰ &quot;&quot; åŒå¼•å· é™¤äº†&quot;$&quot; å’Œ &quot;`&quot; &quot;\\&quot; å…¶ä»–å­—ç¬¦éƒ½æ²¡æœ‰ç‰¹æ®Šæ„ä¹‰ `` åå¼•å· æ˜¯ç³»ç»Ÿå‘½ä»¤å†…å®¹ $() ç”¨æ¥å¼•ç”¨ç³»ç»Ÿå‘½ä»¤ # shellä¸­è¡¨ç¤ºæ³¨é‡Š $ è°ƒç”¨å˜é‡çš„å€¼ \\ è½¬ä¹‰ç¬¦","categories":[{"name":"Server","slug":"Server","permalink":"https://www.wangzhumo.com/categories/Server/"}],"tags":[{"name":"Serverï¼ŒLinux","slug":"Serverï¼ŒLinux","permalink":"https://www.wangzhumo.com/tags/Serverï¼ŒLinux/"}]},{"title":"Facebook/Stethoâ€”â€”Androidå¼€å‘è°ƒè¯•ç¥å™¨","slug":"Facebook-Stetho","date":"2017-12-24T15:47:55.000Z","updated":"2019-12-22T12:28:57.092Z","comments":true,"path":"2017/12/24/Facebook-Stetho/","link":"","permalink":"https://www.wangzhumo.com/2017/12/24/Facebook-Stetho/","excerpt":"ä¸€ã€ç®€ä»‹Stethoæ˜¯ä¸€ä¸ªAndroidåº”ç”¨è°ƒè¯•å·¥å…·ã€‚é›†æˆåï¼Œå¼€å‘äººå‘˜å¯ä»¥é€šè¿‡Chromeçš„å¼€å‘å·¥å…·æŸ¥çœ‹Appç›¸å…³çš„ä¿¡æ¯å’Œè°ƒè¯•ï¼›å¯è§†åŒ–æ“ä½œï¼Œä¸éœ€è¦è‡ªå·±ä½¿ç”¨adbä¹Ÿä¸éœ€è¦rootæƒé™ã€‚","text":"ä¸€ã€ç®€ä»‹Stethoæ˜¯ä¸€ä¸ªAndroidåº”ç”¨è°ƒè¯•å·¥å…·ã€‚é›†æˆåï¼Œå¼€å‘äººå‘˜å¯ä»¥é€šè¿‡Chromeçš„å¼€å‘å·¥å…·æŸ¥çœ‹Appç›¸å…³çš„ä¿¡æ¯å’Œè°ƒè¯•ï¼›å¯è§†åŒ–æ“ä½œï¼Œä¸éœ€è¦è‡ªå·±ä½¿ç”¨adbä¹Ÿä¸éœ€è¦rootæƒé™ã€‚ äºŒã€APPé›†æˆ1.ä¸‹è½½æœ€æ–°çš„jarï¼Œæˆ–è€…é€šè¿‡Gradleå¼•å…¥stethoçš„libraay compile &#39;com.facebook.stetho:stetho:1.3.1&#39; 2.åªéœ€è¦åœ¨ Applicationçš„ onCreate æ–¹æ³•ä¸­è°ƒç”¨ public class MyApplication extends Application { public void onCreate() { super.onCreate(); Stetho.initializeWithDefaults(this); } } 3.å¦‚æœè¿˜æƒ³æŸ¥çœ‹ç½‘ç»œè¯·æ±‚çš„è¯ï¼Œéœ€è¦å¼•å…¥å¦å¤–çš„Library compile &#39;com.facebook.stetho:stetho-okhttp3:1.3.1&#39; 4.ä½¿ç”¨okhttp è¿˜éœ€è¦æ·»åŠ  StethoInterceptor OkHttpClient client = new OkHttpClient.Builder() .addNetworkInterceptor(new StethoInterceptor()) .build(); ä¸‰ã€ä½¿ç”¨é…ç½®å®Œæˆä¹‹åï¼Œåœ¨Chromeåœ°å€æ è¾“å…¥chrome://inspect chrome://inspect/#devices chromeä¼šæ£€æµ‹åˆ°æˆ‘ä»¬çš„appï¼Œç‚¹å‡» inspect è¿›å…¥æŸ¥çœ‹é¡µé¢","categories":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"String.formatçš„å‚æ•°è¡¨","slug":"string-format","date":"2017-12-23T02:56:53.000Z","updated":"2019-12-22T12:30:52.346Z","comments":true,"path":"2017/12/23/string-format/","link":"","permalink":"https://www.wangzhumo.com/2017/12/23/string-format/","excerpt":"","text":"String.format()%s å­—ç¬¦ä¸²ç±»å‹ &quot;mingrisoft&quot; %c å­—ç¬¦ç±»å‹ &#39;m&#39; %b å¸ƒå°”ç±»å‹ true %d æ•´æ•°ç±»å‹ï¼ˆåè¿›åˆ¶ï¼‰ 99 %x æ•´æ•°ç±»å‹ï¼ˆåå…­è¿›åˆ¶ï¼‰ FF %o æ•´æ•°ç±»å‹ï¼ˆå…«è¿›åˆ¶ï¼‰ 77 %f æµ®ç‚¹ç±»å‹ 99.99 %a åå…­è¿›åˆ¶æµ®ç‚¹ç±»å‹ FF.35AE %e æŒ‡æ•°ç±»å‹ 9.38e+5 %g é€šç”¨æµ®ç‚¹ç±»å‹ï¼ˆfå’Œeç±»å‹ä¸­è¾ƒçŸ­çš„ï¼‰ %h æ•£åˆ—ç  %% ç™¾åˆ†æ¯”ç±»å‹ ï¼… %n æ¢è¡Œç¬¦ %tx æ—¥æœŸä¸æ—¶é—´ç±»å‹ï¼ˆxä»£è¡¨ä¸åŒçš„æ—¥æœŸä¸æ—¶é—´è½¬æ¢ç¬¦","categories":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://www.wangzhumo.com/tags/Java/"}]},{"title":"é€æ˜åº¦å¯¹ç…§è¡¨","slug":"transparency-table","date":"2017-12-23T02:55:00.000Z","updated":"2019-12-22T12:29:40.916Z","comments":true,"path":"2017/12/23/transparency-table/","link":"","permalink":"https://www.wangzhumo.com/2017/12/23/transparency-table/","excerpt":"","text":"é€æ˜åº¦å¯¹ç…§è¡¨100% â€” FF 95% â€” F2 90% â€” E6 85% â€” D9 80% â€” CC 75% â€” BF 70% â€” B3 65% â€” A6 60% â€” 99 55% â€” 8C 50% â€” 80 45% â€” 73 40% â€” 66 35% â€” 59 30% â€” 4D 25% â€” 40 20% â€” 33 15% â€” 26 10% â€” 1A 5% â€” 0D 0% â€” 00","categories":[{"name":"Tools","slug":"Tools","permalink":"https://www.wangzhumo.com/categories/Tools/"}],"tags":[{"name":"Android","slug":"Android","permalink":"https://www.wangzhumo.com/tags/Android/"}]},{"title":"å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼è®°å½•","slug":"Regular-Expression","date":"2017-07-31T05:09:38.000Z","updated":"2019-12-22T12:25:04.729Z","comments":true,"path":"2017/07/31/Regular-Expression/","link":"","permalink":"https://www.wangzhumo.com/2017/07/31/Regular-Expression/","excerpt":"å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼","text":"å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼ å¸¸ç”¨æ­£åˆ™ è¯´æ˜ æ­£åˆ™è¡¨è¾¾å¼ ç½‘å€ï¼ˆURLï¼‰ [a-zA-z]+://[^\\s]* IPåœ°å€(IP Address) `((2[0-4]\\d 25[0-5] [01]?\\d\\d?).){3}(2[0-4]\\d 25[0-5] [01]?\\d\\d?)` ç”µå­é‚®ä»¶(Email) \\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)* QQå·ç  [1-9]\\d{4,} HTMLæ ‡è®°(åŒ…å«å†…å®¹æˆ–è‡ªé—­åˆ) `&lt;(.)(.)&gt;.*&lt;\\/\\1&gt; &lt;(.*) \\/&gt;` å¯†ç (ç”±æ•°å­—/å¤§å†™å­—æ¯/å°å†™å­—æ¯/æ ‡ç‚¹ç¬¦å·ç»„æˆï¼Œå››ç§éƒ½å¿…æœ‰ï¼Œ8ä½ä»¥ä¸Š) (?=^.{8,}$)(?=.*\\d)(?=.*\\W+)(?=.*[A-Z])(?=.*[a-z])(?!.*\\n).*$ æ—¥æœŸ(å¹´-æœˆ-æ—¥) `(\\d{4} \\d{2})-((1[0-2]) (0?[1-9]))-(([12][0-9]) (3[01]) (0?[1-9]))` æ—¥æœŸ(æœˆ/æ—¥/å¹´) `((1[0-2]) (0?[1-9]))/(([12][0-9]) (3[01]) (0?[1-9]))/(\\d{4} \\d{2})` æ—¶é—´(å°æ—¶:åˆ†é’Ÿ, 24å°æ—¶åˆ¶) `((1 0?)[0-9] 2[0-3]):([0-5][0-9])` æ±‰å­—(å­—ç¬¦) [\\u4e00-\\u9fa5] ä¸­æ–‡åŠå…¨è§’æ ‡ç‚¹ç¬¦å·(å­—ç¬¦) [\\u3000-\\u301e\\ufe10-\\ufe19\\ufe30-\\ufe44\\ufe50-\\ufe6b\\uff01-\\uffee] ä¸­å›½å¤§é™†å›ºå®šç”µè¯å·ç  `(\\d{4}- \\d{3}-)?(\\d{8} \\d{7})` ä¸­å›½å¤§é™†æ‰‹æœºå·ç  1\\d{10} ä¸­å›½å¤§é™†é‚®æ”¿ç¼–ç  [1-9]\\d{5} ä¸­å›½å¤§é™†èº«ä»½è¯å·(15ä½æˆ–18ä½) \\d{15}(\\d\\d[0-9xX])? éè´Ÿæ•´æ•°(æ­£æ•´æ•°æˆ–é›¶) \\d+ æ­£æ•´æ•° [0-9]*[1-9][0-9]* è´Ÿæ•´æ•° -[0-9]*[1-9][0-9]* æ•´æ•° -?\\d+ å°æ•° (-?\\d+)(\\.\\d+)? ä¸åŒ…å«abcçš„å•è¯ \\b((?!abc)\\w)+\\b å­—ç¬¦è½¬ä¹‰æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„åæ–œæ å­—ç¬¦ () æŒ‡ç¤ºå…¶åè·Ÿçš„å­—ç¬¦æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼‰ï¼Œæˆ–åº”æŒ‰åŸä¹‰è§£é‡Šè¯¥å­—ç¬¦ã€‚ è½¬ä¹‰å­—ç¬¦ æè¿° æ¨¡å¼ åŒ¹é… è½¬ä¹‰å­—ç¬¦\\a æè¿°ä¸æŠ¥è­¦ (bell) ç¬¦ \\u0007 åŒ¹é…ã€‚ æ¨¡å¼\\a åŒ¹é…â€œError!â€+â€œ\\u0007â€ä¸­çš„ â€œ\\u0007â€ è½¬ä¹‰å­—ç¬¦\\b æè¿°åœ¨å­—ç¬¦ç±»ä¸­ï¼Œä¸é€€æ ¼é”® \\u0008 åŒ¹é…ã€‚ æ¨¡å¼[\\b]{3,} åŒ¹é…â€œ\\b\\b\\b\\bâ€ä¸­çš„â€œ\\b\\b\\b\\bâ€ è½¬ä¹‰å­—ç¬¦\\t æè¿°ä¸åˆ¶è¡¨ç¬¦ \\u0009 åŒ¹é…ã€‚ æ¨¡å¼(\\w+)\\t åŒ¹é…â€œitem1\\titem2\\tâ€ä¸­çš„â€œitem1\\tâ€å’Œâ€œitem2\\tâ€ è½¬ä¹‰å­—ç¬¦\\r æè¿°ä¸å›è½¦ç¬¦ \\u000D åŒ¹é…ã€‚ ï¼ˆ\\r ä¸æ¢è¡Œç¬¦ \\n ä¸æ˜¯ç­‰æ•ˆçš„ã€‚ï¼‰ æ¨¡å¼\\r\\n(\\w+) åŒ¹é…â€œ\\r\\nThese are\\ntwo lines.â€ä¸­çš„â€œ\\r\\nTheseâ€ è½¬ä¹‰å­—ç¬¦\\v æè¿°ä¸å‚ç›´åˆ¶è¡¨ç¬¦ \\u000B åŒ¹é…ã€‚ æ¨¡å¼[\\v]{2,} åŒ¹é…â€œ\\v\\v\\vâ€ä¸­çš„â€œ\\v\\v\\vâ€ è½¬ä¹‰å­—ç¬¦\\f æè¿°ä¸æ¢é¡µç¬¦ \\u000C åŒ¹é…ã€‚ æ¨¡å¼[\\f]{2,} åŒ¹é…â€œ\\f\\f\\fâ€ä¸­çš„â€œ\\f\\f\\fâ€ è½¬ä¹‰å­—ç¬¦\\n æè¿°ä¸æ¢è¡Œç¬¦ \\u000A åŒ¹é…ã€‚ æ¨¡å¼\\r\\n(\\w+) åŒ¹é…â€œ\\r\\nThese are\\ntwo lines.â€ä¸­çš„â€œ\\r\\nTheseâ€ è½¬ä¹‰å­—ç¬¦\\e æè¿°ä¸è½¬ä¹‰ç¬¦ \\u001B åŒ¹é…ã€‚ æ¨¡å¼\\e åŒ¹é…â€œ\\x001Bâ€ä¸­çš„â€œ\\x001Bâ€ è½¬ä¹‰å­—ç¬¦\\nnn æè¿°ä½¿ç”¨å…«è¿›åˆ¶è¡¨ç¤ºå½¢å¼æŒ‡å®šå­—ç¬¦ï¼ˆnnn ç”±äºŒä½æˆ–ä¸‰ä½æ•°å­—ç»„æˆï¼‰ã€‚ æ¨¡å¼\\w\\040\\w åŒ¹é…â€œa bc dâ€ä¸­çš„â€œa bâ€å’Œâ€œc dâ€ è½¬ä¹‰å­—ç¬¦\\xnn æè¿°ä½¿ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼æŒ‡å®šå­—ç¬¦ï¼ˆnn æ°å¥½ç”±ä¸¤ä½æ•°å­—ç»„æˆï¼‰ã€‚ æ¨¡å¼\\w\\x20\\w åŒ¹é…â€œa bc dâ€ä¸­çš„â€œa bâ€å’Œâ€œc dâ€ è½¬ä¹‰å­—ç¬¦\\cX\\cx æè¿°åŒ¹é… X æˆ– x æŒ‡å®šçš„ ASCII æ§ä»¶å­—ç¬¦ï¼Œå…¶ä¸­ X æˆ– x æ˜¯æ§ä»¶å­—ç¬¦çš„å­—æ¯ã€‚ æ¨¡å¼\\cC åŒ¹é…â€œ\\x0003â€ä¸­çš„â€œ\\x0003â€(Ctrl-C) è½¬ä¹‰å­—ç¬¦\\unnnn æè¿°ä½¿ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼åŒ¹é… Unicode å­—ç¬¦ï¼ˆç”± nnnn æ­£ç¡®è¡¨ç¤ºçš„å››ä½æ•°ï¼‰ã€‚ æ¨¡å¼\\w\\u0020\\w åŒ¹é…â€œa bc dâ€ä¸­çš„â€œa bâ€å’Œâ€œc dâ€ è½¬ä¹‰å­—ç¬¦\\ æè¿°åœ¨åé¢å¸¦æœ‰ä¸è¯†åˆ«ä¸ºæœ¬ä¸»é¢˜çš„æ­¤è¡¨å’Œå…¶ä»–è¡¨ä¸­çš„è½¬ä¹‰ç¬¦çš„å­—ç¬¦æ—¶ï¼Œä¸è¯¥å­—ç¬¦åŒ¹é…ã€‚ ä¾‹å¦‚ï¼Œ* ä¸ \\x2A ç›¸åŒï¼Œè€Œ . ä¸ \\x2E ç›¸åŒã€‚ è¿™å…è®¸æ­£åˆ™è¡¨è¾¾å¼å¼•æ“åŒºåˆ†è¯­è¨€å…ƒç´ ï¼ˆå¦‚ æˆ– ?ï¼‰ å’Œå­—ç¬¦æ–‡æœ¬ï¼ˆç”¨ \\ æˆ– \\? è¡¨ç¤ºï¼‰ã€‚ æ¨¡å¼\\d+[+-x*]\\d+ åŒ¹é…â€œ(2+2) 39â€ä¸­çš„â€œ2+2â€å’Œâ€œ3*9â€ å­—ç¬¦ç±»å­—ç¬¦ç±»ä¸ä¸€ç»„å­—ç¬¦ä¸­çš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦åŒ¹é…ã€‚ å­—ç¬¦ç±» æè¿° æ¨¡å¼ åŒ¹é… å­—ç¬¦ç±»[character_group] æè¿°åŒ¹é… character_group ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ¹é…åŒºåˆ†å¤§å°å†™ã€‚ æ¨¡å¼[ae] åŒ¹é…â€œgrayâ€ä¸­çš„â€œaâ€â€œlaneâ€ä¸­çš„â€œaâ€å’Œâ€œeâ€ å­—ç¬¦ç±»[^character_group] æè¿°æ±‚åï¼šä¸ä¸åœ¨ character_group ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œcharacter_group ä¸­çš„å­—ç¬¦åŒºåˆ†å¤§å°å†™ã€‚ æ¨¡å¼[^aei] åŒ¹é…â€œreignâ€ä¸­çš„â€œrâ€ã€â€œgâ€å’Œâ€œnâ€ å­—ç¬¦ç±»[ç¬¬ä¸€ä¸ª-last] æè¿°å­—ç¬¦èŒƒå›´ï¼šä¸ä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªçš„èŒƒå›´ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚ æ¨¡å¼[A-Z] åŒ¹é…â€œAB123â€ä¸­çš„â€œAâ€å’Œâ€œBâ€ å­—ç¬¦ç±». æè¿°é€šé…ç¬¦ï¼šä¸é™¤ \\n ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚è‹¥è¦åŒ¹é…æ–‡æœ¬å¥ç‚¹å­—ç¬¦ï¼ˆ. æˆ– \\u002Eï¼‰ï¼Œä½ å¿…é¡»åœ¨è¯¥å­—ç¬¦å‰é¢åŠ ä¸Šè½¬ä¹‰ç¬¦ (.)ã€‚ æ¨¡å¼a.e åŒ¹é…â€œnaveâ€ä¸­çš„â€œaveâ€â€œwaterâ€ä¸­çš„â€œateâ€ å­—ç¬¦ç±»\\p{name} æè¿°ä¸ name æŒ‡å®šçš„ Unicode é€šç”¨ç±»åˆ«æˆ–å‘½åå—ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚ æ¨¡å¼\\p{Lu}\\p{IsCyrillic} åŒ¹é…â€œCity Lightsâ€ä¸­çš„â€œCâ€å’Œâ€œLâ€â€œĞ”Ğ–emâ€ä¸­çš„â€œĞ”â€å’Œâ€œĞ–â€ å­—ç¬¦ç±»\\P{name} æè¿°ä¸ä¸åœ¨ name æŒ‡å®šçš„ Unicode é€šç”¨ç±»åˆ«æˆ–å‘½åå—ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚ æ¨¡å¼\\P{Lu}\\P{IsCyrillic} åŒ¹é…â€œCityâ€ä¸­çš„â€œiâ€ã€â€œtâ€å’Œâ€œyâ€â€œĞ”Ğ–emâ€ä¸­çš„â€œeâ€å’Œâ€œmâ€ å­—ç¬¦ç±»\\w æè¿°ä¸ä»»ä½•å•è¯å­—ç¬¦åŒ¹é…ã€‚ æ¨¡å¼\\w åŒ¹é…â€œID A1.3â€ä¸­çš„â€œIâ€ã€â€œDâ€ã€â€œAâ€ã€â€œ1â€å’Œâ€œ3â€ å­—ç¬¦ç±»\\W æè¿°ä¸ä»»ä½•éå•è¯å­—ç¬¦åŒ¹é…ã€‚ æ¨¡å¼\\W åŒ¹é…â€œID A1.3â€ä¸­çš„â€œ â€ã€â€œ.â€ å­—ç¬¦ç±»\\s æè¿°ä¸ä»»ä½•ç©ºç™½å­—ç¬¦åŒ¹é…ã€‚ æ¨¡å¼\\w\\s åŒ¹é…â€œID A1.3â€ä¸­çš„â€œDâ€ å­—ç¬¦ç±»\\S æè¿°ä¸ä»»ä½•éç©ºç™½å­—ç¬¦åŒ¹é…ã€‚ æ¨¡å¼\\s\\S åŒ¹é…â€ _â€ in â€œint __ctrâ€ å­—ç¬¦ç±»\\d æè¿°ä¸ä»»ä½•åè¿›åˆ¶æ•°å­—åŒ¹é…ã€‚ æ¨¡å¼\\d åŒ¹é…â€œ4 = IVâ€ä¸­çš„â€œ4â€ å­—ç¬¦ç±»\\D æè¿°åŒ¹é…ä¸æ˜¯åè¿›åˆ¶æ•°çš„ä»»æ„å­—ç¬¦ã€‚ æ¨¡å¼\\D åŒ¹é…â€œ4 = IVâ€ä¸­çš„â€œ â€ã€â€œ=â€ã€â€œ â€ã€â€œIâ€å’Œâ€œVâ€ å®šä½ç‚¹å®šä½ç‚¹æˆ–åŸå­é›¶å®½åº¦æ–­è¨€ä¼šä½¿åŒ¹é…æˆåŠŸæˆ–å¤±è´¥ï¼Œå…·ä½“å–å†³äºå­—ç¬¦ä¸²ä¸­çš„å½“å‰ä½ç½®ï¼Œä½†å®ƒä»¬ä¸ä¼šä½¿å¼•æ“åœ¨å­—ç¬¦ä¸²ä¸­å‰è¿›æˆ–ä½¿ç”¨å­—ç¬¦ æ–­è¨€ æè¿° æ¨¡å¼ åŒ¹é… æ–­è¨€^ æè¿°åŒ¹é…å¿…é¡»ä»å­—ç¬¦ä¸²æˆ–ä¸€è¡Œçš„å¼€å¤´å¼€å§‹ã€‚ æ¨¡å¼^\\d{3} åŒ¹é…â€œ901â€â€œ901-â€ æ–­è¨€$ æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨å­—ç¬¦ä¸²çš„æœ«å°¾æˆ–å‡ºç°åœ¨è¡Œæˆ–å­—ç¬¦ä¸²æœ«å°¾çš„ \\n ä¹‹å‰ã€‚ æ¨¡å¼-\\d{3}$ åŒ¹é…â€œ-333â€â€œ-333â€ æ–­è¨€\\A æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨å­—ç¬¦ä¸²çš„å¼€å¤´ã€‚ æ¨¡å¼\\A\\d{3} åŒ¹é…â€œ901â€â€œ901-â€ æ–­è¨€\\Z æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨å­—ç¬¦ä¸²çš„æœ«å°¾æˆ–å‡ºç°åœ¨å­—ç¬¦ä¸²æœ«å°¾çš„ \\n ä¹‹å‰ã€‚ æ¨¡å¼-\\d{3}\\Z åŒ¹é…â€œ-333â€â€œ-333â€ æ–­è¨€\\z æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨å­—ç¬¦ä¸²çš„æœ«å°¾ã€‚ æ¨¡å¼-\\d{3}\\z åŒ¹é…â€œ-333â€â€œ-333â€ æ–­è¨€\\G æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨ä¸Šä¸€ä¸ªåŒ¹é…ç»“æŸçš„åœ°æ–¹ã€‚ æ¨¡å¼\\G(\\d) åŒ¹é…â€œ(1)(3)(5)7â€ä¸­çš„â€œ(1)â€ã€â€œ(3)â€ã€â€œ(5)â€ æ–­è¨€\\b æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨ \\wï¼ˆå­—æ¯æ•°å­—ï¼‰å’Œ \\Wï¼ˆéå­—æ¯æ•°å­—ï¼‰å­—ç¬¦ä¹‹é—´çš„è¾¹ç•Œä¸Šã€‚ æ¨¡å¼\\b\\w+\\s\\w+\\b åŒ¹é…â€œthem theme them themâ€ä¸­çš„â€œthem themeâ€ã€â€œthem themâ€ æ–­è¨€\\B æè¿°åŒ¹é…ä¸å¾—å‡ºç°åœ¨ \\b è¾¹ç•Œä¸Šã€‚ æ¨¡å¼\\Bend\\w*\\b åŒ¹é…â€œend sends endure lenderâ€ä¸­çš„â€œendsâ€å’Œâ€œenderâ€ åˆ†ç»„æ„é€ åˆ†ç»„æ„é€ æè¿°äº†æ­£åˆ™è¡¨è¾¾å¼çš„å­è¡¨è¾¾å¼ï¼Œé€šå¸¸ç”¨äºæ•è·è¾“å…¥å­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²ã€‚ åˆ†ç»„æ„é€ åŒ…æ‹¬ä¸‹è¡¨ä¸­åˆ—å‡ºçš„è¯­è¨€å…ƒç´ ã€‚ åˆ†ç»„æ„é€  æè¿° æ¨¡å¼ åŒ¹é… åˆ†ç»„æ„é€ (å­è¡¨è¾¾å¼) æè¿°æ•è·åŒ¹é…çš„å­è¡¨è¾¾å¼å¹¶å°†å…¶åˆ†é…åˆ°ä¸€ä¸ªä» 1 å¼€å§‹çš„åºå·ä¸­ã€‚ æ¨¡å¼(\\w)\\1 åŒ¹é…â€œdeepâ€ä¸­çš„â€œeeâ€ åˆ†ç»„æ„é€ (?&lt; åç§° &gt; å­è¡¨è¾¾å¼) æè¿°å°†åŒ¹é…çš„å­è¡¨è¾¾å¼æ•è·åˆ°ä¸€ä¸ªå‘½åç»„ä¸­ã€‚ æ¨¡å¼(?\\w)\\k åŒ¹é…â€œdeepâ€ä¸­çš„â€œeeâ€ åˆ†ç»„æ„é€ (?&lt; åç§° 1 - åç§° 2 &gt; å­è¡¨è¾¾å¼) æè¿°å®šä¹‰å¹³è¡¡ç»„å®šä¹‰ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„åˆ†ç»„æ„é€ ä¸­çš„â€œå¹³è¡¡ç»„å®šä¹‰â€éƒ¨åˆ†ã€‚ æ¨¡å¼(((?â€™Openâ€™()[^()])+((?â€™Close-Openâ€™))[^()])+)*(?(Open)(?!))$ åŒ¹é…â€œ3+2^((1-3)(3-1))â€ä¸­çš„â€œ((1-3)(3-1))â€ åˆ†ç»„æ„é€ (?: å­è¡¨è¾¾å¼) æè¿°å®šä¹‰éæ•è·ç»„ã€‚ æ¨¡å¼Write(?:Line)? åŒ¹é…â€œConsole.WriteLine()â€ä¸­çš„â€œWriteLineâ€â€œConsole.Write(value)â€ä¸­çš„â€œWriteâ€ åˆ†ç»„æ„é€ (?imnsx-imnsx: å­è¡¨è¾¾å¼) æè¿°åº”ç”¨æˆ–ç¦ç”¨å­è¡¨è¾¾å¼ä¸­æŒ‡å®šçš„é€‰é¡¹ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ­£åˆ™è¡¨è¾¾å¼é€‰é¡¹ã€‚ æ¨¡å¼A\\d{2}(?i:\\w+)\\b åŒ¹é…â€œA12xl A12XL a12xlâ€ä¸­çš„â€œA12xlâ€å’Œâ€œA12XLâ€ åˆ†ç»„æ„é€ (?= å­è¡¨è¾¾å¼) æè¿°é›¶å®½åº¦æ­£é¢„æµ‹å…ˆè¡Œæ–­è¨€ã€‚ æ¨¡å¼\\w+(?=.) åŒ¹é…â€œHe is. The dog ran. The sun is out.â€ä¸­çš„â€œisâ€ã€â€œranâ€å’Œâ€œoutâ€ åˆ†ç»„æ„é€ (?! å­è¡¨è¾¾å¼) æè¿°é›¶å®½åº¦è´Ÿé¢„æµ‹å…ˆè¡Œæ–­è¨€ã€‚ æ¨¡å¼\\b(?!un)\\w+\\b åŒ¹é…â€œunsure sure unity usedâ€ä¸­çš„â€œsureâ€å’Œâ€œusedâ€ åˆ†ç»„æ„é€ (?&lt;= å­è¡¨è¾¾å¼) æè¿°é›¶å®½åº¦æ­£å›é¡¾åå‘æ–­è¨€ã€‚ æ¨¡å¼(?&lt;=19)\\d{2}\\b åŒ¹é…â€œ1851 1999 1950 1905 2003â€ä¸­çš„â€œ99â€ã€â€œ50â€å’Œâ€œ05â€ åˆ†ç»„æ„é€ (?&lt;! å­è¡¨è¾¾å¼) æè¿°é›¶å®½åº¦è´Ÿå›é¡¾åå‘æ–­è¨€ã€‚ æ¨¡å¼(?&lt;!19)\\d{2}\\b åŒ¹é…â€œ1851 1999 1950 1905 2003â€ä¸­çš„â€œ51â€å’Œâ€œ03â€ åˆ†ç»„æ„é€ (?&gt; å­è¡¨è¾¾å¼) æè¿°éå›æº¯ï¼ˆä¹Ÿç§°ä¸ºâ€œè´ªå©ªâ€ï¼‰å­è¡¨è¾¾å¼ã€‚ æ¨¡å¼13579 åŒ¹é…â€œ1ABB 3ABBC 5AB 5ACâ€ä¸­çš„â€œ1ABBâ€ã€â€œ3ABBâ€å’Œâ€œ5ABâ€ æ•°é‡è¯ é™å®šç¬¦ æè¿° æ¨¡å¼ åŒ¹é… é™å®šç¬¦* æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ æ¨¡å¼\\d*.\\d åŒ¹é…â€œ.0â€ï¼Œâ€œ19.9â€å’Œâ€œ219.9â€ é™å®šç¬¦+ æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ æ¨¡å¼â€be+â€ åŒ¹é…â€œbeenâ€ä¸­çš„â€œbeeâ€ï¼Œâ€œbentâ€ä¸­çš„â€œbeâ€ é™å®šç¬¦? æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ æ¨¡å¼â€rai?nâ€ åŒ¹é…â€œranâ€å’Œâ€œrainâ€ é™å®šç¬¦{n} æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ æ°å¥½ n æ¬¡ã€‚ æ¨¡å¼â€,\\d{3}â€ åŒ¹é…â€œ1,043.6â€ä¸­çš„â€œ,043â€ï¼Œâ€œ9,876,543,210â€ä¸­çš„â€œ,876â€ã€â€œ,543â€å’Œâ€œ,210â€ é™å®šç¬¦{n,} æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ è‡³å°‘ n æ¬¡ã€‚ æ¨¡å¼â€\\d{2,}â€ åŒ¹é…â€œ166â€ï¼Œâ€œ29â€å’Œâ€œ1930â€ é™å®šç¬¦{n,m} æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ è‡³å°‘ n æ¬¡ï¼Œä½†ä¸å¤šäº m æ¬¡ã€‚ æ¨¡å¼â€\\d{3,5}â€ åŒ¹é…â€œ166â€ã€â€œ17668â€â€œ193024â€ä¸­çš„â€œ19302â€ é™å®šç¬¦*? æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ é›¶æ¬¡æˆ–å¤šæ¬¡ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚ æ¨¡å¼\\d*?.\\d åŒ¹é…â€œ.0â€ï¼Œâ€œ19.9â€å’Œâ€œ219.9â€ é™å®šç¬¦+? æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚ æ¨¡å¼â€be+?â€ åŒ¹é…â€œbeenâ€ä¸­çš„â€œbeâ€ï¼Œâ€œbentâ€ä¸­çš„â€œbeâ€ é™å®šç¬¦?? æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚ æ¨¡å¼â€rai??nâ€ åŒ¹é…â€œranâ€å’Œâ€œrainâ€ é™å®šç¬¦{n}? æè¿°åŒ¹é…å‰é¢çš„å…ƒç´ æ°å¥½ n æ¬¡ã€‚ æ¨¡å¼â€,\\d{3}?â€ åŒ¹é…â€œ1,043.6â€ä¸­çš„â€œ,043â€ï¼Œâ€œ9,876,543,210â€ä¸­çš„â€œ,876â€ã€â€œ,543â€å’Œâ€œ,210â€ é™å®šç¬¦{n,}? æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ è‡³å°‘ n æ¬¡ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚ æ¨¡å¼â€\\d{2,}?â€ åŒ¹é…â€œ166â€ï¼Œâ€œ29â€å’Œâ€œ1930â€ é™å®šç¬¦{n,m}? æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ çš„æ¬¡æ•°ä»‹äº n å’Œ m ä¹‹é—´ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚ æ¨¡å¼â€\\d{3,5}?â€ åŒ¹é…â€œ166â€ã€â€œ17668â€â€œ193024â€ä¸­çš„â€œ193â€ã€â€œ024â€","categories":[{"name":"Other","slug":"Other","permalink":"https://www.wangzhumo.com/categories/Other/"}],"tags":[{"name":"Regular","slug":"Regular","permalink":"https://www.wangzhumo.com/tags/Regular/"}]}]}