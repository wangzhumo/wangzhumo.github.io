<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Flutterç¨³å®šç‰ˆå®‰è£…</title>
    <link href="undefined2019/12/02/release-flutter-setup/"/>
    <url>2019/12/02/release-flutter-setup/</url>
    
    <content type="html"><![CDATA[<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h4 id="1-ä¸‹è½½ç¨³å®šç‰ˆåŒ…"><a href="#1-ä¸‹è½½ç¨³å®šç‰ˆåŒ…" class="headerlink" title="1.ä¸‹è½½ç¨³å®šç‰ˆåŒ…"></a>1.ä¸‹è½½ç¨³å®šç‰ˆåŒ…</h4><blockquote><p><a href="https://flutter.dev/docs/development/tools/sdk/releases?tab=macos" target="_blank" rel="noopener">https://flutter.dev/docs/development/tools/sdk/releases?tab=macos</a></p></blockquote><p>é€‰æ‹©ç³»ç»Ÿï¼Œå¹¶é€‰æ‹©äº†<a href="https://storage.googleapis.com/flutter_infra/releases/stable/macos/flutter_macos_v1.9.1+hotfix.6-stable.zip" target="_blank" rel="noopener">v1.9.1+hotfix.6</a>  ç‰ˆæœ¬</p><a id="more"></a><h4 id="2-è§£å‹å¹¶é…ç½®ç¯å¢ƒå˜é‡"><a href="#2-è§£å‹å¹¶é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2.è§£å‹å¹¶é…ç½®ç¯å¢ƒå˜é‡"></a>2.è§£å‹å¹¶é…ç½®ç¯å¢ƒå˜é‡</h4><pre><code class="shell">flutter on ğŸŒ± stableâœ pwd/Users/wangzhumo/Develop/flutterflutter on ğŸŒ± stablevim ~/.bash_profile</code></pre><p>æŠŠè·¯å¾„å†™å…¥<code>.bash_profile</code></p><pre><code class="shell">ulimit -S -n 1024export FLUTTER=/Users/wangzhumo/Develop/flutter#PUB_HOSTED_URL  FLUTTER_STORAGE_BASE_URL æ˜¯Flutterçš„å›½å†…é•œåƒexport PUB_HOSTED_URL=https://pub.flutter-io.cnexport FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cnexport PATH=$PATH:$FLUTTER/bin//é€€å‡ºåˆ°flutterç›®å½•flutter on ğŸŒ± stableâœ source ~/.base_profile</code></pre><p>å†™å®Œä¹‹å<code>wq</code>è®°å¾—ä¿å­˜ï¼Œç„¶å<code>source</code>ä¸€ä¸‹</p><p>####3.é¢„å…ˆä¸‹è½½ï¼ˆå¯é€‰ï¼‰</p><pre><code class="shell">flutter on ğŸŒ± stableâœ flutter precache</code></pre><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><h3 id="Run-flutter-doctor"><a href="#Run-flutter-doctor" class="headerlink" title="Run flutter doctor"></a>Run flutter doctor</h3><p>Run the following command to see if there are any dependencies you need to install to complete the setup (for verbose output, add the <code>-v</code> flag):</p><pre><code class="shell">flutter on ğŸŒ± stableâœ flutter doctor</code></pre><p>è¿è¡Œçš„ç»“æœæ˜¯ï¼š</p><pre><code class="shell">flutter on ğŸŒ± stable took 6sâœ flutter doctorDoctor summary (to see all details, run flutter doctor -v):[âœ“] Flutter (Channel stable, v1.9.1+hotfix.6, on Mac OS X 10.15 19A583, locale zh-Hans-CN)[!] Android toolchain - develop for Android devices (Android SDK version 29.0.2)    ! Some Android licenses not accepted.  To resolve this, run: flutter doctor --android-licenses[âœ“] Xcode - develop for iOS and macOS (Xcode 11.1)[âœ“] Android Studio (version 3.5)[!] IntelliJ IDEA Ultimate Edition (version 2019.2.3)    âœ— Flutter plugin not installed; this adds Flutter specific functionality.    âœ— Dart plugin not installed; this adds Dart specific functionality.[âœ“] VS Code[âœ“] Connected device (2 available)! Doctor found issues in 2 categories.</code></pre><p>å¯ä»¥çœ‹åˆ°æˆ‘è¿™è¾¹<code>Android toolchain</code>æœ‰ç‚¹é—®é¢˜ï¼ŒæŒ‰ç…§æç¤ºçš„</p><pre><code class="shell">âœ flutter doctor --android-licensesWarning: File /Users/wangzhumo/.android/repositories.cfg could not be loaded.1 of 7 SDK package license not accepted.] 100% Computing updates...//ä¸€è·¯ y ä¸‹å»å³å¯</code></pre><p><strong>è¿™ä¸€æ­¥ï¼Œå¯èƒ½ä¼šè€—è´¹å¤§é‡çš„æ—¶é—´ï¼Œå†åŠ ä¸Šç½‘ç»œçš„é—®é¢˜ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œè¯·å‚è€ƒ ã€ä½¿ç”¨é•œåƒã€‘</strong></p><h2 id="ä½¿ç”¨é•œåƒã€è½¬ã€‘"><a href="#ä½¿ç”¨é•œåƒã€è½¬ã€‘" class="headerlink" title="ä½¿ç”¨é•œåƒã€è½¬ã€‘"></a>ä½¿ç”¨é•œåƒã€è½¬ã€‘</h2><blockquote><p><a href="https://flutterchina.club/setup-macos/" target="_blank" rel="noopener">https://flutterchina.club/setup-macos/</a></p></blockquote><p>ç”±äºåœ¨å›½å†…è®¿é—®Flutteræœ‰æ—¶å¯èƒ½ä¼šå—åˆ°é™åˆ¶ï¼ŒFlutterå®˜æ–¹ä¸ºä¸­å›½å¼€å‘è€…æ­å»ºäº†ä¸´æ—¶é•œåƒï¼Œå¤§å®¶å¯ä»¥å°†å¦‚ä¸‹ç¯å¢ƒå˜é‡åŠ å…¥åˆ°ç”¨æˆ·ç¯å¢ƒå˜é‡ä¸­ï¼š</p><pre><code>export PUB_HOSTED_URL=https://pub.flutter-io.cnexport FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn</code></pre><p><strong>æ³¨æ„ï¼š</strong> æ­¤é•œåƒä¸ºä¸´æ—¶é•œåƒï¼Œå¹¶ä¸èƒ½ä¿è¯ä¸€ç›´å¯ç”¨ï¼Œè¯»è€…å¯ä»¥å‚è€ƒè¯¦æƒ…è¯·å‚è€ƒ <a href="https://github.com/flutter/flutter/wiki/Using-Flutter-in-China" target="_blank" rel="noopener">Using Flutter in China</a> ä»¥è·å¾—æœ‰å…³é•œåƒæœåŠ¡å™¨çš„æœ€æ–°åŠ¨æ€ã€‚</p><h2 id="è¿è¡ŒDemo"><a href="#è¿è¡ŒDemo" class="headerlink" title="è¿è¡ŒDemo"></a>è¿è¡ŒDemo</h2>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenGLç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢</title>
    <link href="undefined2019/11/28/learn-opengl-triangle/"/>
    <url>2019/11/28/learn-opengl-triangle/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™é‡Œæˆ‘ä¼šä½¿ç”¨åˆšåˆšå­¦ä¹ åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå°è¯•ç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢ã€‚ä½¿ç”¨Androidæä¾›çš„GLSurfaceViewé…åˆOpenGL ESå®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚</p><a id="more"></a><ul><li>GLSurfaceView</li><li>å®ç°GLSurfaceView.Renderer</li><li>glFrustumfï¼ŒglViewportï¼ŒglVertexPointer</li><li>glDrawArrays</li></ul><h2 id="ç¼–ç "><a href="#ç¼–ç " class="headerlink" title="ç¼–ç "></a>ç¼–ç </h2><h3 id="1-åˆ›å»ºTriangleActivity"><a href="#1-åˆ›å»ºTriangleActivity" class="headerlink" title="1.åˆ›å»ºTriangleActivity"></a>1.åˆ›å»ºTriangleActivity</h3><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;        xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;        xmlns:tools=&quot;http://schemas.android.com/tools&quot;        android:layout_width=&quot;match_parent&quot;        android:layout_height=&quot;match_parent&quot;        tools:context=&quot;.opengl.triangle.TriangleActivity&quot;&gt;    &lt;android.opengl.GLSurfaceView            android:id=&quot;@+id/gl_surface_view&quot;            android:layout_width=&quot;match_parent&quot;            android:layout_height=&quot;match_parent&quot;            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;            app:layout_constraintStart_toStartOf=&quot;parent&quot;            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</code></pre><p>åŠ è½½å¸ƒå±€,è®¾ç½®TriangleRenderer</p><pre><code class="kotlin">@Route(path = IRoute.MEDIA_OPENGL_TRIANGLE)class TriangleActivity : BaseActivity() {    override fun getLayoutId(): Int = R.layout.activity_triangle    override fun initViews(savedInstanceState: Bundle?) {        gl_surface_view.setRenderer(TriangleRenderer())    }}</code></pre><h3 id="2-å®ç°TriangleRenderer"><a href="#2-å®ç°TriangleRenderer" class="headerlink" title="2.å®ç°TriangleRenderer"></a>2.å®ç°TriangleRenderer</h3><p>è¿™é‡Œçš„æ³¨é‡Šå†™çš„å¾ˆå®Œå–„äº†ï¼Œä¸åšå…¶ä»–çš„è¡¥å……</p><pre><code class="kotlin">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2019-11-29  10:49 * * ä¸‰è§’å½¢çš„renderer */class TriangleRenderer : GLSurfaceView.Renderer {    private var ratio = 0F    override fun onDrawFrame(gl: GL10?) {        //åˆ‡æ¢åˆ°æ¨¡å‹çŸ©é˜µ        gl?.apply {            //æ¸…å±,æ¸…é™¤é¢œè‰²ç¼“å†²åŒº            glClear(GL10.GL_COLOR_BUFFER_BIT)            //gluLookAt éœ€è¦æ“ä½œçš„æ˜¯æ¨¡å‹çŸ©é˜µ            glMatrixMode(GL10.GL_MODELVIEW)            //åŠ è½½å•ä½çŸ©é˜µ - åˆå§‹åŒ–            glLoadIdentity()        }      /*         * @param gl a GL10 interface   glå¯¹è±¡         *         * @param eyeX eye point X         * @param eyeY eye point Y      è§‚å¯Ÿè€…çš„ä½ç½®ï¼Œæœ€å¥½æ˜¯ä¸å¹³æˆªå¤´ä½“åœ¨ä¸€ä¸ªåŸç‚¹ä¸Š         * @param eyeZ eye point Z         *         * @param centerX center of view X         * @param centerY center of view Y   è§‚å¯Ÿè€…çš„è§‚å¯Ÿæ–¹å‘ï¼ˆæœå‘0ï¼Œ0ï¼Œ0 åŸç‚¹ï¼‰         * @param centerZ center of view Z         *         * @param upX up vector X         * @param upY up vector Y    è§‚å¯Ÿè€…å‘ä¸Šçš„ä½ç½®         * @param upZ up vector Z         */        //ç¡®å®šè§‚å¯Ÿçš„ç©ºé—´åæ ‡        GLU.gluLookAt(gl, 0F, 0F, 5F, 0F, 0F, 0F, 0F, 1F, 0F)        //é¡¶ç‚¹æ•°ç»„        val trianglePoint = floatArrayOf(            0F, ratio, 1F,            -1F, -ratio, 1F,            1F, -ratio, 1F        )        //åˆ›å»ºé¡¶ç‚¹ç¼“å†²åŒº        val pointBuffer = ByteBuffer.allocateDirect(trianglePoint.size * 4)        val floatBuffer = TextureUtils.loadVertexBuffer(pointBuffer,trianglePoint)        //è®¾ç½®ç»˜å›¾çš„é¢œè‰²,ä½¿ç”¨çº¢è‰²        gl?.glColor4f(1F,0F,0F,1F)        //æŒ‡å®š3ä¸ªå€¼ç¡®å®šä¸€ä¸ªç‚¹        //Must use a native order direct Buffer        gl?.glVertexPointer(3, GL10.GL_FLOAT, 0, floatBuffer)        //ç”»ä¸€ä¸ªä¸‰è§’        gl?.glDrawArrays(GL10.GL_TRIANGLES,0,3)    }    override fun onSurfaceChanged(gl: GL10?, width: Int, height: Int) {        gl?.apply {            //viewportè§†å£   ä¹Ÿå°±æ˜¯openglå¯ä»¥æ˜¾ç¤ºçš„åŒºåŸŸå¤§å°            glViewport(0, 0, width, height)            //æŠ•å½±çŸ©é˜µ - çŸ©é˜µæ¨¡å¼            glMatrixMode(GL10.GL_PROJECTION)            //åŠ è½½å•ä½çŸ©é˜µ - åˆå§‹åŒ–            glLoadIdentity()            //è®¡ç®—æ¯”ä¾‹ï¼Œé¿å…ç¼©æ”¾åæ˜¾ç¤ºå˜å½¢            ratio = width.toFloat() / height            //è®¾ç½®å¹³æˆªå¤´ä½“ï¼Œä¸ºäº†æŠ•å°„åˆ°viewportä¸Šæ—¶ï¼Œä¸è¶…å‡ºviewportï¼Œtop/bottom æŒ‰ç…§æˆ‘ä»¬viewportçš„æ¯”ä¾‹è®¾ç½®              //æ­¤å¤„,  bottom = -left * ratio    top = left * ratio            //zNear è¿‘å¹³é¢è·ç¦»            //zFar  è¿œå¹³é¢è·ç¦»            glFrustumf(-1F, 1F, -ratio, ratio, 3F, 7F)        }    }    override fun onSurfaceCreated(gl: GL10?, config: EGLConfig?) {        gl?.apply {            //æ¸…å±é¢œè‰²è®¾ç½®            glClearColor(0F, 0F, 0F, 1F)            //å¼€å¯é¡¶ç‚¹ç¼“å†²åŒº            glEnableClientState(GL10.GL_VERTEX_ARRAY)        }    }}</code></pre><p><code>TextureUtils</code>æ˜¯åœ¨æ¸²æŸ“Cameraæ—¶å°±å·²ç»å†™å¥½çš„å·¥å…·äº†ï¼Œä¸é‡å¤å†™äº†ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><h4 id="é¡¶ç‚¹åæ ‡"><a href="#é¡¶ç‚¹åæ ‡" class="headerlink" title="é¡¶ç‚¹åæ ‡"></a>é¡¶ç‚¹åæ ‡</h4><pre><code>val trianglePoint = floatArrayOf(            0F, ratio, 1F,            -1F, -ratio, 1F,            1F, -ratio, 1F        )</code></pre><ul><li><p>x  [-1,1]   æˆ‘ä»¬åœ¨å¹³æˆªå¤´ä½“ä¸­çš„æ¯”ä¾‹ï¼Œæœ€å¤§ä¹Ÿå°±æ˜¯[-1,1]</p></li><li><p>y  [-ratio,ratio]  è¿™é‡Œæˆ‘ä»¬è®¡ç®—äº†å±å¹•çš„æ¯”ä¾‹ï¼Œå¾—å‡ºçš„ratio</p></li><li><p>z  è¿™ä¸ªæŒ‡å®šäº†ï¼Œæˆ‘ä»¬åœ¨å¹³æˆªå¤´ä½“ä¸­çš„zä½ç½®ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„<code>glFrustumf(-1F, 1F, -ratio, ratio, 3F, 7F)</code>ä¸­ï¼Œç”¨è¿œå¹³é¢å‡å»è¿‘å¹³é¢ï¼Œ 7 -3 = 4   [0,4]</p></li></ul><h4 id="å¹³æˆªå¤´ä½“"><a href="#å¹³æˆªå¤´ä½“" class="headerlink" title="å¹³æˆªå¤´ä½“"></a>å¹³æˆªå¤´ä½“</h4><pre><code>glFrustumf(-1F, 1F, -ratio, ratio, 3F, 7F)</code></pre><ul><li>Left / right  åˆ†åˆ«ä¸º -1  1</li><li>bottom = -left * ratio</li><li>top = left * ratio</li><li>zNear è¿‘å¹³é¢è·ç¦»</li><li>zFar  è¿œå¹³é¢è·ç¦»</li></ul><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><pre><code>val trianglePoint = floatArrayOf(            0F, ratio, 1F,            -1F, -ratio, 1F,            1F, -ratio, 1F        )</code></pre><p><img src="/images/opengl_result1_1.png" srcset="/img/loading.gif" alt="opengl_result1_1"></p><pre><code>val trianglePoint = floatArrayOf(            0F, ratio, 2F,            -1F, -ratio, 2F,            1F, -ratio, 2F        )</code></pre><p><img src="/images/opengl_result1_2.png" srcset="/img/loading.gif" alt="opengl_result1_2"></p>]]></content>
    
    
    <categories>
      
      <category>Media</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Media</tag>
      
      <tag>OpenGL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenGLçš„æ¨¡å‹ä»¥åŠæ¸²æŸ“ç®¡çº¿Pipeline</title>
    <link href="undefined2019/11/27/learn-opengl-pipeline/"/>
    <url>2019/11/27/learn-opengl-pipeline/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>OpenGLçš„å­¦ä¹ éš¾åº¦è¿˜æ˜¯å¾ˆå¤§çš„ã€‚</p><p>è¿™é‡Œä¸€ä¸€è®°å½•å­¦ä¹ çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œé¦–å…ˆæˆ‘æƒ³è¦å…ˆç®€å•äº†è§£OpenGLçš„å¤§æ¦‚å·¥ä½œæµç¨‹OpenGL Pipelineï¼Œåé¢ä¼šæ…¢æ…¢çš„å®Œå–„è¿™ä¸ªç¬”è®°ã€‚</p><a id="more"></a><p>æ‰¾åˆ°ä¸€å¼ æ¯”è¾ƒè€çš„å›¾ï¼Œè¿™é‡Œæ˜¯ä»¥opengl1.1çš„æ ‡å‡†æ¥ç”»çš„ï¼Œçœ‹èµ·æ¥æ›´å®¹æ˜“ä¸€äº›ï¼Œæ‰€ä»¥ä¸å¦¨å…ˆçœ‹çœ‹ã€‚</p><p><img src="/images/gl1_pipeline_image.png" srcset="/img/loading.gif" alt="gl1_pipeline_image"></p><h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2><blockquote><p><a href="https://www.khronos.org/opengl/wiki/Rendering_Pipeline_Overview" target="_blank" rel="noopener">https://www.khronos.org/opengl/wiki/Rendering_Pipeline_Overview</a></p></blockquote><p>è¿™å¼ ç®¡çº¿å›¾æ¥è‡ªå®˜æ–¹çš„wiki,å¯ä»¥è¯´æ˜¯æ¯”è¾ƒæƒå¨çš„ã€‚</p><p><img src="/images/opengl_render_pipeline.png" srcset="/img/loading.gif" alt="opengl_render_pipeline"></p><ol><li><p><strong>é¡¶ç‚¹æ•°æ®</strong></p><ul><li><p>VAO(Vertex Array Objects)æ¯ä¸ªé¡¶ç‚¹åŒ…å«çš„ä¿¡æ¯</p></li><li><p>VBO(Vertex Buffer Objects)é¡¶ç‚¹æ•°æ®çš„Buffer</p></li></ul></li><li><p><strong>é¡¶ç‚¹å¤„ç†</strong> â€”OpenGLå°†è°ƒç”¨vertex shaderæ¥å¤„ç†é¡¶ç‚¹</p><ul><li><p>é¡¶ç‚¹çš„å˜æ¢ï¼Œæ¯”å¦‚æŠ•å½±çŸ©é˜µå˜åŒ–</p></li><li><p>å…‰ç…§ï¼Œæœ‰æ—¶è¿˜ä¼šæœ‰å…‰ç…§çš„å¤„ç†</p></li><li><p>é¡¶ç‚¹ç€è‰²å™¨</p></li></ul></li></ol><p>  å¯èƒ½ä¼šæœ‰å¤šä¸ªvertex shaderï¼Œä½†æ¯æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ª</p><ol><li><p><strong>Tesselation Shading</strong>    [å¯é€‰]</p></li><li><p><strong>Geometry Shading</strong>    [å¯é€‰]</p></li><li><p><strong>å›¾å…ƒç»„è£…</strong></p><p>å›¾å…ƒç»„è£…é˜¶æ®µä¼šæŠŠé¡¶ç‚¹ç»„è£…æˆä¸€ç»„ç›¸å…³è”çš„å‡ ä½•å›¾å…ƒ</p></li><li><p><strong>è£å‰ª</strong></p><p>æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„é¡¶ç‚¹ä¼šè·‘åˆ°å¯æ˜¾ç¤ºèŒƒå›´ä¹‹å¤–å»ï¼ŒOpenGLä¼šå¸®æˆ‘ä»¬æŠŠè¿™äº›ä¸å¯æ˜¾ç¤ºçš„éƒ¨åˆ†è£åˆ‡æ‰ï¼Œä»¥æé«˜æ•ˆæœï¼ŒèŠ‚çœèµ„æº</p></li><li><p><strong>æ …æ ¼åŒ–</strong></p><p>è£åˆ‡åçš„å›¾å…ƒç»è¿‡æ …æ ¼åŒ–ï¼Œç”Ÿæˆfragment,å¹¶ä¸”ä¼šå­˜æ”¾åœ¨frameBufferä¸­ï¼Œè¿™äº›æ•°æ®è¿˜å¯ä»¥è¢«ä¸‹é¢çš„ä¸¤éƒ¨è¿›è¡ŒåŠ å·¥å¤„ç†</p></li><li><p><strong>Fragment Shading</strong></p><p>fragment shadingç”¨å‰é¢çš„ä¿¡æ¯æ¥å†³å®šfragmentçš„é¢œè‰²ï¼Œæ˜¯å¦éœ€è¦åœæ­¢ï¼Œä»¥åŠå¯ä»¥å¤„ç†texture mapping.</p></li><li><p><strong>Per-Fragment Operations</strong></p></li></ol><p>ç°åœ¨å¯¹å®ƒä»¬çš„å…·ä½“å«ä¹‰å¹¶ä¸éå¸¸æ¸…æ¥šï¼Œç„¶è€Œæˆ‘ä»¬çŸ¥é“äº†æ•´ä¸ªæ¡†æ¶ï¼Œåé¢çš„å­¦ä¹ è¿‡ç¨‹å°±æ˜¯æ…¢æ…¢å¡«å……ï¼Œä¿®æ”¹è¿™ä¸ªæ¡†æ¶çš„è¿‡ç¨‹ã€‚</p><h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h2><p>OpenGlçš„æ¶æ„ï¼Œä¹Ÿæ˜¯å¾ˆç»å…¸çš„C-Sæ¶æ„ã€‚</p><blockquote><p><a href="https://cloud.tencent.com/developer/news/223343" target="_blank" rel="noopener">https://cloud.tencent.com/developer/news/223343</a></p></blockquote><p><img src="/images/opengl_model_image.jpeg" srcset="/img/loading.gif" alt="opengl_model_image"></p><h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
    
    
    <categories>
      
      <category>Media</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Media</tag>
      
      <tag>OpenGL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MediaExtractorä¸MediaMuxerçš„ç®€å•ä½¿ç”¨</title>
    <link href="undefined2019/11/26/mediaextractor-and-mediamuxer-sample/"/>
    <url>2019/11/26/mediaextractor-and-mediamuxer-sample/</url>
    
    <content type="html"><![CDATA[<p><code>MediaExtractor</code>å¯ä»¥è¯´æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å°è£…äº†ï¼Œæ”¯æŒå¾ˆå¤šè¾“å…¥æ ¼å¼ï¼Œå¯ä»¥å¯¹æˆ‘ä»¬çš„å¤šåª’ä½“æ–‡ä»¶è¿›è¡Œåˆ†è§£ï¼Œå¯ä»¥ç”¨æ¥åˆ†ç¦»å®¹å™¨ä¸­çš„è§†é¢‘trackå’ŒéŸ³é¢‘trackã€‚</p><p><code>MediaMuxer</code>ç”¨äºå°è£…ç¼–ç åçš„è§†é¢‘æµå’ŒéŸ³é¢‘æµã€‚è™½ç„¶æœ‰ä¸€äº›é™åˆ¶æ¡ä»¶ï¼Œä½†æ˜¯å¯¹äºä¸€èˆ¬çš„ä½¿ç”¨è¿˜æ˜¯å¯ä»¥èƒœä»»çš„ã€‚</p><a id="more"></a><h2 id="åˆæ­¥è®¤è¯†"><a href="#åˆæ­¥è®¤è¯†" class="headerlink" title="åˆæ­¥è®¤è¯†"></a>åˆæ­¥è®¤è¯†</h2><h3 id="MediaExtractor"><a href="#MediaExtractor" class="headerlink" title="MediaExtractor"></a>MediaExtractor</h3><blockquote><p><a href="https://developer.android.google.cn/reference/android/media/MediaExtractor?hl=en" target="_blank" rel="noopener">https://developer.android.google.cn/reference/android/media/MediaExtractor?hl=en</a></p></blockquote><p>MediaExtractor facilitates extraction of demuxed, typically encoded, media data from a data source.</p><p>ç®€å•çš„æè¿°å®ƒï¼Œå°±æ˜¯ä¸€ä¸ªè§£å°è£…çš„å·¥å…·ã€‚</p><pre><code class="java"> MediaExtractor extractor = new MediaExtractor(); //è®¾ç½®æ¥æº extractor.setDataSource(...); //è·å–åª’ä½“æ–‡ä»¶çš„trackæ•°é‡ int numTracks = extractor.getTrackCount(); for (int i = 0; i &lt; numTracks; ++i) {   MediaFormat format = extractor.getTrackFormat(i);   String mime = format.getString(MediaFormat.KEY_MIME);   //è·å–åˆ°ä½ æƒ³è¦ä½¿ç”¨çš„Track   if (weAreInterestedInThisTrack) {           //æ ‡è®°è¿™ä¸ªTrack     extractor.selectTrack(i);   } } ByteBuffer inputBuffer = ByteBuffer.allocate(...) while (extractor.readSampleData(inputBuffer, ...) &gt;= 0) {   int trackIndex = extractor.getSampleTrackIndex();   long presentationTimeUs = extractor.getSampleTime();   ...   //ä¸‹ä¸€å¸§   extractor.advance(); } //é‡Šæ”¾ extractor.release(); extractor = null;</code></pre><p>docä¸Šæä¾›äº†ä¸€æ®µæ¯”è¾ƒç®€å•çš„ä½¿ç”¨æ–¹å¼</p><p>å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„<code>setDataSource</code>,<code>MediaFormat</code>,<code>selectTrack</code>,<code>release</code></p><h3 id="MediaMuxer"><a href="#MediaMuxer" class="headerlink" title="MediaMuxer"></a>MediaMuxer</h3><blockquote><p><a href="https://developer.android.google.cn/reference/android/media/MediaMuxer?hl=en" target="_blank" rel="noopener">https://developer.android.google.cn/reference/android/media/MediaMuxer?hl=en</a></p></blockquote><p>MediaMuxer facilitates muxing elementary streams. Currently MediaMuxer supports MP4, Webm and 3GP file as the output. It also supports muxing B-frames in MP4 since Android Nougat.</p><p>æ”¯æŒçš„æ ¼å¼æœ‰MP4ï¼Œè€Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„å°è£…ä¹Ÿå°±æ˜¯MP4å•¦ï¼Œæ¯”è¾ƒé—æ†¾çš„æ˜¯åªèƒ½æ”¯æŒå•ä¸ªçš„Video Track å’Œ Audio Trackã€‚</p><h2 id="åˆ†ç¦»MP4çš„Video-Audio-Track"><a href="#åˆ†ç¦»MP4çš„Video-Audio-Track" class="headerlink" title="åˆ†ç¦»MP4çš„Video/Audio Track"></a>åˆ†ç¦»MP4çš„Video/Audio Track</h2><pre><code class="kotlin">        /**     * @param path åª’ä½“æ–‡ä»¶åœ°å€     *     */    fun extractorMedia(path: String) {        val extractor = MediaExtractor()        //è®¾ç½®æ¥æº        extractor.setDataSource(path)        //è·å–åª’ä½“æ–‡ä»¶çš„trackæ•°é‡        val numTracks = extractor.trackCount        for (index in 0 until numTracks){            val format = extractor.getTrackFormat(index)            //è·å–åˆ°ä½ æƒ³è¦ä½¿ç”¨çš„Track            appendLogs(format.toString())        }    }</code></pre><p>æ˜ç¡®çš„çœ‹åˆ°ï¼Œè¿™ä¸ªMP4ä¸­æœ‰ä¸€æ¡éŸ³é¢‘è½¨ï¼Œä¸€æ¡è§†é¢‘è½¨é“ã€‚</p><pre><code>{        track-id=2,       max-bitrate=129051,       //ç ç‡ã€æ¯”ç‰¹ç‡      sample-rate=44100,        //é‡‡æ ·ç‡      file-format=video/mp4,       mime=audio/mp4a-latm,     //ç±»å‹æ˜¯ audio      bitrate=129051,       language=,       aac-profile=2,       durationUs=95087233,       aac-format-adif=0,                   channel-count=2,                     //å£°é“      max-input-size=65541,       csd-0=java.nio.HeapByteBuffer[pos=0 lim=5 cap=5]}</code></pre><pre><code>{      track-id=1,     file-format=video/mp4,     level=2048,     mime=video/avc,             //ç±»å‹æ˜¯ audio    profile=2,     language=,     display-width=1920,     csd-1=java.nio.HeapByteBuffer[pos=0 lim=8 cap=8],     durationUs=95041666,     display-height=1080,     width=1920,     rotation-degrees=0,     max-input-size=1555201,     frame-rate=24,     height=1080,     csd-0=java.nio.HeapByteBuffer[pos=0 lim=41 cap=41]}</code></pre><p>æˆ‘ä»¬ç»§ç»­ï¼Œä¸‹é¢çš„æ“ä½œæŠŠè¿™ä¸ªMP4åˆ†ç¦»ä¸ºä¸€ä¸ª <code>ouput_video_mp4</code> , ä¸€ä¸ª <code>ouput_audio_mp4</code></p><pre><code class="java">        /**     * @param path åª’ä½“æ–‡ä»¶åœ°å€     *     */    fun extractorMedia(path: String) {        val extractor = MediaExtractor()        //è®¾ç½®æ¥æº        extractor.setDataSource(path)        //è§†é¢‘æ–‡ä»¶        val videoStream = File(OUTPUT_DIR, &quot;output_video_mp4.mp4&quot;).outputStream()        //éŸ³é¢‘æ–‡ä»¶        val audioStream = File(OUTPUT_DIR, &quot;output_audio_mp4&quot;).outputStream()        //è®°å½•éŸ³é¢‘/è§†å±è½¨é“çš„index        var videoTrackIndex = -1        var audioTrackIndex = -1        //è·å–åª’ä½“æ–‡ä»¶çš„trackæ•°é‡        val numTracks = extractor.trackCount        for (index in 0 until numTracks) {            val format = extractor.getTrackFormat(index)            val mimeType = format.getString(MediaFormat.KEY_MIME)            //æ ‡è®°è§†é¢‘è½¨é“            if (mimeType.startsWith(&quot;video/&quot;)) {                videoTrackIndex = index            }            //æ ‡è®°éŸ³é¢‘è½¨é“            if (mimeType.startsWith(&quot;audio/&quot;)) {                audioTrackIndex = index            }            appendLogs(&quot;è§†é¢‘åˆ†ç¦» - ä»»åŠ¡å¼€å§‹&quot;)            // åˆ‡æ¢åˆ°è§†é¢‘            extractor.selectTrack(videoTrackIndex)            readTrackStream(videoStream,extractor)            videoStream.close()            appendLogs(&quot;è§†é¢‘åˆ†ç¦» - ä»»åŠ¡ç»“æŸ&quot;)            appendLogs(&quot;éŸ³é¢‘åˆ†ç¦» - ä»»åŠ¡å¼€å§‹&quot;)            // åˆ‡æ¢åˆ°éŸ³é¢‘            extractor.selectTrack(audioTrackIndex)            readTrackStream(audioStream,extractor)            audioStream.close()            appendLogs(&quot;éŸ³é¢‘åˆ†ç¦» - ä»»åŠ¡ç»“æŸ&quot;)        }        appendLogs(&quot;ä»»åŠ¡ç»“æŸ&quot;)        extractor.release()    }        /**     * è¯»å–æ•°æ®ï¼Œå†™å…¥åˆ°æ–‡ä»¶ä¸­     */    private fun readTrackStream(fileInput: FileOutputStream, extractor: MediaExtractor) {        //Buffer        val byteBuffer = ByteBuffer.allocate(1024 * 500)        var readCount = 0        do {            //è¯»å–æ•°æ®            readCount = extractor.readSampleData(byteBuffer,0)            if (readCount &lt; 0){                break            }            //å†™å…¥æ–‡ä»¶            val buffer = ByteArray(readCount)            byteBuffer.get(buffer)            fileInput.write(buffer)            byteBuffer.clear()            //ç§»åŠ¨åˆ°ä¸‹ä¸€å¸§            extractor.advance()        }while (readCount &gt; 0)        byteBuffer.clear()    }</code></pre><h3 id="å°†éŸ³é¢‘-è§†é¢‘åˆå¹¶ä¸ºMP4"><a href="#å°†éŸ³é¢‘-è§†é¢‘åˆå¹¶ä¸ºMP4" class="headerlink" title="å°†éŸ³é¢‘/è§†é¢‘åˆå¹¶ä¸ºMP4"></a>å°†éŸ³é¢‘/è§†é¢‘åˆå¹¶ä¸ºMP4</h3><pre><code class="java">        /**     * åˆå¹¶éŸ³è§†é¢‘     */    fun muxerMediaStream(path: String){        appendLogs(&quot;ä»»åŠ¡å¼€å§‹&quot;)        val mOutputVideoPath = File(OUTPUT_DIR, &quot;output_mp4_file.mp4&quot;).absolutePath        //æŒ‡å®šè¾“å‡ºç›®å½•ï¼ŒæŒ‡å®šFormatæ ¼å¼        appendLogs(&quot;è¾“å‡ºç›®å½•ï¼š$mOutputVideoPath&quot; )        val mMediaMuxer = MediaMuxer(            mOutputVideoPath,            MediaMuxer.OutputFormat.MUXER_OUTPUT_MPEG_4        )        //è·å–ä¸¤ä¸ªè½¨é“ï¼Œå¹¶ä¸”æ·»åŠ åˆ°mMediaMuxer        val extractor = MediaExtractor()        //è®¾ç½®æ¥æº        extractor.setDataSource(path)        //è®°å½•éŸ³é¢‘/è§†å±è½¨é“çš„index        var videoTrackIndex = -1        var audioTrackIndex = -1        //è·å–åª’ä½“æ–‡ä»¶çš„trackæ•°é‡        val numTracks = extractor.trackCount        for (index in 0 until numTracks) {            val format = extractor.getTrackFormat(index)            val mimeType = format.getString(MediaFormat.KEY_MIME)            //æ ‡è®°è§†é¢‘è½¨é“            if (mimeType.startsWith(&quot;video/&quot;)) {                videoTrackIndex = index                appendLogs(&quot;videoTrackIndex ï¼š$videoTrackIndex&quot; )            }            //æ ‡è®°éŸ³é¢‘è½¨é“            if (mimeType.startsWith(&quot;audio/&quot;)) {                audioTrackIndex = index                appendLogs(&quot;audioTrackIndex ï¼š$audioTrackIndex&quot; )            }        }        //æ·»åŠ Track        mMediaMuxer.addTrack(extractor.getTrackFormat(videoTrackIndex))        mMediaMuxer.addTrack(extractor.getTrackFormat(audioTrackIndex))        //æ·»åŠ å®Œæ¯•å¼€å§‹        mMediaMuxer.start()        //è¯»å–æ•°æ®ï¼Œå¹¶ä¸”å†™å…¥MediaMuxer        //å†™å…¥è§†é¢‘æ–‡ä»¶        readTrackAndMuxer(videoTrackIndex,mMediaMuxer,extractor)        //å†™å…¥éŸ³é¢‘æ–‡ä»¶        readTrackAndMuxer(audioTrackIndex,mMediaMuxer,extractor)        //é‡Šæ”¾MediaExtractor        extractor.release()        //é‡Šæ”¾MediaMuxer        mMediaMuxer.stop();        mMediaMuxer.release();    }    /**     * è¯»å–æ–‡ä»¶ï¼Œå¹¶ä¸”å†™å…¥mMediaMuxer.     */    private fun readTrackAndMuxer(trackIndex: Int,mMediaMuxer: MediaMuxer, extractor: MediaExtractor) {        appendLogs(&quot;readTrackAndMuxer å¼€å§‹å†™å…¥&quot; )        //è¯»å–æ•°æ®        extractor.selectTrack(trackIndex)        val byteBuffer = ByteBuffer.allocate(1024 * 500)        val info: MediaCodec.BufferInfo = MediaCodec.BufferInfo()        info.presentationTimeUs = 0        var readCount = 0        do {            //è¯»å–æ•°æ®            readCount = extractor.readSampleData(byteBuffer,0)            if (readCount &lt; 0){                break            }            //å†™å…¥æ–‡ä»¶            info.offset = 0            info.size = readCount            info.flags = MediaCodec.BUFFER_FLAG_KEY_FRAME            info.presentationTimeUs = extractor.sampleTime            mMediaMuxer.writeSampleData(trackIndex,byteBuffer,info)            byteBuffer.clear()            //ç§»åŠ¨åˆ°ä¸‹ä¸€å¸§            extractor.advance()        }while (readCount &gt; 0)        appendLogs(&quot;readTrackAndMuxer ç»“æŸå†™å…¥&quot; )    }</code></pre><p>ä»£ç çš„é€»è¾‘å·²ç»å¾ˆæ¸…æ™°ã€‚</p><h3 id="END"><a href="#END" class="headerlink" title="END."></a>END.</h3>]]></content>
    
    
    <categories>
      
      <category>Media</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Media</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨Textureviewé¢„è§ˆç›¸æœº</title>
    <link href="undefined2019/11/19/camera-with-textureview/"/>
    <url>2019/11/19/camera-with-textureview/</url>
    
    <content type="html"><![CDATA[<h2 id="æµç¨‹åˆ†æ"><a href="#æµç¨‹åˆ†æ" class="headerlink" title="æµç¨‹åˆ†æ"></a>æµç¨‹åˆ†æ</h2><h4 id="å®ç°æ€è·¯"><a href="#å®ç°æ€è·¯" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h4><p>ä½¿ç”¨TextureViewæ˜¾ç¤ºç›¸æœºçš„é¢„è§ˆï¼Œæ¸²æŸ“ä½¿ç”¨openglå®ç°ï¼Œä»¿ç…§GLSurfaceViewçš„æ–¹å¼æ¥é¢„è§ˆè¿™ä¸ªç›¸æœºã€‚</p><a id="more"></a><p>ç›¸æœº â€”-ç”Ÿäº§â€”&gt;  SurfaceTexture  (OpenGL  + GLThread å¤„ç†) â€”&gt; TextureView(SurfaceTextView)å…³è”çš„GLç¯å¢ƒ</p><p>onSurfaceTextureAvailable(surface)â€”æ˜¾ç¤ºâ€“&gt;  TextureView(SurfaceTextView)å…³è”çš„GLç¯å¢ƒ</p><h4 id="å¤§æ¦‚æµç¨‹"><a href="#å¤§æ¦‚æµç¨‹" class="headerlink" title="å¤§æ¦‚æµç¨‹"></a>å¤§æ¦‚æµç¨‹</h4><ol><li><p>Activity æä¾›ä¸€ä¸ª TextureView</p></li><li><p>åˆå§‹åŒ–ç›¸æœºç¡¬ä»¶ï¼ˆæƒé™/Camera1/2ï¼‰ï¼Œå‡†å¤‡å¼€å§‹é¢„è§ˆ</p></li><li><p>æ·»åŠ TextureView <code>setSurfaceTextureListener</code></p></li><li><p>setSurfaceTextureListener</p><ol><li><p>åŠ è½½loadOESTexture</p></li><li><p>åˆ›å»ºRenderer Thread</p></li><li><p>initEGLContext   ä½¿ç”¨TextureViewä¸­çš„surfaceTexture  </p></li><li><p>åˆ›å»ºä¸€ä¸ªTextureEGLRendererç”¨äºé¢„è§ˆ</p><blockquote><p> å®ŒæˆGLç¯å¢ƒçš„å»ºç«‹</p></blockquote></li><li><p>åˆ›å»ºä¸€ä¸ªSurfaceTexture(mOESTextureId) ,ç”¨äºç›¸æœºçš„é¢„è§ˆ</p></li><li><p>å¼€å¯é¢„è§ˆ</p></li></ol></li><li><p>setPreviewTexture(surfaceTexture)  -&gt;  åˆ›å»ºçš„surfaceTexture -&gt; setOnFrameAvailableListener</p></li></ol><h4 id="TextureView"><a href="#TextureView" class="headerlink" title="TextureView"></a>TextureView</h4><p>å‡ ä¸ªå¸¸ç”¨çš„<code>SurfaceView</code>ï¼Œ<code>SurfaceTexture</code>  ,<code>GlSurfaceView</code>ä¸­</p><p><code>TextureView</code>æ˜¯å”¯ä¸€ä¸€ä¸ªå¯ä»¥å½“åšViewä½¿ç”¨ï¼Œæ”¯æŒåŠ¨ç”»æ•ˆæœï¼Œåœ¨5.0å‰åœ¨ä¸»çº¿ç¨‹æ¸²æŸ“ï¼Œåœ¨5.0ååœ¨å•ç‹¬çº¿ç¨‹æ¸²æŸ“</p><p>ä½†æ˜¯å®ƒçš„æ€§èƒ½æ²¡æœ‰å…¶ä»–å‡ ä¸ªå¥½ï¼Œè€—è´¹çš„å†…å­˜ä¹Ÿæ¯”è¾ƒå¤§ï¼Œå¸¸ç”¨åœ¨Listä¸­ï¼Œè€Œä¸”å¿…é¡»è¦åœ¨ç¡¬ä»¶</p><table><thead><tr><th></th><th>TextureView</th><th>SurfaceView</th></tr></thead><tbody><tr><td>ç»˜åˆ¶</td><td>1-3å¸§å»¶è¿Ÿ</td><td>ä½</td></tr><tr><td>å†…å­˜</td><td>é«˜</td><td>ä½</td></tr><tr><td>åŠ¨ç”»å’Œæˆªå›¾</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>è€—ç”µ</td><td>é«˜</td><td>ä½</td></tr></tbody></table><blockquote><p>ä»¥ä¸Šæ˜¯ç½‘ç»œä¸Šçš„èµ„æ–™å›¾è¡¨</p></blockquote><h2 id="ç¼–ç åˆ†æ"><a href="#ç¼–ç åˆ†æ" class="headerlink" title="ç¼–ç åˆ†æ"></a>ç¼–ç åˆ†æ</h2><h5 id="CameraActivity"><a href="#CameraActivity" class="headerlink" title="CameraActivity"></a>CameraActivity</h5><p>ç”¨äºæ‰¿è½½è¿™ä¸ªDemo,å…¶ä¸­æ ¹å¸ƒå±€åªæœ‰ä¸€ä¸ªTextureView</p><h5 id="CameraOpenHelper"><a href="#CameraOpenHelper" class="headerlink" title="CameraOpenHelper"></a>CameraOpenHelper</h5><p>ç›¸æœºçš„å¸®åŠ©ç±»ï¼Œç”¨äºæ‰“å¼€Cameraä»¥åŠå¤„ç†Cameraä¸TextureViewçš„å…³è”</p><h5 id="ITextureRenderer"><a href="#ITextureRenderer" class="headerlink" title="ITextureRenderer"></a>ITextureRenderer</h5><h5 id="TextureEGLRenderer"><a href="#TextureEGLRenderer" class="headerlink" title="TextureEGLRenderer"></a>TextureEGLRenderer</h5><pre><code>fun onSurfaceCreated()  //åŠ è½½GLçš„ä¸€äº›ä¸œè¥¿ï¼Œopenglçš„ç¨‹åºï¼Œç€è‰²å™¨fun onSurfaceChanged(width: Int, height: Int)fun onDrawFrame(surfaceTexture: SurfaceTexture?)   //æ¸²æŸ“</code></pre><h5 id="TextureEGLHelper"><a href="#TextureEGLHelper" class="headerlink" title="TextureEGLHelper"></a>TextureEGLHelper</h5><p><code>class TextureEGLHelper : SurfaceTexture.OnFrameAvailableListener</code></p><ul><li>æä¾› SurfaceTexture ç»™Camera</li><li>initEGLContext</li><li>HandlerThread  åˆå§‹åŒ–/æ¸²æŸ“</li></ul><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><h4 id="CameraActivity-1"><a href="#CameraActivity-1" class="headerlink" title="CameraActivity"></a>CameraActivity</h4><p><code>com.wangzhumo.app.module.media.opengl.camera.CameraActivity</code></p><pre><code>    @SuppressLint(&quot;RestrictedApi&quot;)    override fun initViews(savedInstanceState: Bundle?) {        super.initViews(savedInstanceState)        val cameraOpenHelper = CameraOpenHelper(this)        cameraOpenHelper.bindCameraUseCases(viewFinder)    }</code></pre><p>è¿™ä¸ª<code>CameraActivity</code>å¾ˆç®€å•ï¼Œåªæœ‰xmlé‡Œä¹Ÿåªæœ‰ä¸€ä¸ª<code>TextureView</code></p><h4 id="CameraOpenHelper-1"><a href="#CameraOpenHelper-1" class="headerlink" title="CameraOpenHelper"></a>CameraOpenHelper</h4><p><code>com.wangzhumo.app.module.media.opengl.camera.CameraOpenHelper</code></p><pre><code>class CameraOpenHelper constructor(private val lifeOwner: FragmentActivity) :    TextureView.SurfaceTextureListener{    private var textureEGLHelper: TextureEGLHelper? = null    private var viewFinder : TextureView? = null    private var mCamera: ICamera? = null    private var mCameraId = 0    fun bindCameraUseCases(textureView: TextureView) {        this.viewFinder = textureView        this.textureEGLHelper = TextureEGLHelper()        textureView.surfaceTextureListener = this    }    override fun onSurfaceTextureSizeChanged(surface: SurfaceTexture?, width: Int, height: Int) {        textureEGLHelper?.onSurfaceChanged(width, height)    }    override fun onSurfaceTextureUpdated(surface: SurfaceTexture?) {}    override fun onSurfaceTextureDestroyed(surface: SurfaceTexture?): Boolean {        onDestroy()        return false    }    override fun onSurfaceTextureAvailable(surface: SurfaceTexture?, width: Int, height: Int) {        //å½“å¤–éƒ¨çš„TextureViewå¯ç”¨ä¹‹åï¼Œå¼€å¯æ‘„åƒå¤´ï¼Œæ‰“å¼€æ¸²æŸ“çº¿ç¨‹        val textureId = TextureUtils.loadOESTexture()        textureEGLHelper?.initEGL(viewFinder,textureId)        //é€šè¿‡ä¼ é€’çš„textureId,æ„å»ºä¸€ä¸ªSurfaceTextureï¼Œç”¨äºç›¸æœºçš„é¢„è§ˆ        val surfaceTexture = textureEGLHelper?.loadOESTexture()        //ä¸ä½¿ç”¨è‡ªå·±çš„SurfaceViewï¼Œå¦å¤–æ„å»ºä¸€ä¸ªSurfaceViewæ¥æ¥æ”¶Cameraçš„é¢„è§ˆæ•°æ®        //å‰ç½®æ‘„åƒå¤´        mCameraId = Camera.CameraInfo.CAMERA_FACING_FRONT        mCamera = CameraV1(lifeOwner)        mCamera?.apply {            openCamera(mCameraId)            setPreviewTexture(surfaceTexture)            enablePreview(true)        }    }</code></pre><h4 id="ITextureRenderer-1"><a href="#ITextureRenderer-1" class="headerlink" title="ITextureRenderer"></a>ITextureRenderer</h4><h4 id="TextureEGLRenderer-1"><a href="#TextureEGLRenderer-1" class="headerlink" title="TextureEGLRenderer"></a>TextureEGLRenderer</h4><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2019-11-22  21:31 * * æ¸²æŸ“å®ç° */class TextureEGLRenderer constructor(val textureId: Int) : ITextureRenderer {    /**     * ç¨‹åº     */    private var mShaderProgram = -1    private var mOESTextureId = -1    private var mVertexBuffer: FloatBuffer    /**     * å˜æ¢çŸ©é˜µ     */    private val transformMatrix = FloatArray(16)    private var aPositionLocation = -1    private var aTextureCoordLocation = -1    private var uTextureMatrixLocation = -1    private var uTextureSamplerLocation = -1    init {        mVertexBuffer = TextureUtils.loadVertexBuffer(VERTEX_DATA)        mOESTextureId = textureId    }    override fun onSurfaceCreated() {        //åŠ è½½GLçš„ä¸€äº›ä¸œè¥¿        val vertexShader = ShaderUtils.compileVertexShader(RawUtils.readResource(R.raw.vertex_texture_shader))        val fragmentShader = ShaderUtils.compileFragmentShader(RawUtils.readResource(R.raw.fragment_texture_shader))        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLRenderer&quot;,&quot;onSurfaceCreated&quot;,56,&quot;vertexShader = $vertexShader , fragmentShader = $fragmentShader&quot;)        mShaderProgram = ShaderUtils.linkProgram(vertexShader, fragmentShader)        aPositionLocation = GLES30.glGetAttribLocation(mShaderProgram, POSITION_ATTRIBUTE)        aTextureCoordLocation = GLES30.glGetAttribLocation(mShaderProgram, TEXTURE_COORD_ATTRIBUTE)        uTextureMatrixLocation = GLES30.glGetUniformLocation(mShaderProgram, TEXTURE_MATRIX_UNIFORM)        uTextureSamplerLocation = GLES30.glGetUniformLocation(mShaderProgram, TEXTURE_SAMPLER_UNIFORM)        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLRenderer&quot;,&quot;onSurfaceCreated&quot;,63,            &quot;mShaderProgram = $mShaderProgram , aPositionLocation = $aPositionLocation , aTextureCoordLocation = $aTextureCoordLocation , uTextureMatrixLocation = $uTextureSamplerLocation , uTextureSamplerLocation = $uTextureSamplerLocation&quot;)    }    override fun onSurfaceChanged(width: Int, height: Int) {        GLES30.glViewport(0, 0, width, height)    }    override fun onDrawFrame(surfaceTexture: SurfaceTexture?) {        GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT)        GLES30.glUseProgram(mShaderProgram)  //å¼€å§‹ä½¿ç”¨ç¨‹åº        surfaceTexture?.updateTexImage()        surfaceTexture?.getTransformMatrix(transformMatrix)        GLES30.glActiveTexture(GLES30.GL_TEXTURE0)        GLES30.glBindTexture(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, mOESTextureId)        GLES30.glUniform1i(uTextureSamplerLocation, 0)        GLES30.glUniformMatrix4fv(            uTextureMatrixLocation,            1,            false,            transformMatrix,            0        )        mVertexBuffer.position(0)        GLES30.glEnableVertexAttribArray(aPositionLocation)        GLES30.glVertexAttribPointer(            aPositionLocation,            2,            GLES30.GL_FLOAT,            false,            STRIDE,            mVertexBuffer        )        mVertexBuffer.position(2)        GLES30.glEnableVertexAttribArray(aTextureCoordLocation)        GLES30.glVertexAttribPointer(            aTextureCoordLocation,            2,            GLES30.GL_FLOAT,            false,            STRIDE,            mVertexBuffer        )        GLES30.glDrawArrays(GLES30.GL_TRIANGLES, 0, 6)    }    companion object {        private const val TAG = &quot;TextureEGLRenderer&quot;        private const val POSITION_ATTRIBUTE = &quot;aPosition&quot;        private const val TEXTURE_COORD_ATTRIBUTE = &quot;aTextureCoord&quot;        private const val TEXTURE_MATRIX_UNIFORM = &quot;uTextureMatrix&quot;        private const val TEXTURE_SAMPLER_UNIFORM = &quot;uTextureSampler&quot;        private const val POSITION_SIZE = 2        private const val TEXTURE_SIZE = 2        private const val STRIDE = (POSITION_SIZE + TEXTURE_SIZE) * 4        /**         * é¡¶ç‚¹æ•°ç»„         */        private val VERTEX_DATA = floatArrayOf(            1.0f, 1.0f, 1.0f, 1.0f,            -1.0f, 1.0f, 0.0f, 1.0f,            -1.0f, -1f, 0.0f, 0.0f,            1.0f, 1.0f, 1.0f, 1.0f,            -1.0f, -1.0f, 0f, 0.0f,            1.0f, -1.0f, 1.0f, 0.0f        )    }}</code></pre><p>è¿™ä¸ª<code>TextureEGLRenderer</code>ä¸­çš„GLæ¸²æŸ“ï¼Œå¤§éƒ¨åˆ†å†…å®¹ä¸æ˜¯å¾ˆç†Ÿï¼Œæ‰€ä»¥ä¸åšå¤ªå¤šçš„è§£è¯»ï¼Œå½“å§‘ä¸”å…ˆå½“åšå›ºå®šçš„ç”¨æ³•ï¼Œå…ˆå¼€å§‹ä½¿ç”¨</p><h4 id="TextureEGLHelper-1"><a href="#TextureEGLHelper-1" class="headerlink" title="TextureEGLHelper"></a>TextureEGLHelper</h4><p><code>com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper</code></p><pre><code>class TextureEGLHelper : SurfaceTexture.OnFrameAvailableListener {    /**     * æ¸²æŸ“/åˆå§‹åŒ– çº¿ç¨‹     */    private var mHandlerThread: HandlerThread? = null    /**     * æ¸²æŸ“å™¨     */    private var mRenderer: ITextureRenderer? = null    /**     * mHandlerThread å†…éƒ¨çš„Handler     */    private var mHandler: Handler? = null    /**     * æœ€ç»ˆæ˜¾ç¤ºçš„TextureView     */    private var mTextureView: TextureView? = null    /**     * çº¹ç†ID     */    private var mOESTextureId = 0    /**     * æ˜¾ç¤ºè®¾å¤‡     */    private var mEGLDisplay = EGL14.EGL_NO_DISPLAY    /**     * EGLä¸Šä¸‹æ–‡     */    private var mEGLContext = EGL14.EGL_NO_CONTEXT    /**     * EGLç»˜å›¾surface     */    private var mEglSurface: EGLSurface? = null    /**     * è‡ªå®šä¹‰çš„SurfaceTexture - å®é™…ä¸Šæ¥æ”¶Cameraä¸Šçš„æ•°æ®     */    private var mOESSurfaceTexture: SurfaceTexture? = null    /**     * @param textureView  å¤–éƒ¨çš„TextureView     * @param textureId    æä¾›çš„TextureID     */    fun initEGL(textureView: TextureView?, textureId: Int) {        mTextureView = textureView        mOESTextureId = textureId        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGL&quot;,84,&quot;initEGL HandlerThread åˆ›å»º&quot;)        mHandlerThread = HandlerThread(&quot;Renderer Thread&quot;)        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGL&quot;,85,&quot;initEGL HandlerThread å¼€å§‹è¿è¡Œ&quot;)        mHandlerThread?.start()        //æ­¤å¤„çš„Handlerï¼Œç”¨äºå¤„ç†å„ç§å‘é€è¿‡æ¥çš„å‘½ä»¤        mHandler = object : Handler(mHandlerThread?.looper) {            override fun handleMessage(msg: Message) {                when (msg.what) {                    MSG_INIT -&gt; {                        //initEGLContext                        initEGLContext()   //åˆå§‹åŒ–EGLç¯å¢ƒ                        initEGLRenderer()   //åˆå§‹åŒ–æ¸²æŸ“å™¨                        //åˆå§‹åŒ– Renderer.                    }                    MSG_RENDER -&gt; {                        //å¼€å§‹æ¸²æŸ“ï¼ŒonFrameAvailableä¸­å‘é€ï¼Œç”±mHandlerThreadè´Ÿè´£æ¸²æŸ“çš„è°ƒç”¨ã€‚                        drawFrame()                    }                    MSG_DESTROY -&gt; {                        //mHandlerThread å…³é—­                        //åœæ­¢mHandler                        //é”€æ¯èµ„æº                    }                    else -&gt; return                }            }        }        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGL&quot;,113,&quot;initEGL HandlerThread å¼€å§‹è¿è¡Œ -- sendEmptyMessage(MSG_INIT)&quot;)        mHandler?.sendEmptyMessage(MSG_INIT)    }    /**     * åˆå§‹åŒ–EGLContext     */    private fun initEGLContext() {        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGLContext&quot;,122,&quot;initEGL initEGLContext start&quot;)        mEGLDisplay = EGL14.eglGetDisplay(EGL14.EGL_DEFAULT_DISPLAY)        //éœ€åˆ¤æ–­æ˜¯å¦æˆåŠŸè·å–EGLDisplay        if (mEGLDisplay == EGL14.EGL_NO_DISPLAY) {            throw  RuntimeException(&quot;Unable to get EGL14 display&quot;)        }        val versions = IntArray(2)        versions[0] = 3        if (!EGL14.eglInitialize(mEGLDisplay, versions, 0, versions, 1)) {            throw RuntimeException(&quot;eglInitialize failed! &quot; + EGL14.eglGetError())        }        //eglçš„ä¸€äº›é…ç½®        val eglConfigAttribute = intArrayOf(            EGL14.EGL_BUFFER_SIZE, 32,            EGL14.EGL_RED_SIZE, 8,            EGL14.EGL_GREEN_SIZE, 8,            EGL14.EGL_BLUE_SIZE, 8,            EGL14.EGL_ALPHA_SIZE, 8,            EGL14.EGL_RENDERABLE_TYPE, 4,            EGL14.EGL_SURFACE_TYPE, EGL14.EGL_WINDOW_BIT,            EGL14.EGL_NONE        )        val numConfig = IntArray(1)        val eglConfig = arrayOfNulls&lt;EGLConfig&gt;(1)        //EGLé…ç½®        val eglChooseFlag = EGL14.eglChooseConfig(            mEGLDisplay,            eglConfigAttribute,            0,            eglConfig,            0,            eglConfig.size,            numConfig,            0        )        if (!eglChooseFlag) {            throw RuntimeException(&quot;eglChooseConfig failed! &quot; + EGL14.eglGetError())        }        //åˆ›å»ºEGLæ˜¾ç¤ºçš„çª—å£        val surfaceAttribute = intArrayOf(            EGL14.EGL_NONE        )        val surfaceTexture = mTextureView?.surfaceTexture        if (surfaceTexture == null) {            throw RuntimeException(&quot;surfaceTexture is null&quot;)        }        mEglSurface = EGL14.eglCreateWindowSurface(            mEGLDisplay,            eglConfig[0],            mTextureView?.surfaceTexture,            surfaceAttribute, 0        )        //åˆ›å»ºä¸Šä¸‹æ–‡        val ctxAttribute = intArrayOf(            EGL14.EGL_CONTEXT_CLIENT_VERSION,            3,            EGL14.EGL_NONE        )        mEGLContext = EGL14.eglCreateContext(            mEGLDisplay,            eglConfig[0],            EGL14.EGL_NO_CONTEXT,            ctxAttribute, 0        )        //æ ¡éªŒ1        if (mEGLDisplay === EGL14.EGL_NO_DISPLAY || mEGLContext === EGL14.EGL_NO_CONTEXT) {            throw RuntimeException(&quot;eglCreateContext fail failed! &quot; + EGL14.eglGetError())        }        //æ ¡éªŒ2        val makeFlag = EGL14.eglMakeCurrent(mEGLDisplay, mEglSurface, mEglSurface, mEGLContext)        if (!makeFlag) {            throw RuntimeException(&quot;eglMakeCurrent failed! &quot; + EGL14.eglGetError())        }        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGLContext&quot;,191,&quot;initEGL initEGLContext end&quot;)    }    /**     * åˆå§‹åŒ–Renderer     */    private fun initEGLRenderer() {        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;initEGLRenderer&quot;,220,&quot;initEGLRenderer  åˆ›å»º TextureEGLRenderer&quot;)        mRenderer = TextureEGLRenderer(mOESTextureId)        mRenderer?.onSurfaceCreated()    }    /**     * åˆ›å»ºå¯ä»¥æ”¾åœ¨å¤–éƒ¨ï¼Œä½†æ˜¯ä¸ºäº†åŠ å…¥ç›‘å¬æ–¹ä¾¿ï¼Œå°±æ”¾åœ¨è¿™é‡Œåˆå§‹åŒ–     */    fun loadOESTexture(): SurfaceTexture? {        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;loadOESTexture&quot;,198,&quot;loadOESTexture æä¾›SurfaceTexture&quot;)        mOESSurfaceTexture = SurfaceTexture(mOESTextureId)        mOESSurfaceTexture?.setOnFrameAvailableListener(this)        Log.d(TAG,&quot;com.wangzhumo.app.module.media.opengl.camera.TextureEGLHelper&quot;,&quot;loadOESTexture&quot;,200,&quot;loadOESTexture æ·»åŠ setOnFrameAvailableListener&quot;)        return mOESSurfaceTexture    }    /*     * setOnFrameAvailableListener   ç»™ loadOESTexture æä¾›çš„SurfaceTextureä½¿ç”¨     */    override fun onFrameAvailable(surfaceTexture: SurfaceTexture?) {        //frameå¯ç”¨ä¹‹åï¼Œå¼€å§‹æ¸²æŸ“        if (mHandler != null) {            //ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œéœ€è¦åœ¨mHandlerThreadä¸­å»æ¸²æŸ“            mHandler?.sendEmptyMessage(MSG_RENDER)        }    }    /**     * å®é™…ä¸Šæ¸²æŸ“ç”»é¢çš„æ–¹æ³•     */    private fun drawFrame() {        if (mRenderer != null) {            EGL14.eglMakeCurrent(mEGLDisplay, mEglSurface, mEglSurface, mEGLContext)            mRenderer?.onDrawFrame(mOESSurfaceTexture)            EGL14.eglSwapBuffers(mEGLDisplay, mEglSurface)        }    }    /**     * onSurfaceChanged å›è°ƒ     */    fun onSurfaceChanged(width: Int, height: Int) {        mRenderer?.onSurfaceChanged(width, height)    }    /**     * é‡Šæ”¾èµ„æº     */    fun onDestroy() {        mHandler?.removeCallbacksAndMessages(null)        mHandlerThread?.quitSafely()    }    companion object {        var MSG_INIT = 100        var MSG_RENDER = 200        var MSG_DESTROY = 300        const val TAG = &quot;TextureEGLHelper&quot;    }}</code></pre><h3 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" class="headerlink" title="å·¥å…·ç±»"></a>å·¥å…·ç±»</h3><h4 id="TextureUtils"><a href="#TextureUtils" class="headerlink" title="TextureUtils"></a>TextureUtils</h4><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2019-08-23$  23:31$ */object TextureUtils {    /**     * åŠ è½½OES Texture     *     * @return     */    @JvmStatic    fun loadOESTexture(): Int {        val textureIds = IntArray(1)        //textureIds ä¸­å­˜æ”¾ä¸€ä¸ªtexturesä¸­çš„å¯ç”¨å€¼        GLES20.glGenTextures(1, textureIds, 0)        //å½“è°ƒç”¨glBindTexture        //å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨è¿™ä¸ªå‡½æ•°textureIds[0] ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¹ç†å¯¹è±¡        //å¦‚æœtextureIds[0]å·²ç»åˆ›å»ºè¿‡äº†ï¼ŒæŠŠè¿™ä¸ªçº¹ç†ç½®ä¸º æ´»åŠ¨        //å¦‚æœtextureä¸º0ï¼Œå°±åœæ­¢ä½¿ç”¨è¿™ä¸ªçº¹ç†å¯¹è±¡ï¼Œå¹¶è¿”å›æ— åç§°çš„é»˜è®¤çº¹ç†        GLES20.glBindTexture(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, textureIds[0])        //è®¾ç½®å‚æ•°        GLES20.glTexParameterf(            GLES11Ext.GL_TEXTURE_EXTERNAL_OES,            GLES20.GL_TEXTURE_MIN_FILTER,            GLES20.GL_NEAREST.toFloat()        )        GLES20.glTexParameterf(            GLES11Ext.GL_TEXTURE_EXTERNAL_OES,            GLES20.GL_TEXTURE_MAG_FILTER,            GLES20.GL_LINEAR.toFloat()        )        GLES20.glTexParameterf(            GLES11Ext.GL_TEXTURE_EXTERNAL_OES,            GLES20.GL_TEXTURE_WRAP_S,            GLES20.GL_CLAMP_TO_EDGE.toFloat()        )        GLES20.glTexParameterf(            GLES11Ext.GL_TEXTURE_EXTERNAL_OES,            GLES20.GL_TEXTURE_WRAP_T,            GLES20.GL_CLAMP_TO_EDGE.toFloat()        )        //å–æ¶ˆç»‘å®šçº¹ç†ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªé»˜è®¤çš„çº¹ç†        GLES20.glBindTexture(GLES11Ext.GL_TEXTURE_EXTERNAL_OES, 0)        return textureIds[0]    }    /**     * åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹Buffer     */    fun loadVertexBuffer(vertexData: FloatArray): FloatBuffer {        val buffer = ByteBuffer.allocateDirect(vertexData.size * 4)            .order(ByteOrder.nativeOrder())            .asFloatBuffer()        buffer.put(vertexData, 0, vertexData.size).position(0)        return buffer    }    /**     * åˆ›å»ºä¸€ä¸ªæ–°çš„SurfaceTexture     */    fun loadOESTexture(mOESTextureId: Int): SurfaceTexture {        return SurfaceTexture(mOESTextureId)    }}</code></pre><h4 id="ShaderUtils"><a href="#ShaderUtils" class="headerlink" title="ShaderUtils"></a>ShaderUtils</h4><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2019-09-28  16:16 */object ShaderUtils {    /**     * ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨     *     * @param shaderCode     * @return     */    @JvmStatic    fun compileVertexShader(shaderCode: String): Int {        return compileShader(GLES30.GL_VERTEX_SHADER, shaderCode)    }    /**     * ç¼–è¯‘ç‰‡æ®µç€è‰²å™¨     *     * @param shaderCode     * @return     */    @JvmStatic    fun compileFragmentShader(shaderCode: String): Int {        return compileShader(GLES30.GL_FRAGMENT_SHADER, shaderCode)    }    /**     * ç¼–è¯‘     *     * @param type       é¡¶ç‚¹ç€è‰²å™¨:GLES30.GL_VERTEX_SHADER     * ç‰‡æ®µç€è‰²å™¨:GLES30.GL_FRAGMENT_SHADER     * @param shaderCode     * @return     */    @JvmStatic    private fun compileShader(type: Int, shaderCode: String): Int {        //åˆ›å»ºä¸€ä¸ªç€è‰²å™¨        val shaderId = GLES30.glCreateShader(type)        if (shaderId != 0) {            GLES30.glShaderSource(shaderId, shaderCode)            GLES30.glCompileShader(shaderId)            //æ£€æµ‹çŠ¶æ€            val compileStatus = IntArray(1)            GLES30.glGetShaderiv(shaderId, GLES30.GL_COMPILE_STATUS, compileStatus, 0)            if (compileStatus[0] == 0) {                val logInfo = GLES30.glGetShaderInfoLog(shaderId)                System.err.println(logInfo)                //åˆ›å»ºå¤±è´¥                GLES30.glDeleteShader(shaderId)                return 0            }            return shaderId        } else {            //åˆ›å»ºå¤±è´¥            return 0        }    }    /**     * é“¾æ¥å°ç¨‹åº     *     * @param vertexShaderId   é¡¶ç‚¹ç€è‰²å™¨     * @param fragmentShaderId ç‰‡æ®µç€è‰²å™¨     * @return     */    @JvmStatic    fun linkProgram(vertexShaderId: Int, fragmentShaderId: Int): Int {        val programId = GLES30.glCreateProgram()        if (programId != 0) {            //å°†é¡¶ç‚¹ç€è‰²å™¨åŠ å…¥åˆ°ç¨‹åº            GLES30.glAttachShader(programId, vertexShaderId)            //å°†ç‰‡å…ƒç€è‰²å™¨åŠ å…¥åˆ°ç¨‹åºä¸­            GLES30.glAttachShader(programId, fragmentShaderId)            //é“¾æ¥ç€è‰²å™¨ç¨‹åº            GLES30.glLinkProgram(programId)            val linkStatus = IntArray(1)            GLES30.glGetProgramiv(programId, GLES30.GL_LINK_STATUS, linkStatus, 0)            if (linkStatus[0] == 0) {                val logInfo = GLES30.glGetProgramInfoLog(programId)                System.err.println(logInfo)                GLES30.glDeleteProgram(programId)                return 0            }            return programId        } else {            //åˆ›å»ºå¤±è´¥            return 0        }    }    /**     * éªŒè¯ç¨‹åºç‰‡æ®µæ˜¯å¦æœ‰æ•ˆ     *     * @param programObjectId     * @return     */    @JvmStatic    fun validProgram(programObjectId: Int): Boolean {        GLES30.glValidateProgram(programObjectId)        val programStatus = IntArray(1)        GLES30.glGetProgramiv(programObjectId, GLES30.GL_VALIDATE_STATUS, programStatus, 0)        return programStatus[0] != 0    }}</code></pre><h3 id="è¾“å‡ºæ—¥å¿—"><a href="#è¾“å‡ºæ—¥å¿—" class="headerlink" title="è¾“å‡ºæ—¥å¿—"></a>è¾“å‡ºæ—¥å¿—</h3><p>CameraActivity onCreated &lt;&lt;&lt;</p><p>CameraActivity, createTextureView, 69]:åˆ›å»ºå¸®åŠ©ç±» CameraOpenHelper()</p><p>CameraActivity, createTextureView, 71]:ç»‘å®šTextureView  bindCameraUseCasesï¼ˆtextureViewï¼‰</p><p>CameraOpenHelper, bindCameraUseCases, 39]:åˆ›å»ºEGLHelper TextureEGLHelperï¼ˆï¼‰</p><p>CameraOpenHelper, bindCameraUseCases, 36]:æ·»åŠ  surfaceTextureListener</p><p>CameraActivity onResumed &lt;&lt;&lt;</p><p>CameraOpenHelper, onSurfaceTextureAvailable, 85]:onSurfaceTextureAvailable  loadOESTexture = 0</p><p>TextureEGLHelper, initEGL, 84]:initEGL HandlerThread åˆ›å»º</p><p>TextureEGLHelper, initEGL, 85]:initEGL HandlerThread å¼€å§‹è¿è¡Œ</p><p>TextureEGLHelper, initEGL, 113]:initEGL HandlerThread å¼€å§‹è¿è¡Œ â€“ sendEmptyMessage(MSG_INIT)</p><p>TextureEGLHelper, loadOESTexture, 198]:loadOESTexture æä¾›SurfaceTexture</p><p>TextureEGLHelper, loadOESTexture, 200]:loadOESTexture æ·»åŠ setOnFrameAvailableListener</p><p>TextureEGLHelper, initEGLContext, 122]:initEGL initEGLContext start</p><p>TextureEGLHelper, initEGLContext, 191]:initEGL initEGLContext end</p><p>TextureEGLHelper, initEGLRenderer, 220]:initEGLRenderer  åˆ›å»º TextureEGLRenderer</p><p>TextureEGLRenderer, init, 49]:mOESTextureId = 0 , mVertexBuffer = 24</p><p>TextureEGLRenderer, onSurfaceCreated, 63]:mShaderProgram = 3 , aPositionLocation = 0 , aTextureCoordLocation = 1 , uTextureMatrixLocation = 1 , uTextureSamplerLocation = 1</p><p>CameraOpenHelper, onSurfaceTextureAvailable, 95]:onSurfaceTextureAvailable  enablePreview  å¼€å¯æ‘„åƒå¤´</p><p><img src="/Users/wangzhumo/Develop/hexo/source/images/camera_texture_img.png" srcset="/img/loading.gif" alt="æ•ˆæœå›¾"></p>]]></content>
    
    
    <categories>
      
      <category>Media</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Media</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ubuntuå®‰è£…coturnæœåŠ¡</title>
    <link href="undefined2019/11/06/coturn-install-ubuntu/"/>
    <url>2019/11/06/coturn-install-ubuntu/</url>
    
    <content type="html"><![CDATA[<h2 id="coturn-project"><a href="#coturn-project" class="headerlink" title="coturn project"></a>coturn project</h2><p>This project evolved from rfc5766-turn-server project (<a href="https://code.google.com/p/rfc5766-turn-server/" target="_blank" rel="noopener">https://code.google.com/p/rfc5766-turn-server/</a>).</p><p>è¿™æ˜¯ä¸€ä¸ªç©¿é€æœåŠ¡ï¼Œä¸ºwebrtcçš„é“¾æ¥åšæœåŠ¡,æŒ‰ç…§rfc5766-turn-serverå®ç°ã€‚</p><a id="more"></a><p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://github.com/coturn/coturn" target="_blank" rel="noopener">https://github.com/coturn/coturn</a></p><p><strong>å®‰è£…Wiki</strong>: <a href="https://github.com/coturn/coturn/wiki/CoturnConfig" target="_blank" rel="noopener">https://github.com/coturn/coturn/wiki/CoturnConfig</a></p><h2 id="ä¾èµ–åº“Third-party-libraries"><a href="#ä¾èµ–åº“Third-party-libraries" class="headerlink" title="ä¾èµ–åº“Third-party libraries"></a>ä¾èµ–åº“Third-party libraries</h2><h3 id="libevent"><a href="#libevent" class="headerlink" title="libevent"></a>libevent</h3><pre><code>$ wget https://github.com/downloads/libevent/libevent/libevent-2.0.21-stable.tar.gz# éœ€è¦soduæƒé™$ tar xvfz libevent-2.0.21-stable.tar.gz$ cd libevent-2.0.21-stable$ ./configure$ make$ make install</code></pre><p>å®‰è£…å®Œæ¯• <code>/usr/local/lib</code></p><h2 id="coturn-install"><a href="#coturn-install" class="headerlink" title="coturn install"></a>coturn install</h2><p><strong>ä¸‹è½½åœ°å€</strong>ï¼š<a href="https://github.com/coturn/coturn/wiki/Downloads" target="_blank" rel="noopener">https://github.com/coturn/coturn/wiki/Downloads</a></p><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><h4 id="æ–¹å¼ä¸€ï¼š"><a href="#æ–¹å¼ä¸€ï¼š" class="headerlink" title="æ–¹å¼ä¸€ï¼š"></a>æ–¹å¼ä¸€ï¼š</h4><p>æˆ‘é€‰æ‹©äº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œ4.5.0.8</p><pre><code>$ wget https://coturn.net/turnserver/v4.5.0.8/turnserver-4.5.0.8.tar.gz</code></pre><p>ä¸€ç›´ä¸‹è½½å¤±è´¥..æ‰€ä»¥æˆ‘åœ¨æœ¬åœ°ä¸‹è½½äº†ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨  <code>home/wangzhumo/source</code></p><h4 id="æ–¹å¼äºŒï¼š"><a href="#æ–¹å¼äºŒï¼š" class="headerlink" title="æ–¹å¼äºŒï¼š"></a>æ–¹å¼äºŒï¼š</h4><pre><code>$ cd /home/wangzhumo/source$ git clone https://github.com/coturn/coturn</code></pre><h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><pre><code># è§£å‹$ tar -xvf turnserver-4.5.0.8.tar$ cd turnserver-4.5.0.8$ ./configure$ make$ sudo make install</code></pre><pre><code># è®°å½•å®‰è£…ä½ç½®install -d /usr/localinstall -d /usr/local/bininstall -d /usr/local/var/dbinstall -d /usr/local/man/man1install -d /usr/local/etcinstall -d /usr/local/libinstall -d /usr/local/share/examples/turnserverinstall -d /usr/local/share/doc/turnserverinstall -d /usr/local/share/turnserverinstall -d /usr/local/include/turn1) If your system supports automatic start-up system daemon services, then to enable the turnserver as a system service that is automaticallystarted, you have to:    a) Create and edit /etc/turnserver.conf or     /usr/local/etc/turnserver.conf .     Use /usr/local/etc/turnserver.conf.default as an example.    b) For user accounts settings: set up SQLite or PostgreSQL or     MySQL or MongoDB or Redis database for user accounts.    Use /usr/local/share/turnserver/schema.sql as SQL database schema,    or use /usr/local/share/turnserver/schema.userdb.redis as Redis    database schema description and/or     /usr/local/share/turnserver/schema.stats.redis    as Redis status &amp; statistics database schema description.    If you are using SQLite, the default database location is in     /var/db/turndb or in /usr/local/var/db/turndb or in /var/lib/turn/turndb.    c) add whatever is necessary to enable start-up daemon for the     /usr/local/bin/turnserver.2) If you do not want the turnserver to be a system service,    then you can start/stop it &quot;manually&quot;, using the &quot;turnserver&quot;    executable with appropriate options (see the documentation).3) To create database schema, use schema in file /usr/local/share/turnserver/schema.sql.4) For additional information, run:   $ man turnserver   $ man turnadmin   $ man turnutils</code></pre><h2 id="coturn-é…ç½®"><a href="#coturn-é…ç½®" class="headerlink" title="coturn é…ç½®"></a>coturn é…ç½®</h2><h3 id="turnserver-conf"><a href="#turnserver-conf" class="headerlink" title="turnserver.conf"></a>turnserver.conf</h3><pre><code>$ sudo vim /usr/local/etc/turnserver.conf.default</code></pre><p>è¦ä¿®æ”¹çš„åœ°æ–¹åªæœ‰5å¤„ï¼š</p><ul><li><p>listening-port=3478</p></li><li><p>external-ip=[æœåŠ¡å™¨çš„ip]</p></li><li><p>min-port=50001  </p><p>max-port=65535</p></li><li><p>user=wangzhumo:webrtcpwd</p></li><li><p>realm=stun.wangzhumo.com</p></li></ul><pre><code>$ sudo mv /usr/local/etc/turnserver.conf.default /usr/local/etc/turnserver.conf</code></pre><h3 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h3><p>1.æ‰“å¼€äº‘æœåŠ¡å™¨çš„ å®‰å…¨ç»„ ï¼ŒåŠ å…¥  3478 ï¼Œ50001â€”65535</p><p>2.æœ¬æœºçš„é˜²ç«å¢™</p><h2 id="coturn-å¼€å¯"><a href="#coturn-å¼€å¯" class="headerlink" title="coturn å¼€å¯"></a>coturn å¼€å¯</h2><pre><code>$ turnserver -o -c /usr/local/etc/turnserver.conf</code></pre><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>æµ‹è¯•åœ°å€ï¼š<a href="https://webrtc.github.io/samples/src/content/peerconnection/trickle-ice/" target="_blank" rel="noopener">https://webrtc.github.io/samples/src/content/peerconnection/trickle-ice/</a></p><p>1.è¾“å…¥ï¼š</p><p>STUN or TURN URI:   turn:stun.wangzhumo.com</p><p>TURN username:  wangzhumo</p><p>TURN password:  webrtcpwd</p><p>2.Add Server</p><p>3.Gather candidates</p><p>æµ‹è¯•ç»“æœï¼š</p><pre><code>Time    Component    Type    Foundation    Protocol    Address    Port    Priority0.003    rtp    host    2749607730    udp    172.30.21.85    60720    126 | 30 | 2557.794    rtp    srflx    842163049    udp    221.221.255.18    33338    100 | 30 | 2557.825    rtp    relay    1676812102    udp    171.51.157.190    65032    2 | 30 | 2557.825    Done7.827</code></pre><p>çœ‹åˆ°relayç±»å‹çš„å°±è¯´æ˜æˆåŠŸäº†</p><h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2>]]></content>
    
    
    <categories>
      
      <category>Media</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Server</tag>
      
      <tag>Media</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>STUNåè®®ç®€å•è®¤è¯†</title>
    <link href="undefined2019/10/22/stun-protocol-start/"/>
    <url>2019/10/22/stun-protocol-start/</url>
    
    <content type="html"><![CDATA[<h2 id="STUNç®€ä»‹"><a href="#STUNç®€ä»‹" class="headerlink" title="STUNç®€ä»‹"></a>STUNç®€ä»‹</h2><ul><li>STUNä¸»è¦ç”¨äºNATçš„ç©¿è¶Š</li><li>STUNä¹Ÿæ˜¯ä¸€ä¸ªc/sæ¶æ„</li></ul><a id="more"></a><h2 id="STUNçš„è§„èŒƒ"><a href="#STUNçš„è§„èŒƒ" class="headerlink" title="STUNçš„è§„èŒƒ"></a>STUNçš„è§„èŒƒ</h2><h4 id="RFC3489-STUN"><a href="#RFC3489-STUN" class="headerlink" title="RFC3489/STUN"></a>RFC3489/STUN</h4><p>Simple Traversal of UDP Through NAT</p><p>é€šè¿‡UDPå¯¹NATè¿›è¡Œç©¿è¶Š,ä½†æ˜¯ç°åœ¨å¯¹UDPçš„æ”¯æŒä¸å¥½,å› æ­¤æ•ˆæœä¸å¥½</p><h4 id="RFC5389-STUN"><a href="#RFC5389-STUN" class="headerlink" title="RFC5389/STUN"></a>RFC5389/STUN</h4><p>Session Traversal Utilities for NAT</p><p>å®šä¹‰ä¸ºä¸€ç³»åˆ—çš„ç©¿è¶Šå·¥å…·,å·²ç»å’Œ<code>RFC3489</code>å®Œå…¨ä¸ä¸€è‡´äº†.</p><p>UDP/TCPéƒ½ä½¿ç”¨,è¾¾åˆ°ç©¿è¶Šçš„ç›®çš„.</p><h2 id="STUNåè®®"><a href="#STUNåè®®" class="headerlink" title="STUNåè®®"></a>STUNåè®®</h2><h3 id="STUN-Header"><a href="#STUN-Header" class="headerlink" title="STUN Header"></a>STUN Header</h3><blockquote><p>20ä¸ªå­—èŠ‚çš„STUN Header</p></blockquote><p><a href="https://tools.ietf.org/html/rfc3489" target="_blank" rel="noopener">RFC3489</a></p><p><a href="https://tools.ietf.org/html/rfc5389" target="_blank" rel="noopener">RFC5389 Figure 2</a></p><pre><code class="shell">       0                   1                   2                   3       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+      |0 0|     STUN Message Type     |         Message Length        |      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+      |                         Magic Cookie                          |      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+      |                                                               |      |                     Transaction ID (96 bits)                  |      |                                                               |      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                                    Figure 2: Format of STUN Message Header</code></pre><h4 id="ç±»å‹-2byte"><a href="#ç±»å‹-2byte" class="headerlink" title="ç±»å‹(2byte)"></a>ç±»å‹(2byte)</h4><pre><code class="shell">                        0                 1                        2  3  4 5 6 7 8 9 0 1 2 3 4 5                       +--+--+-+-+-+-+-+-+-+-+-+-+-+-+                       |M |M |M|M|M|C|M|M|M|C|M|M|M|M|                       |11|10|9|8|7|1|6|5|4|0|3|2|1|0|                       +--+--+-+-+-+-+-+-+-+-+-+-+-+-+                    0  0  0 0 0 0 0 0 0 0 0 0 0 1    0x0001   ç»‘å®šæ¶ˆæ¯                    0  0  0 0 0 1 0 0 0 0 0 0 0 1    0x0101   å“åº”æ¶ˆæ¯                     0  0  0 0 0 1 0 0 0 1 0 0 0 1    0x0111   é”™è¯¯æ¶ˆæ¯                Figure 3: Format of STUN Message Type Field</code></pre><p><a href="https://tools.ietf.org/html/rfc5389" target="_blank" rel="noopener">RFC5389 Figure 3</a></p><p>å…¶ä¸­2ä¸ªå­—èŠ‚(16bit)</p><ul><li>0-2å…±2ä½å›ºå®šä¸º00,å¦‚æœå¤ç”¨åŒä¸€ä¸ªç«¯å£,00å¤´è¡¨ç¤ºè¿™æ˜¯STUNåè®®</li><li><p>2-4å…±2ä½ç”¨äºåˆ†ç±» C0/C1</p><ul><li><p>0b00 è¯·æ±‚</p></li><li><p>0b01  æŒ‡ç¤º</p></li><li><p>0b10  æˆåŠŸçš„å“åº”</p></li><li><p>0b11   å¤±è´¥çš„å“åº”</p><blockquote><p>è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯,<code>c0,c1</code>å¹¶ä¸æ˜¯ä»…ä»…æŒ¨ç€çš„,éœ€è¦æŠŠ16è¿›åˆ¶æ•°å­—è½¬ä¸ºäºŒè¿›åˆ¶,ç„¶åçœ‹å¯¹åº”çš„ä½æ•°</p></blockquote><p><img src="/images/stun_16_2_c0c1.png" srcset="/img/loading.gif" alt="image-20191222192530007"></p><p>å›¾ä¸­å±•ç¤ºçš„æ˜¯å“åº”æ¶ˆæ¯,c0ä¹Ÿå°±æ˜¯ç¬¬5ä½æ˜¯0</p></li></ul></li><li>4-16å…±12ä½ç”¨ä¸å®šä¹‰è¯·æ±‚/æŒ‡ç¤º</li></ul><h4 id="æ¶ˆæ¯é•¿åº¦-2byte"><a href="#æ¶ˆæ¯é•¿åº¦-2byte" class="headerlink" title="æ¶ˆæ¯é•¿åº¦(2byte)"></a>æ¶ˆæ¯é•¿åº¦(2byte)</h4><p>æ¶ˆæ¯é•¿åº¦2ä¸ªå­—èŠ‚(16bit),æ³¨æ„å®ƒä¸åŒ…æ‹¬æ¶ˆæ¯å¤´çš„é•¿åº¦</p><h4 id="äº‹åŠ¡ID-16byte"><a href="#äº‹åŠ¡ID-16byte" class="headerlink" title="äº‹åŠ¡ID(16byte)"></a>äº‹åŠ¡ID(16byte)</h4><p>äº‹åŠ¡IDç”¨æ¥è¡¨ç¤ºæŸä¸€ä¸ªæ“ä½œ,è¯·æ±‚ä¸ç›¸åº”äº‹åŠ¡IDç›¸åŒ<br>16ä¸ªå­—èŠ‚ (8bit * 16 = 128bit)</p><p><em>5389ä¸­,Transaction ID (96bit) + Magic Cookie(32bit) = 128bit</em></p><p><strong>Magic Cookie</strong>åŒ…å«<code>å›ºå®šå€¼0x2112A442</code> </p><h3 id="STUN-Body"><a href="#STUN-Body" class="headerlink" title="STUN Body"></a>STUN Body</h3><blockquote><p>æ¶ˆæ¯å¤´åæœ‰0æˆ–å¤šä¸ªå±æ€§</p><p>æ¯ä¸ªå±æ€§è¿›è¡ŒTLVç¼–ç   Type,Length,Value</p></blockquote><p>PS:32ä½å¯¹é½,ä¸è¶³çš„è¡¥0</p><p><strong>TLV</strong> </p><pre><code>       0                   1                   2                   3       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+      |         Type                  |            Length             |      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+      |                         Value (variable)                ....      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                              Figure 4: Format of STUN Attributes</code></pre><h4 id="TYPE"><a href="#TYPE" class="headerlink" title="TYPE"></a>TYPE</h4><p>è¡¨ç¤ºå±æ€§çš„ç±»å‹,åªæœ‰ç¬¬ä¸€æ¬¡å‡ºç°çš„å±æ€§ä¼šè¢«æ¥æ”¶ç«¯è§£æï¼Œè€Œå…¶ä½™çš„å°†è¢«å¿½ç•¥</p><p>Typeå€¼åœ¨0x0000-0x7FFFä¹‹é—´çš„å±æ€§è¢«æŒ‡å®šä¸º<strong>å¼ºåˆ¶ç†è§£</strong>,STUNç»ˆç«¯å¿…é¡»è¦ç†è§£æ­¤å±æ€§</p><p>Typeå€¼åœ¨0x8000-0xFFFFä¹‹é—´çš„å±æ€§ä¸º<strong>é€‰æ‹©æ€§ç†è§£</strong>,å¦‚æœSTUNç»ˆç«¯ä¸è¯†åˆ«æ­¤å±æ€§åˆ™å°†å…¶å¿½ç•¥</p><p>   0x0001: MAPPED-ADDRESS<br>   0x0002: RESPONSE-ADDRESS<br>   0x0003: CHANGE-REQUEST<br>   0x0004: SOURCE-ADDRESS<br>   0x0005: CHANGED-ADDRESS<br>   0x0006: USERNAME<br>   0x0007: PASSWORD<br>   0x0008: MESSAGE-INTEGRITY<br>   0x0009: ERROR-CODE<br>   0x000a: UNKNOWN-ATTRIBUTES<br>   0x000b: REFLECTED-FROM</p><ul><li>MAPPED-ADDRESSï¼šMAPPED-ADDRESSå±æ€§è¡¨ç¤ºæ˜ å°„è¿‡çš„IPåœ°å€å’Œç«¯å£ã€‚å®ƒåŒ…æ‹¬8ä½çš„åœ°å€æ—ï¼Œ16ä½çš„ç«¯å£å·åŠé•¿åº¦å›ºå®šçš„IPåœ°å€ã€‚</li><li>RESPONSE-ADDRESSï¼šRESPONSE-ADDRESSå±æ€§è¡¨ç¤ºå“åº”çš„ç›®çš„åœ°å€</li><li>CHASNGE-REQUESTï¼šå®¢æˆ·ä½¿ç”¨32ä½çš„CHANGE-REQUESTå±æ€§æ¥è¯·æ±‚æœåŠ¡å™¨ä½¿ç”¨ä¸åŒçš„åœ°å€æˆ–ç«¯å£å·æ¥å‘é€å“åº”ã€‚</li><li>SOURCE-ADDRESSï¼šSOURCE-ADDRESSå±æ€§å‡ºç°åœ¨æ†ç»‘å“åº”ä¸­ï¼Œå®ƒè¡¨ç¤ºæœåŠ¡å™¨å‘é€å“åº”çš„æºIPåœ°å€å’Œç«¯å£ã€‚</li><li>CHANGED-ADDRESSï¼šå¦‚æœæ†ç»‘è¯·æ±‚çš„CHANGE-REQUESTå±æ€§ä¸­çš„â€œæ”¹å˜IPâ€å’Œâ€œæ”¹å˜ç«¯å£â€æ ‡å¿—è®¾ç½®äº†ï¼Œåˆ™CHANGED-ADDRESSå±æ€§è¡¨ç¤ºå“åº”å‘å‡ºçš„IPåœ°å€å’Œç«¯å£å·ã€‚</li><li>USERNAMEï¼šUSERNAMEå±æ€§ç”¨äºæ¶ˆæ¯çš„å®Œæ•´æ€§æ£€æŸ¥ï¼Œç”¨äºæ¶ˆæ¯å®Œæ•´æ€§æ£€æŸ¥ä¸­æ ‡è¯†å…±äº«ç§å¯†ã€‚USERNAMEé€šå¸¸å‡ºç°åœ¨å…±äº«ç§å¯†å“åº”ä¸­ï¼Œä¸PASSWORDä¸€èµ·ã€‚å½“ä½¿ç”¨æ¶ˆæ¯å®Œæ•´æ€§æ£€æŸ¥æ—¶ï¼Œå¯æœ‰é€‰æ‹©åœ°å‡ºç°åœ¨æ†ç»‘è¯·æ±‚ä¸­ã€‚</li><li>PASSWORDï¼šPASSWORDå±æ€§ç”¨åœ¨å…±äº«ç§å¯†å“åº”ä¸­ï¼Œä¸USERNAMEä¸€èµ·ã€‚PASSWORDçš„å€¼æ˜¯å˜é•¿çš„ï¼Œç”¨ä½œå…±äº«ç§å¯†ï¼Œå®ƒçš„é•¿åº¦å¿…é¡»æ˜¯4å­—èŠ‚çš„å€æ•°ï¼Œä»¥ä¿è¯å±æ€§ä¸è¾¹ç•Œå¯¹é½ã€‚</li><li>MESSAGE-INTEGRITYï¼šMESSAGE-INTEGRITYå±æ€§åŒ…å«STUNæ¶ˆæ¯çš„HMAC-SHA1ï¼Œå®ƒå¯ä»¥å‡ºç°åœ¨æ†ç»‘è¯·æ±‚æˆ–æ†ç»‘å“åº”ä¸­ï¼›MESSAGE-INTEGRITYå±æ€§å¿…é¡»æ˜¯ä»»ä½•STUNæ¶ˆæ¯çš„æœ€åä¸€ä¸ªå±æ€§ã€‚å®ƒçš„å†…å®¹å†³å®šäº†HMACè¾“å…¥çš„Keyå€¼ã€‚</li><li>ERROR-CODEï¼šERROR-CODEå±æ€§å‡ºç°åœ¨æ†ç»‘é”™è¯¯å“åº”æˆ–å…±äº«ç§å¯†é”™è¯¯å“åº”ä¸­ã€‚å®ƒçš„å“åº”å·æ•°å€¼èŒƒå›´ä»100åˆ°699ã€‚</li><li>UNKNOWN-ATTRIBUTESï¼šUNKNOWN-ATTRIBUTESå±æ€§åªå­˜åœ¨äºå…¶ERROR-CODEå±æ€§ä¸­çš„å“åº”å·ä¸º420çš„æ†ç»‘é”™è¯¯å“åº”æˆ–å…±äº«ç§å¯†é”™è¯¯å“åº”ä¸­ã€‚</li><li>REFLECTED-FROMï¼šREFLECTED-FROMå±æ€§åªå­˜åœ¨äºå…¶å¯¹åº”çš„æ†ç»‘è¯·æ±‚åŒ…å«RESPONSE-ADDRESSå±æ€§çš„æ†ç»‘å“åº”ä¸­ã€‚å±æ€§åŒ…å«è¯·æ±‚å‘å‡ºçš„æºIPåœ°å€ï¼Œå®ƒçš„ç›®çš„æ˜¯æä¾›è·Ÿè¸ªèƒ½åŠ›ï¼Œè¿™æ ·STUNå°±ä¸èƒ½è¢«ç”¨ä½œDOSæ”»å‡»çš„åå°„å™¨ã€‚</li></ul><h4 id="Attributesçš„ä½¿ç”¨ä½ç½®"><a href="#Attributesçš„ä½¿ç”¨ä½ç½®" class="headerlink" title="Attributesçš„ä½¿ç”¨ä½ç½®"></a>Attributesçš„ä½¿ç”¨ä½ç½®</h4><pre><code>                                       Binding  Shared  Shared  Shared                       Binding  Binding  Error    Secret  Secret  Secret   Att.                Req.     Resp.    Resp.    Req.    Resp.   Error                                                                  Resp.   _____________________________________________________________________   MAPPED-ADDRESS      N/A      M        N/A      N/A     N/A     N/A   RESPONSE-ADDRESS    O        N/A      N/A      N/A     N/A     N/A   CHANGE-REQUEST      O        N/A      N/A      N/A     N/A     N/A   SOURCE-ADDRESS      N/A      M        N/A      N/A     N/A     N/A   CHANGED-ADDRESS     N/A      M        N/A      N/A     N/A     N/A   USERNAME            O        N/A      N/A      N/A     M       N/A   PASSWORD            N/A      N/A      N/A      N/A     M       N/A   MESSAGE-INTEGRITY   O        O        N/A      N/A     N/A     N/A   ERROR-CODE          N/A      N/A      M        N/A     N/A     M   UNKNOWN-ATTRIBUTES  N/A      N/A      C        N/A     N/A     C   REFLECTED-FROM      N/A      C        N/A      N/A     N/A     N/A</code></pre><h4 id="MAPPED-ADDRESS"><a href="#MAPPED-ADDRESS" class="headerlink" title="MAPPED-ADDRESS"></a>MAPPED-ADDRESS</h4><p>NATå®¢æˆ·ç«¯çš„åå°„åœ°å€,Familyä¸ºIPç±»å‹ï¼Œå³IPV4(0x01)æˆ–IPV6(0x02)ï¼ŒPortä¸ºç«¯å£ï¼ŒAddressä¸º32ä½æˆ–128ä½çš„IPåœ°å€ã€‚æ³¨æ„é«˜8ä½å¿…é¡»å…¨éƒ¨ç½®é›¶ï¼Œ</p><pre><code> 0                   1                   2                   3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|0 0 0 0 0 0 0 0|    Family     |           Port                |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|                                                               ||                 Address (32 bits or 128 bits)                 ||                                                               |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+    Figure 5: Format of MAPPED-ADDRESS Attribute</code></pre>]]></content>
    
    
    <categories>
      
      <category>WebRTC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Media</tag>
      
      <tag>WebRTC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JNI è®¤è¯†JNIçš„åŸºæœ¬æ¦‚å¿µ</title>
    <link href="undefined2018/10/28/jni-basic-conception/"/>
    <url>2018/10/28/jni-basic-conception/</url>
    
    <content type="html"><![CDATA[<h4 id="JNIEnv"><a href="#JNIEnv" class="headerlink" title="JNIEnv"></a>JNIEnv</h4><p>åœ¨Androidçš„ä¸–ç•Œä¸­,æˆ‘ä»¬ç¼–å†™å®Œæˆçš„æºä»£ç éƒ½è¢«ç¼–è¯‘æˆclassæ–‡ä»¶ï¼Œè€ŒAndroidåˆä¸ºäº†é¿å…ä¸€äº›é—®é¢˜ï¼Œæä¾›äº†Dalvik VMï¼ŒDalvikè™šæ‹Ÿæœºè´Ÿè´£æŠŠdexæ–‡ä»¶è½½å…¥ã€‚</p><p>é‚£ä¹ˆ .so æ–‡ä»¶æ€ä¹ˆè¿è¡Œé‚£ï¼Ÿ</p><p>è‚¯å®šä¹Ÿæ˜¯è¦åœ¨Dalvik VMä¸­çš„,è¦ä¸æ€ä¹ˆäº’ç›¸è°ƒç”¨é‚£ï¼Ÿæ€»ä¸èƒ½é æ„å¿µæŠŠ</p>]]></content>
    
    
    <categories>
      
      <category>JNI</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JNI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JNI-ä»Android Studioé»˜è®¤å·¥ç¨‹è®¤è¯†JNI</title>
    <link href="undefined2018/10/28/taste-jni-default-project/"/>
    <url>2018/10/28/taste-jni-default-project/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å¯¹äºJNI,Googleä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…¥é—¨æ–‡æ¡£</p><blockquote><p><a href="https://developer.android.com/ndk/guides/" target="_blank" rel="noopener">https://developer.android.com/ndk/guides/</a></p></blockquote><p>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨JNIé‚£ï¼ŸGoogleå·²ç»å¾ˆæ˜ç¡®çš„ä¸ºæˆ‘ä»¬æŒ‡æ˜äº†ï¼š</p><ul><li>åœ¨å¹³å°ä¹‹é—´ç§»æ¤å…¶åº”ç”¨ã€‚</li><li>é‡å¤ä½¿ç”¨ç°æœ‰åº“ï¼Œæˆ–è€…æä¾›å…¶è‡ªå·±çš„åº“ä¾›é‡å¤ä½¿ç”¨ã€‚</li><li>åœ¨æŸäº›æƒ…å†µä¸‹æé«˜æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åƒæ¸¸æˆè¿™ç§è®¡ç®—å¯†é›†å‹åº”ç”¨ã€‚</li></ul><a id="more"></a><p>æœ¬æ¥æ˜¯æ‰“ç®—å­¦ä¹ NDKçš„è€ä¸€å¥—çš„ï¼Œä¸è¿‡æœ€è¿‘å­¦ä¹ çš„è¯¾ç¨‹åˆšå¥½è®²åˆ°è¿™ä¸ªéƒ¨åˆ†ï¼Œä½¿ç”¨CMakeçš„æ–¹å¼çš„ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥å­¦ä¹ æœ€æ–°çš„JNIä½¿ç”¨æ–¹å¼äº†ã€‚</p><h3 id="å·¥ç¨‹ç»“æ„"><a href="#å·¥ç¨‹ç»“æ„" class="headerlink" title="å·¥ç¨‹ç»“æ„"></a>å·¥ç¨‹ç»“æ„</h3><pre><code class="shell">.â”œâ”€â”€ CMakeLists.txtâ”œâ”€â”€ build.gradleâ””â”€â”€ src    â”œâ”€â”€ main        â”œâ”€â”€ AndroidManifest.xml        â”œâ”€â”€ cpp        â”‚   â””â”€â”€ native-lib.cpp        â”œâ”€â”€ java</code></pre><p>å½“æˆ‘ä»¬åˆ›å»ºå¥½ä¸€ä¸ªæ”¯æŒC++çš„Androidé¡¹ç›®åï¼Œä¼šå¾—åˆ°è¿™æ ·çš„ä¸€ä¸ªé¡¹ç›®ç»“æ„ï¼ˆä¸é‡è¦çš„çœç•¥æ‰äº†ï¼‰</p><ul><li>CMakeLists.txt  æ˜¯CMakeçš„é…ç½®æ–‡ä»¶</li><li>build.gradle       Androidçš„æ„å»ºå·¥å…·</li><li>Src   æ˜¯Java &amp; C çš„æºç æ–‡ä»¶ç›®å½•<ul><li>cpp æ˜¯Cæºç </li><li>java æ˜¯Javaçš„æºç </li></ul></li></ul><h3 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h3><pre><code class="shell"># Sets the minimum version of CMake required to build the native library.cmake_minimum_required(VERSION 3.4.1)# æ ¹æ®Cæ–‡ä»¶ç”Ÿæˆåº“æ–‡ä»¶# å¯ä»¥æ·»åŠ å…¶ä»–çš„éç³»ç»Ÿåº“add_library( # Sets the name of the library.        native-lib        # Sets the library as a shared(åŠ¨æ€åº“) library.        SHARED        # Provides a relative path to your source(æºæ–‡ä»¶) file(s).        src/main/cpp/native-lib.cpp)# æ·»åŠ ä½ éœ€è¦ä½¿ç”¨çš„ç³»ç»Ÿåº“find_library( # Sets the name of the path variable.        log-lib        # Specifies(æŒ‡å®šä¸€ä¸ªåå­—) the name of the NDK library that        # you want CMake to locate.        log)# å°†åº“é“¾æ¥èµ·æ¥# ä¸‹é¢å†™ä½ éœ€è¦é“¾æ¥çš„åº“target_link_libraries( # Specifies the target library.        native-lib        # Links the target library to the log library        # included in the NDK.        ${log-lib})</code></pre><p>å½“ä½ ç¼–è¯‘æˆåŠŸåï¼Œå¯ä»¥åœ¨<code>app/build/intermediates/cmake/</code>çš„ç›®å½•ä¸‹çœ‹åˆ°ä½ ç¼–è¯‘æˆåŠŸç”Ÿæˆçš„.soæ–‡ä»¶</p><h3 id="Androidéƒ¨åˆ†"><a href="#Androidéƒ¨åˆ†" class="headerlink" title="Androidéƒ¨åˆ†"></a>Androidéƒ¨åˆ†</h3><pre><code class="java">public class MainActivity extends AppCompatActivity {    // Used to load the &#39;native-lib&#39; library on application startup.    // æŠŠåº“è¯»å–åˆ°javaä¸­æ¥ libnative-lib.so  ,æ³¨æ„è¦å»æ‰libè¿™ä¸ªå‰ç¼€    static {        System.loadLibrary(&quot;native-lib&quot;);    }    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_main);        // Example of a call to a native method        TextView tv = (TextView) findViewById(R.id.sample_text);        // å¯ä»¥çœ‹åˆ°è¿™é‡Œç›´æ¥è°ƒç”¨äº† Â·nativeÂ· æ–¹æ³•        tv.setText(stringFromJNI());    }    /**     * A native method that is implemented by the &#39;native-lib&#39; native library,     * which is packaged with this application.     */    public native String stringFromJNI();}</code></pre><h3 id="nativeéƒ¨åˆ†"><a href="#nativeéƒ¨åˆ†" class="headerlink" title="nativeéƒ¨åˆ†"></a>nativeéƒ¨åˆ†</h3><pre><code class="c">#include &lt;jni.h&gt;#include &lt;string&gt;extern &quot;C&quot; JNIEXPORT jstring JNICALLJava_com_wangzhumo_jni_MainActivity_stringFromJNI(   //æ³¨æ„è¿™ä¸ª,æ˜¯åˆ¶å®šçš„æ ¼å¼                                                    // javahå¯ä»¥ç”Ÿæˆ or æ‰‹å†™        JNIEnv *env,        jobject /* this */) {    std::string hello = &quot;Hello from C++&quot;;    return env-&gt;NewStringUTF(hello.c_str());}</code></pre>]]></content>
    
    
    <categories>
      
      <category>JNI</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JNI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¤è¯†æ—¶åŸŸä¸é¢‘åŸŸ</title>
    <link href="undefined2018/09/21/time-and-frequency-domain/"/>
    <url>2018/09/21/time-and-frequency-domain/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æˆ‘ä¹Ÿæ²¡æƒ³åˆ°æˆ‘æœ‰ä¸€å¤©ä¼šæ¡èµ·è¿™äº›ä¸œè¥¿ï¼Œæˆ‘ä¸€ä¸ªæ•°å­¦å¼±é¸¡å‹åŠ›å±±å¤§ã€‚</p><p>èµ·å› æ˜¯æœ€è¿‘åœ¨å­¦ä¹ éŸ³è§†é¢‘å¼€å‘ï¼Œæˆ‘å‘ç°ä¸€æ¶‰åŠåˆ°ç†è®ºçŸ¥è¯†è¿™å—ï¼Œæ€»ä¼šæœ‰å‡ ä¸ª <code>æ—¶åŸŸ</code>ï¼Œ<code>é¢‘åŸŸ</code>ï¼Œ<code>å‚…é‡Œå¶å˜åŒ–</code>è¿™æ ·çš„åè¯å‡ºç°ï¼Œæˆ‘èƒ½æ€ä¹ˆåŠï¼Œå­¦å‘—</p><p>é“¾æ¥ï¼š</p><blockquote><p>ä¿¡å·é¢‘åŸŸå’Œæ—¶åŸŸçš„å…³ç³»ï¼Ÿ</p><p><a href="https://www.zhihu.com/question/21040374" target="_blank" rel="noopener">https://www.zhihu.com/question/21040374</a></p></blockquote><p>æƒ³å­¦ä¹ ä¸€ä¸ªä¸œè¥¿ï¼Œé¦–å…ˆè¦ææ˜ç™½æ˜¯ä»€ä¹ˆï¼Ÿç„¶åæ‰èƒ½ç»§ç»­å»è®¤è¯†å®ƒã€‚</p><p>è€Œæˆ‘å§‹ç»ˆè®¤ä¸ºï¼Œå­¦ä¹ ä¹Ÿæ˜¯ç”±æµ…å…¥æ·±çš„ï¼Œç”±ç‚¹åŠé¢çš„ï¼Œä¸å¯èƒ½ä¸€ä¸Šæ¥å°±è®¤è¯†åˆ°äº†å®ƒçš„æ ¸å¿ƒç†è®ºã€‚</p><h3 id="ç®€å•çš„è®¤è¯†"><a href="#ç®€å•çš„è®¤è¯†" class="headerlink" title="ç®€å•çš„è®¤è¯†"></a>ç®€å•çš„è®¤è¯†</h3><blockquote><p>@èˆªç©ºèˆªå¤©è¿· </p><p><a href="https://www.zhihu.com/people/jin-it/activities" target="_blank" rel="noopener">https://www.zhihu.com/people/jin-it/activities</a></p></blockquote><p>è¿™ä½å¤§å…„å¼Ÿçš„å›¾æ˜¯æˆ‘çš„å¯è’™ã€‚</p><p><img src="/images/time_domain.png" srcset="/img/loading.gif" alt="æ—¶åŸŸ"></p><p>è¿™å¼ å›¾å°±æ˜¯ä¸€ä¸ªæ—¶åŸŸå›¾ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ­£å¼¦æ³¢ï¼Œxè½´ä¸Šæ˜¯æ—¶é—´çš„å˜åŒ–ï¼Œyè½´å°±æ˜¯æŒ¯å¹…äº†</p><ul><li><p>é¢‘ç‡ ï¼š6Hz</p></li><li><p>æŒ¯å¹… ï¼š5V</p></li></ul><p><img src="/images/frequency_domain.png" srcset="/img/loading.gif" alt="é¢‘åŸŸ"></p><p>è¿™é‡Œå°±æ˜¯å›¾1ä¸­æ­£å¼¦æ³¢çš„é¢‘åŸŸå›¾</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°xè½´æ˜¯é¢‘ç‡äº†ï¼Œyè½´å°±æ˜¯æŒ¯å¹…äº†</p><p>å…¶ä¸­ç»¿è‰²çš„çº¿ï¼Œå…¶xè½´çš„äº¤ç‚¹æ˜¯æŒ‡è¿™ä¸ªæ­£å¼¦æ³¢çš„é¢‘ç‡æ˜¯6,å®ƒçš„é«˜åº¦å°±æ˜¯è¿™ä¸ªæ­£å¼¦æ³¢çš„æ³¢å³°äº†5V</p><h3 id="è¿›ä¸€æ­¥è®¤è¯†"><a href="#è¿›ä¸€æ­¥è®¤è¯†" class="headerlink" title="è¿›ä¸€æ­¥è®¤è¯†"></a>è¿›ä¸€æ­¥è®¤è¯†</h3><p>æ¥è‡ªï¼š</p><blockquote><p>@ä¸€äºŒ</p><p><a href="https://www.zhihu.com/people/yier-64/activities" target="_blank" rel="noopener">https://www.zhihu.com/people/yier-64/activities</a></p><p><a href="https://zh.wikipedia.org/wiki/%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2#" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2#</a></p></blockquote><p><img src="/images/fuliye_gif.gif" srcset="/img/loading.gif" alt="git"></p><p>å‚…é‡Œå¶å˜æ¢å°†å‡½æ•°çš„æ—¶åŸŸï¼ˆçº¢è‰²ï¼‰ä¸é¢‘åŸŸï¼ˆè“è‰²ï¼‰ç›¸å…³è”</p><p>åˆšå¼€å§‹çš„æ—¶å€™æˆ‘æ²¡çœ‹å‰é¢ <code>@èˆªç©ºèˆªå¤©è¿·</code>çš„ç­”æ¡ˆï¼Œç›´æ¥åœ¨CSDNä¸ŠæŸ¥çš„ï¼Œç„¶åå°±æˆ‘æ‡µé€¼äº†ã€‚</p><blockquote><p><a href="https://blog.csdn.net/jiujiaobusiniao/article/details/53321491" target="_blank" rel="noopener">https://blog.csdn.net/jiujiaobusiniao/article/details/53321491</a></p></blockquote><p>ç›¯ç€è¿™å‡ å¼ å›¾çœ‹äº†å¾ˆä¹…ï¼Œå¾ˆä¹…ã€‚ã€‚ã€‚</p><h3 id="å¼€å§‹ç†è§£"><a href="#å¼€å§‹ç†è§£" class="headerlink" title="å¼€å§‹ç†è§£"></a>å¼€å§‹ç†è§£</h3><blockquote><p>@Heinrich</p><p><a href="https://www.zhihu.com/people/Erdnussoelbearbeiter/activities" target="_blank" rel="noopener">https://www.zhihu.com/people/Erdnussoelbearbeiter/activities</a></p><p>å‚…é‡Œå¶åˆ†æä¹‹ææ­»æ•™ç¨‹</p><p><a href="https://zhuanlan.zhihu.com/p/19763358?refer=wille" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/19763358?refer=wille</a></p></blockquote><p>çœŸçš„æ˜¯ç»™å¤§ä½¬é€’çƒŸã€‚</p><p>å¤§ä½¬ï¼Œç«</p><p><img src="/images/time_frequency_domain.jpg" srcset="/img/loading.gif" alt="time_frequency_domain"></p><p>ä¸‹ä¸€æ­¥æˆ‘ä»¬å°±çœ‹çœ‹å‚…é‡Œå¶å˜æ¢</p>]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>frequency</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>éŸ³è§†é¢‘-FFmpegçš„ç¼–è¯‘ä¸å®‰è£…</title>
    <link href="undefined2018/09/20/ffmpeg-build-install/"/>
    <url>2018/09/20/ffmpeg-build-install/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æ­£å¦‚FFmpegçš„ç®€ä»‹æ‰€è¯´</p><blockquote><p>FFmpeg is a collection of libraries and tools to process multimedia content such as audio, video, subtitles and related metadata.</p></blockquote><p>FFmpegåœ¨éŸ³è§†é¢‘é¢†åŸŸç®—å¾—ä¸Šæ˜¯é›†å¤§æˆè€…ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œå¹¶ä¸”å¯ä»¥è‡ªè¡Œæ›¿æ¢æ·»åŠ ç¼–ç æ ‡å‡†ç­‰</p><p>å¯ä»¥åšåˆ°å½•åˆ¶ï¼Œæ’­æ”¾ï¼Œè§£ç ï¼Œè½¬ç ï¼Œæ»¤é•œç­‰ç­‰ï¼Œæ‰€ä»¥å®ƒè¢«å¾ˆå¤šå…¬å¸é‡‡ç”¨ã€‚</p><a id="more"></a><ul><li><code>libavcodec</code> ç¼–è§£ç .</li><li><code>libavformat</code> éŸ³è§†é¢‘çš„è§£å°è£…</li><li><code>libavutil</code> å·¥å…·å‡½æ•°</li><li><code>libavfilter</code> éŸ³è§†é¢‘æ»¤æ³¢å™¨ï¼ˆæ»¤é•œï¼‰</li><li><code>libavdevice</code> ç¡¬ä»¶çš„éŸ³è§†é¢‘é‡‡é›†ã€åŠ é€Ÿå’Œæ˜¾ç¤º</li><li><code>libswresample</code> é‡é‡‡æ ·ï¼Œé‡‡æ ·æ ¼å¼è½¬æ¢å’Œæ··åˆ</li><li><code>libswscale</code> åŸå§‹è§†é¢‘çš„ç¼©æ”¾ï¼Œè‰²å½©æ˜ å°„è½¬æ¢ï¼Œå›¾åƒé¢œè‰²ç©ºé—´æˆ–æ ¼å¼è½¬æ¢</li></ul><p>FFmpeg </p><blockquote><p>å®˜æ–¹ç½‘ç«™ <a href="https://ffmpeg.org/" target="_blank" rel="noopener">https://ffmpeg.org/</a></p><p>Github    <a href="https://github.com/FFmpeg/FFmpeg" target="_blank" rel="noopener">https://github.com/FFmpeg/FFmpeg</a></p></blockquote><h4 id="Homebrew"><a href="#Homebrew" class="headerlink" title="Homebrew"></a>Homebrew</h4><pre><code class="shell"># phyooos @ wangzhumo in ~ [20:58:24] C:127$ brew install ffmpeg --with-sdl2 --with-fdk-aac --with-freetype --with-libass  --with-libvorbis --with-libvpx --with-opus --with-x265 #ç»è¿‡ä¸€æ®µæ—¶é—´çš„ä¸‹è½½==&gt; ./configure --prefix=/usr/local/Cellar/ffmpeg/4.0.2 --enable-shared --enable-pthreads --ena==&gt; make installğŸº  /usr/local/Cellar/ffmpeg/4.0.2: 251 files, 53.2MB, built in 8 minutes 1 second#å¥½äº†å·²ç»å®‰è£…æˆåŠŸäº†</code></pre><p>æ³¨æ„<code>--with-sdl2</code> å…¶å®å°±æ˜¯<code>ffplay</code></p><p><code>--with-ffplay</code>å·²ç»è¿‡æ—¶è¢«<code>--with-sdl2</code>æ›¿ä»£äº†ï¼Œæ‰€ä»¥ä¸€å®šè¦æ›¿æ¢æ‰ï¼Œè¦ä¸ç„¶<code>ffplay</code>çš„å®‰è£…ä¼šå¤±è´¥</p><p>å¦‚æœä½ ä¸æƒ³è‡ªå·±æ‰‹åŠ¨ç¼–è¯‘å®‰è£…ï¼Œé‚£ä¹ˆè¿™é‡Œå·²ç»å¤Ÿäº†ï¼Œä¸‹æ–‡æ˜¯æ‰‹åŠ¨çš„ç¼–è¯‘å®‰è£…è®°å½•ã€‚</p><h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><h4 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h4><p>å®˜æ–¹ç½‘ç«™ï¼š</p><blockquote><p><a href="http://ffmpeg.org/download.html" target="_blank" rel="noopener">http://ffmpeg.org/download.html</a></p></blockquote><p>ä¸‹è½½è§£å‹ï¼Œç›®å½•ffmpeg</p><p>Git:</p><pre><code class="shell">git clone https://git.ffmpeg.org/ffmpeg.git ffmpeg</code></pre><h4 id="å‡†å¤‡å…¶ä»–åº“"><a href="#å‡†å¤‡å…¶ä»–åº“" class="headerlink" title="å‡†å¤‡å…¶ä»–åº“"></a>å‡†å¤‡å…¶ä»–åº“</h4><h5 id="brew-insatll"><a href="#brew-insatll" class="headerlink" title="brew insatll"></a>brew insatll</h5><blockquote><p>brew install pkg-config</p><p>brew install speex</p><p>brew install x264</p><p>brew install x265</p><p>brew install libsoxr</p></blockquote><h5 id="opencore"><a href="#opencore" class="headerlink" title="opencore"></a>opencore</h5><blockquote><p><a href="https://sourceforge.net/projects/opencore-amr/" target="_blank" rel="noopener">https://sourceforge.net/projects/opencore-amr/</a></p></blockquote><pre><code class="shell">$ ./configure$ make$ make install</code></pre><h5 id="fdk-acc"><a href="#fdk-acc" class="headerlink" title="fdk-acc"></a>fdk-acc</h5><blockquote><p><a href="https://sourceforge.net/projects/opencore-amr/files/fdk-aac/" target="_blank" rel="noopener">https://sourceforge.net/projects/opencore-amr/files/fdk-aac/</a></p></blockquote><p>##### </p><h4 id="ç¼–è¯‘å¼€å§‹"><a href="#ç¼–è¯‘å¼€å§‹" class="headerlink" title="ç¼–è¯‘å¼€å§‹"></a>ç¼–è¯‘å¼€å§‹</h4><h6 id="ç¼–å†™build-mac-os-sh"><a href="#ç¼–å†™build-mac-os-sh" class="headerlink" title="ç¼–å†™build_mac_os.sh"></a>ç¼–å†™build_mac_os.sh</h6><pre><code class="shell">#è¿›å…¥ffmpegç›®å½•cd ~/ffmpeg#åˆ›å»ºæ–‡ä»¶build_mac_os.shvim ./build_mac_os.sh#æ–‡ä»¶å†™å…¥./configure --cc=/usr/bin/clang  \    --prefix=/usr/local/ffmpeg \    --enable-gpl \    --enable-nonfree \    --enable-libfdk-aac \    --enable-libx264 \    --enable-libmp3lame \    --enable-libopencore-amrnb \    --enable-libopencore-amrwb \    --enable-libx265 \    --enable-filter=delogo \    --enable-debug \    --disable-optimizations \    --enable-libspeex \    --enable-videotoolbox \    --enable-shared \    --enable-pthreads \    --enable-version3 \    --enable-hardcoded-tables \    --host-cflags= \    --host-ldflags= make clean#æ‰§è¡Œæ–‡ä»¶sudo ./build_mac_os.sh</code></pre><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><h6 id="make-amp-amp-make-install"><a href="#make-amp-amp-make-install" class="headerlink" title="make &amp;&amp; make install"></a>make &amp;&amp; make install</h6><p>ç­‰å¾…ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™</p><pre><code class="shell">make &amp;&amp; make install</code></pre><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><h4 id="ç®€å•çš„å½•å±"><a href="#ç®€å•çš„å½•å±" class="headerlink" title="ç®€å•çš„å½•å±"></a>ç®€å•çš„å½•å±</h4><h5 id="æŸ¥æ‰¾è®¾å¤‡"><a href="#æŸ¥æ‰¾è®¾å¤‡" class="headerlink" title="æŸ¥æ‰¾è®¾å¤‡"></a>æŸ¥æ‰¾è®¾å¤‡</h5><pre><code class="shell"># phyooos @ wangzhumo in ~ [10:51:09] C:1$ ffmpeg -f avfoundation -list_devices true -i &quot;&quot; # æ³¨æ„ä¸Šé¢å‘½ä»¤-i  çš„å‚æ•°å°±æ˜¯ â€â€œ åˆ«å¿˜äº†#è¾“å‡ºï¼š#...[AVFoundation input device @ 0x7fe495402280] AVFoundation video devices:[AVFoundation input device @ 0x7fe495402280] [0] FaceTime HD Camera[AVFoundation input device @ 0x7fe495402280] [1] Capture screen 0[AVFoundation input device @ 0x7fe495402280] [2] Capture screen 1[AVFoundation input device @ 0x7fe495402280] AVFoundation audio devices:[AVFoundation input device @ 0x7fe495402280] [0] Built-in Microphone: Input/output error</code></pre><p>å¯ä»¥çœ‹åˆ°<code>AVFoundation video devices</code>çš„è®¾å¤‡æœ‰3ä¸ª</p><p>[0] æ‘„åƒå¤´</p><p>[1] å±å¹•1</p><p>[2] å±å¹•2</p><h5 id="å½•åˆ¶"><a href="#å½•åˆ¶" class="headerlink" title="å½•åˆ¶"></a>å½•åˆ¶</h5><pre><code class="shell">ffmpeg -f avfoundation -i 1 -r 30 ~/Downloads/out.yuv</code></pre><p>ä½¿ç”¨<code>Ctrl + c</code>ç»ˆæ­¢å½•åˆ¶</p><ul><li>-f  ä½¿ç”¨ <code>avfoundation</code>æ¥å½•åˆ¶</li><li>-i  æŒ‡å®šäº†å½“å‰ç”¨æ¥å½•åˆ¶çš„è®¾å¤‡ï¼Œè¿™é‡Œçš„<code>1</code></li><li>-r  å¸§ç‡30</li><li>out.yuv è¾“å‡ºæ–‡ä»¶</li></ul><h4 id="ç®€å•çš„æ’­æ”¾"><a href="#ç®€å•çš„æ’­æ”¾" class="headerlink" title="ç®€å•çš„æ’­æ”¾"></a>ç®€å•çš„æ’­æ”¾</h4><p>åœ¨å½•åˆ¶è¿‡ç¨‹ä¸­ï¼Œæœ‰æ‰“å°å½•åˆ¶çš„å‚æ•°</p><pre><code class="shell">Metadata:    encoder         : Lavf58.12.100    Stream #0:0: Video: rawvideo (UYVY / 0x59565955), uyvy422, 2880x1800, q=2-31, 2488320 kb/s, 30 fps, 30 tbn, 30 tbc</code></pre><p>æˆ‘ä»¬ä½¿ç”¨<code>ffplay</code>è¿›è¡Œæ’­æ”¾</p><pre><code class="shell">ffplay -s 2880x1800 -pixel_format uyvy422 ~/Downloads/out.yuv</code></pre><ul><li>-s æŒ‡å®šåˆ†è¾¨ç‡</li><li>-pixel_format ç¼–ç æ ¼å¼ </li></ul><p>æ·»åŠ è‡³ç¯å¢ƒå˜é‡</p>]]></content>
    
    
    <categories>
      
      <category>Media</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Media</tag>
      
      <tag>FFmpeg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>éŸ³è§†é¢‘-éŸ³é¢‘çš„åŸºç¡€ç†è®º</title>
    <link href="undefined2018/09/08/multimedia-learn-audio-base/"/>
    <url>2018/09/08/multimedia-learn-audio-base/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><h5 id="å£°éŸ³"><a href="#å£°éŸ³" class="headerlink" title="å£°éŸ³"></a>å£°éŸ³</h5><p>å­¦è¿‡ç‰©ç†çš„æˆ‘ä»¬éƒ½çŸ¥é“,å£°éŸ³å…¶å®å°±æ˜¯ä¸€ç§ç‰©ä½“çš„éœ‡åŠ¨</p><p>è€Œå£°éŸ³æœ‰ä¸‰è¦ç´ : é¢‘ç‡,æŒ¯å¹…,æ³¢å½¢</p><ul><li>é¢‘ç‡,ä»£è¡¨ç€å£°éŸ³çš„éŸ³é˜¶é«˜ä½</li><li>æŒ¯å¹…,æ ‡å¿—ç€éŸ³å£°çš„å“åº¦</li><li>æ³¢å½¢,æ—¢æ˜¯å£°è‰²</li></ul><p>é‚£ä¹ˆéŸ³é¢‘ä¿¡å·è¦åšçš„å°±æ˜¯æŠŠè¿™äº›éœ‡åŠ¨è½¬åŒ–ä¸ºæ•°å­—ä¿¡å·,å¯¹æ¨¡æ‹Ÿä¿¡å·è¿›è¡Œé‡‡æ ·,åœ¨æ—¶é—´è½´ä¸Šå¯¹æ¨¡æ‹Ÿä¿¡å·æ•°å­—åŒ–,æ ¹æ®é‡‡æ ·çš„é¢‘ç‡,æ¯ä¸€ç§’å¯¹æ¨¡æ‹Ÿä¿¡å·é‡‡æ ·næ¬¡.</p><a id="more"></a><h3 id="è®¤è¯†PCM"><a href="#è®¤è¯†PCM" class="headerlink" title="è®¤è¯†PCM"></a>è®¤è¯†PCM</h3><h5 id="PCM"><a href="#PCM" class="headerlink" title="PCM"></a>PCM</h5><p>æ—¢ç„¶è¦æŠŠå£°éŸ³é‡‡é›†ä¸ºæ•°å­—ä¿¡å·,é‚£ä¹ˆè‚¯å®šå°±æœ‰ä¸€ç§ç¼–ç çš„æ ¼å¼,è€Œå¸¸ç”¨çš„å°±æ˜¯<code>PCM(Pulse Code Modulation)è„‰å†²ç¼–ç è°ƒåˆ¶</code>æ ¼å¼.</p><p>PCMè¿˜æœ‰å‡ ä¸ªå…³é”®çš„æ¦‚å¿µ,å®ƒä»¬å…±åŒæè¿°äº†ä¸€æ®µPCMçš„æ•°æ®.</p><ul><li><p>é‡åŒ–æ ¼å¼(sampleFormat) </p><p>ä¹Ÿæœ‰å«é‡‡æ ·ä½æ•°çš„,ä»£è¡¨ç€æè¿°æ•°å­—ä¿¡å·æ‰€ä½¿ç”¨çš„ä½æ•°,8bit(å·²ç»å¾ˆå°‘ç”¨äº†)ã€16bit(ä¸€èˆ¬ä½¿ç”¨è¿™ä¸ª)å’Œ24bit</p></li><li><p>é‡‡æ ·ç‡(sampleRate) </p><p>æˆ‘ä»¬çŸ¥é“äººçš„è€³æœµèƒ½å¬åˆ°çš„èŒƒå›´æ˜¯20Hz - 20kHz,æˆ‘ä»¬çš„é‡‡æ ·ç‡å¦‚æœé«˜äºè¿™ä¸ªå€¼,åˆ™å¿…å®šå¯ä»¥ä¿è¯å£°éŸ³çš„è¿˜åŸ,</p><p>æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨44.1kHzé‡‡æ ·ç‡</p></li><li><p>å£°é“æ•°(channel)</p><p>å£°é“æ•°å°±æ˜¯æŒ‡,å£°éŸ³åœ¨å½•åˆ¶æˆ–æ’­æ”¾æ—¶ä¸åŒç©ºé—´ä½ç½®</p><ul><li>å•å£°é“ é‡‡æ ·æ•°æ®ä¸º8ä½çš„çŸ­æ•´æ•°(short)</li><li>åŒå£°é“ é‡‡æ ·æ•°æ®ä¸º16ä½çš„æ•´æ•°(int)  <em>é«˜å…«ä½(å·¦å£°é“)å’Œä½å…«ä½(å³å£°é“)</em></li></ul></li></ul><p>è¿˜æœ‰ä¸€ä¸ªæ¦‚å¿µ,<strong>æ¯”ç‰¹ç‡</strong>éœ€è¦æˆ‘ä»¬æ³¨æ„:å®ƒæŒ‡çš„æ˜¯æ¯ä¸€ç§’çš„æ¯”ç‰¹æ•°,ç”¨æ¥è¡¡é‡å•ä½æ—¶é—´å†…éŸ³é¢‘æ•°æ®çš„å®¹é‡å¤§å°</p><p>ä¸¾ä¸ªä¾‹å­: ä¸€ä¸ª44.1kHz      åŒå£°é“       16bité‡åŒ–æ ¼å¼</p><pre><code class="java">44100 * 2 * 16 = 1411.2kbps//æŠŠbpsè£…æ¢ä¸ºMB1411.2k / 8 / 1024  =  172Kb/s172 * 60   = 10.08Mb</code></pre><p>PCMå…¶å®ä¸€èˆ¬å¹¶ä¸ç”¨æ¥ç¼–ç ä¼ è¾“,ä»–ç»å¸¸æ˜¯ä½œä¸ºä¸€ä¸ªè£¸æ•°æ®æ¥ä½¿ç”¨çš„,æ²¡æœ‰ç»è¿‡å‹ç¼©çš„.</p><h3 id="éŸ³é¢‘ç¼–ç "><a href="#éŸ³é¢‘ç¼–ç " class="headerlink" title="éŸ³é¢‘ç¼–ç "></a>éŸ³é¢‘ç¼–ç </h3><p>å¸¸è§çš„æ¯”å¦‚<code>PCM</code>,<code>ACC</code>,<code>MP3</code>,<code>WAV</code>ç­‰ç­‰</p><h4 id="WAV"><a href="#WAV" class="headerlink" title="WAV"></a>WAV</h4><p>æˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç”¨è¿™ç§æ ¼å¼æ¥è¿›è¡Œä¼ è¾“,ç»å¸¸æ˜¯ä½œä¸ºæœ¬åœ°æ–‡ä»¶æ¥ä½¿ç”¨çš„.</p><p><strong>ç‰¹ç‚¹</strong>:æ”¯æŒå¹¿æ³›,éŸ³è´¨å¥½</p><p><strong>ç”¨é€”</strong>:ç»å¸¸è¢«ç”¨æ¥åšéŸ³ä¹ç´ æ,ä»¥åŠæˆ‘ä»¬å¼€å‘çš„ä¸­é—´æ–‡ä»¶</p><h4 id="MP3"><a href="#MP3" class="headerlink" title="MP3"></a>MP3</h4><p>MP3æ‹¥æœ‰ä¸é”™çš„å‹ç¼©æ¯”,è¿™ä¹Ÿæ˜¯ä¸€ç§å…¼å®¹éå¸¸å¹¿æ³›ä¸€ç§ç¼–ç æ ¼å¼</p><p><strong>ç‰¹ç‚¹</strong>: éŸ³è´¨åœ¨128Kbit/sä»¥ä¸Šè¡¨ç°çš„è¾ƒä¸ºä¸é”™,å‹ç¼©æ¯”é«˜,å…¼å®¹æ€§å¥½</p><p><strong>ç”¨é€”</strong>:é«˜æ¯”ç‰¹ç‡ä¸‹çš„éŸ³ä¹.</p><h4 id="ACC"><a href="#ACC" class="headerlink" title="ACC"></a>ACC</h4><p>æ–°ä¸€ä»£çš„éŸ³é¢‘å‹ç¼©ç¼–ç æŠ€æœ¯,ä½¿ç”¨äº†æœ‰æŸå‹ç¼©,å¯ä»¥åœ¨128kbit/sçš„é«˜ç ç‡</p>]]></content>
    
    
    <categories>
      
      <category>Media</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Media</tag>
      
      <tag>Audio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>éŸ³è§†é¢‘-å…¥é—¨è·¯å¾„</title>
    <link href="undefined2018/09/01/multimedia-learn/"/>
    <url>2018/09/01/multimedia-learn/</url>
    
    <content type="html"><![CDATA[<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p>é›·ç¥ï¼š</p><blockquote><p><a href="https://blog.csdn.net/column/details/ffmpeg-devel.html" target="_blank" rel="noopener">https://blog.csdn.net/column/details/ffmpeg-devel.html</a>   </p></blockquote><p>googleæä¾›çš„æ–‡æ¡£ï¼š</p><blockquote><p><a href="https://source.android.com/devices/graphics/" target="_blank" rel="noopener">https://source.android.com/devices/graphics/</a></p><p><a href="https://source.android.com/devices/audio" target="_blank" rel="noopener">https://source.android.com/devices/audio</a></p></blockquote><p>Jhusterçš„ä¸“æ </p><blockquote><p><a href="http://blog.51cto.com/ticktick/category15.html" target="_blank" rel="noopener">http://blog.51cto.com/ticktick/category15.html</a></p></blockquote><p>Android éŸ³è§†é¢‘å¼€å‘å­¦ä¹ æ€è·¯</p><blockquote><p><a href="https://www.cnblogs.com/renhui/p/7452572.html" target="_blank" rel="noopener">https://www.cnblogs.com/renhui/p/7452572.html</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Media</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Media</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OkHttpæºç åˆ†æ-WebSocket</title>
    <link href="undefined2018/08/20/okhttp-source-code-websocket/"/>
    <url>2018/08/20/okhttp-source-code-websocket/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>OkHttpå¯ä»¥è¯´æ˜¯Androidä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶,æœ€è¿‘çš„ä¸šåŠ¡éœ€è¦WebSocketçš„åŠŸèƒ½,çœ‹åˆ°æœ‰äººè¯´okhttpå°±å¯ä»¥åšåˆ°äº†,äºæ˜¯æˆ‘æ‰“å¼€äº†æºç ,æœç„¶.</p><pre><code>Okhttp  - internal    - ws    okhttp3.internal.ws.RealWebSocket    okhttp3.internal.ws.WebSocketProtocol    okhttp3.internal.ws.WebSocketReader    okhttp3.internal.ws.WebSocketWriter  okhttp3.WebSocket  okhttp3.WebSocketListener</code></pre><p>é‚£ä¹ˆæ¥ä¸‹æ¥,è®©æˆ‘æ¥ä¸€æ¢ç©¶ç«Ÿ </p><a id="more"></a><h3 id="WebSocketåˆ›å»º"><a href="#WebSocketåˆ›å»º" class="headerlink" title="WebSocketåˆ›å»º"></a>WebSocketåˆ›å»º</h3><p><strong>okhttp3.WebSocket</strong></p><pre><code class="java">public interface WebSocket {  /** Returns the original request that initiated this web socket. */  Request request();  /**   * Returns the size in bytes of all messages enqueued to be transmitted to the server.    */  long queueSize();  /**   * Attempts to enqueue {@code text} to be UTF-8 encoded and sent as a the data of a text (type   */  boolean send(String text);  /**   * Attempts to enqueue {@code bytes} to be sent as a the data of a binary (type {@code 0x2})   * message.   * &lt;p&gt;This method returns immediately.   */  boolean send(ByteString bytes);  boolean close(int code, @Nullable String reason);  /**   * Immediately and violently release resources held by this web socket, discarding any enqueued   * messages. This does nothing if the web socket has already been closed or canceled.   */  void cancel();  interface Factory {    /**     * Creates a new web socket and immediately returns it. Creating a web socket initiates an asynchronous process to connect the socket     */    WebSocket newWebSocket(Request request, WebSocketListener listener);  }}</code></pre><p>å“,,,è¿™æ³¨é‡Šå†™çš„,éƒ½èˆä¸å¾—åˆ äº†.</p><p>å¯ä»¥çœ‹åˆ°,æ¥å£ä¸­çš„æ–¹æ³•åŸºæœ¬ä¸Šéƒ½æ˜¯å¯¹WebSocketçš„æ“ä½œ,å¦‚å‘é€,å…³é—­,å–æ¶ˆ,å¤§å°</p><p>éœ€è¦å…³æ³¨çš„æ˜¯<code>interface Factory</code> ä¸­çš„<code>newWebSocket()</code>æ–¹æ³•,å®ç°åœ¨<code>OkHttpClient</code></p><p><strong>okhttp3.OkHttpClient</strong></p><pre><code class="java">  /**   * Uses {@code request} to connect a new web socket.   */  @Override public WebSocket newWebSocket(Request request, WebSocketListener listener) {    RealWebSocket webSocket = new RealWebSocket(request, listener, new Random(), pingInterval);    webSocket.connect(this);    return webSocket;  }</code></pre><p>å‘ç°æ˜¯ç”±<code>RealWebSocket</code>æ¥åˆ›å»º<code>WebSocket</code>çš„è¿æ¥çš„</p><p>å®ƒæ¥æ”¶äº†ä¸€ä¸ª<code>Request</code>,ä»¥åŠ<code>WebSocketListener</code></p><p>å…¶ä¸­çš„<code>pingInterval</code>æ˜¯å‘é€pingæ¶ˆæ¯çš„æ—¶é—´,æ˜¯ç”±<code>OkhttpClient</code>å»è®¾ç½®çš„.</p><p>æ¥ä¸‹æ¥å…³æ³¨<code>connetc(this)</code>è¿™ä¸ªæ–¹æ³•,æˆ‘ä»¬å»çœ‹çœ‹<code>RealWebSocket</code></p><p><strong>okhttp3.internal.ws.RealWebSocket</strong></p><pre><code class="java">public final class RealWebSocket implements WebSocket, WebSocketReader.FrameCallback {    //public interface FrameCallback {    //    void onReadMessage(String text) throws IOException;    //    void onReadMessage(ByteString bytes) throws IOException;    //    void onReadPing(ByteString buffer);    //    void onReadPong(ByteString buffer);    //    void onReadClose(int code, String reason);      //}}</code></pre><p>å®ç°æ¥å£:</p><ol><li><p>å®ç°äº†<code>WebSocket</code>æ¥å£ä¸­çš„æ–¹æ³•</p></li><li><p>å®ç°<code>WebSocketReader.FrameCallback</code>æ¥å£</p><p>å¯ä»¥çœ‹åˆ°,å…¶ä¸­éƒ½æ˜¯è¯»å–æ•°æ®çš„å›è°ƒ</p></li></ol><p>å±æ€§å­—æ®µ:</p><ol><li><p><code>private final Request originalRequest;</code></p><p>æ˜¯æˆ‘ä»¬åº”ç”¨ä¸­ä¼ è¿‡æ¥çš„åŸå§‹è¯·æ±‚</p></li><li><p><code>final WebSocketListener listener;</code></p><p>è¿™æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„è¿‡ç¨‹ä¸­,æ¯”è¾ƒå…³æ³¨çš„ä¸€ä¸ªç±»,ä»–æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»,ä¸»è¦è´Ÿè´£æŠŠ<code>WebSocket</code>ä¸­çš„é€šä¿¡</p><ul><li><code>onOpen(WebSocket webSocket, Response response)</code></li><li><code>onMessage(WebSocket webSocket, String text)</code></li><li><code>onMessage(WebSocket webSocket, ByteString bytes)</code></li><li><code>onClosing(WebSocket webSocket, int code, String reason)</code></li><li><code>onClosed(WebSocket webSocket, int code, String reason)</code></li><li><code>onFailure(WebSocket webSocket, Throwable t, @Nullable Response response)</code></li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebSocketçš„ä½¿ç”¨ç¬”è®°-ç†è®ºåŸºç¡€</title>
    <link href="undefined2018/08/19/websocket-note/"/>
    <url>2018/08/19/websocket-note/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>WebSocket æ˜¯HTML5ä¸€ç§æ–°çš„webé€šä¿¡æŠ€æœ¯,å®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„å…¨åŒå·¥å®æ—¶é€šä¿¡(full-duplex)</p><p>åœ¨WebSocketä¸­,ç¬¬ä¸€æ¬¡è¿˜æ˜¯é‡‡ç”¨Httpçš„å½¢å¼æ¥é€šçŸ¥æœåŠ¡å™¨,å‡†å¤‡ä½¿ç”¨WebSocketçš„åè®®,è€Œå¦‚æœæœåŠ¡å™¨æ”¯æŒçš„è¯,ä¼šè¿”å›æˆåŠŸçš„é€šçŸ¥<code>101</code>,è€Œåå°±ä¼šé•¿è¿æ¥æ¥è¿›è¡Œå…¨åŒå·¥çš„é€šä¿¡,è€Œä¸æ˜¯<code>Request &amp; Response</code>,æ¯ä¸€æ¬¡è¯·æ±‚å®Œæˆéƒ½æ–­å¼€è¿æ¥.</p><p>å› æ­¤,WebSocketé€šå¸¸æ˜¯ä½¿ç”¨åœ¨æ¨é€,å³æ—¶é€šè®¯,ç­‰ç­‰éœ€è¦å³æ—¶æ€§çš„é€šè®¯éœ€æ±‚.</p><p><strong><a href="https://zh.wikipedia.org/wiki/WebSocket" target="_blank" rel="noopener">Wiki</a> </strong></p><blockquote><p>WebSocket æ˜¯ç‹¬ç«‹çš„ã€åˆ›å»ºåœ¨ TCP ä¸Šçš„åè®®.  WebSocketä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚åœ¨WebSocket APIä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚</p></blockquote><a id="more"></a><h3 id="WebSocketç®€ä»‹"><a href="#WebSocketç®€ä»‹" class="headerlink" title="WebSocketç®€ä»‹"></a>WebSocketç®€ä»‹</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ å›¾:</p><p><img src="/images/websocket-http.png" srcset="/img/loading.gif" alt="websocket-http"></p><p>é¢,å†æ¥ä¸€å¼ :</p><p><img src="/images/websocket-http-duibi.png" srcset="/img/loading.gif" alt="duibi"></p><p>å…ˆè¯´ç¬¬äºŒå¼ å›¾,è¯´æ˜äº†WebSocketä¸Httpçš„å…³ç³»,å…¶å®ä¸¤è€…é™¤äº†éƒ½æ˜¯åŸºäº<code>TCP</code>ä¹‹å¤–è”ç³»å¹¶ä¸å¤§,åªæ˜¯WebSocketçš„ç¬¬ä¸€æ¬¡æ¡æ‰‹ç”³è¯·å‡çº§åè®®çš„æ—¶å€™ä½¿ç”¨äº†Httpçš„è¿æ¥,è€Œåçš„å„ç§è¿æ¥éƒ½æ˜¯ä½¿ç”¨WebSocketçš„.</p><p>å†æ¥è¯´ç¬¬ä¸€å¼ å›¾,ä¸»è¦æ­ç¤ºäº†WebSocketçš„å·¥ä½œæµç¨‹,é€šè¿‡æ¡æ‰‹ååŒæ–¹å¯ç”¨äº†WebSocketé€šä¿¡,è€Œä¹‹åçš„ä¸€ç³»åˆ—æ“ä½œéƒ½æ˜¯WebSocketè‡ªå·±æ¥æ“ä½œçš„.</p><p><strong>WebSocketå®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚</strong></p><pre><code class="xml">GET ws://echo.websocket.org/?encoding=text HTTP/1.1Origin: http://websocket.orgCookie: __utma=99asConnection: UpgradeHost: echo.websocket.orgSec-WebSocket-Key: uRovscZjNol/umbTt5uKmw==Upgrade: websocketSec-WebSocket-Version: 13</code></pre><p>è¿™æ˜¯WebSocketç¬¬ä¸€æ¬¡å‘é€çš„è¯·æ±‚,åªæ”¯æŒGETè¯·æ±‚</p><ul><li>Upgrade ä¸»è¦è¡¨æ˜æˆ‘éœ€è¦å‡çº§åè®®,å…¶åæ ‡æ˜äº†éœ€è¦å‡çº§çš„åè®®ç±»å‹</li><li>Sec-WebSocket-Key  åˆ™æ˜¯WebSocket å®¢æˆ·ç«¯å‘é€çš„ä¸€ä¸ª base64 ç¼–ç çš„å¯†æ–‡,éœ€è¦æœåŠ¡å™¨ç«¯è¿”ä¸€ä¸ªå¯¹åº”åŠ å¯†<code>Sec-WebSocket-Accept</code>åº”ç­”,å¦‚æœä¸åˆæ³•åˆ™æŠ›å‡º<code>Error during WebSocket handshake</code>é”™è¯¯,å¹¶å…³é—­è¿æ¥</li></ul><p><strong>WebSocketæœåŠ¡å™¨è¿”å›</strong></p><pre><code class="xml">HTTP/1.1 101 WebSocket Protocol HandshakeDate: Fri, 10 Feb 2012 17:38:18 GMTConnection: UpgradeServer: Kaazing GatewayUpgrade: WebSocketAccess-Control-Allow-Origin: http://websocket.orgAccess-Control-Allow-Credentials: trueSec-WebSocket-Accept: rLHCkw/SKsO9GAH/ZSFhBATDKrU=Access-Control-Allow-Headers: content-type</code></pre><ul><li>Sec-WebSocket-Keyçš„å†…å®¹åŠ ä¸Šå­—ç¬¦ä¸²258EAFA5-E914-47DA-95CA-C5AB0DC85B11</li><li>ç”Ÿæˆçš„å­—ç¬¦ä¸²è¿›è¡ŒSHA1ç¼–ç </li><li>å†å°†ç”Ÿæˆçš„å­—ç¬¦ä¸²è¿›è¡ŒBase64ç¼–ç </li></ul><h3 id="WebSocketé€šä¿¡"><a href="#WebSocketé€šä¿¡" class="headerlink" title="WebSocketé€šä¿¡"></a>WebSocketé€šä¿¡</h3><p>WebSocketä¸­æ‰€æœ‰æ•°æ®å‡ä½¿ç”¨å¸§çš„å½¢å¼å‘é€ã€‚</p><p>å®¢æˆ·ç«¯å‘é€çš„æ•°æ®å¸§éƒ½è¦ç»è¿‡æ©ç å¤„ç†,æœåŠ¡ç«¯å‘é€çš„æ‰€æœ‰æ•°æ®å¸§éƒ½ä¸èƒ½ç»è¿‡æ©ç å¤„ç†,å¦åˆ™å¯¹æ–¹éœ€è¦å‘é€å…³é—­å¸§ã€‚  ä¸€ä¸ªå¸§åŒ…å«ä¸€ä¸ªå¸§ç±»å‹çš„æ ‡è¯†ç ,ä¸€ä¸ªè´Ÿè½½é•¿åº¦,å’Œè´Ÿè½½(åŒ…æ‹¬æ‰©å±•å†…å®¹å’Œåº”ç”¨å†…å®¹)</p><p><strong>WebSocketæ•°æ®å¸§çš„ç»Ÿä¸€æ ¼å¼</strong></p><pre><code class="xml">  0                   1                   2                   3  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-------+-+-------------+-------------------------------+ |F|R|R|R| opcode|M| Payload len |    Extended payload length    | |I|S|S|S|  (4)  |A|     (7)     |             (16/64)           | |N|V|V|V|       |S|             |   (if payload len==126/127)   | | |1|2|3|       |K|             |                               | +-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - + |     Extended payload length continued, if payload len == 127  | + - - - - - - - - - - - - - - - +-------------------------------+ |                               |Masking-key, if MASK set to 1  | +-------------------------------+-------------------------------+ | Masking-key (continued)       |          Payload Data         | +-------------------------------- - - - - - - - - - - - - - - - + :                     Payload Data continued ...                : + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - + |                     Payload Data continued ...                | +---------------------------------------------------------------+</code></pre><ul><li><p><strong>FIN </strong> 1ä¸ªæ¯”ç‰¹ã€‚</p><p>å¦‚æœæ˜¯1,è¡¨ç¤ºè¿™æ˜¯æ¶ˆæ¯çš„æœ€åä¸€ä¸ªåˆ†ç‰‡,è‹¥æ˜¯0è¡¨ç¤ºä¸æ˜¯æœ€åä¸€ä¸ª</p></li><li><p><strong>RSV1, RSV2, RSV3</strong>å„å 1ä¸ªæ¯”ç‰¹</p><p>è¿™ä¸‰ä¸ªéƒ½æ˜¯ç•™ç€æ‰©å±•ç”¨çš„</p></li><li><p><strong>Opcode</strong> 4ä¸ªæ¯”ç‰¹</p><ul><li><p>0 è¡¨ç¤ºæ­¤å¸§æ˜¯ä¸€ä¸ªç»§ç»­å¸§,éœ€è¦æ‹¼æ¥åœ¨ä¸Šä¸€ä¸ªæ”¶åˆ°çš„å¸§,ç»„æˆä¸€ä¸ªå®Œæ•´çš„æ¶ˆæ¯,æ‰€ä»¥éæ§åˆ¶å¸§çš„å‘é€å’Œæ¥æ”¶å¿…é¡»æ˜¯ç›¸åŒçš„é¡ºåº</p></li><li><p>1 æ–‡æœ¬å¸§</p></li><li><p>2 äºŒè¿›åˆ¶å¸§</p></li><li><p>3 - 7 ä¿ç•™</p></li><li><p>8 å…³é—­è¿æ¥æ§åˆ¶å¸§</p><p>æ­¤å¸§å¯èƒ½ä¼šåŒ…å«å†…å®¹,ä»¥è¡¨ç¤ºå…³é—­è¿æ¥çš„åŸå› ,æ³¨æ„å¿…é¡»æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯æˆå¯¹å‡ºç°,è€Œåå…³é—­é“¾æ¥.</p></li><li><p>9 Ping<br>ç±»ä¼¼äºå¿ƒè·³,æ”¶åˆ°Pingä¹‹ååº”ç«‹å³å‘é€Pongå“åº”</p></li><li><p>10 Pong</p><p>å¦‚æœé€šä¿¡ä¸€æ–¹å¹¶æ²¡æœ‰å‘é€Ping,ä½†æ˜¯æ”¶åˆ°äº†Pong,å¹¶ä¸è¦æ±‚å®ƒè¿”å›ä»»ä½•ä¿¡æ¯</p></li><li><p>11 - 15 ä¿ç•™</p></li></ul></li></ul><ul><li><p><strong>Mask</strong>  1ä¸ªæ¯”ç‰¹</p><p>è¡¨ç¤ºæ˜¯å¦è¦å¯¹æ•°æ®è½½è·è¿›è¡Œæ©ç æ“ä½œ</p></li><li><p><strong>Payload length</strong></p><p>7bit æ•°æ®çš„é•¿åº¦, length == 126 æ—¶,åé¢çš„2 ä¸ªå­—èŠ‚ä¹Ÿæ˜¯è¡¨ç¤ºæ•°æ®é•¿åº¦</p><p>å½“å®ƒ length == 127 æ—¶,åé¢çš„ 8 ä¸ªå­—èŠ‚è¡¨ç¤ºæ•°æ®é•¿åº¦</p></li><li><p><strong>Masking-key</strong> 0æˆ–4å­—èŠ‚</p><p>ä¸»è¦çœ‹Maskçš„å€¼æ¥å†³å®š</p></li><li><p><strong>Payload data</strong>   æ‰©å±•æ•°æ®+åº”ç”¨æ•°æ®</p><p>åº”ç”¨æ•°æ®,åœ¨æ‰©å±•æ•°æ®ä¹‹å,å¸§æ•°æ®çš„å‰©ä½™é•¿åº¦å°±æ˜¯åº”ç”¨æ•°æ®çš„é•¿åº¦.</p></li></ul><h3 id="WebSocketä¿æŒå¿ƒè·³"><a href="#WebSocketä¿æŒå¿ƒè·³" class="headerlink" title="WebSocketä¿æŒå¿ƒè·³"></a>WebSocketä¿æŒå¿ƒè·³</h3><p>WebSocketä¿æŒå®¢æˆ·ç«¯,æœåŠ¡ç«¯çš„å®æ—¶åŒå‘é€šä¿¡,éœ€è¦ç¡®ä¿å®¢æˆ·ç«¯,æœåŠ¡ç«¯ä¹‹é—´çš„TCPè¿æ¥æ²¡æœ‰æ–­å¼€ã€‚</p><p>ä½†æ˜¯åˆä¸èƒ½ä¸€ç›´å»å‘é€æ•°æ®,è¿™æ ·çš„è¯ä¼šæµªè´¹å¤§é‡çš„èµ„æº.</p><p>æ­¤æ—¶å°±æ˜¯å¿ƒè·³æ¥ä¿æŒè¿æ¥:</p><ul><li>å‘é€æ–¹  ping     opcode =  9 </li><li>æ¥æ”¶æ–¹  pong   opcode =  A</li></ul><h3 id="WebSocketçš„ä½¿ç”¨"><a href="#WebSocketçš„ä½¿ç”¨" class="headerlink" title="WebSocketçš„ä½¿ç”¨"></a>WebSocketçš„ä½¿ç”¨</h3><p>è¿™ä¸€éƒ¨åˆ†æˆ‘å‡†å¤‡ç”¨å¦ä¸€ç¯‡ç¬”è®°æ¥è®°å½•</p><h4 id="OkHttp"><a href="#OkHttp" class="headerlink" title="OkHttp"></a>OkHttp</h4><p>è¿™é‡Œå•ç‹¬è¯´ä¸€ä¸‹<code>okhttp</code>,ç«Ÿç„¶æ”¯æŒwebsocketçš„é€šä¿¡åè®®,è€Œä¸”è¿˜æœ‰ä¸€ä¸ªæ‰©å±•æ¨¡å—mockserveræ”¯æŒæµ‹è¯•..ç®€ç›´å®Œç¾</p><blockquote><p>implementation â€œcom.squareup.okhttp3:okhttp:$okhttpVersionâ€</p><p>implementation â€œcom.squareup.okhttp3:mockwebserver:$okhttpVersionâ€</p></blockquote><h4 id="Java-websocket"><a href="#Java-websocket" class="headerlink" title="Java-websocket"></a>Java-websocket</h4><p><a href="https://github.com/TooTallNate/Java-WebSocket" target="_blank" rel="noopener">Java-WebSocket</a>,è¿™æ˜¯ä½¿ç”¨javaæ¥å®ç°çš„WebSocketå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯,ä¹Ÿæ˜¯6çš„é£èµ·.</p><p>é‚£ä¹ˆæˆ‘ä¸‹ä¸€ç¯‡ç¬”è®°ä¸»è¦ä¼šè®°å½•Okhttpçš„ä½¿ç”¨,æˆ–è€…ä¼šåˆ†æä¸€ä¸‹okhttpä¸­å®ç°websocketçš„æºç .</p>]]></content>
    
    
    <categories>
      
      <category>Server</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Server</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MacOSè£…æœºå¿…å¤‡</title>
    <link href="undefined2018/08/17/macos-change-list/"/>
    <url>2018/08/17/macos-change-list/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æ›´æ¢å·¥ä½œçš„æœºå™¨,æ‰€æœ‰çš„ç¯å¢ƒéƒ½è¦å†æ­ä¸€æ¬¡,è¿˜æ˜¯æŒºè‹¦é€¼çš„</p><p>è¿™é‡Œè®°å½•ä¸‹æ¥.</p><a id="more"></a><h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><h4 id="ssh-ç›¸å…³"><a href="#ssh-ç›¸å…³" class="headerlink" title="ssh ç›¸å…³"></a>ssh ç›¸å…³</h4><ul><li>~/.ssh/config é…ç½®ç›®å½•</li><li>~/.ssh/ä¸‹çš„æ‰€æœ‰å…¬é’¥/å¯†é’¥</li></ul><h4 id="brewåŒ…ç®¡ç†"><a href="#brewåŒ…ç®¡ç†" class="headerlink" title="brewåŒ…ç®¡ç†"></a>brewåŒ…ç®¡ç†</h4><ul><li><p>å®‰è£…</p><pre><code class="shell">/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></pre></li></ul><h5 id="List"><a href="#List" class="headerlink" title="List"></a>List</h5><ul><li>brew install htop     //ç³»ç»Ÿç›‘æ§</li><li>brew install hexo    //åšå®¢ç³»ç»Ÿ</li><li>brew install kotlin   //kotlinç¼–è¯‘ç¯å¢ƒ</li><li>brew insatll zsh      //zsh</li><li>brew install vim     //vim</li><li>brew install tree     //tree å·¥å…·</li><li>brew install python3    //py</li><li>brew install polipo  //ç»ˆç«¯çš„ä»£ç†å·¥å…·</li><li>brew install git    //git</li><li>brew install cmake   //cmakeç¼–è¯‘</li><li>brew install hightlight  //é«˜äº®</li><li>brew install autojump   //autojump</li></ul><h4 id="ç»ˆç«¯"><a href="#ç»ˆç«¯" class="headerlink" title="ç»ˆç«¯"></a>ç»ˆç«¯</h4><h5 id="iterm2"><a href="#iterm2" class="headerlink" title="iterm2"></a>iterm2</h5><blockquote><p><a href="https://www.iterm2.com/" target="_blank" rel="noopener">https://www.iterm2.com/</a></p></blockquote><h5 id="go2Shell"><a href="#go2Shell" class="headerlink" title="go2Shell"></a>go2Shell</h5><blockquote><p><a href="http://zipzapmac.com/go2shell" target="_blank" rel="noopener">http://zipzapmac.com/go2shell</a></p></blockquote><h5 id="zsh"><a href="#zsh" class="headerlink" title="zsh"></a>zsh</h5><p>~/.zshrc</p><h4 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h4><pre><code class="shell">ulimit -S -n 1024export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_161.jdk/Contents/Homeexport ANDROID_HOME=/Users/phyooos/Library/Android/sdkexport TOMCAT_HOME=/Users/phyooos/develop/apache-tomcat-7.0.77export GRADLE_USER_HOME=/Users/phyooos/develop/gradleexport MYSQL_HOME=/usr/local/mysql-5.7.18-macos10.12-x86_64export GOROOT=/usr/local/goexport GOPATH=/Users/phyooos/develop/workspaceexport GOBIN=$GOPATH/binexport NDK_HOME=/Users/phyooos/Library/Android/sdk/ndk-bundleexport REPO_URL=&#39;https://mirrors.tuna.tsinghua.edu.cn/git/git-repo/&#39;export SCALA_HOME=/Users/phyooos/develop/scala-2.11.8export MAVEN_HOME=/Users/phyooos/develop/apache-maven-3.5.0export FLUTTER_HOME=/Users/phyooos/develop/flutterexport WEBP_HOME=/Users/phyooos/develop/libwebpexport DART_HOME=/Users/phyooos/develop/flutter/bin/cache/dart-sdkexport PATH=/usr/local/Cellar/gcc/8.1.0/bin:/usr/local/bin:$PATH:$JAVA_HOME/bin:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools:$TOMCAT_HOME/bin:$GRADLE_HOME/bin:$MYSQL_HOME/bin:$GOROOT/bin:$GOPATH:$GOBIN:$GOPATH/bin:$FLUTTER_HOME/bin:$DART_HOME/bin:$MAVEN_HOME/bin:$SCALA_HOME/bin:$NDK_HOME:$WEBP_HOME/bin</code></pre><h3 id="æ–‡ä»¶"><a href="#æ–‡ä»¶" class="headerlink" title="æ–‡ä»¶"></a>æ–‡ä»¶</h3><h4 id="æ¡Œé¢æ–‡ä»¶"><a href="#æ¡Œé¢æ–‡ä»¶" class="headerlink" title="æ¡Œé¢æ–‡ä»¶"></a>æ¡Œé¢æ–‡ä»¶</h4><ul><li>æ–‡ä»¶å¤¹</li></ul><h5 id="Develop"><a href="#Develop" class="headerlink" title="Develop"></a>Develop</h5><ul><li>flutter çš„å®‰è£…</li><li>hexo </li><li>proxyee</li><li>workspace</li></ul><h5 id="å›¾ç‰‡"><a href="#å›¾ç‰‡" class="headerlink" title="å›¾ç‰‡"></a>å›¾ç‰‡</h5><h5 id="å…¬å…±"><a href="#å…¬å…±" class="headerlink" title="å…¬å…±"></a>å…¬å…±</h5><h5 id="éŸ³ä¹"><a href="#éŸ³ä¹" class="headerlink" title="éŸ³ä¹"></a>éŸ³ä¹</h5><h5 id="workspace"><a href="#workspace" class="headerlink" title="workspace"></a>workspace</h5><h3 id="è½¯ä»¶"><a href="#è½¯ä»¶" class="headerlink" title="è½¯ä»¶"></a>è½¯ä»¶</h3><h4 id="ç½‘ç»œé€šè®¯"><a href="#ç½‘ç»œé€šè®¯" class="headerlink" title="ç½‘ç»œé€šè®¯"></a>ç½‘ç»œé€šè®¯</h4><ul><li>Aira2GUI</li><li>Google Chrome</li><li>ShadowsocksX-NG-R8</li><li>LanScan Pro</li><li>Little Snitch Configuration</li><li>Charles</li><li>Foxmail</li><li>å¾®ä¿¡</li><li>QQ</li><li>é’‰é’‰</li><li>Zeplin</li></ul><h4 id="ç³»ç»Ÿå·¥å…·"><a href="#ç³»ç»Ÿå·¥å…·" class="headerlink" title="ç³»ç»Ÿå·¥å…·"></a>ç³»ç»Ÿå·¥å…·</h4><ul><li>Enpass</li><li>æˆªå›¾ - è…¾è®¯</li><li>Dukto</li><li>Bartender 3</li><li>Go2Shell</li><li>Iterm2</li><li>Kaleidoscope</li><li>Cheat Sheet</li><li>TinyPNG4Mac</li><li>Pap.er</li><li>CleanMyMac</li><li>Tuxera Disk Manager</li></ul><h4 id="å¼€å‘å·¥å…·"><a href="#å¼€å‘å·¥å…·" class="headerlink" title="å¼€å‘å·¥å…·"></a>å¼€å‘å·¥å…·</h4><ul><li>Android Studio</li><li>Intellij IDEA</li><li>PyCharm</li><li>Xcode</li><li>Tower</li><li>GoLand</li><li>CodeRunner</li><li>Visual Studio Code</li><li>Postman</li><li>Yummy FTP Pro</li><li>Typora</li><li>æœ‰é“è¯å…¸</li><li>NWeb</li><li>Paw for Trello</li></ul><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><ul><li>MindNode</li><li>IThoughtsX</li><li>Sketch</li><li>Xnip</li><li>ç½‘æ˜“äº‘éŸ³ä¹</li><li>Acorn</li><li>IINA</li><li>PicGIF</li></ul>]]></content>
    
    
    <categories>
      
      <category>Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kotlinå­¦ä¹ ç¬”è®°-é«˜çº§å‡½æ•°</title>
    <link href="undefined2018/08/13/kotlin-learn-advance-fun/"/>
    <url>2018/08/13/kotlin-learn-advance-fun/</url>
    
    <content type="html"><![CDATA[<h3 id="å¸¸ç”¨é«˜çº§å‡½æ•°"><a href="#å¸¸ç”¨é«˜çº§å‡½æ•°" class="headerlink" title="å¸¸ç”¨é«˜çº§å‡½æ•°"></a>å¸¸ç”¨é«˜çº§å‡½æ•°</h3><h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><ul><li><p>ä¸€èˆ¬æ–¹å¼</p><p>```kotlin<br>fun main(args: Array<string>) {</string></p><pre><code>val list = listOf(1,2,3,4,5,6,7)//å‡½æ•°å¼•ç”¨çš„æ–¹å¼intè½¬ä¸ºdoublelist.map(Int::toDouble)val newList = list.map{    //it å°±æ˜¯å½“å‰å…ƒç´     it *2}</code></pre><p>}</p></li></ul><pre><code>  &lt;!--more--&gt;- å¼•ç”¨å‡½æ•°çš„map  ```kotlin  fun main(args: Array&lt;String&gt;) {      val list = listOf(1,2,3,4,5,6,7)      //å‡½æ•°å¼•ç”¨çš„æ–¹å¼intè½¬ä¸ºdouble      list.map(Int::toDouble)  }  //æºç  map  public inline fun &lt;T, R&gt; Iterable&lt;T&gt;.map(transform: (T) -&gt; R): List&lt;R&gt; {      return mapTo(ArrayList&lt;R&gt;(collectionSizeOrDefault(10)), transform)      //ArrayList&lt;R&gt;(collectionSizeOrDefault(10))   åˆå§‹åŒ–ä¸€ä¸ªå’ŒåŸæ¥ä¸€æ ·é•¿çš„list      //transform å°±æ˜¯æˆ‘ä»¬ä¼ è¿›å»çš„å‡½æ•°  }  //æºç  mapTo  //destination  å°±æ˜¯ä¸Šé¢åˆå§‹åŒ–å¥½çš„List  //transform ä¹Ÿæ˜¯ä¸Šé¢ä¼ è¿›æ¥çš„å‡½æ•°,è´Ÿè´£è½¬æ¢  public inline fun &lt;T, R, C : MutableCollection&lt;in R&gt;&gt; Iterable&lt;T&gt;.mapTo(destination: C, transform: (T) -&gt; R): C {      //ä¸€ä¸ªforå¾ªç¯,éå†æ‰€æœ‰å…ƒç´ ,å¹¶è½¬æ¢åæ·»åŠ åˆ°æ–°List      for (item in this)          destination.add(transform(item))      return destination  //è¿”å›List  }</code></pre><h4 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h4><pre><code class="kotlin">fun main(args: Array&lt;String&gt;) {    //ä»¥ä¸Šæ˜¯ä¸€ä¸ªå…ƒç´ ä¸ºæ•°ç»„çš„List    val list = listOf(1..8,9..12,13..27 step 2,28..32)    //å±•å¼€List,å¹¶æŠŠListä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´  + 1    val newList = list.flatMap { intRange -&gt;        intRange.map { item -&gt;            item + 1        }    }    //åŒä¸Š     val newList2 = list.flatMap { it -&gt;        it.map {            it + 1        }    }    // åªæ˜¯å±•å¼€äº†List,å…¶ä»–ä»€ä¹ˆä¹Ÿæ²¡åš    val newList3 = list.flatMap { it -&gt;        it    }}//æºç /** * Returns a single list of all elements yielded from results of [transform] function being invoked on each element of original collection. */public inline fun &lt;T, R&gt; Iterable&lt;T&gt;.flatMap(transform: (T) -&gt; Iterable&lt;R&gt;): List&lt;R&gt; {            //åˆ›å»ºList  , ä¼ å…¥é’ˆå¯¹åŸListä¸­å…ƒç´ çš„è½¬æ¢æ–¹æ³•    return flatMapTo(ArrayList&lt;R&gt;(), transform)}/** * Appends all elements yielded from results of [transform] function being invoked on each element of original collection, to the given [destination]. */public inline fun &lt;T, R, C : MutableCollection&lt;in R&gt;&gt; Iterable&lt;T&gt;.flatMapTo(destination: C, transform: (T) -&gt; Iterable&lt;R&gt;): C {    //éå†åŸæ¥List    for (element in this) {        //æ­¤å¤„çš„transform,è½¬æ¢åŸListä¸­çš„æ¯ä¸€ä¸ªå…ƒç´         val list = transform(element)        destination.addAll(list)    }    //è¿”å›äº†æ–°List    return destination}</code></pre><h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><pre><code class="kotlin">//å®é™…å°±è®¡ç®—äº†æ‰€æœ‰å…ƒç´ çš„å’ŒnewList.reduce { acc, i -&gt;        //acc æ˜¯ä¸Šä¸€æ¬¡è®¡ç®—çš„ç»“æœ        //i æ˜¯å½“å‰çš„å…ƒç´                 acc + i   // è¿™ä¸ªæ˜¯æ“ä½œçš„å‡½æ•°}//æºç /** * Accumulates value starting with the first element and applying [operation] from left to right to current accumulator value and each element. */public inline fun &lt;S, T: S&gt; Iterable&lt;T&gt;.reduce(operation: (acc: S, T) -&gt; S): S {    //è·å–äº†æˆ‘ä»¬çš„è¿­ä»£å¯¹è±¡    val iterator = this.iterator()    //å¦‚æœä¸æ˜¯ç©ºListå°±ç»§ç»­æ‰§è¡Œ    if (!iterator.hasNext()) throw UnsupportedOperationException(&quot;Empty collection can&#39;t be reduced.&quot;)    //å–åˆ°Listçš„ç¬¬ä¸€ä¸ªå…ƒç´     var accumulator: S = iterator.next()    while (iterator.hasNext()) {        //è¿™ä¸€æ­¥å°±æ˜¯æŠŠä¸Šé¢ä¸€ä¸ªè¿›å…¥æ“ä½œçš„ç»“æœå’Œä¸‹ä¸€ä¸ªå…ƒç´ åšäº† operation çš„æ“ä½œ,        //è€Œè¿™ä¸ª operation å°±æ˜¯ä½ ä¼ è¿›æ¥çš„å‡½æ•°        //è®¡ç®—å®Œæ¯•ä¹‹å,åˆæŠŠè®¡ç®—ç»“æœèµ‹ç»™äº† accumulator         accumulator = operation(accumulator, iterator.next())    }    //æœ€åè¿”å›ç»“æœ    return accumulator}eg:val list = listOf(1,2,3,4)val accumulator = list[0] = 1while ( -- ){//ç¬¬ä¸€æ¬¡    1 = 1 + 2 = 3//ç¬¬äºŒæ¬¡    3 = 3 + 3 = 6//ç¬¬ä¸‰æ¬¡    6 = 6 + 6 = 10}return 10</code></pre><h4 id="flod"><a href="#flod" class="headerlink" title="flod"></a>flod</h4><pre><code class="kotlin">//æºç è¡¨ç¤º,åªæ˜¯åˆå§‹å€¼æ˜¯ä½ æŒ‡å®šçš„é‚£ä¸ªå€¼,å…¶ä»–å’Œreduceå·®ä¸å¤šä¸€è‡´çš„æ€è·¯/** * Accumulates value starting with [initial] value and applying [operation] from left to right to current accumulator value and each element. */public inline fun &lt;T, R&gt; Iterable&lt;T&gt;.fold(initial: R, operation: (acc: R, T) -&gt; R): R {    var accumulator = initial    //operation æ“ä½œä¸Šæ¬¡ç»“æ„    for (element in this) accumulator = operation(accumulator, element)    return accumulator}//å­—ç¬¦ä¸²æ‹¼æ¥newList.fold(StringBuffer()){ acc, i -&gt;        acc.append(i).append(&quot;,&quot;)}è¾“å‡º:2,3,4,5,6,7,8,9,10,11,12,13,14,16,18,20,22,24,26,28,29,30,31,32,33,</code></pre><h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>è¿‡æ»¤æ‰ä¸ç¬¦åˆæ¡ä»¶çš„</p><h4 id="takeWhile"><a href="#takeWhile" class="headerlink" title="takeWhile"></a>takeWhile</h4><p>å–ç¬¬ä¸€ä¸ªä¸ç¬¦åˆæ¡ä»¶å…ƒç´ ä¹‹å‰çš„æ‰€æœ‰å…ƒç´ .</p><p>#### </p><h4 id="let"><a href="#let" class="headerlink" title="let"></a>let</h4><p>æœ€å¸¸ç”¨çš„åœºæ™¯å°±æ˜¯ä½¿ç”¨letå‡½æ•°å¤„ç†éœ€è¦é’ˆå¯¹ä¸€ä¸ªå¯nullçš„å¯¹è±¡ç»Ÿä¸€åšåˆ¤ç©ºå¤„ç†</p><pre><code class="kotlin">fun main(args: Array&lt;String&gt;) {    //ä»¥ä¸Šæ˜¯ä¸€ä¸ªå…ƒç´ ä¸ºæ•°ç»„çš„List    val list = listOf(1..8,9..12,13..27 step 2,28..32)    val kc = KotlinClassA()    val per : DataClass? = DataClass(12,&quot;è„‘å£³ç—›&quot;)    per?.copy()    per?.addWhat1(kc)    per?.addWhat2(kc)    per?.addWhat3(kc)    //let    per?.let {        it.copy()        it.addWhat1(kc)        it.addWhat2(kc)        it.addWhat3(kc)    }}//æºç @kotlin.internal.InlineOnlypublic inline fun &lt;T, R&gt; T.let(block: (T) -&gt; R): R {    contract {        callsInPlace(block, InvocationKind.EXACTLY_ONCE)    }    //æŠŠæ¥æ”¶çš„å‚æ•°,ä¼ å…¥äº†æˆ‘ä»¬æä¾›çš„å‡½æ•°ä¸­    return block(this)}</code></pre><h4 id="with"><a href="#with" class="headerlink" title="with"></a>with</h4><p>é€‚ç”¨äºè°ƒç”¨åŒä¸€ä¸ªç±»çš„å¤šä¸ªæ–¹æ³•æ—¶ï¼Œå¯ä»¥çœå»ç±»åé‡å¤ï¼Œç›´æ¥è°ƒç”¨ç±»çš„æ–¹æ³•å³å¯ï¼Œå¦‚Androidä¸­onBinderViewHolderä¸­ï¼Œæ•°æ®modelçš„å±æ€§æ˜ å°„åˆ°UIä¸Š</p><pre><code class="kotlin">@kotlin.internal.InlineOnlypublic inline fun &lt;T, R&gt; with(receiver: T, block: T.() -&gt; R): R {    contract {        callsInPlace(block, InvocationKind.EXACTLY_ONCE)    }    return receiver.block()}//ç”¨æ”¶åˆ°çš„å®ä¾‹å»è°ƒç”¨ blockæ–¹æ³•,è¿”å›å€¼è‡ªå·±å®šä¹‰</code></pre><h4 id="run"><a href="#run" class="headerlink" title="run"></a>run</h4><p>let + with çš„ç»“åˆä½“</p><p>æ—¢å¯ä»¥ç›´æ¥è®¿é—®å®ä¾‹çš„å…¬æœ‰å±æ€§å’Œæ–¹æ³•</p><p>åˆå¼¥è¡¥äº†withå‡½æ•°ä¼ å…¥å¯¹è±¡åˆ¤ç©ºé—®é¢˜</p><pre><code class="kotlin">@kotlin.internal.InlineOnlypublic inline fun &lt;T, R&gt; T.run(block: T.() -&gt; R): R {    contract {        callsInPlace(block, InvocationKind.EXACTLY_ONCE)    }    return block()}</code></pre><h4 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h4><pre><code class="kotlin">@kotlin.internal.InlineOnlypublic inline fun &lt;T&gt; T.apply(block: T.() -&gt; Unit): T {    contract {        callsInPlace(block, InvocationKind.EXACTLY_ONCE)    }    block()    return this}//æ³¨æ„å®ƒè¿”å›çš„æ˜¯this</code></pre><h3 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h3><ul><li>å°±æ˜¯å‡½æ•°çš„è¿è¡Œç¯å¢ƒ</li><li>æŒæœ‰å‡½æ•°çš„è¿è¡ŒçŠ¶æ€</li><li>å‡½æ•°å†…éƒ¨å¯ä»¥å®šä¹‰å‡½æ•°</li><li>å‡½æ•°å†…éƒ¨ä¹Ÿå¯ä»¥å®šä¹‰ç±»</li></ul><pre><code class="kotlin">fun fibonacci(): () -&gt; Long {    var first = 0L    var second = 1L    return fun() : Long{        val result = second        second += first        first = second - first        return result    }}fun main(args: Array&lt;String&gt;) {    val f = fibonacci()    println(f())    println(f())    println(f())    println(f())    println(f())}è¾“å‡º:11235</code></pre><p>æˆ‘ä»¬å‘ç°<code>var first = 0L</code>,<code>var second = 1L</code> è¿™ä¸¤ä¸ªçš„å€¼è¢«ä¿å­˜ä½äº†</p><p>æ¯æ¬¡f() å,firstå’Œ secondéƒ½èƒ½è®°ä½ä»–ä»¬å½“å‰è¢«èµ‹äºˆçš„å€¼</p><h3 id="å¤åˆå‡½æ•°"><a href="#å¤åˆå‡½æ•°" class="headerlink" title="å¤åˆå‡½æ•°"></a>å¤åˆå‡½æ•°</h3><p>è¿™ç®€ç›´å¤ªç§€äº†</p><pre><code class="kotlin">fun add(int: Int) =  int + 1fun multiply(int: Int)  =  int * 2fun &lt;A, B, C&gt; compose(f: (B) -&gt; C, g: (A) -&gt; B) : (A) -&gt; C {    return { x -&gt; f(g(x)) }}fun main(args: Array&lt;String&gt;) {    val addAndMultiply = compose(::add, ::multiply)    println(addAndMultiply(9))  //è¾“å‡º  19}</code></pre><p>### </p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Javaï¼ŒKotlin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kotlinå­¦ä¹ ç¬”è®°-åŸºç¡€</title>
    <link href="undefined2018/08/10/kotlin-learn-note-basic/"/>
    <url>2018/08/10/kotlin-learn-note-basic/</url>
    
    <content type="html"><![CDATA[<h3 id="åŸºæœ¬ç±»å‹"><a href="#åŸºæœ¬ç±»å‹" class="headerlink" title="åŸºæœ¬ç±»å‹"></a>åŸºæœ¬ç±»å‹</h3><h5 id="ä¸ä¼šéšå¼è½¬æ¢"><a href="#ä¸ä¼šéšå¼è½¬æ¢" class="headerlink" title="ä¸ä¼šéšå¼è½¬æ¢"></a>ä¸ä¼šéšå¼è½¬æ¢</h5><pre><code class="kotlin">val a = 123val b : Float = a  //è¿™æ ·æ˜¯ä¸åˆæ³•çš„,ä¸æ”¯æŒéšå¼è½¬æ¢val c : Float = a.toFloat()</code></pre><a id="more"></a><h5 id="å¤šè¡Œ"><a href="#å¤šè¡Œ" class="headerlink" title="å¤šè¡Œ"></a>å¤šè¡Œ</h5><pre><code class="kotlin">val lines = &quot;&quot;&quot;    å¥½äººå•Š.    #/    $a&quot;&quot;&quot;print(lines)</code></pre><p>è¾“å‡ºä¸º</p><pre><code class="kotlin">    å¥½äººå•Š.    #/    123Process finished with exit code 0</code></pre><h3 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h3><h5 id="ç©ºå®‰å…¨"><a href="#ç©ºå®‰å…¨" class="headerlink" title="ç©ºå®‰å…¨"></a>ç©ºå®‰å…¨</h5><pre><code class="kotlin">fun getValue() : String {    return null  //æŠ¥é”™}</code></pre><p>å¦‚æœä½ è¿™ä¹ˆå†™,ä¸€å®šæ˜¯ä¼šæŠ¥é”™çš„,åŸå› æ˜¯  æŒ‡å®šçš„è¿”å›å€¼ <code>String</code> ä¸æ¥å—nullçš„è¿”å›å€¼</p><p>å¦‚æœä½ ä¸€å®šè¦å®ƒå¯ä»¥è¿”å›ä¸€ä¸ªç©ºé‚£å°±åªèƒ½åŠ ä¸€ä¸ª<code>?</code></p><pre><code class="kotlin">fun getValue() : String? {    return null}</code></pre><p>é‚£ä¹ˆä½œä¸ºè°ƒç”¨è€…</p><pre><code class="kotlin">print(getValue()?.length)     //è¾“å‡º  nullprint(getValue()!!.length)      //è¾“å‡º KotlinNullPointerException ,ç›´æ¥å°±ç»™å¹²å´©äº†</code></pre><ul><li><code>?</code> çš„ä½œç”¨æ˜¯,å¦‚æœä¸ºç©ºåˆ™è¾“å‡ºnull  ,å¦‚æœä¸ä¸ºç©ºåˆ™æ­£å¸¸ä½¿ç”¨</li><li><code>!!</code>å–æ¶ˆç©ºå®‰å…¨æœºåˆ¶,å°±å’Œjavaä¸€æ ·äº†</li></ul><h5 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h5><p>å¯¹äºè½¬æ¢å¼‚å¸¸çš„é‚£äº›,å¦‚æœä¸€æ—¦é”™è¯¯å°±ç›´æ¥å¥”æºƒ,æˆ‘ä»¬å¸Œæœ›å®ƒä¸è¦å´©æºƒ,è€Œæ˜¯ä»¥å…¶ä»–çš„æ–¹å¼æ¥è¡¨ç°</p><pre><code class="kotlin">open class Parentclass Child : Parent()fun main(args: Array&lt;String&gt;) {    val parent = Parent()    val child = parent as? Child    //ç„¶è€ŒæŠ›å‡ºäº†ä¸€ä¸ªå¼‚å¸¸  ClassCastException,ç±»å‹è½¬æ¢å¼‚å¸¸    print(child)  }</code></pre><p>é‚£ä¹ˆKotlinå¯¹æ­¤åšäº†ä»€ä¹ˆæ“ä½œ?</p><pre><code class="kotlin">val child = parent as? Childprint(child)   //è¾“å‡º null,è€Œä¸ä¼šç›´æ¥å¥”æºƒ</code></pre><h3 id="åŒºé—´Range"><a href="#åŒºé—´Range" class="headerlink" title="åŒºé—´Range"></a>åŒºé—´Range</h3><ul><li><code>a..b</code> è¿ç®—ç¬¦  [a,b]</li><li><code>a until b</code>  [a,b)</li></ul><pre><code class="kotlin">val range : IntRange  = 1..29</code></pre><h4 id="Range-çš„æ–¹æ³•"><a href="#Range-çš„æ–¹æ³•" class="headerlink" title="Range çš„æ–¹æ³•"></a>Range çš„æ–¹æ³•</h4><ul><li>contains   ä¹Ÿå¯ä»¥ä½¿ç”¨  <code>in</code> è¿ç®—ç¬¦</li><li>isEmpty</li><li>EMPTY   (é™æ€å˜é‡)</li></ul><pre><code class="kotlin">print(range.contains(9))   //  tureprint(99 in range)  // false</code></pre><h4 id="éå†Range"><a href="#éå†Range" class="headerlink" title="éå†Range"></a>éå†Range</h4><pre><code class="kotlin">for (i in range){    print(i)}</code></pre><h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><h4 id="åˆ›å»ºæ•°ç»„"><a href="#åˆ›å»ºæ•°ç»„" class="headerlink" title="åˆ›å»ºæ•°ç»„"></a>åˆ›å»ºæ•°ç»„</h4><pre><code class="kotlin">val intArr: IntArray = intArrayOf(1,2,3,4,5)val charArr: CharArray = charArrayOf(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;)val objArr: Array&lt;Parent&gt; = arrayOf(Parent(&quot;ç‹&quot;),Parent(&quot;è¯›&quot;),Parent(&quot;é­”&quot;))</code></pre><h4 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h4><pre><code class="kotlin">formap iterator...</code></pre><h3 id="val-var-coust"><a href="#val-var-coust" class="headerlink" title="val/var/coust"></a>val/var/coust</h3><p>var   å¯ä»¥ä¿®æ”¹</p><p>val    ä¸å¯ä¿®æ”¹final    <strong>è¿è¡Œæ—¶å¸¸é‡</strong></p><p>const   é™æ€å¸¸é‡         <strong>ç¼–è¯‘æœŸå¸¸é‡</strong></p><h3 id="Lambda"><a href="#Lambda" class="headerlink" title="Lambda"></a>Lambda</h3><pre><code class="kotlin">//ä¸€èˆ¬å†™æ³•fun doSome(a:Int,b:Int) : Int{    return a + b +1}//å¦‚æœåªæœ‰è¿”å›å€¼,å…¶å®å¯ä»¥ç›´æ¥å†™fun doSome(a:Int,b:Int) : Int = a + b +1</code></pre><pre><code class="java">val array  = arrayOf(1,3,4,5,6,7)fun main(args: Array&lt;String&gt;) {    //lambdaè¡¨è¾¾å¼    array.forEach {        print(it)    }    // ::  å¼•ç”¨    array.forEach(::print)    array.forEachIndexed { index, i -&gt;        print(&quot;index = $index , value = $i&quot;)    }}</code></pre><p>æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯,Lambdaä¸­çš„Return</p><pre><code class="kotlin">fun main(args: Array&lt;String&gt;) {    array.forEachIndexed { index, i -&gt;        if (index ==2 ) return        println(&quot;index = $index , value = $i&quot;)    }    print(&quot;Fun End&quot;)}//è¾“å‡º:index = 0 , value = 1index = 1 , value = 3Process finished with exit code 0</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,<code>if (index ==2 ) return</code>ç›´æ¥å°±è¿”å›äº†<code>main</code>çš„æ–¹æ³•</p><p>é‚£ä¹ˆæˆ‘æƒ³è·³å‡º<code>forEachIndexed</code>æ€ä¹ˆåŠ?</p><pre><code class="kotlin">fun main(args: Array&lt;String&gt;) {    array.forEachIndexed JUMP@{ index, i -&gt;        if (index == 2) return@JUMP        println(&quot;index = $index , value = $i&quot;)    }    print(&quot;Fun End&quot;)}//è¾“å‡ºindex = 0 , value = 1index = 1 , value = 3index = 3 , value = 5index = 4 , value = 6index = 5 , value = 7Fun End</code></pre><p>æˆ‘ä»¬å¯ä»¥å‘ç°,index = 2 çš„é‚£ä¸€æ¡æ¶ˆå¤±äº†,å› ä¸ºæˆ‘ä»¬è·³å‡ºäº†æ–¹æ³•,å›åˆ°äº†æˆ‘ä»¬æ ‡è®°çš„åœ°æ–¹ <code>JUMP@</code></p><h3 id="ç±»æˆå‘˜"><a href="#ç±»æˆå‘˜" class="headerlink" title="ç±»æˆå‘˜"></a>ç±»æˆå‘˜</h3><h5 id="é‡å†™é»˜è®¤çš„Get-Setæ–¹æ³•"><a href="#é‡å†™é»˜è®¤çš„Get-Setæ–¹æ³•" class="headerlink" title="é‡å†™é»˜è®¤çš„Get/Setæ–¹æ³•"></a>é‡å†™é»˜è®¤çš„Get/Setæ–¹æ³•</h5><pre><code class="kotlin">class KotlinClassA{    var a = 123        get() {            println(&quot;get a value&quot;)            return field        }        set(value) {            field = value            println(&quot;someone set value&quot;)        }}</code></pre><h5 id="å­—æ®µå»¶è¿Ÿåˆå§‹åŒ–"><a href="#å­—æ®µå»¶è¿Ÿåˆå§‹åŒ–" class="headerlink" title="å­—æ®µå»¶è¿Ÿåˆå§‹åŒ–"></a>å­—æ®µå»¶è¿Ÿåˆå§‹åŒ–</h5><pre><code class="kotlin">class KotlinClassA{    var a = 123        get() {            print(&quot;get a value&quot;)            return field        }        set(value) {            field = value            print(&quot;someone set value&quot;)        }    //varç›´æ¥ä½¿ç”¨lateinitå³å¯    lateinit var b:String    //valçš„åªèƒ½ç”¨ by äº†,lazyè¿”å›ä¸€ä¸ªlambdaè¡¨è¾¾å¼    val c :String by lazy {        print(&quot;lazy init c&quot;)        &quot;666&quot;    }}fun main(args: Array&lt;String&gt;) {    val kot =  KotlinClassA()    println(kot.a)    println(kot.c)}è¾“å‡º:get a value  123lazy init c  666Process finished with exit code 0</code></pre><p>å¯ä»¥çœ‹åˆ°,cæ˜¯åœ¨æˆ‘è°ƒç”¨å®ƒçš„æ—¶å€™,æ‰æ‰“å°äº†<code>lazy init c</code>è¯´æ˜ç¡®å®æ˜¯å»¶è¿ŸåŠ è½½çš„,å¦åˆ™åº”è¯¥æ˜¯<code>KotlinClassA</code>åˆå§‹åŒ–çš„æ—¶å€™å°±åº”è¯¥æ‰“å°è¿™å¥è¯çš„.</p><h3 id="æ“ä½œç¬¦"><a href="#æ“ä½œç¬¦" class="headerlink" title="æ“ä½œç¬¦"></a>æ“ä½œç¬¦</h3><p>åœ¨javaä¸­,æ“ä½œç¬¦çš„ä½œç”¨æ˜¯å›ºå®šçš„,æˆ‘ä»¬æ²¡æœ‰åŠæ³•å»æ”¹å˜å®ƒ</p><p>ä½†æ˜¯åœ¨kotlinä¸­,å…è®¸æˆ‘ä»¬å»è‡ªé‡å†™æ“ä½œç¬¦,åªéœ€è¦ä¿è¯å…¥<strong>å…¥å‚æ•°é‡</strong>ä¸<strong>å‡½æ•°å</strong>ä¸€è‡´å³å¯</p><p><a href="http://kotlinlang.org/docs/reference/operator-overloading.html" target="_blank" rel="noopener">Kotlinç»™å‡ºçš„æ–‡æ¡£</a></p><pre><code class="kotlin">class OperatorClass(val value :Int){    //æ¯”å¦‚æˆ‘æƒ³è®©åŠ æ³•å˜æˆå‡æ³•    operator fun plus(other : OperatorClass):Int{        return value - other.value    }    operator fun plus(other : Int):Int{        return value - other.value    }}fun main(args: Array&lt;String&gt;) {    val opera = OperatorClass(66)    //ä¸¤ä¸ªç±»ç›¸åŠ     print(opera + OperatorClass(6))    print(opera + 10)}è¾“å‡º:6056</code></pre><p>æˆ‘ä¸ä»…ä»…è®©OperatorClassæœ‰äº†åŠ æ³•,è€Œä¸”è¿˜æŠŠåŠ æ³•æ”¹å†™æˆäº†å‡æ³•</p><p>è¿˜æœ‰å¾ˆå¤šçš„æ“ä½œç¬¦æ˜¯å¯ä»¥é‡å†™çš„,çœ‹çœ‹æ–‡æ¡£å°±çŸ¥é“äº†.</p><h3 id="è¡¨è¾¾å¼"><a href="#è¡¨è¾¾å¼" class="headerlink" title="è¡¨è¾¾å¼"></a>è¡¨è¾¾å¼</h3><h5 id="ifè¡¨è¾¾å¼"><a href="#ifè¡¨è¾¾å¼" class="headerlink" title="ifè¡¨è¾¾å¼"></a>ifè¡¨è¾¾å¼</h5><p>kotlinä¸­çš„ifç­‰ç­‰,éƒ½æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼,ä»–æ˜¯å¯ä»¥æœ‰å€¼çš„,æˆ‘ä¸€ç›´æ²¡æœ‰ç†è§£è¿™ä¸ª.</p><p>çœ‹åˆ°è¿™ä¸ªä¾‹å­,æˆ‘æ˜ç™½äº†</p><pre><code class="kotlin">const val DEBUG = 0const val USER = 1const val USER_NAME = &quot;kotlin&quot;const val USER_PASS_WD = &quot;jetBrains&quot;const val ADMIN = &quot;admin&quot;fun main(args: Array&lt;String&gt;) {    //ä½¿ç”¨äº†ifçš„è¿”å›å€¼,æ¯å—ä¸­çš„æœ€åä¸€è¡Œå°±æ˜¯è¿”å›å€¼    val mode = if (args.isNotEmpty() &amp;&amp; args[0] == &quot;0&quot;) {        DEBUG    } else {        USER    }    println(&quot;USER:&quot;)    val user = readLine()    println(&quot;PASSWORD:&quot;)    val passwd = readLine()    if (mode == DEBUG &amp;&amp; user == ADMIN &amp;&amp; passwd == ADMIN) {        println(&quot;Welcome Admin Login.&quot;)    } else if (user == USER_NAME &amp;&amp; passwd == USER_PASS_WD) {        println(&quot;Welcome $user Login.&quot;)    } else {        println(&quot;Error.&quot;)    }}</code></pre><h5 id="Whenè¡¨è¾¾å¼"><a href="#Whenè¡¨è¾¾å¼" class="headerlink" title="Whenè¡¨è¾¾å¼"></a>Whenè¡¨è¾¾å¼</h5><p>whenä¹Ÿå’Œifè¡¨è¾¾å¼ä¸€æ ·,ä½†è¦æ³¨æ„çš„æ˜¯,å¦‚æœæ˜¯è¦ç”¨æ¥èµ‹å€¼,é‚£ä¹ˆelse -&gt; ä¹Ÿéœ€è¦è¿”å›å€¼</p><pre><code class="kotlin">val mode = when{        args.isNotEmpty() &amp;&amp; args[0] == &quot;0&quot; -&gt; 0        else -&gt; 1    }   when (mode){    !is Int -&gt; println(&quot;mode is Int&quot;)    in 0..9 -&gt; println(&quot;$mode in 1..9&quot;)    0 -&gt; println(&quot;mode == 0&quot;)    else -&gt; println(&quot;bye&quot;)}</code></pre><h3 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h3><h5 id="forå¾ªç¯"><a href="#forå¾ªç¯" class="headerlink" title="forå¾ªç¯"></a>forå¾ªç¯</h5><p>åªè¦ä¸€ä¸ªæ•°æ®ç»“æ„å¯è¿­ä»£,å°±å¯ä»¥ä½¿ç”¨è¿™æ ·çš„æ–¹å¼æ¥éå†</p><pre><code class="kotlin">fun main(args: Array&lt;String&gt;) {    for (value in args){        println(value)    }    for ((index,value) in args.withIndex()){        println(&quot;current $index index = $value&quot;)    }    for (valueWithIndex in args.withIndex()){        println(&quot;current ${valueWithIndex.index} index =  ${valueWithIndex.value}&quot;)    }}</code></pre><h5 id="è·³å‡ºå’Œè·³è¿‡"><a href="#è·³å‡ºå’Œè·³è¿‡" class="headerlink" title="è·³å‡ºå’Œè·³è¿‡"></a>è·³å‡ºå’Œè·³è¿‡</h5><pre><code class="kotlin">@LABEL   æ ‡ç­¾breakcontinue</code></pre><h3 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h3><p>è¿™ç©æ„ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼,åˆ«çš„å°±ä¸è¯´äº†</p><h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><h5 id="å¤šä¸ªå‚æ•°"><a href="#å¤šä¸ªå‚æ•°" class="headerlink" title="å¤šä¸ªå‚æ•°"></a>å¤šä¸ªå‚æ•°</h5><pre><code class="kotlin">fun sing(vararg words: String,count :Int){    words.forEach(::println)    println(count)}fun main(args: Array&lt;String&gt;) {    val array = arrayOf(&quot;ds&quot;,&quot;ce&quot;,&quot;lp&quot;)    sing(&quot;abc&quot;,&quot;def&quot;,&quot;zyx&quot;,&quot;opl&quot;,count =  4)    // *Array   å¯ä»¥æŠŠä¸€ä¸ªæ•°ç»„å±•å¼€    sing(*array,count = array.size)}</code></pre><h5 id="é»˜è®¤å€¼"><a href="#é»˜è®¤å€¼" class="headerlink" title="é»˜è®¤å€¼"></a>é»˜è®¤å€¼</h5><pre><code class="kotlin">fun sing(vararg words: String,count :Int = 1000){    words.forEach(::println)    println(count)}fun main(args: Array&lt;String&gt;) {    sing(&quot;12&quot;,&quot;23&quot;,&quot;63&quot;)}</code></pre><p>ä¸‹é¢çš„è°ƒç”¨ä¸­,å¹¶æ²¡æœ‰ä¼ å…¥countçš„å€¼,ä½†æ˜¯å¹¶ä¸ä¼šæŠ¥é”™,å› ä¸ºå‡½æ•°ä¸­æŒ‡å®šcountçš„é»˜è®¤å€¼äº†</p><h3 id="æ¥å£-ç»§æ‰¿"><a href="#æ¥å£-ç»§æ‰¿" class="headerlink" title="æ¥å£/ç»§æ‰¿"></a>æ¥å£/ç»§æ‰¿</h3><pre><code class="kotlin">interface Drive{    fun drive()}interface Fix{    fun fix(){        println(&quot;ç»´ä¿®æŠ€èƒ½&quot;)    }}class CarDrive: Drive{    override fun drive() {        println(&quot;é©¾é©¶æŠ€èƒ½-æ±½è½¦&quot;)    }}class ComputerFix: Fix{    override fun fix() {        super.fix()        println(&quot;ç»´ä¿®æŠ€èƒ½-ä¿®ç”µè„‘&quot;)    }}class Manager : Drive,Fix{    override fun drive() {        println(&quot;ç»ç†å¼€è½¦-å¥¥è¿ªè½¿è½¦&quot;)    }    override fun fix() {        super.fix()        println(&quot;ç»ç†ç»´ä¿®-æ±½è½¦&quot;)    }}class SeniorManager(val drive: Drive,val fix: Fix) : Drive by drive , Fix by fixfun main(args: Array&lt;String&gt;) {    val manager = Manager()    manager.drive()    manager.fix()    val carDrive = CarDrive()    val computerFix = ComputerFix()    val seniorManager = SeniorManager(carDrive,computerFix)    seniorManager.drive()    seniorManager.fix()}</code></pre><ul><li>æ¥å£å¯ä»¥æœ‰é»˜è®¤çš„æ–¹æ³•,ä½†æ˜¯æ²¡æœ‰çŠ¶æ€</li><li><code>Drive by drive , Fix by fix</code> ä»£ç†äº†ç»ç†çš„æŠ€èƒ½.</li></ul><h3 id="é™æ€æ–¹æ³•-JvmStatic"><a href="#é™æ€æ–¹æ³•-JvmStatic" class="headerlink" title="é™æ€æ–¹æ³•/@JvmStatic"></a>é™æ€æ–¹æ³•/@JvmStatic</h3><pre><code class="kotlin">class Pay private constructor(val money : Double){    companion object {        fun toPay(v : Double): Pay{            return Pay(v)        }        // JvmStaticæ³¨è§£çš„,å¯ä»¥åœ¨Javaä¸­åƒé™æ€æ–¹æ³•ä¸€æ ·è°ƒç”¨        @JvmStatic        fun copyPay(p : Pay) : Pay{            return Pay(p.money)        }    }}kotlin:    val pay = Pay.toPay(10.93)    val pay2 = Pay.copyPay(pay)Java:    //æ­£å¸¸çš„è°ƒç”¨,å¿…é¡»ä½¿ç”¨ Companion ä¼´ç”Ÿå¯¹è±¡    Pay pay = Pay.Companion.toPay(123.8);    Pay pay2 = Pay.copyPay(pay);</code></pre>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Javaï¼ŒKotlin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Glide4.Xç‰ˆæœ¬å›¾ç‰‡åŠ è½½æ˜¾ç¤ºè¿›åº¦</title>
    <link href="undefined2018/08/09/glide-okhttp-progress/"/>
    <url>2018/08/09/glide-okhttp-progress/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Glideæ— ç–‘æ˜¯ä¸€æ¬¾éå¸¸ä¼˜ç§€çš„å›¾ç‰‡åŠ è½½æ¡†æ¶,ä½†æ˜¯ä»–å¹¶æ²¡æœ‰æ”¯æŒæ˜¾ç¤ºå›¾ç‰‡åŠ è½½çš„è¿›åº¦.</p><p>é‚£ä¹ˆæˆ‘ä»¬é‡åˆ°è¿™ç§éœ€æ±‚çš„æ—¶å€™åº”è¯¥æ€ä¹ˆåŠ?è‡ªå·±å†™ä¸€ä¸ªå›¾ç‰‡åŠ è½½æ¡†æ¶ä¹ˆ?</p><p>ä¸,æˆ‘ä»¬è‚¯å®šæ˜¯é€‰æ‹©è‡ªå·±æ¥æ‰©å±•è¿™ä¸ªæ¡†æ¶,ä½¿å¾—Glideâ€æ”¯æŒâ€æ˜¾ç¤ºè¿›åº¦</p><p><strong>GlideImageView</strong>  ç”¨æ¥æ§åˆ¶start &amp; autoStart , ç”¨æ¥æ˜¾ç¤º progress , error</p><p><strong>OkHttp</strong>  ç”¨æ¥æ”¯æŒè¿›åº¦çš„å›è°ƒ</p><a id="more"></a><h3 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p>ä¸ºä»€ä¹ˆæˆ‘è¦é€‰æ‹©ä½¿ç”¨OkHttpæ¥æ”¹é€ é‚£?</p><pre><code class="java">@Override    public void registerComponents(Context context, Glide glide, Registry registry) {        registry.replace(GlideUrl.class, InputStream.class, new OkHttpUrlLoader.Factory());    }</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,ModelLoaderFactoryæ˜¯æˆ‘ä»¬è‡ªå·±ä¼ è¿›å»çš„,é‚£ä¹ˆæˆ‘åªè¦æŒæœ‰è¿™ä¸ªModelLoaderFactoryä¸å°±å¯ä»¥çŸ¥é“è¿›åº¦äº†ä¹ˆ?</p><p>è¿½è¸ªæºç å‘ç°äº†åˆå§‹åŒ–OkHttpClientçš„æ–¹æ³•,internalClient æ˜¯Call.Factoryç±»å‹çš„,è€ŒOkHttpClientæ˜¯Call.Factoryçš„å®ç°ç±».</p><pre><code class="java">    /**     * Constructor for a new Factory that runs requests using a static singleton client.     */    public Factory() {      this(getInternalClient());    }    /**     * Constructor for a new Factory that runs requests using given client.     *     * @param client this is typically an instance of {@code OkHttpClient}.     *      * çœ‹åˆ°è¿™ä¸ªæœ‰å‚çš„æ„é€ å‡½æ•°äº†ä¹ˆ?è¿˜æ˜¯Publicçš„..     */    public Factory(@NonNull Call.Factory client) {      this.client = client;    }private static Call.Factory getInternalClient() {      if (internalClient == null) {        synchronized (Factory.class) {          if (internalClient == null) {            internalClient = new OkHttpClient();          }        }      }      return internalClient;}</code></pre><p>é‚£ä¹ˆ,å¯ä»¥ç¡®å®šæ›¿æ¢OkHttpClientçš„æ€è·¯æ˜¯æ­£ç¡®çš„,ä¸‹é¢æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹</p><p><img src="/images/glide_okhttp_progress.png" srcset="/img/loading.gif" alt="glide-okhttp"></p><ul><li><p>OkHttpLoadImage  æä¾›OkHttpClientå¹¶æ·»åŠ æ‹¦æˆªå™¨</p><ul><li>OnProgressListener  ç”±éœ€è¦æ˜¾ç¤ºè¿›åº¦çš„Viewå®ç°,æä¾›ä¸€ä¸ªUrl,å›è°ƒprogress</li><li>OkHttpClient çš„å®ä¾‹</li><li>HashMap<string,onprogresslistener>  å®é™…ä¸Šå­˜æ”¾çš„æ˜¯Viewè‡ªå·±</string,onprogresslistener></li></ul></li><li><p>ProgressResponseBody  å¯¹å¤–æä¾›å½“å‰ä¸‹è½½çš„è¿›åº¦</p></li><li><p>LoadImageView  è®°å½•å½“å‰url,æ˜¾ç¤ºè¿›åº¦</p></li><li><p>GlideLoaderModule @GlideModule</p><p>é€šè¿‡<code>new OkHttpUrlLoader.Factory(OkHttpLoadImage.INSTANCE())</code>æ›¿ä»£é»˜è®¤çš„OkHttpClient</p></li></ul><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><h4 id="OkHttpLoadImage"><a href="#OkHttpLoadImage" class="headerlink" title="OkHttpLoadImage"></a>OkHttpLoadImage</h4><p>è¯¥ç±»æä¾›ä¸€ä¸ªOkHttpClientçš„å®ä¾‹,åœ¨è¿™ä¸ªå®ä¾‹ä¸­æ·»åŠ ä¸€ä¸ªNetworkInterceptor,è¿™ä¸ªæ‹¦æˆªå™¨æä¾›å½“å‰ä¸‹è½½çš„è¿›åº¦</p><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/8/9 ä¸‹åˆ6:10 */public final class OkHttpLoadImage {    //ä¸€å®šè¦è®°å¾—unRegister,è¿™é‡Œå­˜æ”¾çš„æ˜¯keyä»¥åŠOnProgressListener    //å®é™…ä¸Š,æˆ‘ä»¬æœ€å¥½é‡‡ç”¨è½¯å¼•ç”¨,è¿™æ ·æ›´åŠ çš„å®‰å…¨,æ¯•ç«Ÿæˆ‘ä»¬æ— æ³•æ„ŸçŸ¥Viewçš„ç”Ÿå‘½å‘¨æœŸ    private static HashMap&lt;String, OnProgressListener&gt; progressListenerMap;    //æ·»åŠ äº†æ‹¦æˆªçš„OkHttpClient    private OkHttpClient okHttpClient;    static {        progressListenerMap = new HashMap&lt;&gt;();    }    private OkHttpLoadImage() {        initOkHttp();    }    /**     * æ„å»ºä¸€ä¸ªOkHttpçš„å®ä¾‹     * ProgressResponseBody æ˜¯ä¸€ä¸ªæ¯”è¾ƒå…³é”®çš„ç±»,ä»–æä¾›äº†è¿›åº¦     */    private void initOkHttp() {        okHttpClient = new OkHttpClient.Builder()                .addNetworkInterceptor(chain -&gt; {                    Request request = chain.request();                    Response response = chain.proceed(request);                    ProgressResponseBody body = new ProgressResponseBody(response, request.url().toString());                    //æ·»åŠ ç›‘å¬,ä½¿å¾—å½“å‰ç±»çŸ¥é“è¿›åº¦                    body.addOnResponseListener(responseListener);                    return response.newBuilder()                            .body(body)                            .build();                })                .build();    }    private static class SingletonHolder {        private static OkHttpLoadImage instance = new OkHttpLoadImage();    }    public static OkHttpClient INSTANCE(){        return SingletonHolder.instance.okHttpClient;    }    private static ProgressResponseBody.OnResponseListener responseListener = new ProgressResponseBody.OnResponseListener() {        @Override        public void update(String key, float progress) {            //å»å¯»æ‰¾è¿™ä¸ªkeyï¼Œå¹¶ä¼ å›å»å½“å‰çš„è¿›åº¦            OnProgressListener listener = progressListenerMap.get(key);            if (listener != null) {                listener.onProgress(progress);            }        }    };    /**     * æ³¨å†Œè¿›åº¦çš„å›è°ƒ     */    public static void register(OnProgressListener listener) {        //å¯èƒ½ä¼šæœ‰å¤šä¸ªViewæ³¨å†Œï¼Œä½†æ˜¯æˆ‘ä»¬åªå›è°ƒå½“å‰è¿™ä¸ª        progressListenerMap.put(listener.getKey(), listener);    }    /**     * å–æ¶ˆç›‘å¬     *     * @param listener view     */    public static void unRegister(OnProgressListener listener) {        progressListenerMap.remove(listener.getKey());    }    /**     * ç›‘å¬è¿›åº¦çš„æ¥å£     */    public interface OnProgressListener {        //å›è°ƒå½“å‰çš„è¿›åº¦ç»™View        void onProgress(float progress);        //è·å–å½“å‰Viewèµ„æºçš„key(URLå³å¯)        String getKey();    }}</code></pre><h4 id="ProgressResponseBody"><a href="#ProgressResponseBody" class="headerlink" title="ProgressResponseBody"></a>ProgressResponseBody</h4><p>è¿™ä¸ªä¸œè¥¿,ç½‘ä¸Šåˆ°å¤„éƒ½æ˜¯</p><pre><code class="java">public class ProgressResponseBody extends ResponseBody{    //OkHttpLoadImageä¸­ä¼ è¿›æ¥çš„response    private final ResponseBody responseBody;    private String url;    private BufferedSource bufferedSource;    public ProgressResponseBody(Response response,String url) {        this.responseBody = response.body();        this.url = url;    }    @Override    public MediaType contentType() {        return responseBody.contentType();    }    @Override    public long contentLength() {        return responseBody.contentLength();    }    @Override    public BufferedSource source() {        if (bufferedSource == null) {            bufferedSource = Okio.buffer(source(responseBody.source()));        }        return bufferedSource;    }    private Source source(BufferedSource source) {        return new ForwardingSource(source) {            long totalBytes = 0L;            @Override            public long read(Buffer sink, long byteCount) throws IOException {                long bytesRead = super.read(sink, byteCount);                // read() returns the number of bytes read, or -1 if this source is exhausted.                totalBytes += bytesRead != -1 ? bytesRead : 0;                if (listener != null) {                    //æ³¨æ„è¿™å—çš„ 1.0 *  , è¦ä¸ä¸¤ä¸ªlongé™¤æ³•ä¼šä¸€ç›´æ˜¯ 0                     listener.update(url, (float) 1.0 * totalBytes/contentLength());                }                return bytesRead;            }        };    }    private OnResponseListener listener;    public void addOnResponseListener(OnResponseListener listener){        this.listener = listener;    }    public interface OnResponseListener{        void update(String key,float progress);    }}</code></pre><h4 id="LoadImageView"><a href="#LoadImageView" class="headerlink" title="LoadImageView"></a>LoadImageView</h4><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/8/9 ä¸‹åˆ5:59 */public class LoadImageView extends AppCompatImageView implements OkHttpLoadImage.OnProgressListener{    private Paint mPaint;    private float progress;    private String url;    public LoadImageView(Context context) {        this(context,null);    }    public LoadImageView(Context context, @Nullable AttributeSet attrs) {        this(context, attrs,0);    }    public LoadImageView(Context context, AttributeSet attrs, int defStyleAttr) {        super(context, attrs, defStyleAttr);        init();    }    public void setImageUrl(String url){        this.url = url;        //æ­¤æ—¶å¼€å§‹åŠ è½½        OkHttpLoadImage.register(this);        ImageLoader.LoaderImg(getContext(),url).into(this);        Glide.with(this).load(url).into(this);    }    /**     * åˆå§‹åŒ–å·¥å…·     */    private void init() {       mPaint = new Paint();       mPaint.setColor(Color.BLACK);       mPaint.setAntiAlias(true);       mPaint.setStrokeWidth(5);       mPaint.setTextSize(50);    }    @SuppressLint(&quot;DefaultLocale&quot;)    @Override    protected void onDraw(Canvas canvas) {        super.onDraw(canvas);        canvas.drawText(String.format(&quot;Already : %d&quot;,(int)(100 * progress)),100,100,mPaint);    }    public void progress(float progress){        this.progress = progress;        invalidate();    }    @Override    public void onProgress(float progress) {        post(() -&gt; progress(progress));    }    @Override    public String getKey() {        return url;    }    public boolean isLoaded(){        return progress == 1F;    }}</code></pre><h4 id="GlideLoaderModule"><a href="#GlideLoaderModule" class="headerlink" title="GlideLoaderModule"></a>GlideLoaderModule</h4><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2017/8/9 ä¸‹åˆ12:16 * */@GlideModulepublic final class GlideLoaderModule extends AppGlideModule {    @Override    public void applyOptions(Context context, GlideBuilder builder) {        RequestOptions options  = new RequestOptions()                .centerCrop()                .placeholder(R.drawable.default_images_load)                .error(R.drawable.default_images_load)                .priority(Priority.HIGH)                .format(DecodeFormat.PREFER_ARGB_8888)                .diskCacheStrategy(DiskCacheStrategy.ALL);        int maxMemory = (int) Runtime.getRuntime().maxMemory();        int memoryCacheSize = maxMemory / 8;        //è®¾ç½®å†…å­˜ç¼“å­˜å¤§å°        File cacheDir = new File(ApiConstants.INSTANCE.getIMAGE_PATH() + File.separator);        if(!cacheDir.exists()){            cacheDir.mkdirs();        }        int diskCacheSize = 1024 * 1024 * 512;        //è®¾ç½®ç£ç›˜ç¼“å­˜å¤§å°        builder.setMemoryCache(new LruResourceCache(memoryCacheSize));        builder.setDiskCache(new DiskLruCacheFactory(cacheDir.getPath(), &quot;Images&quot;, diskCacheSize));        builder.setDefaultRequestOptions(options);    }    @Override    public void registerComponents(Context context, Glide glide, Registry registry) {        registry.replace(GlideUrl.class, InputStream.class,                new OkHttpUrlLoader.Factory(OkHttpLoadImage.INSTANCE()));    }}</code></pre><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p><img src="/images/glide_progress_image.gif" srcset="/img/loading.gif" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>View</tag>
      
      <tag>Glide</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Glide4.Xç‰ˆæœ¬çš„åŸºæœ¬ä½¿ç”¨</title>
    <link href="undefined2018/08/09/glide-4-note/"/>
    <url>2018/08/09/glide-4-note/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Glideæ˜¯ä¸€æ¬¾æ€§èƒ½ä¼˜å¼‚,åŒ…å¤§å°ä¸­ç­‰,åŠ è½½é€Ÿåº¦å¿«çš„å›¾ç‰‡åŠ è½½å·¥å…·,ä¹Ÿæ˜¯Googleæ¨èä½¿ç”¨çš„åŠ è½½æ¡†æ¶ä¹‹ä¸€.</p><p>åœ¨ä»¥å‰çš„å·¥ç¨‹ä¸­,æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨3.8ç‰ˆæœ¬ä¸€ä¸‹çš„Glide,è€Œåœ¨4.Xç‰ˆæœ¬ä¸­,Glideçš„ä½¿ç”¨æ–¹å¼å‘ç”Ÿäº†ä¸€äº›å˜åŒ–,æ‰€ä»¥ä»Šå¤©ç‰¹æ„å†™äº†ç¬”è®°æ¥è®°å½•,ä»¥ä¾¿äºä»¥åä½¿ç”¨æ—¶æŸ¥é˜…</p><h4 id="åœ°å€"><a href="#åœ°å€" class="headerlink" title="åœ°å€"></a>åœ°å€</h4><blockquote><p>Glide:   <a href="https://github.com/bumptech/glide" target="_blank" rel="noopener">https://github.com/bumptech/glide</a></p></blockquote><a id="more"></a><h4 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–:"></a>ä¾èµ–:</h4><pre><code class="groovy">implementation (&quot;com.github.bumptech.glide:glide:4.7.1&quot;) {    exclude group: &quot;com.android.support&quot;}annotationProcessor &quot;com.github.bumptech.glide:compiler:4.7.1&quot;//kotlinä½¿ç”¨kapt// kapt &#39;com.github.bumptech.glide:compiler:4.7.1&#39;    //å¦‚æœä½ éœ€è¦ä½¿ç”¨okhttpä½œä¸ºç½‘ç»œå±‚implementation &quot;com.github.bumptech.glide:okhttp3-integration:4.7.1&quot;</code></pre><h4 id="æ··æ·†-proguard"><a href="#æ··æ·†-proguard" class="headerlink" title="æ··æ·†(proguard):"></a>æ··æ·†(proguard):</h4><pre><code class="xml">-keep public class * implements com.bumptech.glide.module.GlideModule-keep public class * extends com.bumptech.glide.module.AppGlideModule-keep public enum com.bumptech.glide.load.resource.bitmap.ImageHeaderParser$** {  **[] $VALUES;  public *;}# for DexGuard only-keepresourcexmlelements manifest/application/meta-data@value=GlideModule</code></pre><h3 id="å¼€å§‹ä½¿ç”¨"><a href="#å¼€å§‹ä½¿ç”¨" class="headerlink" title="å¼€å§‹ä½¿ç”¨"></a>å¼€å§‹ä½¿ç”¨</h3><h4 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h4><p>ç»§æ‰¿ AppGlideModule</p><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/8/9 ä¸‹åˆ12:16 */@GlideModulepublic class GlideLoaderModule extends AppGlideModule {    @Override    public void applyOptions(Context context, GlideBuilder builder) {        RequestOptions options  = new RequestOptions()                .centerCrop()                .placeholder(R.drawable.default_images_load)                .error(R.drawable.default_images_load)                .priority(Priority.HIGH)                .format(DecodeFormat.PREFER_ARGB_8888)                .diskCacheStrategy(DiskCacheStrategy.ALL);        int maxMemory = (int) Runtime.getRuntime().maxMemory();        int memoryCacheSize = maxMemory / 8;        //è®¾ç½®å†…å­˜ç¼“å­˜å¤§å°        File cacheDir = new File(ApiConstants.INSTANCE.getIMAGE_PATH() + File.separator);        if(!cacheDir.exists()){            cacheDir.mkdirs();        }        int diskCacheSize = 1024 * 1024 * 512;        //è®¾ç½®ç£ç›˜ç¼“å­˜å¤§å°        builder.setMemoryCache(new LruResourceCache(memoryCacheSize));        builder.setDiskCache(new DiskLruCacheFactory(cacheDir.getPath(), &quot;Images&quot;, diskCacheSize));        builder.setDefaultRequestOptions(options);    }    @Override    public void registerComponents(Context context, Glide glide, Registry registry) {        registry.replace(GlideUrl.class, InputStream.class, new OkHttpUrlLoader.Factory());    }}</code></pre><p>æ³¨æ„,<code>GlideLoaderModule</code>åœ¨4.Xç‰ˆæœ¬ä¹‹å,ä¸éœ€è¦å†™åˆ°Manifestæ–‡ä»¶ä¸­å»,ä½†æ˜¯éœ€è¦ä½ æ·»åŠ <code>@GlideModule</code>æ³¨è§£</p><p>æ³¨æ„,<code>GlideLoaderModule</code>åœ¨4.Xç‰ˆæœ¬ä¹‹å,ä¸éœ€è¦å†™åˆ°Manifestæ–‡ä»¶ä¸­å»,ä½†æ˜¯éœ€è¦ä½ æ·»åŠ <code>@GlideModule</code>æ³¨è§£</p><h4 id="å ä½ç¬¦"><a href="#å ä½ç¬¦" class="headerlink" title="å ä½ç¬¦"></a>å ä½ç¬¦</h4><ul><li><p><a href="https://muyangmin.github.io/glide-docs-cn/javadocs/400/com/bumptech/glide/request/RequestOptions.html#placeholder-int-" target="_blank" rel="noopener">placeholder</a></p><ul><li><p>å ä½ç¬¦æ˜¯å½“è¯·æ±‚æ­£åœ¨æ‰§è¡Œæ—¶è¢«å±•ç¤ºçš„ Drawable,å½“è¯·æ±‚æˆåŠŸå®Œæˆæ—¶,å ä½ç¬¦ä¼šè¢«è¯·æ±‚åˆ°çš„èµ„æºæ›¿</p></li><li><p>å¦‚æœèµ„æºæ˜¯ä»å†…å­˜ä¸­åŠ è½½å‡ºæ¥çš„ï¼Œé‚£ä¹ˆå ä½ç¬¦å¯èƒ½æ ¹æœ¬ä¸ä¼šè¢«æ˜¾ç¤º</p></li><li>å¦‚æœè¯·æ±‚å¤±è´¥å¹¶ä¸”æ²¡æœ‰è®¾ç½® <code>error Drawable</code> ï¼Œåˆ™å ä½ç¬¦å°†è¢«æŒç»­å±•ç¤º</li></ul></li><li><p><a href="https://muyangmin.github.io/glide-docs-cn/javadocs/400/com/bumptech/glide/request/RequestOptions.html#error-int-" target="_blank" rel="noopener">error</a></p><ul><li>åœ¨è¯·æ±‚æ°¸ä¹…æ€§å¤±è´¥æ—¶å±•ç¤º</li><li>ä¹Ÿåœ¨è¯·æ±‚çš„url/modelä¸º <code>null</code> ï¼Œä¸”å¹¶æ²¡æœ‰è®¾ç½® <code>fallback Drawable</code> æ—¶å±•ç¤º</li></ul></li><li><p><a href="https://muyangmin.github.io/glide-docs-cn/javadocs/400/com/bumptech/glide/request/RequestOptions.html#fallback-int-" target="_blank" rel="noopener">fallback</a></p><ul><li>åœ¨è¯·æ±‚çš„url/modelä¸º <code>null</code> æ—¶å±•ç¤º(æ³¨æ„,null).   ä¼šè¦†ç›–<code>error</code>çš„ç¬¬äºŒæ¡æ˜¾ç¤ºæ¡ä»¶</li></ul></li></ul><h4 id="Transform-åœ†è§’"><a href="#Transform-åœ†è§’" class="headerlink" title="Transform(åœ†è§’)"></a>Transform(åœ†è§’)</h4><p>å˜æ¢è¿™å—,åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†</p><h5 id="é»˜è®¤å˜æ¢"><a href="#é»˜è®¤å˜æ¢" class="headerlink" title="é»˜è®¤å˜æ¢"></a>é»˜è®¤å˜æ¢</h5><ul><li><a href="https://muyangmin.github.io/glide-docs-cn/javadocs/400/com/bumptech/glide/load/resource/bitmap/CenterCrop.html" target="_blank" rel="noopener">CenterCrop</a></li><li><a href="https://muyangmin.github.io/glide-docs-cn/javadocs/400/com/bumptech/glide/load/resource/bitmap/FitCenter.html" target="_blank" rel="noopener">FitCenter</a></li><li><a href="https://muyangmin.github.io/glide-docs-cn/javadocs/400/com/bumptech/glide/load/resource/bitmap/CircleCrop.html" target="_blank" rel="noopener">CircleCrop</a></li></ul><h5 id="å¤šé‡å˜æ¢"><a href="#å¤šé‡å˜æ¢" class="headerlink" title="å¤šé‡å˜æ¢"></a>å¤šé‡å˜æ¢</h5><p>ä½¿ç”¨<code>transform</code>æ–¹æ³•</p><ul><li><p>æ–¹å¼ä¸€</p><pre><code class="java">Glide.with(context)  .load(url)  .transform(new MultiTransformation(new FitCenter(), new CustomTransformation())  .into(imageView);</code></pre></li><li><p>æ–¹å¼äºŒ</p><pre><code class="java">GlideApp.with(context)  .load(url)  .transforms(new FitCenter(), new CustomTransformation())  .into(imageView);</code></pre></li></ul><h5 id="è‡ªå®šä¹‰å˜æ¢"><a href="#è‡ªå®šä¹‰å˜æ¢" class="headerlink" title="è‡ªå®šä¹‰å˜æ¢()"></a>è‡ªå®šä¹‰å˜æ¢()</h5><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/11/2 ä¸Šåˆ12:20 * åœ†è§’å›¾ç‰‡ */public class GlideRoundTransform extends BitmapTransformation {    private static final String ID = &quot;com.wangzhumo.app.commonlib.utils.GlideRoundTransform&quot;;    private static float radius = 0f;    public GlideRoundTransform() {        this(5);    }    /**     * åœ†è§’åƒç´      * @param dp     */    public GlideRoundTransform(int dp) {        radius = Resources.getSystem().getDisplayMetrics().density * dp;    }    @Override    protected Bitmap transform(@NonNull BitmapPool pool, @NonNull Bitmap toTransform, int outWidth, int outHeight) {        return roundCrop(pool, toTransform);    }    private static Bitmap roundCrop(BitmapPool pool, Bitmap source) {        if (source == null) return null;        Bitmap result = pool.get(source.getWidth(), source.getHeight(), Bitmap.Config.ARGB_8888);        Canvas canvas = new Canvas(result);        Paint paint = new Paint();        paint.setShader(new BitmapShader(source, BitmapShader.TileMode.CLAMP, BitmapShader.TileMode.CLAMP));        paint.setAntiAlias(true);        RectF rectF = new RectF(0f, 0f, source.getWidth(), source.getHeight());        canvas.drawRoundRect(rectF, radius, radius, paint);        return result;    }    @Override    public boolean equals(Object o) {        return o instanceof GlideRoundTransform;    }    @Override    public int hashCode() {        return ID.hashCode();    }    @Override    public void updateDiskCacheKey(MessageDigest messageDigest) {        messageDigest.update(ID.getBytes());    }}</code></pre><p>å…¶ä¸­<code>equals()</code>,<code>hashCode()</code>,<code>updateDiskCacheKey</code>ä¸»è¦æ˜¯ä¸ºäº†ç¼“å­˜å’Œå­˜å‚¨çš„æ­£å¸¸å·¥ä½œ</p><h4 id="GlideExtension-æ‰©å±•API"><a href="#GlideExtension-æ‰©å±•API" class="headerlink" title="GlideExtension(æ‰©å±•API)"></a>GlideExtension(æ‰©å±•API)</h4><h5 id="GlideOption"><a href="#GlideOption" class="headerlink" title="GlideOption"></a>GlideOption</h5><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/8/9 ä¸‹åˆ2:57 * æ”¯æŒå¿«æ·ä½¿ç”¨åœ†è§’å›¾ç‰‡ */@GlideExtensionpublic final class RoundGlideExtension {    private RoundGlideExtension(){ }    /**     * ç»™urlæ·»åŠ å‚æ•°     * @param options RequestOptions     */    @GlideOption    public static void round(RequestOptions options,int corner){        options.transform(new GlideRoundTransform(corner));    }    /**     * ç»™urlæ·»åŠ å‚æ•°     * @param options RequestOptions     */    @GlideOption    public static void round(RequestOptions options){        options.transform(new GlideRoundTransform());    }}</code></pre><ol><li>æ·»åŠ <code>@GlideExtension</code>æ³¨è§£</li><li>ç§æœ‰æ„é€ </li><li>é™æ€æ–¹æ³•,ä»¥åŠ<code>@GlideOption</code>æ³¨è§£</li></ol><pre><code class="java">//é€šè¿‡GlideApp.with(context).load(url).apply(options).round();// orGlideApp.with(context).load(url).apply(options).round(corner);//æ¥åŠ è½½åœ†è§’å›¾ç‰‡</code></pre><h5 id="GlideType"><a href="#GlideType" class="headerlink" title="GlideType"></a>GlideType</h5><p>å…è®¸ä½ æ·»åŠ å¯¹æ–°çš„èµ„æºç±»å‹çš„æ”¯æŒï¼ŒåŒ…æ‹¬æŒ‡å®šé»˜è®¤é€‰é¡¹ã€‚</p><p>æš‚æ—¶æ²¡æœ‰ä½¿ç”¨.</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä¸‹ä¸€æœŸ,æˆ‘ä»¬åšä¸€ä¸ªå¸¦è¿›åº¦æ¡çš„å›¾ç‰‡åŠ è½½.</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidä¸­ä½¿ç”¨æ³¨è§£ç¬”è®°</title>
    <link href="undefined2018/08/09/annotation-simple-note/"/>
    <url>2018/08/09/annotation-simple-note/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>@Override å°±æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„æ³¨è§£.</p><ol><li>æ£€æŸ¥æ˜¯å¦æ­£ç¡®çš„å¤å†™çˆ¶ç±»æ–¹æ³•</li><li>æ ‡å¿—æ˜¯é‡å†™æ–¹æ³•</li></ol><p><strong>å…ƒæ³¨è§£</strong></p><p>å…ƒæ³¨è§£æ˜¯,é¢,å—¯ æ³¨è§£çš„æ³¨è§£</p><ul><li>@Retentionï¼šæ³¨è§£ç”Ÿå‘½å‘¨æœŸ</li><li>@Targetï¼šä½œç”¨èŒƒå›´</li><li>@Inheritedï¼šæ ‡æ˜æ‰€ä¿®é¥°çš„æ³¨è§£ç±»å‹æ˜¯è¢«ç»§æ‰¿çš„,å­ç±»ä¼šç»§æ‰¿è¿™ä¸ªæ³¨è§£</li><li>@Documentedï¼šjavadoc</li></ul><p>è¿™äº›éƒ½æ˜¯ç”±Javaè¯­è¨€æœ¬èº«æä¾›çš„æœ€åŸºç¡€çš„æ³¨è§£,ä»–ä»¬è´Ÿè´£æ³¨è§£å…¶ä»–çš„æ³¨è§£,å…·ä½“çš„ä½œç”¨è§ä¸Šæ–‡</p><a id="more"></a><h3 id="è‡ªå®šä¹‰æ³¨è§£"><a href="#è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="è‡ªå®šä¹‰æ³¨è§£"></a>è‡ªå®šä¹‰æ³¨è§£</h3><h4 id="è¿è¡Œæ—¶æ³¨è§£-RUNTIME"><a href="#è¿è¡Œæ—¶æ³¨è§£-RUNTIME" class="headerlink" title="è¿è¡Œæ—¶æ³¨è§£(RUNTIME)"></a>è¿è¡Œæ—¶æ³¨è§£(RUNTIME)</h4><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/8/9 ä¸Šåˆ10:50 *  * æ ‡è®°å­—æ®µä¸ºimageUrl,å›¾ç‰‡åœ°å€ */@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.FIELD)public @interface ImageUrl {    String error() default &quot;http://wangzhumo.com/css/images/avatar.png&quot;;}/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/8/9 ä¸Šåˆ10:48 *  * æ ‡è®°å­—æ®µä¸ºContent,å†…å®¹ */@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.FIELD)public @interface Content {}</code></pre><p>@ImageUrl  ä¸ @Content  ä¸­éƒ½æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•,è¿™é‡Œåªæ˜¯ä½¿ç”¨æ ‡è®°çš„åŠŸèƒ½</p><p>ä¸ºäº†ä½“ç°æ ‡è®°çš„ä½œç”¨</p><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/8/9 ä¸Šåˆ10:47 */public class Whatever {    public String haha;    //çå†™çš„å­—æ®µå,æ ‡è®°ä¸ºæ­£æ–‡    @Content    public String aaaa;    //çå†™çš„å­—æ®µå,æ ‡è®°ä¸ºå›¾ç‰‡åœ°å€    @ImageUrl(error = &quot;http://wangzhumo.com/images/java_heap_stack.png&quot;)    public String bajkfhajks;    public String waht;     /**     * è‡ªåŠ¨ç”Ÿäº§     *     * @return List     */    public static List&lt;Whatever&gt; create() {        List&lt;Whatever&gt; whatever = new ArrayList&lt;&gt;();        for (int i = 0; i &lt; 10; i++){            //å¼€å§‹å»ºç«‹            if (i==3){                whatever.add(new Whatever(String.format(Locale.CHINA,&quot;ç¬¬%dä¸ªé¡¹ç›®&quot;,i),&quot;&quot;));            }else{                whatever.add(new Whatever(String.format(Locale.CHINA,&quot;ç¬¬%dä¸ªé¡¹ç›®&quot;,i),&quot;http://wangzhumo.com/css/images/avatar.png&quot;));            }        }        return whatever;    }}</code></pre><p>åœ¨RecyclerViewä¸­ä½¿ç”¨</p><p>com.wangzhumo.playground.SimpleAdapter#onBindViewHolder</p><pre><code class="java">@Overridepublic void onBindViewHolder(@NonNull ViewHolder holder, int position) {    try {        for (Field field : getItem(position).getClass().getDeclaredFields()) {            field.setAccessible(true);            if (field.isAnnotationPresent(Content.class)) {                holder.bindView.setContext((String) field.get(getItem(position)));            } else if (field.isAnnotationPresent(ImageUrl.class)) {                String imageUrl = (String) field.get(getItem(position));                if (TextUtils.isEmpty(imageUrl)) {                    ImageUrl url = field.getAnnotation(ImageUrl.class);                    holder.bindView.setImageUrl(url.error());                }else{                    holder.bindView.setImageUrl(imageUrl);                }            }        }    } catch (IllegalAccessException e) {        e.printStackTrace();    }}</code></pre><p><code>TextUtils.isEmpty(imageUrl)</code>ç®€å•çš„åˆ¤æ–­,æ˜¯å¦è®¾ç½®äº†å€¼,å¦‚æœå®ƒæ²¡æœ‰å€¼,é‚£å°±ç›´æ¥ä½¿ç”¨ url.error() ä¸­è®¾ç½®çš„å€¼</p><p><img src="/images/annotation_image_error.png" srcset="/img/loading.gif" alt="image_error"></p><p>åœ¨ç”Ÿæˆæ•°æ®æ—¶,æˆ‘ç»™ç¬¬4ä¸ªä½ç½®çš„å›¾ç‰‡è®¾ç½®äº†<code>&quot;&quot;</code>ç©ºå€¼,åˆ™è¿™é‡Œç›´æ¥æ˜¾ç¤ºäº†æˆ‘ @ImageUrl( error = â€œxxxxxâ€)ä¸­è®¾ç½®çš„å›¾ç‰‡</p><p>å¦‚æœæˆ‘æ”¹é€ ä¸€ä¸‹,è®¾ç½®GlideApp.with(imageUrl  ).error(@ImageUrl.error()) å¯ä»¥æˆä¸ºä¸€ä¸ªå¾ˆå®ç”¨çš„æ–¹æ³•</p><h4 id="ç¼–è¯‘æ—¶æ³¨è§£-CLASS"><a href="#ç¼–è¯‘æ—¶æ³¨è§£-CLASS" class="headerlink" title="ç¼–è¯‘æ—¶æ³¨è§£(CLASS)"></a>ç¼–è¯‘æ—¶æ³¨è§£(CLASS)</h4><p>å¯¹äºæˆ‘ä¸ªäººæ¥è¯´,åŸºæœ¬ä¸Šæ²¡æœ‰è¿™æ ·çš„éœ€è¦,ä½†æ˜¯å¦‚<code>Dagger2</code> ä½¿ç”¨ç¼–è¯‘æ—¶æ³¨è§£ + APT å®ç°ä¾èµ–æ³¨å…¥</p><p>å…¶ä»–å¦‚<code>ARouter</code>,<code>BufferKnike</code>,<code>Glide</code>ä¹Ÿä¼šä½¿ç”¨è¿™æ ·çš„æŠ€æœ¯.</p><p>å¦‚Glide</p><pre><code class="java">package com.bumptech.glide.annotation.compiler;  //public final class GlideAnnotationProcessor extends AbstractProcessor{      @Override    public synchronized void init(ProcessingEnvironment processingEnvironment) {         super.init(processingEnvironment);        //...          //ä¸»è¦æ˜¯åˆå§‹åŒ–ä¸€äº›å·¥å…·ç±»å•Šä»€ä¹ˆçš„      }      @Override      public Set&lt;String&gt; getSupportedAnnotationTypes() {        //...        //è¯¥æ–¹æ³•ä¸­è¿”å›æ‰€æœ‰æ³¨è§£çš„ç±»        }      @Override      public SourceVersion getSupportedSourceVersion() {        return SourceVersion.latestSupported();      }      @Override      public boolean process(Set&lt;? extends TypeElement&gt; set, RoundEnvironment env) {        //...        //è¿™é‡Œæ˜¯é‡è¦çš„éƒ¨åˆ†,é€šè¿‡æ³¨é‡Šæˆ‘ä»¬å°±èƒ½çŸ¥é“å®ƒå¤§æ¦‚åšä»€ä¹ˆäº†      }}</code></pre><ol><li><p>éå†å¾—åˆ°éœ€è¦è§£æçš„å…ƒç´ åˆ—è¡¨</p></li><li><p>åˆ¤æ–­ç¬¦åˆè¦æ±‚çš„å…ƒç´ </p></li><li><p>ä¿®æ”¹,æ•´ç†è¾“å‡ºå‚æ•°,æˆ–è€…å€ŸåŠ©APTç”Ÿäº§ä»£ç ç­‰</p></li></ol><p>å¦‚æœä½ å¯¹è¿™éƒ¨åˆ†æ„Ÿå…´è¶£,ä¸å¦¨é€‰ä¸€ä¸ªåº“çœ‹çœ‹</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode-ç½—é©¬æ•°å­—è½¬æ•´æ•°</title>
    <link href="undefined2018/08/06/roman-to-integer/"/>
    <url>2018/08/06/roman-to-integer/</url>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªç½—é©¬æ•°å­—ï¼Œå°†å…¶è½¬æ¢æˆæ•´æ•°ã€‚è¾“å…¥ç¡®ä¿åœ¨ 1 åˆ° 3999 çš„èŒƒå›´å†…ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><pre><code>è¾“å…¥: &quot;III&quot;è¾“å‡º: 3</code></pre><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>è¿™ä¸€é¢˜å…¶å®ä¸åœ¨äºç®—æ³•æœ‰å¤šéš¾,è€Œæ˜¯åœ¨äºä½ å¯¹äºè¿™ä¸ªç½—é©¬æ•°å­—ä¸æ•´å½¢ä¹‹é—´çš„å…³ç³»è¦ææ¸…æ¥š</p><table><thead><tr><th>åŸºæœ¬å­—ç¬¦</th><th>I</th><th>V</th><th>X</th><th>L</th><th>C</th><th>D</th><th>M</th></tr></thead><tbody><tr><td>ç›¸åº”çš„é˜¿æ‹‰ä¼¯æ•°å­—è¡¨ç¤ºä¸º</td><td>1</td><td>5</td><td>10</td><td>50</td><td>100</td><td>500</td><td>1000</td></tr></tbody></table><p>ä¸Šé¢æ˜¯ä»–ä»¬ä¹‹é—´çš„å¯¹åº”å…³ç³»,ä½†æ˜¯è¿™è¿˜ä¸å¤Ÿ(ä»¥ä¸‹æ¥è‡ªç™¾åº¦ç™¾ç§‘)</p><a id="more"></a><ol><li>ç›¸åŒçš„æ•°å­—è¿å†™ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºè¿™äº›æ•°å­—ç›¸åŠ å¾—åˆ°çš„æ•°,å¦‚:â…¢ = 3</li><li>å°çš„æ•°å­—åœ¨å¤§çš„æ•°å­—çš„å³è¾¹ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºè¿™äº›æ•°å­—ç›¸åŠ å¾—åˆ°çš„æ•°, å¦‚:â…§ = 8; â…« = 12</li><li>å°çš„æ•°å­—,(é™äºâ… ã€X å’ŒC)åœ¨å¤§çš„æ•°å­—çš„å·¦è¾¹ï¼Œæ‰€è¡¨ç¤ºçš„æ•°ç­‰äºå¤§æ•°å‡å°æ•°å¾—åˆ°çš„æ•°,å¦‚:â…£= 4; â…¨= 9</li><li>æ­£å¸¸ä½¿ç”¨æ—¶,è¿å†™çš„æ•°å­—é‡å¤ä¸å¾—è¶…è¿‡ä¸‰æ¬¡</li><li>åœ¨ä¸€ä¸ªæ•°çš„ä¸Šé¢ç”»ä¸€æ¡æ¨ªçº¿,è¡¨ç¤ºè¿™ä¸ªæ•°æ‰©å¤§1000å€</li></ol><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ul><li>éœ€è¦ä¸€ä¸ªé”®å€¼å¯¹æ¥ä¿å­˜ç½—é©¬æ•°å­—ä¸æ•´å½¢çš„å…³ç³»</li><li>éå†,å¹¶æ¯”è¾ƒå‰ä¸€ä¸ªç½—é©¬å­—ç¬¦ä¸å½“å‰ç½—é©¬å­—ç¬¦çš„å¤§å°<ul><li>å½“å‰ç½—é©¬å­—ç¬¦æ›´å¤§,åˆ™+=</li><li>å½“å‰å°,åˆ™-=</li></ul></li><li>è¾“å‡ºç»“æœ</li></ul><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/8/7 ä¸‹åˆ5:41 * ç»™å®šä¸€ä¸ªç½—é©¬æ•°å­—ï¼Œå°†å…¶è½¬æ¢æˆæ•´æ•°ã€‚è¾“å…¥ç¡®ä¿åœ¨ 1 åˆ° 3999 çš„èŒƒå›´å†…ã€‚ * * ç¤ºä¾‹ 1: * * è¾“å…¥: &quot;III&quot; * è¾“å‡º: 3 * */public class RomanToIntClass {    private static HashMap&lt;Character, Integer&gt; contrastMap;    static {        contrastMap = new HashMap&lt;&gt;();        contrastMap.put(&#39;I&#39;, 1);        contrastMap.put(&#39;V&#39;, 5);        contrastMap.put(&#39;X&#39;, 10);        contrastMap.put(&#39;L&#39;, 50);        contrastMap.put(&#39;C&#39;, 100);        contrastMap.put(&#39;D&#39;, 500);        contrastMap.put(&#39;M&#39;, 1000);    }    /**     * ç½—é©¬è½¬æ•´å½¢     * @param romanStr ç½—é©¬å­—ç¬¦ä¸²     * @return æ•´æ•°     */    public static int romanToInt(String romanStr){        char[] romanCharArray = romanStr.toCharArray();        int result = 0;        for (int i = 0; i &lt; romanCharArray.length; i++) {            //éå†è¿™ä¸ªç½—é©¬æ•°ç»„            if (i == romanCharArray.length -1 || contrastMap.get(romanCharArray[i+1]) &lt;= contrastMap.get(romanCharArray[i])){                //å¦‚æœæ»¡è¶³,è¯´æ˜å½“å‰çš„è¿™ä¸ªç½—é©¬å­—ç¬¦æ˜¯å¤§äºåä¸€ä¸ªç½—é©¬æ•°å­—çš„,åˆ™åº”è¯¥åŠ ä¸Šå½“å‰çš„ç½—é©¬å­—ç¬¦                result += contrastMap.get(romanCharArray[i]);            }else{                //åˆ™æ˜¯å‰é¢å°,åé¢å¤§,åº”è¯¥å‡å»å½“å‰çš„è¿™ä¸ªç½—é©¬å­—ç¬¦                result -= contrastMap.get(romanCharArray[i]);            }        }        return result;    }}</code></pre><h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><pre><code class="shell">è¾“å…¥:  MCMXCIVè¾“å‡º: 1994Process finished with exit code 0</code></pre>]]></content>
    
    
    <categories>
      
      <category>Programme</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Programme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®—æ³•å¤ä¹ ç¬”è®°-å¿«é€Ÿæ’åº</title>
    <link href="undefined2018/07/31/Arithmetic-quick-sort/"/>
    <url>2018/07/31/Arithmetic-quick-sort/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>é€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†,å…¶ä¸­ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½æ¯”å¦å¤–ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°,ç„¶åå†æŒ‰æ­¤æ–¹æ³•å¯¹è¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åº,æ•´ä¸ªæ’åºè¿‡ç¨‹å¯ä»¥é€’å½’è¿›è¡Œ,ä»¥æ­¤è¾¾åˆ°æ•´ä¸ªæ•°æ®å˜æˆæœ‰åºåºåˆ—ã€‚ </p><p>å¿«é€Ÿæ’åºç”± C. A. R. Hoareï¼ˆä¸œå°¼éœå°”ï¼ŒCharles Antony Richard Hoareï¼‰åœ¨1960å¹´æå‡º .è€Œåç»è¿‡å¾ˆå¤šäºº,å¾ˆé•¿æ—¶é—´çš„ä¼˜åŒ–,æ‰å¾—åˆ°ç°åœ¨çš„ç‰ˆæœ¬.å¿«é€Ÿæ’åºå¯ä»¥è¯´æ˜¯ä¸€ä¸ªè‡³å…³é‡è¦çš„ç®—æ³•äº†,ç°åœ¨çš„å¾ˆå¤šè¯­è¨€åŸºç¡€åº“ä¸­çš„æ’åº,å°±æ˜¯ä½¿ç”¨çš„å¿«é€Ÿæ’åºç®—æ³•æ¥å®Œæˆçš„.</p><p><img src="/images/quick_sort.png" srcset="/img/loading.gif" alt="quick_sort"></p><a id="more"></a><h3 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p>è¿™é‡Œæˆ‘æ‰“ç®—ä½¿ç”¨å‰åæŒ‡é’ˆçš„æ–¹æ³•æ¥å®Œæˆå¿«é€Ÿæ’åº.å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆ,ä¸€ä¸ªcurræŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ,è€ŒpreæŒ‡å‘çš„æ˜¯curr-1çš„ä½ç½®.</p><ol><li>å®šä¹‰currä»¥åŠpreä¸¤ä¸ªæŒ‡é’ˆ</li><li>å½“array[curr] &lt; key åˆ™currä¸preæŒ‡é’ˆåŒæ—¶å‘åç§»åŠ¨</li><li>å½“array[curr] &gt; key åˆ™currå‘åç§»åŠ¨ä¸€ä½,preä¿æŒä¸åŠ¨(å½“å‰è¿™ä¸ªä½ç½®çš„å€¼æ˜¯å°äºkeyçš„)</li><li>å½“array[curr] &lt; key åˆ™éœ€è¦äº¤æ¢array[curr]ä»¥åŠarray[pre]  </li></ol><p>å¯ä»¥è¿™ä¹ˆè¯´,æ¯æ¬¡æ‰¾åˆ°array[curr] è¿™ä¸ªä½ç½®çš„å…ƒç´ æ¯”keyè¦å°,è¯´æ˜å®ƒä¸åº”è¯¥åœ¨å½“å‰çš„è¿™ä¸ªä½ç½®,éœ€è¦å’Œpreçš„ä½ç½®å…ƒç´ äº¤æ¢,åº”ä¸ºpreä¸€ç›´æ˜¯æŒ‡å‘äº†æœ€åä¸€ä¸ªå°äºkeyçš„å…ƒç´ ä½ç½®</p><p>çœ‹ä¸Šå›¾æ‰€ç¤º,åºå·5çš„è¿™ä¸€æ’,æˆ‘ç”¨æ¡†åˆ†å‡ºäº†ä¸‰ä¸ªéƒ¨åˆ†.</p><ul><li>ç»¿è‰²åŒºåŸŸ[0,pre]  éƒ½æ˜¯å°äºkeyçš„</li><li>çº¢è‰²åŒºåŸŸ[pre+1,curr)éƒ½æ˜¯å¤§äºkeyçš„</li><li>è€Œæ©™è‰²çš„åŒºåŸŸ[curr,right]éƒ½æ˜¯æ²¡æœ‰ç»è¿‡æ¯”è¾ƒçš„åŒºåŸŸ</li></ul><p>é‚£ä¹ˆå¾ˆå®¹æ˜“å°±å¯ä»¥çœ‹å‡º,å…¶å®æˆ‘ä»¬å°±æ˜¯æƒ³è®©è¿™ä¸ªæ•°ç»„,ä»¥preä¸ºåˆ†ç•Œç‚¹,å·¦é¢çš„éƒ½å°äºkey,è€Œå³é¢çš„éƒ½å¤§äº</p><p>é‚£ä¹ˆ,åªè¦å‘ç°array[curr] &lt; key ç›´æ¥å’Œarray[pre+1]äº¤æ¢ä½ç½®,è¿˜æ˜¯æ»¡è¶³ä¸Šé¢çš„è¦æ±‚çš„.</p><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/7/31 ä¸‹åˆ5:54 * å¿«é€Ÿæ’åº[left,right) */public class QuickClass{    //ä¸ºäº†ç»™åˆ†å‰²æ•°ç»„çš„æ–¹æ³•ä½¿ç”¨,ç”¨äºé€‰å‡ºä¸€ä¸ªkey    private static Random mRandom = new Random(System.currentTimeMillis());    /**     * å¿«é€Ÿæ’åºå…¥å£-å‰åæŒ‡é’ˆ     *     * @param array è¦æ’åºçš„æ•°ç»„     * @param left  å·¦è¾¹ç•Œ     * @param right å³è¾¹ç•Œ     */    public static void quickSort(int[] array, int left, int right) {        //å¦‚æœleft &gt;= rightäº†,è¯´æ˜è¿™ä¸ªæ•°ç»„å·²ç»ä¸èƒ½å†ç»§ç»­åˆ†äº†        if (left &gt;= right) return;        //æ­¤å¤„æ‰¾åˆ°è¿™ä¸ªp,åˆ†å‰²ç‚¹,éœ€è¦ç»è¿‡ä¸€è½®çš„å¿«é€Ÿæ’åº        int p = partition(array, left, right);        //é€’å½’è°ƒç”¨        quickSort(array, left, p);        quickSort(array, p + 1, right);    }    /**     * åˆ†å‰²æ•°ç»„     * æ’åºarray[left , right] çš„é¡ºåº     * ä½¿å¾—è¿”å›ä¸€ä¸ªp ,åœ¨ array[left,p] éƒ½å°äºk  åœ¨array[p+1 , right)éƒ½å¤§äºk     *     * @param array è¦æ’åºçš„æ•°ç»„     * @param left  å·¦è¾¹è¾¹ç•Œ     * @param right å³è¾¹è¾¹ç•Œ     * @return p åˆ†å‰²äº†ä¸¤ä¸ªæ•°ç»„çš„ä½ç½®     */    private static int partition(int[] array, int left, int right) {        //éšæœºæ›¿æ¢ä¸€ä¸ªå…ƒç´ åˆ°keyçš„ä½ç½®,è¿™æ˜¯ä¸ºäº†é¿å…å¦‚æœæ’åˆ—ä¸€ä¸ªè¿‘ä¹æœ‰åºçš„æ•°ç»„æ—¶,        //é€ æˆä¸€ä¾§çš„å­æ•°ç»„ç‰¹å¤š,è€Œå¦ä¸€ä¾§åˆ™å¾ˆå°‘,ä½¿å¾—æ•ˆç‡é™ä½        swap(array,left,mRandom.nextInt(right - left + 1) + left);        //æ‹¿å‡ºkey        int key = array[left];        //å®šä¹‰ä¸€ä¸ªpreç­‰äºcurr-1        //ä¸ºä»€ä¹ˆç›´æ¥èµ‹å€¼ä¸ºlefté‚£?å› ä¸ºleftæ˜¯æˆ‘keyçš„ä½ç½®,        //å¯ä»¥ç›´æ¥ä¸ç”¨æ¯”è¾ƒ,curr = pre+1å³æ˜¯ç¬¬ä¸€ä¸ªè¦æ¯”è¾ƒçš„å…ƒç´         int pre = left;        for(int curr = pre+1;curr &lt;= right;curr++){            //æ­¤æ—¶åˆ¤æ–­ array[curr] ä¸ keyçš„å…³ç³»å³å¯            if(array[curr] &lt; key){                swap(array,curr, ++pre);                            }        }        //å®Œæˆåéœ€è¦æŠŠkeyå…ƒç´ ç§»åŠ¨åˆ°preçš„ä½ç½®å»        swap(array,left,pre);        return pre;    }    /**     * äº¤æ¢ä½ç½®     *     * @param arr æ•°ç»„     * @param a     * @param b     */    private static void swap(int[] arr, int a, int b) {        int temp = arr[a];        arr[a] = arr[b];        arr[b] = temp;    } }</code></pre><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™è¿˜åªæ˜¯å¿«é€Ÿæ’åºçš„æœ€ç®€å•æ–¹æ³•,è¿˜æœ‰æ›´ä¸ºå¤æ‚ä¸€äº›çš„ä¸‰è·¯å¿«æ’ç­‰,åé¢ç»§ç»­å­¦ä¹ </p><p>æµ‹è¯•æ‰“å°:</p><pre><code class="shell">1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21</code></pre>]]></content>
    
    
    <categories>
      
      <category>Programme</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Programme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®—æ³•å¤ä¹ ç¬”è®°-å½’å¹¶æ’åº</title>
    <link href="undefined2018/07/31/Arithmetic-merge-sort/"/>
    <url>2018/07/31/Arithmetic-merge-sort/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å½’å¹¶æ’åºå¯ä»¥è¯´æ˜¯ä¸€ä¸ªç»å…¸çš„ä½¿ç”¨åˆ†æ²»æ€ç»´çš„æ’åºç®—æ³•äº†.</p><p>å…ˆæŠŠé—®é¢˜<strong>åˆ†</strong>ä¸ºä¸€äº›å°çš„é—®é¢˜ç„¶åé€’å½’æ±‚è§£,è€Œä½¿ç”¨<strong>æ²»</strong>çš„æ€æƒ³æŠŠåˆ†é˜¶æ®µæ±‚å¾—çš„ç­”æ¡ˆåˆå¹¶åœ¨ä¸€èµ·.</p><p>é¦–å…ˆæˆ‘å¾—æ¥ä¸€å¼ å›¾è¯´æ˜è¿™ä¸ªäº‹:</p><p><img src="/images/merge_sort.png" srcset="/img/loading.gif" alt="merge"></p><a id="more"></a><p>ä¸Šå›¾æ˜¾ç¤ºäº†ä¸€ä¸ªè¾“å…¥æ•°ç»„è¢«åˆ†è§£çš„è¿‡ç¨‹,ä¸‹é¢åªè¦æˆ‘ä»¬èƒ½ç»™ä»–åˆå¹¶èµ·æ¥å°±å¯ä»¥å®Œæˆè¿™æ˜¯è¾“å…¥æ•°ç»„çš„æ’åºäº†</p><h3 id="åˆå¹¶æ€è·¯"><a href="#åˆå¹¶æ€è·¯" class="headerlink" title="åˆå¹¶æ€è·¯"></a>åˆå¹¶æ€è·¯</h3><p>åˆå¹¶çš„æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸´æ—¶æ•°ç»„çš„å¸®åŠ©,è¿™ä¸ªä¸´æ—¶æ•°ç»„çš„å¤§å°åº”è¯¥æ˜¯ä¸è¾“å…¥æ•°ç»„çš„å¤§å°ä¸€è‡´çš„.</p><p><code>int[] array,int left,int mid,int right,int [] tempArray</code></p><p>éœ€è¦ä¼ å…¥  éœ€è¦æ’åºçš„æ•°ç»„,å·¦æ•°ç»„çš„å·¦è¾¹ç•Œ, å·¦æ•°ç»„çš„å³è¾¹ç•Œ  ,å³æ•°ç»„å³è¾¹ç•Œ,ä¸´æ—¶æ•°ç»„</p><ol><li><p>éå†å·¦å³æ•°ç»„,ç›´è‡³ä¸¤ä¸ªæ•°ç»„è‡³å°‘æœ‰ä¸€ä¸ªæ•°ç»„å…¨éƒ¨éå†ä¸€æ¬¡</p><p>=&gt;   å·¦æ•°ç»„å½“å‰index &lt;= mid  &amp;&amp;  å³æ•°ç»„å½“å‰index  &lt;= right</p></li><li><p>æ¯”è¾ƒå·¦å³ä¸¤ä¸ªæ•°ç»„ä¸­å…ƒç´ çš„å¤§å°.</p><p>åˆ†ä¸ºä¸¤ç§æƒ…å†µ:</p><ul><li>å·¦æ•°ç»„å½“å‰å…ƒç´  &lt;= å³è¾¹æ•°ç»„å½“å‰å…ƒç´ <ul><li>äº¤æ¢tempArrayå½“å‰ä½ç½® ä¸ å·¦æ•°ç»„å½“å‰å…ƒç´ </li><li>tempArray çš„index ++ ,å› ä¸ºè¿™ä¸€ä¸ªä½ç½®å·²ç»ç¡®å®šäº†,åº”è¯¥ç¡®å®šä¸‹ä¸€ä¸ªå…ƒç´ äº† </li><li>å·¦è¾¹å½“å‰å…ƒç´ index ++ ,è¿™ä¸ªå…ƒç´ å·²ç»æ¯”è¾ƒè¿‡äº†,åº”è¯¥ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªä½ç½®ä¸å³æ•°ç»„å…ƒç´ æ¯”è¾ƒ</li></ul></li><li>å³è¾¹å½“å‰å…ƒç´ æ›´å¤§<ul><li>äº¤æ¢tempArrayå½“å‰ä½ç½® ä¸ å³æ•°ç»„å½“å‰å…ƒç´ </li><li>tempArray çš„index ++ </li><li>å³è¾¹å½“å‰å…ƒç´ index ++ </li></ul></li></ul></li><li><p>å½“ä¸Šé¢çš„å¾ªç¯å®Œæˆå,è¿˜æœ‰ä¸€ç§å¯èƒ½æ˜¯,å³è¾¹æˆ–å·¦è¾¹çš„æ•°ç»„ä¸­è¿˜æœ‰å…ƒç´ æ²¡æœ‰å‚ä¸æ¯”è¾ƒ</p><p>=&gt;   å› ä¸ºè¿™äº›å‰©ä¸‹çš„å…ƒç´ éƒ½æ¯”å¦ä¸€ä¸ªæ•°ç»„ä¸­å…ƒç´ å¤§,è€Œè¿™ä¸ªæ•°ç»„æœ¬èº«ä¹Ÿæ˜¯æœ‰åºçš„åˆ™</p><p>=&gt;   æŠŠè¿™äº›å‰©ä¸‹çš„å…ƒç´ å…¨éƒ¨è¿½åŠ åˆ°tempArray</p></li><li><p>æœ€åæˆ‘ä»¬å‘ç°,tempArrayå·²ç»æ˜¯ä¸€ä¸ªæœ‰åºçš„æ•°ç»„äº†,ä½†æ˜¯æˆ‘ä»¬è¦æ’åºçš„æ˜¯array</p><p>=&gt;   æŠŠtempArrayä¸­å…ƒç´ å…¨éƒ¨å¤åˆ¶ç»™array</p></li></ol><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/7/31 ä¸‹åˆ4:26 * å½’å¹¶æ’åº */public class MergeClass {    /**     * å½’å¹¶æ’åº     *     * @param array   éœ€è¦æ’åºçš„æ•°ç»„     * @param left  å·¦è¾¹ç•Œ     * @param right  å³è¾¹ç•Œ     * @param tempArray ä¸´æ—¶æ•°ç»„,é¿å…é¢‘ç¹åˆ›å»ºæ•°ç»„     */    public static void MergeSort(int[] array,int left,int right,int [] tempArray){        mergeSort(array, left, right, tempArray);    }    public static void mergeSort(int[] array,int left,int right,int [] tempArray){        //é€šè¿‡è§‚å¯Ÿä¸Šå›¾,æˆ‘ä»¬å¯ä»¥çŸ¥é“,å¦‚æœ left &gt;= right         //å°±æ˜¯æœ€å°çš„æ•°ç»„äº†,æ‰€ä»¥è¦åœæ­¢é€’å½’,å¼€å§‹è¿”å›        if(left &gt;= right){            return;        }        //è®¡ç®—å½“å‰ä¼ å…¥æ•°ç»„çš„ä¸­ç‚¹,ç”¨æ¥æŠŠæ•°ç»„åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†,è¿™é‡Œæ³¨æ„é¿å…intè¶Šç•Œ        int mid = left + (right - left) / 2 ;        //é€’å½’è°ƒç”¨å·¦å³æ•°ç»„        //å·¦è¾¹æ•°ç»„ [left , mid]        mergeSort(array, left, mid, tempArray);        //å³è¾¹æ•°ç»„ (mid,right]        mergeSort(array, mid + 1 , right , tempArray);        //åˆå¹¶è¿™ä¸ªæ•°ç»„,éœ€è¦åŸå§‹æ•°ç»„,ä¸´æ—¶æ•°ç»„,å·¦å³è¾¹ç•Œä»¥åŠmid(è¿™æ˜¯ä¸ºäº†è®¡ç®—å³è¾¹æ•°ç»„çš„å¼€å§‹index)        merge(array,left,mid,right,tempArray);    }    /**     * åˆå¹¶æ•°ç»„     *     * @param array     * @param left     * @param mid     * @param right     * @param tempArray     */    public static void merge(int[] array,int left,int mid,int right,int [] tempArray){        //ä¸ºäº†åé¢çš„æ“ä½œ,å…ˆå®šä¹‰å¥½å‡ ä¸ªè¾¹ç•Œå€¼        int i = left;   //å·¦æ•°ç»„indexå¼€å§‹ä½ç½®        int j = mid + 1;   //å³æ•°ç»„idnexå¼€å§‹ä½ç½®        int temp = 0;  //ä¸´æ—¶æ•°ç»„indexçš„å¼€å§‹ä½ç½®        //1.å¾ªç¯        while(i &lt;= mid &amp;&amp; j &lt;= right){            //2.æ¯”è¾ƒå¤§å°            if(array[i] &lt;= array[j]){                //åˆå¹¶èµ‹å€¼ä¸index ++                 tempArray[temp++] = array[i++];            }else{                tempArray[temp++] = array[j++];            }        }        //3.å‰©ä½™å…ƒç´         while(i &lt;= mid){            tempArray[temp++] = array[i++];        }        while(j &lt;= right){            tempArray[temp++] = array[j++];        }        //4.å¤åˆ¶å›array        temp = 0;        while(left &lt;= right){            array[left++] = tempArray[temp++];        }    } }</code></pre><p>æœ€åæµ‹è¯•äº†ä¸€ä¸‹,æ²¡é—®é¢˜</p><pre><code class="shell"> 13 21 23 26 45 67 123 213 456 563</code></pre>]]></content>
    
    
    <categories>
      
      <category>Programme</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Programme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ConstraintLayoutä½¿ç”¨æŒ‡å—-è¿›é˜¶ä½¿ç”¨</title>
    <link href="undefined2018/07/30/ConstraintLayout-Advance/"/>
    <url>2018/07/30/ConstraintLayout-Advance/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p><a href="http://www.wangzhumo.com/2018/07/12/ConstraintLayout-Basic/">ConstraintLayoutä½¿ç”¨æŒ‡å—-åŸºç¡€çš„çº¦æŸ</a></p><p>é€šè¿‡ä¸Šä¸€ç¯‡çš„äº†è§£,å¤§æ¦‚å·²ç»çŸ¥é“ConstraintLayoutçš„åŸºæœ¬åŠŸèƒ½äº†,ä½†æ˜¯å¯¹äºæˆ‘ä»¬æ—¥å¸¸çš„å¼€å‘å·¥ä½œ,è¿˜æ˜¯æœ‰ä¸€å®šçš„å·®è·,æ‰€ä»¥è¿™ä¸€ç¯‡,ä¸»è¦è®°å½•ä¸€äº›å¼€å‘ä¸­ç”¨åˆ°çš„è¿›é˜¶åŠŸèƒ½.</p><p>è¡Œäº†,æ¥ä¸Šæ–‡çš„<strong>çºµæ¨ªæ¯”</strong>,ä¸Šä»£ç </p><a id="more"></a><h3 id="å¼€å‘ä¸­å®ä¾‹"><a href="#å¼€å‘ä¸­å®ä¾‹" class="headerlink" title="å¼€å‘ä¸­å®ä¾‹"></a>å¼€å‘ä¸­å®ä¾‹</h3><h4 id="å‚ç…§çº¿-Guidelines"><a href="#å‚ç…§çº¿-Guidelines" class="headerlink" title="å‚ç…§çº¿(Guidelines)"></a>å‚ç…§çº¿(Guidelines)</h4><p><img src="/images/constraint_guideline.png" srcset="/img/loading.gif" alt="guide"></p><p>æœ¬æ¥ä»¥ä¸ºå¾ˆé«˜ç«¯</p><pre><code class="java">public class Guideline extends View{    æ„é€ å‡½æ•°{        super.setVisibility(8);    }       public void setVisibility(int visibility) {  }    public void draw(Canvas canvas) { }}</code></pre><p>å“ˆå“ˆ,å°±æ˜¯ä¸€ä¸ªVIew,ä¸ç»˜åˆ¶åœ¨ç•Œé¢ä¸Šè€Œå·².</p><pre><code class="xml">&lt;android.support.constraint.Guideline      android:id=&quot;@+id/guideline&quot;      android:layout_width=&quot;wrap_content&quot;      android:layout_height=&quot;wrap_content&quot;      app:layout_constraintGuide_begin=&quot;127dp&quot;    //è¿™é‡Œæ˜¯æŒ‡ä»å³è¾¹å¼€ä½¿,åç§»127dp      app:layout_constraintGuide_end=&quot;127dp&quot;  //è¿™é‡Œæ˜¯æŒ‡ä»å·¦è¾¹å¼€ä½¿,åç§»127dp      app:layout_constraintGuide_percent=&quot;0.5&quot;  //åœ¨æ•´ä¸ªå¸ƒå±€çš„50%å¤„,ä¹Ÿå°±æ˜¯å±…ä¸­      android:orientation=&quot;vertical&quot;/&gt;    //çº¿çš„ç±»å‹æ˜¯,å‚ç›´</code></pre><p>é‚£ä¹ˆ,æˆ‘ä»¬å¯ä»¥å°†å…¶ä»–æ§ä»¶é™„ç€åœ¨å®ƒä¸Šé¢,ä¸€èµ·å¸ƒå±€ç§»åŠ¨</p><h4 id="Chain-é“¾"><a href="#Chain-é“¾" class="headerlink" title="Chain é“¾"></a>Chain é“¾</h4><p>è¿™ç©æ„å¯å‰å®³äº†,å°±æ¯”æƒé‡ä»€ä¹ˆçš„å¼ºäº†æœ‰1000å€å§</p><p>æ¯”å¦‚æˆ‘æƒ³æŠŠä¸‹å›¾è¿™æ ·çš„ä¸‰ä¸ªæ§ä»¶å¹³åˆ†æ•´ä¸ªå¸ƒå±€å®½åº¦</p><p><img src="/images/constraint_unchain.png" srcset="/img/loading.gif" alt="chain"></p><p>æ­£å¸¸çš„æ“ä½œæ˜¯,ç”¨ä¸€ä¸ªLinearLayoutè®¾ç½®æƒé‡</p><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨ConstraintLayoutä¼šæ›´åŠ ç®€å•,è€Œä¸”åŠŸèƒ½æ›´å¤š</p><pre><code class="xml">&lt;layout xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;        xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;    &lt;android.support.constraint.ConstraintLayout            android:id=&quot;@+id/rootView&quot;            android:background=&quot;@android:color/white&quot;            android:layout_width=&quot;match_parent&quot;            android:layout_height=&quot;match_parent&quot;&gt;        &lt;ImageView                android:layout_width=&quot;wrap_content&quot;                android:layout_height=&quot;wrap_content&quot;                app:srcCompat=&quot;@mipmap/ic_launcher&quot;                android:id=&quot;@+id/imageView2&quot;                app:layout_constraintStart_toStartOf=&quot;parent&quot;                app:layout_constraintEnd_toStartOf=&quot;@+id/imageView3&quot;                app:layout_constraintHorizontal_chainStyle=&quot;spread_inside&quot;/&gt;        &lt;ImageView                android:layout_width=&quot;wrap_content&quot;                android:layout_height=&quot;wrap_content&quot;                app:srcCompat=&quot;@mipmap/ic_launcher&quot;                android:id=&quot;@+id/imageView3&quot;                app:layout_constraintStart_toEndOf=&quot;@+id/imageView2&quot;                app:layout_constraintEnd_toStartOf=&quot;@+id/imageView4&quot;/&gt;        &lt;ImageView                android:layout_width=&quot;wrap_content&quot;                android:layout_height=&quot;wrap_content&quot;                app:srcCompat=&quot;@mipmap/ic_launcher&quot;                android:id=&quot;@+id/imageView4&quot;                app:layout_constraintStart_toEndOf=&quot;@+id/imageView3&quot;                app:layout_constraintEnd_toEndOf=&quot;parent&quot;/&gt;    &lt;/android.support.constraint.ConstraintLayout&gt;&lt;/layout&gt;</code></pre><p>ä½ å¯èƒ½ä¼šè¯´,è¿™ä¹ˆå¤šlayout_constraintStart_toEndOf ä»€ä¹ˆçš„,æ˜æ˜æ›´éº»çƒ¦</p><p><img src="/images/constraint_chain.gif" srcset="/img/loading.gif" alt=""></p><h5 id="æ“ä½œæ­¥éª¤"><a href="#æ“ä½œæ­¥éª¤" class="headerlink" title="æ“ä½œæ­¥éª¤"></a>æ“ä½œæ­¥éª¤</h5><ol><li>é€‰ä¸­ä¸€ä¸ªæ§ä»¶</li><li>æ¡†é€‰æ‰€æœ‰è¦ç»„æˆ<code>Chain</code>çš„æ§ä»¶</li><li>æ·»åŠ Chain</li></ol><p>è¿˜èƒ½çœ‹åˆ°æˆ‘ç‚¹å‡»äº†ä¸€ä¸ª  é“¾æ¥  æŒ‰é’®,ä»–ä»¬ä¸‰ä¸ªçš„å¸ƒå±€åˆå‘ç”Ÿäº†å˜åŒ–</p><h5 id="chainStyle"><a href="#chainStyle" class="headerlink" title="chainStyle"></a>chainStyle</h5><p>è¿™æ˜¯ç”±chainStyleçš„æ”¹å˜é€ æˆçš„</p><pre><code class="xml">app:layout_constraintHorizontal_chainStyle=&quot;spread_inside&quot;</code></pre><ul><li><p>spread(é»˜è®¤çš„æ¨¡å¼)</p><p>å¹³åˆ†é—´éš™è®©å¤šä¸ª View å¸ƒå±€åˆ°å‰©ä½™ç©ºé—´</p></li><li><p>spread_inside</p><p>è¾¹ç¼˜çš„ä¸¤ä¸ª View ç´§è´´çˆ¶æ§ä»¶è¾¹ç¼˜,å‰©ä½™çš„ View åœ¨å‰©ä½™çš„ç©ºé—´å†…å¹³åˆ†é—´éš™å¸ƒå±€</p></li><li><p>packed</p><p>æ‰€æœ‰çš„Viewsæ‰“åŒ…å±…ä¸­,ç›¸äº’æ²¡æœ‰é—´éš”</p></li></ul><blockquote><p>è¦æ³¨æ„çš„æ˜¯spreadè¿˜æœ‰ä¸¤ä¸ªå¼ºå¤§çš„ä¸œè¥¿</p></blockquote><ol><li><p>å¦‚æœæˆ‘æŠŠä¸‰ä¸ªæ§ä»¶çš„widthè®¾ç½®ä¸º 0dpä¼šè¿™æ ·:</p><p><img src="/images/constraint_width.png" srcset="/img/loading.gif" alt="0dp"></p></li></ol><ol><li><p>å¦‚æœä½ æƒ³è®©ä»–ä»¬å‡ ä¸ªæ§ä»¶æŒ‰æ¯”ä¾‹å¹³åˆ†:</p><p>å¯ä»¥æ·»åŠ è¯¥å±æ€§</p><pre><code class="xml">app:layout_constraintHorizontal_weight = &quot;0.3&quot;</code></pre><p><img src="/images/constraint_weight.png" srcset="/img/loading.gif" alt="weight"></p><p>è¿™æ˜¯æˆ‘è®¾ç½®çš„  0.3 : 0.2 : 0.5</p></li></ol><h4 id="è¦†ç›–çˆ¶æ§ä»¶"><a href="#è¦†ç›–çˆ¶æ§ä»¶" class="headerlink" title="è¦†ç›–çˆ¶æ§ä»¶"></a>è¦†ç›–çˆ¶æ§ä»¶</h4><pre><code class="xml">&lt;ImageView            android:layout_width=&quot;match_parent&quot;            android:layout_height=&quot;200dp&quot;             app:srcCompat=&quot;@drawable/ic_launcher_background&quot;            android:id=&quot;@+id/imageView5&quot;             android:scaleType=&quot;fitXY&quot;            app:layout_constraintStart_toStartOf=&quot;parent&quot;            app:layout_constraintEnd_toEndOf=&quot;parent&quot;            app:layout_constraintTop_toTopOf=&quot;parent&quot;            tools:ignore=&quot;VectorDrawableCompat&quot;/&gt;    &lt;ImageView            android:id=&quot;@+id/imageView7&quot;            android:layout_width=&quot;40dp&quot;            android:layout_height=&quot;40dp&quot;            app:srcCompat=&quot;@mipmap/icon_youtube&quot;            tools:layout_editor_absoluteX=&quot;160dp&quot;            app:layout_constraintBottom_toBottomOf=&quot;@+id/imageView5&quot;             app:layout_constraintTop_toBottomOf=&quot;@+id/imageView5&quot;/&gt;</code></pre><p>ä¸»è¦å…³æ³¨è¿™ä¸¤å¥</p><pre><code class="xml">app:layout_constraintBottom_toBottomOf=&quot;@+id/imageView5&quot; app:layout_constraintTop_toBottomOf=&quot;@+id/imageView5&quot;</code></pre><p>æˆ‘ä»¬çš„imageView7  å§å®ƒçš„ä¸Šä¸‹éƒ½æŒ‡å®šäº†ä½äº imageView5çš„ä¸‹åº•è¾¹.</p><p><img src="/images/constraint_above.png" srcset="/img/loading.gif" alt="above"></p><h4 id="ç™¾åˆ†æ¯”å¸ƒå±€"><a href="#ç™¾åˆ†æ¯”å¸ƒå±€" class="headerlink" title="ç™¾åˆ†æ¯”å¸ƒå±€"></a>ç™¾åˆ†æ¯”å¸ƒå±€</h4><pre><code>app:layout_constraintHorizontal_bias=&quot;0.3&quot;</code></pre><p>ç”¨å¥½è¿™ä¸ªå±æ€§å’Œ GuideLineå³å¯</p><h3 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­.."></a>æœªå®Œå¾…ç»­..</h3><p>åé¢æœ‰ç”¨çš„,ä¼šç»§ç»­æ·»åŠ åˆ°è¿™é‡Œ</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»Šæ—¥å¤´æ¡çš„å±å¹•é€‚é…æ–¹æ¡ˆ</title>
    <link href="undefined2018/07/30/Screen-toutiao-resize/"/>
    <url>2018/07/30/Screen-toutiao-resize/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><blockquote><p>ä»Šæ—¥å¤´æ¡ä¼ é€é—¨:</p><p><a href="https://mp.weixin.qq.com/s/d9QCoBP6kV9VSWvVldVVwA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/d9QCoBP6kV9VSWvVldVVwA</a></p></blockquote><p>ç°åœ¨Androidç«¯çš„é€‚é…æ–¹æ¡ˆä¹Ÿæ˜¯äº”èŠ±å…«é—¨çš„,ä½†å°±æ˜¯è¿™æ ·,æˆ‘ä»¬çš„UIè®¾è®¡å¸ˆä»¬è¿˜è§‰å¾—å’Œä»–ä»¬çš„è®¾è®¡å›¾ä¸ä¸€è‡´,æˆ‘çœŸçš„æ˜¯æœäº†ä»–ä»¬çš„åƒç´ çœ¼.</p><p>ä»Šæ—¥å¤´æ¡çš„è¿™ä¸ªé€‚é…æ–¹æ¡ˆ,å¯ä»¥è¯´æ˜¯å–å·§åˆ°ä¸€ä¸ª<strong>å¦™å•Š</strong>çš„æ°´å¹³äº†.</p><a id="more"></a><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>android.util.TypedValue#applyDimension</p><pre><code class="java">public static float applyDimension(int unit, float value,                                       DisplayMetrics metrics)    {        switch (unit) {        case COMPLEX_UNIT_PX:            return value;        case COMPLEX_UNIT_DIP:            return value * metrics.density;        case COMPLEX_UNIT_SP:            return value * metrics.scaledDensity;        case COMPLEX_UNIT_PT:            return value * metrics.xdpi * (1.0f/72);        case COMPLEX_UNIT_IN:            return value * metrics.xdpi;        case COMPLEX_UNIT_MM:            return value * metrics.xdpi * (1.0f/25.4f);        }        return 0;    }</code></pre><p>è¿™ä¸€æ®µå°±æ˜¯,ç³»ç»Ÿæ¥è°ƒç”¨,ä»¥ä¾¿ç¼©æ”¾è°ƒæ•´è‡ªå·±çš„å¤§å°,æ»¡è¶³å¯¹åº”å±å¹•å¤§å°çš„ä»£ç äº†.</p><p>ä¸»è¦çœ‹<code>COMPLEX_UNIT_PX</code>,<code>COMPLEX_UNIT_DIP</code> ,<code>COMPLEX_UNIT_SP</code>è¿™ä¸‰ä¸ªcase</p><p>å› ä¸ºæˆ‘ä»¬å¼€å‘çš„è¿‡ç¨‹ä¸­,ä¹Ÿä¸»è¦æ˜¯ç”¨äº†è¿™ä¸‰ç§å•ä½,å°¤å…¶æ˜¯DIP,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šæŠŠå­—ä½“çš„å¤§å°ä¹Ÿç”¨DIPè¿™ä¸ªå•ä½æ¥å†™.</p><blockquote><p>value * metrics.density</p></blockquote><p>é€šè¿‡è§‚å¯Ÿæˆ‘ä»¬å¯ä»¥å‘ç°,éƒ½æ˜¯value * DisplayMetrics.å¸¸é‡</p><p>é‚£ä¹ˆæˆ‘è¦æ˜¯èƒ½æŠŠDisplayMetricsé‡Œé¢çš„è¿™ä¸ªå¸¸é‡å€¼æ”¹äº†,æ˜¯ä¸æ˜¯å°±å¯ä»¥ä¸ºæ‰€æ¬²ä¸ºäº†?</p><pre><code class="java"> public float density; //... public float scaledDensity;</code></pre><p>å¹¸ç¦æ¥å¾—å¤ªçªç„¶,è¿™å‡ ä¸ªå¸¸é‡éƒ½æ˜¯ public è€Œä¸”é finalçš„.</p><h3 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h3><p>ä¸¾ä¾‹è¯´æ˜æˆ‘æœ€è¿‘åšäº†ä¸€ä¸ªå¤§å±çš„é¡¹ç›®,ä½¿å¾—æ˜¯960dp,çœ‹çœ‹è¿™ä¸ªå…¬å¼</p><p>æˆ‘çš„è¿™ä¸ªå±å¹•å®½åº¦æ˜¯ 3000px,ä»–çš„å®½åº¦æ˜¯960dp</p><pre><code class="java">case COMPLEX_UNIT_DIP:      return value * metrics.density;</code></pre><p>å¸¦å…¥å…¬å¼</p><pre><code class="java">3000px  = density * 960dp =&gt;  åˆ™  density = 3000 / 960=&gt;  åˆ™  density = å±å¹•çœŸå®å®½åº¦ / è®¾è®¡å›¾å®½åº¦(dp)</code></pre><p>é‚£ä¹ˆä¸‹é¢ç›´æ¥è´´ä»£ç äº†</p><pre><code class="java">/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/6/25 ä¸‹åˆ5:17 * * ä»Šæ—¥å¤´æ¡çš„å±å¹•é€‚é…æ–¹æ¡ˆ: * ä¿®æ”¹densityå€¼,å¼ºè¡ŒæŠŠæ‰€æœ‰ä¸åŒå°ºå¯¸åˆ†è¾¨ç‡çš„æ‰‹æœºçš„å®½åº¦dpå€¼æ”¹æˆåŒä¸€ä¸ªå€¼ */public class ResizeDensity {    private static float sNoncompatDensity;    private static float sNoncompatScaledDensity;    /**     *     * @param activity activity     * @param application application     */    public static void setCustomDensity(@NonNull Activity activity, @NonNull final Application application) {        DisplayMetrics appDisplayMetrics = application.getResources().getDisplayMetrics();        if (sNoncompatDensity == 0) {            sNoncompatDensity = appDisplayMetrics.density;            sNoncompatDensity = appDisplayMetrics.scaledDensity;            application.registerComponentCallbacks(new ComponentCallbacks() {                @Override                public void onConfigurationChanged(Configuration newConfig) {                    if (newConfig != null &amp;&amp; newConfig.fontScale &gt; 0) {                        sNoncompatScaledDensity = application.getResources().getDisplayMetrics().scaledDensity;                    }                }                @Override                public void onLowMemory() {                }            });        }        float targetDensity = appDisplayMetrics.widthPixels / 960;        float targetScaleDensity = targetDensity * (sNoncompatScaledDensity / sNoncompatDensity);        int targetDensityDpi = (int) (160 * targetDensity);        appDisplayMetrics.density = targetDensity;        appDisplayMetrics.scaledDensity = targetScaleDensity;        appDisplayMetrics.densityDpi = targetDensityDpi;        final DisplayMetrics activityDisplayMetrics = activity.getResources().getDisplayMetrics();        activityDisplayMetrics.density = targetDensity;        activityDisplayMetrics.scaledDensity = targetScaleDensity;        activityDisplayMetrics.densityDpi = targetDensityDpi;    }}</code></pre><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ç›´æ¥åœ¨Activityä¸­å»è°ƒç”¨å°±å¯ä»¥è¾¾åˆ°æ•ˆæœäº†.</p><blockquote><p>ä»Šæ—¥å¤´æ¡å‘ç°çš„ä¸€ä¸ªå°é—®é¢˜:</p><p>ä½†æ˜¯æµ‹è¯•åå‘ç°å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœåœ¨ç³»ç»Ÿè®¾ç½®ä¸­åˆ‡æ¢å­—ä½“ï¼Œå†è¿”å›åº”ç”¨ï¼Œå­—ä½“å¹¶æ²¡æœ‰å˜åŒ–ã€‚äºæ˜¯è¿˜å¾—ç›‘å¬ä¸‹å­—ä½“åˆ‡æ¢ï¼Œè°ƒç”¨ Application#registerComponentCallbacks æ³¨å†Œä¸‹ onConfigurationChanged ç›‘å¬å³å¯ã€‚</p></blockquote><p>é˜…è¯»æºç â€¦è¯»æºç â€¦æºç â€¦</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidäº‹ä»¶åˆ†å‘æœºåˆ¶-ViewGroup</title>
    <link href="undefined2018/07/30/Android-MotionEvent-ViewGroup/"/>
    <url>2018/07/30/Android-MotionEvent-ViewGroup/</url>
    
    <content type="html"><![CDATA[<h3 id="æ€»è§ˆ"><a href="#æ€»è§ˆ" class="headerlink" title="æ€»è§ˆ"></a>æ€»è§ˆ</h3><h4 id="ä»€ä¹ˆæ˜¯äº‹ä»¶åˆ†å‘"><a href="#ä»€ä¹ˆæ˜¯äº‹ä»¶åˆ†å‘" class="headerlink" title="ä»€ä¹ˆæ˜¯äº‹ä»¶åˆ†å‘"></a>ä»€ä¹ˆæ˜¯äº‹ä»¶åˆ†å‘</h4><p>å°±æ˜¯å°†ç³»ç»Ÿä¼ é€’è¿‡æ¥çš„MotionEventåˆ†å‘åˆ°æŸä¸ªå…·ä½“çš„View,å¹¶å¤„ç†è¿™ä¸ªMotionEventçš„æ•´ä¸ªè¿‡ç¨‹</p><p>æˆ‘ä»¬å…ˆè¦æ˜ç™½</p><ul><li>è´£ä»»é“¾æ¨¡å¼</li><li>ViewGroupå’ŒViewçš„æ ‘å½¢ç»“æ„</li><li>ä¸€æ¬¡å®Œæ•´çš„MotionEventäº‹ä»¶(ACTION_DOWN , ACTION_MOVE , ACTION_UP)</li></ul><a id="more"></a><h4 id="ä¸»è¦æ–¹æ³•"><a href="#ä¸»è¦æ–¹æ³•" class="headerlink" title="ä¸»è¦æ–¹æ³•"></a>ä¸»è¦æ–¹æ³•</h4><ol><li><p>boolean dispatchTouchEvent(MotionEvent ev)</p><p>è¿™ä¸ªæ–¹æ³•æ˜¯åˆ†å‘ç‚¹å‡»äº‹ä»¶çš„æ–¹æ³•,åªè¦è¿™ä¸ªç‚¹å‡»äº‹ä»¶èƒ½ä¼ é€’åˆ°å½“å‰çš„æ§ä»¶,å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•</p></li><li><p>boolean onInterceptTouchEvent(MotionEvent ev)</p><p>æ˜¯å¦è¦æ‹¦æˆªè¿™ä¸ªäº‹ä»¶?è¦æ˜ç™½çš„æ˜¯,Viewæ˜¯æ²¡æœ‰è¿™ä¸ªæ–¹æ³•çš„,å› ä¸ºViewæ˜¯æœ€ä¸‹å±‚çš„,æ²¡æœ‰èµ„æ ¼å»æ‹¦æˆª.</p><p>å®ƒè¦ä¹ˆæ¶ˆè´¹äº‹ä»¶,è¦ä¹ˆä¸æ¶ˆè´¹è¿”å›å®ƒçš„çˆ¶æ§ä»¶,è€Œä¸æ˜¯è‡ªå·±æ‹¦æˆªæ‰äº‹ä»¶.</p></li><li><p>boolean onTouchEvent(MotionEvent event) </p><p>å¤„ç†ç‚¹å‡»äº‹ä»¶,ViewGroupçš„dispatchTouchEventæ–¹æ³•ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•.</p></li></ol><h4 id="ä¸»è¦å‚ä¸æˆå‘˜"><a href="#ä¸»è¦å‚ä¸æˆå‘˜" class="headerlink" title="ä¸»è¦å‚ä¸æˆå‘˜"></a>ä¸»è¦å‚ä¸æˆå‘˜</h4><ol><li><p>Activity</p><p>æˆ‘ä»¬è¦æ˜ç™½,ä¸€ä¸ªäº‹ä»¶åœ¨ç‰©ç†ç¡¬ä»¶å±‚äº§ç”Ÿå,æ˜¯ç”±ç³»ç»Ÿçš„è¾“å…¥ç³»ç»Ÿå¤„ç†,ç„¶åç»è¿‡å…¶ä¼ é€’é€šé“(å¦‚æœæ·±å…¥äº†è§£,æˆ‘ä»¬å¯ä»¥çŸ¥é“,å…¶åº•å±‚æ˜¯ç”±ä¸€ä¸ªåŒå‘çš„Socketæ¥åšåˆ°çš„),ä¼ é€’åˆ°UIçº¿ç¨‹,Activityæ˜¯ç¬¬ä¸€ä¸ªæ‹¿åˆ°è¿™ä¸ªäº‹ä»¶çš„,ä½†æ˜¯å®ƒå¹¶ä¸èƒ½å¤„ç†è¿™ä¸ªäº‹ä»¶,æ‰€ä»¥Activityå¿…é¡»æŠŠè¿™ä¸ªäº‹ä»¶åˆ†å‘ä¸‹å»,è€Œä¸ä¼šè‡ªå·±å¤„ç†.</p></li><li><p>ViewGroup</p><p>å®ƒä¸Viewæœ€å¤§çš„ä¸åŒåœ¨äº,è™½ç„¶å®ƒä¹Ÿæ˜¯Viewçš„å­ç±»,ä½†æ˜¯å®ƒå¯èƒ½è¿˜ç®¡ç†ç€å…¶ä»–ViewGroup &amp; View,æ‰€ä»¥å®ƒæ˜¯æœ‰æ‰€æœ‰çš„ä¸‰ä¸ªæ–¹æ³•çš„.</p></li><li><p>View</p><p>æ—¢æ˜¯æ‰€æœ‰æ§ä»¶çš„çˆ¶ç±»,ä¹Ÿæ˜¯æˆ‘ä»¬è¯´çš„æœ€åŸºæœ¬çš„æ§ä»¶,å®ƒåªèƒ½é€‰æ‹©å¤„ç†æˆ–ä¸å¤„ç†äº‹ä»¶,æ²¡æœ‰å…¶ä»–æ“ä½œäº†.</p></li></ol><h3 id="é˜…è¯»æºç "><a href="#é˜…è¯»æºç " class="headerlink" title="é˜…è¯»æºç "></a>é˜…è¯»æºç </h3><h4 id="Activity-dispatchTouchEvent"><a href="#Activity-dispatchTouchEvent" class="headerlink" title="Activity#dispatchTouchEvent"></a>Activity#dispatchTouchEvent</h4><pre><code class="java">public boolean dispatchTouchEvent(MotionEvent ev) {        if (ev.getAction() == MotionEvent.ACTION_DOWN) {            onUserInteraction();   //ç©ºæ–¹æ³•,ä¸çœ‹        }        //æŸ¥çœ‹superDispatchTouchEventå‘ç°æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•,é‚£ä¹ˆæˆ‘ä»¬å»æ‰¾å®ƒçš„å®ç°ç±»        if (getWindow().superDispatchTouchEvent(ev)) {            return true;        }        //ç›´æ¥è°ƒç”¨äº†onTouchEvent()        return onTouchEvent(ev);}</code></pre><p>=&gt; Window çš„å®ç°ç±»,ç°åœ¨åªæœ‰ä¸€ä¸ª PhoneWindow</p><pre><code class="java"> @Override public boolean superDispatchTouchEvent(MotionEvent event) {        return mDecor.superDispatchTouchEvent(event);     //é‚£ä¹ˆæˆ‘ä»¬çŸ¥é“mDecoræ˜¯DecorView,å®ƒç»§æ‰¿äº†FrameLayoutå¹¶ä¸”æ˜¯TitleView å’Œ ContextViewçš„å®¹å™¨ }//DecorViewçš„superDispatchTouchEventæ–¹æ³•public boolean superDispatchTouchEvent(MotionEvent event) {        return super.dispatchTouchEvent(event);    }</code></pre><p>å¾ˆæ˜æ˜¾çš„,æˆ‘ä»¬çŸ¥é“è¿™ä¸ªsuperæ˜¯æŒ‡çš„DecorViewçš„çˆ¶ç±»ViewGroup</p><p><code>android.view.ViewGroup#dispatchTouchEvent</code></p><h4 id="ViewGroup-dispatchTouchEvent"><a href="#ViewGroup-dispatchTouchEvent" class="headerlink" title="ViewGroup#dispatchTouchEvent"></a>ViewGroup#dispatchTouchEvent</h4><p>è¿™ä¸ªä»£ç é•¿åˆ°çˆ†ç‚¸</p><pre><code class="java">@Overridepublic boolean dispatchTouchEvent(MotionEvent ev) {     //...çœç•¥    //æœäº†åŠå¤©æ‰çŸ¥é“,mInputEventConsistencyVerifierè°ƒè¯•ç”¨çš„,è¿å¸¦è¾…åŠ©åŠŸèƒ½çš„éƒ½çœç•¥äº†    boolean handled = false;    //onFilterTouchEventForSecurity è¿™ä¸ªæ–¹æ³•æ˜¯Viewä¸­çš„,å¦‚æœfalseå°±è¦ä¸¢å¼ƒäº‹ä»¶    //ç¬¬ä¸€æ­¥ :     //å¦‚æœæ˜¯tureæ‰ç»§ç»­æ¥å¤„ç†è¿™ä¸ªäº‹ä»¶,å…¶å®å°±æ˜¯Windowæ˜¯å¦è¢«é®ç›–çš„å€¼    if (onFilterTouchEventForSecurity(ev)) {        final int action = ev.getAction();        final int actionMasked = action &amp; MotionEvent.ACTION_MASK;        // Handle an initial down.        if (actionMasked == MotionEvent.ACTION_DOWN) {            //ç¬¬äºŒæ­¥ :             //è¿™é‡Œæ¸…é™¤æ‰äº†æ‰€æœ‰ä¹‹å‰çš„çŠ¶æ€,            //1. clearTouchTargets() çœ‹èµ·æ¥æ˜¯æ¸…ç©ºäº†ä¸€ä¸ªä¿å­˜éœ€è¦æ¥å—äº‹ä»¶Viewçš„é“¾è¡¨            //   mFirstTouchTargeté“¾è¡¨åˆå§‹åŒ–            //2.mGroupFlags &amp;= ~FLAG_DISALLOW_INTERCEPT;            //  è¿™ä¸ªæ ‡è®°æ„ä¸º:ä¸å…è®¸ViewGroupå¯¹è§¦æ‘¸äº‹ä»¶è¿›è¡Œæ‹¦æˆª            cancelAndClearTouchTargets(ev);            resetTouchState();        }        final boolean intercepted;        //ç¬¬ä¸‰æ­¥:        //æ£€æŸ¥å½“å‰ViewGroupæ˜¯å¦æƒ³è¦æ‹¦æˆªè§¦æ‘¸äº‹ä»¶,å¹¶æŠŠå€¼å†™å…¥interceptedè¿”å›        if (actionMasked == MotionEvent.ACTION_DOWN || mFirstTouchTarget != null) {                   //è¿™ä¸ªæ ‡å¿—ä½é€šè¿‡requestDisallowInterceptTouchEventæ¥è®¾ç½®                final boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0;                if (!disallowIntercept) {                    //å¦‚æœä¸ç¦ç”¨æ‹¦æˆªäº‹ä»¶,åˆ™è°ƒç”¨onInterceptTouchEvent(ev);                    //å¹¶ä¸”è¿”å›onInterceptTouchEventçš„è¿”å›å€¼ç»™intercepted                    intercepted = onInterceptTouchEvent(ev);                    ev.setAction(action); // restore action in case it was changed                } else {                    intercepted = false;                }        } else {                // There are no touch targets and this action is not an initial down                // so this view group continues to intercept touches.                intercepted = true;        }        //...çœç•¥        //ç¬¬å››æ­¥,æ£€æŸ¥æ˜¯å¦å–æ¶ˆäº†äº‹ä»¶        final boolean canceled = resetCancelNextUpFlag(this)            || actionMasked == MotionEvent.ACTION_CANCEL;        // ç¬¬äº”æ­¥,æŠŠäº‹ä»¶canceled,intercepted  æ—¢æ²¡æœ‰è¢«å–æ¶ˆ,ä¹Ÿæ²¡æœ‰è¢«æ‹¦æˆªçš„æ—¶å€™        // æŠŠäº‹ä»¶åˆ†å‘åˆ°å®ƒçš„å­Viewä¸­å»        final boolean split = (mGroupFlags &amp; FLAG_SPLIT_MOTION_EVENTS) != 0;        TouchTarget newTouchTarget = null;        boolean alreadyDispatchedToNewTouchTarget = false;        if (!canceled &amp;&amp; !intercepted) {            //çœç•¥..            if (actionMasked == MotionEvent.ACTION_DOWN                || (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_DOWN)                || actionMasked == MotionEvent.ACTION_HOVER_MOVE) {                final int actionIndex = ev.getActionIndex(); // always 0 for down                final int idBitsToAssign = split ? 1 &lt;&lt; ev.getPointerId(actionIndex)                    : TouchTarget.ALL_POINTER_IDS;                //æ¸…ç©ºè¿™ä¸ªidBitsToAssignä¹‹å‰çš„TouchTargeté“¾è¡¨                removePointersFromTouchTargets(idBitsToAssign);               //è·å–è¿™ä¸ªViewçš„æ‰€æœ‰å­Viewä¸ªæ•°                final int childrenCount = mChildrenCount;                if (newTouchTarget == null &amp;&amp; childrenCount != 0) {                    final float x = ev.getX(actionIndex);                    final float y = ev.getY(actionIndex);                    // Find a child that can receive the event.                    // Scan children from front to back.                    final ArrayList&lt;View&gt; preorderedList = buildTouchDispatchChildList();                    final boolean customOrder = preorderedList == null                        &amp;&amp; isChildrenDrawingOrderEnabled();                    final View[] children = mChildren;                    //ç¬¬å…­æ­¥,æ‰§è¡Œäº‹ä»¶åˆ†å‘                    //æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯éå†æ‰€æœ‰çš„å­View,å¹¶æŠŠ                    for (int i = childrenCount - 1; i &gt;= 0; i--) {                        final int childIndex = getAndVerifyPreorderedIndex(                           childrenCount, i, customOrder);                        final View child = getAndVerifyPreorderedView(                            preorderedList, children, childIndex);                        //çœç•¥...                        //è¿™é‡Œåˆ¤æ–­,å½“å‰å¾ªç¯åˆ°çš„è¿™ä¸ªå­Viewæ˜¯å¦å¯ç‚¹å‡»,å¹¶ä¸”è¿™ä¸ªåæ ‡                        //åœ¨å­Viewçš„å¯è§†èŒƒå›´å†…,å¦‚æœéƒ½æ»¡è¶³,åˆ™è·³å‡ºåˆ¤æ–­ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ,å¦‚æœ                        //ä¸èƒ½æ»¡è¶³æ¡ä»¶,åˆ™continue,è·³è¿‡è¿™ä¸ªView                        if (!canViewReceivePointerEvents(child)                          || !isTransformedTouchPointInView(x, y, child, null)) {                            ev.setTargetAccessibilityFocus(false);                            continue;                        }                        newTouchTarget = getTouchTarget(child);                        if (newTouchTarget != null) {                            // Child is already receiving touch within its bounds.                            // Give it the new pointer in addition to the ones it is handling.                            newTouchTarget.pointerIdBits |= idBitsToAssign;                            break;                        }                        resetCancelNextUpFlag(child);                        //æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,è¿™é‡ŒæŠŠäº‹ä»¶åˆ†å‘ä¸‹å»äº†,ç»™äº†å½“å‰çš„è¿™ä¸ªchild                        if (dispatchTransformedTouchEvent(ev, false, child, idBitsToAssign)) {                            // Child wants to receive touch within its bounds.                            //å¦‚æœèƒ½èµ°åˆ°è¿™é‡Œ,åˆ™å­Viewè¿”å›çš„è‚¯å®šæ˜¯ture,è¯´æ˜å­View                            //æ¶ˆè´¹ &amp; æ‹¦æˆªäº†è¿™ä¸ªäº‹ä»¶                            mLastTouchDownTime = ev.getDownTime();                            if (preorderedList != null) {                                // childIndex points into presorted list, find original index                                for (int j = 0; j &lt; childrenCount; j++) {                                    if (children[childIndex] == mChildren[j]) {                                        mLastTouchDownIndex = j;                                        break;                                    }                                }                            } else {                                mLastTouchDownIndex = childIndex;                            }                            mLastTouchDownX = ev.getX();                            mLastTouchDownY = ev.getY();                            //ddTouchTarget()å°†childæ·»åŠ åˆ°mFirstTouchTarget                            newTouchTarget = addTouchTarget(child, idBitsToAssign);                            //è®¾ç½®alreadyDispatchedToNewTouchTargetä¸ºtrue                            alreadyDispatchedToNewTouchTarget = true;                            break;                        }                        // The accessibility focus didn&#39;t handle the event, so clear                        // the flag and do a normal dispatch to all children.                        ev.setTargetAccessibilityFocus(false);                    }                    if (preorderedList != null) preorderedList.clear();                }                if (newTouchTarget == null &amp;&amp; mFirstTouchTarget != null) {                    // Did not find a child to receive the event.                    // Assign the pointer to the least recently added target.                    newTouchTarget = mFirstTouchTarget;                    while (newTouchTarget.next != null) {                        newTouchTarget = newTouchTarget.next;                    }                    newTouchTarget.pointerIdBits |= idBitsToAssign;                }            }        }        //ä»¥ä¸Š,åˆ¤æ–­ä¸è¢«å–æ¶ˆ,ä¸è¢«æ‹¦æˆªçš„æ–¹æ³•å®Œæ¯•äº†        //ç¬¬ä¸ƒæ­¥,ç»§ç»­åˆ†å‘äº‹ä»¶        // Dispatch to touch targets.        //è¿™é‡Œæ³¨æ„çœ‹dispatchTransformedTouchEventçš„ç¬¬ä¸‰ä¸ªå‚æ•°,æ˜¯null        //åœ¨è¯¥æ–¹æ³•ä¸­,childè¿™ä¸ªå‚æ•°ä¸ºnull,åˆ™æ˜¯ç›´æ¥è°ƒç”¨äº†super.dispatchTouchEvent(ev)        if (mFirstTouchTarget == null) {            // No touch targets so treat this as an ordinary view.            handled = dispatchTransformedTouchEvent(ev, canceled, null,                                                    TouchTarget.ALL_POINTER_IDS);        } else {            // Dispatch to touch targets, excluding the new touch target if we already            // dispatched to it.  Cancel touch targets if necessary.            TouchTarget predecessor = null;            TouchTarget target = mFirstTouchTarget;            while (target != null) {                //TouchTarget   è¿™é‡Œæ˜¯ä¸€ç›´åœ¨éå†è¿™ä¸ªé“¾è¡¨,è¿›è¡Œåˆ¤æ–­,äº‹ä»¶åˆ†å‘                final TouchTarget next = target.next;                if (alreadyDispatchedToNewTouchTarget &amp;&amp; target == newTouchTarget) {                    handled = true;                } else {                    final boolean cancelChild = resetCancelNextUpFlag(target.child)                        || intercepted;                    if (dispatchTransformedTouchEvent(ev, cancelChild,                                                      target.child, target.pointerIdBits)) {                        handled = true;                    }                    if (cancelChild) {                        if (predecessor == null) {                            mFirstTouchTarget = next;                        } else {                            predecessor.next = next;                        }                        target.recycle();                        target = next;                        continue;                    }                }                predecessor = target;                target = next;            }        }        //ç¬¬å…«æ­¥ å¦‚æœæœ‰å¿…è¦,æ›´æ–°å–æ¶ˆæ ‡è®°        // Update list of touch targets for pointer up or cancel, if needed.        if (canceled            || actionMasked == MotionEvent.ACTION_UP            || actionMasked == MotionEvent.ACTION_HOVER_MOVE) {            resetTouchState();        } else if (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_UP) {            final int actionIndex = ev.getActionIndex();            final int idBitsToRemove = 1 &lt;&lt; ev.getPointerId(actionIndex);            removePointersFromTouchTargets(idBitsToRemove);        }    }    if (!handled &amp;&amp; mInputEventConsistencyVerifier != null) {        mInputEventConsistencyVerifier.onUnhandledEvent(ev, 1);    }    return handled;}</code></pre><p>æˆ‘ä»¬ä¸å¦¨æ¥æ¢³ç†ä¸€ä¸‹</p><p>ç¬¬ä¸€æ­¥è‡³ç¬¬ä¸‰æ­¥éƒ½æ˜¯æ ¹æ®å„ç§æ ‡è®°,æ˜¯å¦å¯è§ç­‰æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ†å‘è¿™ä¸ªäº‹ä»¶.</p><p>ä»ç¬¬å››æ­¥å¼€å§‹,æ‰æ˜¯å¼€å§‹åˆ†å‘è¿™ä¸ªäº‹ä»¶çš„ä»£ç ,ç¬¬äº”æ­¥åˆ¤æ–­æ˜¯ä¸æ˜¯DOWN,MOVEäº‹ä»¶,å¦‚æœæ˜¯å°±å¼€å§‹åˆ†å‘ç»™æ¯ä¸€ä¸ªå­View,åŒæ—¶æŠŠè¿™ä¸ªViewæ·»åŠ åˆ°äº†<code>mFirstTouchTarget</code>è¿™ä¸ªé“¾è¡¨ä¸­</p><p>è€Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬ä¸ƒæ­¥,<code>mFirstTouchTarget == null</code>åˆ¤æ–­è¿™ä¸ªé“¾è¡¨,å¦‚æœä¸æ˜¯nullå°±ç»§ç»­åˆ†å‘äº‹ä»¶,å¦‚æœæ˜¯nullçš„è¯å°±ç›´æ¥å›è°ƒçˆ¶ç±»çš„<code>super.dispatchTouchEvent</code></p><p>è¿™æ ·æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®º:</p><blockquote><p>å¦‚æœä¸€ä¸ªViewæ²¡æœ‰æ¥æ”¶åˆ°<code>DOWN</code>äº‹ä»¶,è€Œåçš„äº‹ä»¶å®ƒè‚¯å®šä¹Ÿæ— æ³•æ¥æ”¶åˆ°.</p></blockquote><h4 id="android-view-ViewGroup-dispatchTransformedTouchEvent"><a href="#android-view-ViewGroup-dispatchTransformedTouchEvent" class="headerlink" title="android.view.ViewGroup#dispatchTransformedTouchEvent"></a>android.view.ViewGroup#dispatchTransformedTouchEvent</h4><pre><code class="java"> private boolean dispatchTransformedTouchEvent(MotionEvent event, boolean cancel,            View child, int desiredPointerIdBits) {        final boolean handled;        //çœç•¥...        // Perform any necessary transformations and dispatch.        if (child == null) {            //å¦‚æœå­Viewä¸ºç©º,åˆ™æŠŠè‡ªå·±å½“åšä¸€ä¸ªViewæ¥å¤„ç†,è¿™é‡Œæ˜¯ç›´æ¥è°ƒç”¨çš„View.dispatchTouchEvent            handled = super.dispatchTouchEvent(transformedEvent);        } else {            final float offsetX = mScrollX - child.mLeft;            final float offsetY = mScrollY - child.mTop;            transformedEvent.offsetLocation(offsetX, offsetY);            if (! child.hasIdentityMatrix()) {                transformedEvent.transform(child.getInverseMatrix());            }            //è¿™é‡Œå°±å¾ˆæ˜ç™½äº†,äº‹ä»¶åˆä¼ é€’åˆ°è¯¥ViewGroupçš„å­Viewä¸­å»äº†            handled = child.dispatchTouchEvent(transformedEvent);        }        // Done.        transformedEvent.recycle();        //è¿”å›        return handled;    }</code></pre><h4 id="android-view-ViewGroup-onInterceptTouchEvent"><a href="#android-view-ViewGroup-onInterceptTouchEvent" class="headerlink" title="android.view.ViewGroup#onInterceptTouchEvent"></a>android.view.ViewGroup#onInterceptTouchEvent</h4><pre><code class="java">   public boolean onInterceptTouchEvent(MotionEvent ev) {        if (ev.isFromSource(InputDevice.SOURCE_MOUSE)                &amp;&amp; ev.getAction() == MotionEvent.ACTION_DOWN                &amp;&amp; ev.isButtonPressed(MotionEvent.BUTTON_PRIMARY)                &amp;&amp; isOnScrollbarThumb(ev.getX(), ev.getY())) {            return true;        }        return false;    }</code></pre><p>æ³¨æ„çœ‹ä¸€ä¸‹ä»–çš„æ³¨é‡Š</p><p><code>Implement this method to intercept all touch screen motion events.</code></p><p>ä¸€èˆ¬éƒ½æ˜¯è¿”å›falseçš„,å¦‚æœä½ éœ€è¦æ‹¦æˆªæ‰€æœ‰çš„äº‹ä»¶è€Œä¸å»åˆ†å‘,é‡å†™ç„¶åè¿”å›tureå³å¯</p><h4 id="è€ŒViewGroupçš„onTouchEventæ˜¯ç›´æ¥èµ°çš„View-onTouchEvent"><a href="#è€ŒViewGroupçš„onTouchEventæ˜¯ç›´æ¥èµ°çš„View-onTouchEvent" class="headerlink" title="è€ŒViewGroupçš„onTouchEventæ˜¯ç›´æ¥èµ°çš„View.onTouchEvent()"></a>è€ŒViewGroupçš„onTouchEventæ˜¯ç›´æ¥èµ°çš„View.onTouchEvent()</h4><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li><p><strong>ViewGroupä¸­dispatchTouchEvent()ä¼šæŠŠäº‹ä»¶è¿›è¡Œéå†ä¼ é€’</strong></p><p>éå†å®ƒè‡ªå·±çš„æ‰€æœ‰å­View,ç„¶åè°ƒç”¨childçš„dispatchTouchEvent()æ¥åˆ†å‘è§¦æ‘¸äº‹ä»¶</p></li><li><p><strong>ViewGroupçš„æŸä¸ªå­Viewæ²¡æœ‰æ¥å—ACTION_DOWN,åˆ™å®ƒå†ä¹Ÿä¸ä¼šè¢«åˆ†å‘äº‹ä»¶äº†</strong></p></li><li><p><strong>ViewGroupçš„onInterceptTouchEvent()é»˜è®¤è¿”å›false</strong></p><p>ä¹Ÿå°±æ˜¯è¯´,å¦‚æœä½ éœ€è¦è‡ªå®šä¹‰çš„ViewGroupæ‹¦æˆªäº‹ä»¶,ç›´æ¥é‡å†™è¿”å›falseå³å¯</p></li><li><p><strong>ViewGroupçš„onTouchEvent å¹¶æ²¡æœ‰è‡ªå·±çš„å®ç°,ç›´æ¥è°ƒç”¨å…¶çˆ¶ç±»Viewçš„</strong></p></li></ul><p>ä¸‹ç¯‡Viewèµ°èµ·</p>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è´å¡å°”æ›²çº¿ç»ƒä¹ -è°·æ­ŒçŒœç”»å°æ­Œçš„å€’è®¡æ—¶</title>
    <link href="undefined2018/07/27/Bezier-Google-caihuaxiaoge/"/>
    <url>2018/07/27/Bezier-Google-caihuaxiaoge/</url>
    
    <content type="html"><![CDATA[<p>æ€»çš„æ¥è¯´ä¸€å…±æœ‰å››æ®µäºŒé˜¶è´å¡å°”æ›²çº¿ï¼Œå…¶å®æˆ‘ä»¬æ˜¯å¯ä»¥åªç”¨ä¸€æ¬¡é«˜é˜¶è´å¡å°”æ›²çº¿æ¥æå®šçš„ï¼Œä½†æ˜¯é‚£æ ·ä¸æ˜¯å¾ˆåˆ’ç®—ï¼Œæ‰€ä»¥æˆ‘ç”¨å››æ®µäºŒé˜¶æ›²çº¿æ‹¼æ¥ä¸ºä¸€ä¸ªå¾ªç¯ã€‚</p><p>ç¤ºæ„å›¾ï¼š</p><p><img src="/images/wave_show.png" srcset="/img/loading.gif" alt="ç¤ºæ„å›¾"></p><p>å›¾ä¸­å¤§æ¡†è¡¨ç¤ºæ‰‹æœºå±å¹•ï¼Œæˆ‘ä»¬åªè¦æ¯æ¬¡éƒ½ç§»åŠ¨Sç‚¹çš„ä½ç½®å°±å¯ä»¥åšåˆ°æ¨¡æ‹Ÿæ³¢æµªã€‚</p><a id="more"></a><p>é‚£ä¹ˆéœ€è¦ç¡®å®š</p><ol><li>å®½åº¦ï¼ˆDç‚¹ä½ç½®ï¼‰</li><li>æ³¢æµªé«˜åº¦ ï¼ˆC ç‚¹ï¼Œæ§åˆ¶ç‚¹çš„é«˜åº¦ï¼Œå®ƒçš„å®½åº¦æ˜¯ä¸åšå˜åŒ–çš„ï¼‰</li><li>èµ·å§‹ç‚¹çš„ä½ç½®</li></ol><p>å½“æˆ‘ä»¬å¼€å§‹ç§»åŠ¨æ—¶ï¼Œåªéœ€è¦ç§»åŠ¨Sç‚¹ä½ç½®å³å¯ï¼Œå…¶ä»–ç‚¹éƒ½è°ƒç”¨quadTo ï¼ŒlineTo çš„APIå°±å¯ä»¥ç›´æ¥ç›¸å¯¹ä½ç½®çš„ä½ç§»</p><p>å®ç°æ•ˆæœå›¾:</p><p><img src="/images/wave_image.gif" srcset="/img/loading.gif" alt=""></p><p>å¥½äº†ï¼Œæ—¢ç„¶é“ç†å·²ç»æ˜ç™½äº†ï¼Œé‚£å°±å¼€å§‹ä»£ç æŠŠ</p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>é€‰æ‹©ç»§æ‰¿Viewå®ç°ï¼Œæˆ‘ä»¬æ²¡æœ‰å…¶ä»–çš„æ§ä»¶éœ€è¦åè°ƒï¼Œåªè¦ç®¡å¥½è‡ªå·±å°±OK,ç›´æ¥ä¸ŠViewå³å¯</p><p>æœ¬æ¥æ„æ€çš„æ˜¯åšä¸€ä¸ªå¯ä»¥ç”»å¤šæ¡æ³¢æµªçš„View,ä½†æ˜¯è¯•äº†ä¸€ä¸‹,å¤šæ¡å¾ˆéš¾çœ‹â€¦..è€Œä¸”æˆ‘æ˜¯ä¸ºäº†ç»ƒæ‰‹,æ‰€ä»¥åŠé€”æ”¹äº†è®¾è®¡</p><h4 id="WaveView-java"><a href="#WaveView-java" class="headerlink" title="WaveView.java"></a>WaveView.java</h4><blockquote><p>WaveViewä¸»è¦è´Ÿè´£åˆå§‹åŒ–Wave.javaå®ä¾‹,ä»¥åŠè®¡ç®—æ°´é¢çš„é«˜åº¦å…¶ä»–éƒ½æ˜¯å…·ä½“äº¤ç»™äº†Wave.javaåšçš„</p></blockquote><p>onDrawçš„ä¸»è¦é€»è¾‘:</p><pre><code class="java">@Overrideprotected void onDraw(Canvas canvas) {    //è¿™ä¸€æ­¥æ˜¯ç”»äº†ä¸€ä¸ªåœ†è§’çŸ©å½¢,è¾¾åˆ°æ•´ä¸ªæ§ä»¶çš„åœ†è§’æ•ˆæœ    //åœ¨superä¹‹å‰è°ƒç”¨,é™¤äº†èƒŒæ™¯,å¯ä»¥æŒ¡ç€æ‰€æœ‰çš„ç»˜åˆ¶    canvas.clipPath(radiusPath);     super.onDraw(canvas);    //ä¸ºäº†å®ç°æœ€åæ—¶åˆ»çš„æŠ–åŠ¨æ•ˆæœ    matrix.setRotate(postRotate, 0.5F, 0.5F);//å¿½ç•¥,æœªå®ç°    canvas.save();//å¿½ç•¥,æœªå®ç°    canvas.concat(matrix);//å¿½ç•¥,æœªå®ç°    //draw wave,è¿™ä¸€æ­¥å°±æ˜¯æŠŠä¸¤æ¡æ³¢æµªéƒ½ç”»äº†å‡ºæ¥,forå¾ªç¯æ‰€æœ‰çš„æ³¢æµª,å…¶å®å°±2æ¡    for (int i = waveList.length-1; i &gt;= 0; i--) {        waveList[i].drawWave(canvas);    }    canvas.restore();//å¿½ç•¥,æœªå®ç°}</code></pre><p>æ°´é¢é«˜åº¦åŠ¨ç”»:(å…¶å®è¿™é‡Œæ²¡æœ‰è®¾ç½®åŠ¨ç”»çš„æ—¶é•¿,å› ä¸ºè¿™ä¸ªæ˜¯ç•™ç»™ä½¿ç”¨è€…æ¥è®¾ç½®çš„)</p><pre><code class="java">/** * è®¾ç½®æ°´å‡èµ·çš„åŠ¨ç”» * @return ValueAnimator */private ValueAnimator getWaterRaiseAnim() {    //åˆå§‹åŒ–åŠ¨ç”»    if (waterAnimator == null) {        //å¯ä»¥çœ‹åˆ°,æˆ‘ä»¬çš„å˜åŒ–èŒƒå›´æ˜¯ 0F -  mHeight        waterAnimator = ValueAnimator.ofFloat(0F, mHeight);        waterAnimator.setInterpolator(new AccelerateInterpolator());        waterAnimator.addUpdateListener(animation -&gt; {            for (Wave wave : waveList) { //å¾ªç¯è°ƒç”¨wave,å‘Šè¯‰æ¯ä¸€ä¸ªå®ä¾‹,é«˜åº¦å˜åŒ–äº†                wave.updateHeight((float) animation.getAnimatedValue());            }        });    }    return waterAnimator;}</code></pre><p>ä¸¤ä¸ªstartAnim,ç›®çš„æ˜¯ç”¨æˆ·ä¸ä¼ é€’æ—¶é—´æ—¶,æˆ‘ä»¬ä½¿ç”¨é»˜è®¤çš„20 * 1000æ¯«ç§’</p><pre><code class="java">//å¼€å§‹åŠ¨ç”»public void startAnim() {    startAnim(DEFAULT_TIME);}/** * å¼€å§‹åŠ¨ç”» * @param time æ—¶é—´å•ä½ ç§’ */public void startAnim(long time) {    if (animatorSet != null) {        if (animatorSet.isRunning()) {            animatorSet.cancel();        }        animatorSet.start();    }else{        initAnim(time);        animatorSet.start();    }}//è¿™é‡Œæœ¬æ¥è¿˜æ·»åŠ äº†æ™ƒåŠ¨çš„åŠ¨ç”»,æ³¨é‡Šæ‰çš„å°±æ˜¯private void initAnim(long time) {    animatorSet = new AnimatorSet();    waterAnimator = getWaterRaiseAnim();    waterAnimator.setDuration(time);    animatorSet.play(waterAnimator);    //rotateAnim = getRotateAnim();    //animatorSet.play(rotateAnim).after(time / 5 * 4)}</code></pre><p>Wave.java</p><blockquote><p>ä¸»è¦è´Ÿè´£ç»˜åˆ¶æ³¢æµª,å¹¶è‡ªå·±è°ƒç”¨åŠ¨ç”»è¾¾åˆ°æ³¢æµªèµ·ä¼æ•ˆæœ</p></blockquote><p>ç»˜åˆ¶çš„æ–¹æ³•:</p><pre><code class="java">     /**     * å½“å‰è¿™ä¸€æ¡æ³¢æµªçš„ç»˜åˆ¶     *     * @param canvas ç”»å¸ƒ     */    public void drawWave(Canvas canvas) {        //å¦‚æœä¸æ˜¯ç¬¬ä¸€å±‚,åˆ™ä¸éœ€è¦è¦ç”»æ³¢æµªä¸‹é¢çš„éƒ¨åˆ†        drawWave(isTop());        canvas.drawPath(mPath, mPaint);    }        /**     * @param isNeed æ˜¯å¦éœ€è¦ç»˜åˆ¶ä¸‹é¢éƒ¨åˆ†     */    private void drawWave(boolean isNeed) {        mPath.reset();        mPath.moveTo(mLeftTop.x, mLeftTop.y);        mPath.quadTo(mControlFirst.x, mControlFirst.y, mLeftMid.x, mLeftMid.y);        mPath.quadTo(mControlSecond.x, mControlSecond.y, mMid.x, mMid.y);        mPath.quadTo(mControlThree.x, mControlThree.y, mRightMid.x, mRightMid.y);        mPath.quadTo(mControlFour.x, mControlFour.y, mRightTop.x, mRightTop.y);        if (isNeed) {            mPath.lineTo(mRightBottom.x, mRightBottom.y);            mPath.lineTo(mLeftBottom.x, mLeftBottom.y);            mPath.lineTo(mLeftTop.x, mLeftTop.y);        } else {            mPath.lineTo(mRightTop.x, mRightTop.y + mWaveTrough);            mPath.lineTo(mLeftTop.x, mLeftTop.y + mWaveTrough);            mPath.lineTo(mLeftTop.x, mLeftTop.y);        }    }</code></pre><p>åŠ¨ç”»</p><pre><code class="java">    /**     * åˆå§‹åŒ–ä¸€ä¸ªåŠ¨ç”»,å¹¶å¼€å¯åŠ¨ç”»     */    public void startAnim() {        ValueAnimator valueAnimator;        if ((layerNum &amp; 1) == 0) {            //è¾¾åˆ°ä½ç§»æ˜¯ä»å·¦å‘å³çš„æ•ˆæœ            valueAnimator = ValueAnimator.ofFloat(mLeftTop.x, 0);        } else {            //ä½ç§»ä»å³å‘å·¦çš„ç§»åŠ¨            valueAnimator = ValueAnimator.ofFloat(mRightTop.x, mWidth);        }        valueAnimator.setInterpolator(new LinearInterpolator());        valueAnimator.setDuration(1000);        //æ— é™çš„åŠ¨ç”»,ä¸€ç›´æ’­æ”¾,è¾¾æˆä¸€ä¸ªå¾ªç¯        valueAnimator.setRepeatCount(Animation.INFINITE);        valueAnimator.addUpdateListener(animation -&gt; {            float value = (float) animation.getAnimatedValue();            //äº¤ç»™nextæ–¹æ³•,å…·ä½“çš„ç®—å‡ºæ¯ä¸€ä¸ªç‚¹çš„ä¸‹ä¸€ä¸ªä½ç½®            next(value);        });        valueAnimator.start();    }</code></pre><p>next(float value)</p><pre><code class="java">    /**     * å˜åŒ–åçš„æ•°å€¼     * @param value xæ–¹å‘çš„ä½ç§»     */    private void next(float value) {        if ((layerNum &amp; 1) == 0) {            //è¿™æ˜¯å‘å³ç§»åŠ¨            mLeftTop.set(value, mHeight - mWaterHeight);            mLeftMid.set(mLeftTop.x + mWidth / 2f, mHeight - mWaterHeight);            mMid.set(mLeftMid.x + mWidth / 2f, mHeight - mWaterHeight);            mRightMid.set(mMid.x + mWidth / 2f, mHeight - mWaterHeight);            mRightTop.set(mRightMid.x + mWidth / 2f, mHeight - mWaterHeight);            mControlFirst.set(mLeftTop.x + mWidth / 4f, mLeftTop.y + mWaveTrough);            mControlSecond.set(mLeftMid.x + mWidth / 4f, mLeftMid.y - mWavePeak);            mControlThree.set(mMid.x + mWidth / 4f, mMid.y + mWaveTrough);            mControlFour.set(mRightMid.x + mWidth / 4f, mRightMid.y - mWaveTrough);        } else {            //å‘å·¦ç§»åŠ¨            mLeftTop.set(value, mHeight - mWaterHeight);            mLeftMid.set(mLeftTop.x - mWidth / 2f, mHeight - mWaterHeight);            mMid.set(mLeftMid.x - mWidth / 2f, mHeight - mWaterHeight);            mRightMid.set(mMid.x - mWidth / 2f, mHeight - mWaterHeight);            mRightTop.set(mRightMid.x - mWidth / 2f, mHeight - mWaterHeight);            mControlFirst.set(mLeftTop.x - mWidth / 4f, mLeftTop.y + mWaveTrough);            mControlSecond.set(mLeftMid.x - mWidth / 4f, mLeftMid.y - mWavePeak);            mControlThree.set(mMid.x - mWidth / 4f, mMid.y + mWaveTrough);            mControlFour.set(mRightMid.x - mWidth / 4f, mRightMid.y - mWaveTrough);        }        //è¿™é‡Œæˆ‘ä»¬åªå¯¹ç¬¬ä¸€ä¸ªæ³¢æµªè®¾ç½®äº†å›è°ƒ,æ‰€ä»¥å¿…é¡»è¦åˆ¤æ–­,ä¸æ˜¯ç©ºæ‰èƒ½é€šçŸ¥WaveViewé‡ç»˜        if (onRequestDraw != null) {            onRequestDraw.onDraw();        }    }</code></pre><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å®šä¹‰ä¸€å®šè¦æ¸…æ¥š,è¦ä¸ç„¶ä¼šæŠŠè‡ªå·±æ··è¿›å».</p><p>å…·ä½“ä»£ç è¯·åˆ°</p><blockquote><p> GIthub  :  <a href="https://github.com/wangzhumo/module_views" target="_blank" rel="noopener">https://github.com/wangzhumo/module_views</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidå¼€å‘xmlä¸­çš„æ ·å¼</title>
    <link href="undefined2018/07/26/Android-xml-style/"/>
    <url>2018/07/26/Android-xml-style/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æˆ‘ä»¬åœ¨Appä¸­,å¾ˆå¤šæ—¶å€™éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„é£æ ¼,æ ·å¼.å¦‚TextView,EditText,Button,ProgressBar,CheckBoxç­‰ç­‰,éƒ½éœ€è¦èƒŒæ™¯,é˜´å½±ç­‰.æˆ‘ä»¬å¯ä»¥ç”¨UIè®¾è®¡å¸ˆæä¾›çš„åˆ‡å›¾,ä½†æ˜¯å¦‚æœæˆ‘ä»¬èƒ½ä½¿ç”¨Androidæä¾›çš„<code>shapeã€selectorã€layer-listã€level-listã€styleã€theme</code>ç­‰å®ç°ä¼šæ›´å¥½.</p><p>ä¸‹é¢åšä¸€ä¸ªåŸºæœ¬ä½¿ç”¨çš„ç¬”è®°.</p><a id="more"></a><h3 id="Shape"><a href="#Shape" class="headerlink" title="Shape"></a>Shape</h3><p>shapeå®šä¹‰çš„xmlæ–‡ä»¶æˆ‘ä»¬éƒ½æ˜¯å­˜æ”¾åœ¨drawableç›®å½•ä¸‹ï¼Œå¦‚æœä½ çš„é¡¹ç›®æ²¡æœ‰åˆ™æ–°å»ºä¸€ä¸ª.</p><p>ä½¿ç”¨shapeå¯ä»¥é€šè¿‡android:shapeå±æ€§æŒ‡å®šä¸‹é¢å››ç§ç±»å‹çš„å½¢çŠ¶</p><ul><li><strong>rectangle</strong>: çŸ©å½¢</li><li><strong>oval</strong>: æ¤­åœ†å½¢</li><li><strong>line</strong>: çº¿å½¢</li><li><strong>ring</strong>: ç¯å½¢</li></ul><h4 id="åŸºæœ¬å±æ€§"><a href="#åŸºæœ¬å±æ€§" class="headerlink" title="åŸºæœ¬å±æ€§"></a>åŸºæœ¬å±æ€§</h4><ul><li><p><strong>corners</strong> è®¾ç½®åœ†è§’,rectangleçŸ©å½¢çš„æ—¶å€™ç”¨</p><p>å¯ä»¥<code>radius</code>ä½¿ç”¨æ‰€æœ‰çš„åœ†è§’,ä¹Ÿå¯ä»¥å•ç‹¬è®¾ç½®æ¯ä¸€ä¸ªåœ†è§’</p><ul><li>android:radius   å››ä¸ªåœ†è§’éƒ½ä¼šä½¿ç”¨è¿™ä¸ªå€¼</li><li><em>android:topLeftRadius</em> å·¦ä¸Šè§’çš„åŠå¾„</li><li><em>android:topRightRadius</em> å³ä¸Šè§’çš„åŠå¾„</li><li><em>android:bottomLeftRadius</em> å·¦ä¸‹è§’çš„åŠå¾„</li><li><em>android:bottomRightRadius</em> å³ä¸‹è§’çš„åŠå¾„</li></ul></li><li><p><strong>soid</strong>  è®¾ç½®å¡«å……è‰²</p><ul><li>android:color  å¡«å……è‰²</li></ul></li><li><p><strong>stroke</strong>  è®¾ç½®æè¾¹çº¿æ¡</p><ul><li><em>android:color</em> æè¾¹çº¿æ¡é¢œè‰²</li><li><em>android:width</em> æè¾¹çº¿æ¡å®½åº¦</li><li><em>android:dashWidth</em> è®¾ç½®çº¿æ¡ä¸ºè™šçº¿æ—¶çš„æ¨ªçº¿é•¿åº¦</li><li><em>android:dashGap</em> è®¾ç½®çº¿æ¡ä¸ºè™šçº¿æ—¶çš„æ¨ªçº¿ä¹‹é—´çš„é—´éš”</li></ul></li><li><p><strong>padding</strong>  å†…å®¹ä¸è¾¹ç•Œçš„å†…é—´è·</p><ul><li><em>android:left</em> å·¦å†…é—´è·</li><li><em>android:right</em> å³å†…é—´è·</li><li><em>android:top</em> ä¸Šå†…é—´è·</li><li><em>android:bottom</em> ä¸‹å†…é—´è·</li></ul></li><li><p><strong>gradient</strong>  è¿™ä¸ªå±æ€§å¯ä»¥ç»™ä½ çš„å›¾å½¢è®¾ç½®æ¸å˜</p><ul><li><p>android:type æ¸å˜çš„ç±»å‹   </p><ul><li>(ç¬¬ä¸€æ¬¡ç”¨æ–¹å½¢,å“ˆå“ˆ)  linear çº¿æ€§æ¸å˜</li><li>sweep æ‰«ææ¸å˜</li><li>radial æ”¾å°„æ¸å˜</li></ul></li><li><p>android:startColor æ¸å˜å¼€å§‹çš„é¢œè‰²</p></li><li><p>android:centerColor  æ¸å˜çš„ä¸­é—´è‰²</p></li><li><p>android:endColor  æ¸å˜ç»“æŸçš„é¢œè‰²</p></li><li><p>android:angle æ¸å˜çš„è§’åº¦,å½“ä½ è®¾ç½®çº¿æ€§æ¸å˜å¯ç”¨</p></li><li><p>android:centerX  æ¸å˜ä¸­å¿ƒçš„Xåæ ‡,å½“ä½ è®¾ç½®æ”¾å°„æ¸å˜æœ‰æ•ˆ</p></li><li><p>android:centerY   æ¸å˜ä¸­å¿ƒçš„Yåæ ‡ ,å½“ä½ è®¾ç½®æ”¾å°„æ¸å˜æœ‰æ•ˆ</p></li><li><p>android:gradientRadius  æ¸å˜çš„åŠå¾„,é’ˆå¯¹æ”¾å°„æ¸å˜</p></li></ul></li></ul><h5 id="rectangle"><a href="#rectangle" class="headerlink" title="rectangle"></a>rectangle</h5><p>åŒåŸºæœ¬å±æ€§</p><h5 id="line"><a href="#line" class="headerlink" title="line"></a>line</h5><p>stroke &amp; size ç»„åˆå®ç°,å¸¸ç”¨æ¥åšEditTextçš„å…‰æ ‡</p><h5 id="oval"><a href="#oval" class="headerlink" title="oval"></a>oval</h5><ul><li><strong>size</strong>   å¯ä»¥è®¾ç½®å›¾å½¢çš„å®½,é«˜<ul><li>android:width  å®½åº¦</li><li>android:height  é«˜åº¦</li></ul></li></ul><p>å…¶ä»–åŒåŸºæœ¬å±æ€§</p><h5 id="ring"><a href="#ring" class="headerlink" title="ring"></a>ring</h5><ul><li><strong>android:innerRadius</strong>  é‡Œé¢åœ†çš„åŠå¾„</li><li><strong>android:innerRadiusRatio</strong>  é»˜è®¤3,ä¾¿æ˜¯å†…åœ†åŠå¾„æ˜¯å®½åº¦/3 </li><li><strong>android:thickness</strong>   ç¯çš„å®½åº¦</li><li><strong>android:thicknessRatio</strong>  é»˜è®¤æ˜¯9,è¡¨ç¤ºç¯çš„å®½åº¦æ˜¯å®½åº¦/9</li></ul><pre><code class="xml-dtd">&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;    android:innerRadiusRatio=&quot;3&quot;    android:shape=&quot;ring&quot;    android:thicknessRatio=&quot;9&quot;    android:useLevel=&quot;false&quot;&gt;    &lt;gradient        android:endColor=&quot;@color/colorAccent&quot;        android:startColor=&quot;#FFFFFF&quot;        android:type=&quot;sweep&quot; /&gt;&lt;/shape&gt;</code></pre><p>å›¾ç¤º:</p><p><img src="/images/shape_ring.png" srcset="/img/loading.gif" alt="ring"></p><h3 id="Selector"><a href="#Selector" class="headerlink" title="Selector"></a>Selector</h3><p>selectorå¯ä»¥æ·»åŠ å¤šä¸ªItem,è¡¨ç¤ºä¸åŒçš„çŠ¶æ€çš„ä¸åŒèµ„æº.drawable &amp; color</p><p>è¦æ³¨æ„çš„:</p><ul><li><p>drawableçš„èµ„æºæ”¾åœ¨ drawableç›®å½•,å¹¶ä¸”æŒ‡å®šçš„æ˜¯ android:drawable</p></li><li><p>color çš„æ”¾åœ¨colorç›®å½•,å¹¶ä¸”æŒ‡å®š android:color </p></li></ul><p>é‚£ä¹ˆä¸‹é¢æˆ‘åˆ—ä¸¾å‡ºæ‰€æœ‰çš„å¯ä»¥è®¾ç½®çš„çŠ¶æ€</p><ul><li><strong>android:state_enabled</strong>: è®¾ç½®è§¦æ‘¸æˆ–ç‚¹å‡»äº‹ä»¶æ˜¯å¦å¯ç”¨çŠ¶æ€</li><li><strong>android:state_pressed</strong>: æ˜¯å¦æŒ‰å‹çŠ¶æ€</li><li><strong>android:state_selected</strong>: æ˜¯å¦é€‰ä¸­çŠ¶æ€ï¼Œtrueè¡¨ç¤ºå·²é€‰ä¸­ï¼Œfalseè¡¨ç¤ºæœªé€‰ä¸­</li><li><strong>android:state_checked</strong>: æ˜¯å¦å‹¾é€‰çŠ¶æ€</li><li><strong>android:state_checkable</strong>: å‹¾é€‰æ˜¯å¦å¯ç”¨çŠ¶æ€</li><li><strong>android:state_focused</strong>: æ˜¯å¦è·å¾—ç„¦ç‚¹çŠ¶æ€</li><li><strong>android:state_window_focused</strong>: å½“å‰çª—å£æ˜¯å¦è·å¾—ç„¦ç‚¹çŠ¶æ€</li><li><strong>android:state_activated</strong>: æ˜¯å¦è¢«æ¿€æ´»çŠ¶æ€</li><li><strong>android:state_hovered</strong>: æ˜¯åœ¨ä¸Šé¢æ»‘åŠ¨çš„çŠ¶æ€</li><li><strong>android:enterFadeDuration</strong>  çŠ¶æ€æ”¹å˜æ—¶çš„æ·¡å…¥æ—¶é—´</li><li><strong>android:exitFadeDuration</strong> çŠ¶æ€æ”¹å˜æ—¶æ—§çŠ¶æ€æ¶ˆå¤±çš„æ·¡å‡º</li></ul><h3 id="layout-list"><a href="#layout-list" class="headerlink" title="layout-list"></a>layout-list</h3><p>layer-listçš„ä½œç”¨æ˜¯æŠŠå¤šä¸ªdrawableæŒ‰ç…§é¡ºåºå±‚å åœ¨ä¸€èµ·æ˜¾ç¤º.</p><p>å®ƒæ—¢å¯ä»¥æ˜¯æ ¹èŠ‚ç‚¹,ä¹Ÿå¯ä»¥ä½œä¸ºselectorçš„Itemå­˜åœ¨.</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨layer-listçš„ç‰¹æ€§æ¥åšé˜´å½±æ•ˆæœ.</p><pre><code class="xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;    &lt;item        android:left=&quot;4dp&quot;        android:top=&quot;4dp&quot;&gt;        &lt;shape&gt;            &lt;solid android:color=&quot;@android:color/darker_gray&quot; /&gt;            &lt;corners android:radius=&quot;10dp&quot; /&gt;        &lt;/shape&gt;    &lt;/item&gt;    &lt;item        android:bottom=&quot;4dp&quot;        android:right=&quot;4dp&quot;&gt;        &lt;shape&gt;            &lt;solid android:color=&quot;@android:color/white&quot; /&gt;            &lt;corners android:radius=&quot;10dp&quot; /&gt;        &lt;/shape&gt;    &lt;/item&gt;&lt;/layer-list&gt;</code></pre><p><img src="/images/layer_list.png" srcset="/img/loading.gif" alt="layer"></p><p>layer-listçš„itemå¯ä»¥é€šè¿‡ä»¥ä¸‹å››ä¸ªå±æ€§æ¥è®¾ç½®åç§»é‡ï¼š</p><ul><li>android:top é¡¶éƒ¨åç§»é‡</li><li>android:bottom åº•éƒ¨åç§»é‡</li><li>android:left å·¦è¾¹åç§»é‡</li><li>android:right å³è¾¹åç§»é‡</li></ul><h3 id="level-list"><a href="#level-list" class="headerlink" title="level-list"></a>level-list</h3><p>level-listå¯ä»¥å­˜æ”¾å¤šå¼ drawable,æ¯ä¸€å¼ drawableå¯¹åº”ä¸€å®šçš„levelèŒƒå›´,ä½¿ç”¨æ—¶é€šè¿‡levelå€¼å±•ç¤ºå¯¹åº”çš„drawable</p><p><strong>android:drawable</strong> æŒ‡å®šdrawableèµ„æº</p><p><strong>android:minLevel</strong> è¯¥Drawableçš„æœ€å°levelå€¼</p><p><strong>android:maxLevel</strong> è¯¥Drawableçš„æœ€å¤§levelå€¼</p><pre><code class="xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;level-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;    &lt;item        android:drawable=&quot;@drawable/draw1&quot;        android:maxLevel=&quot;50&quot;        android:minLevel=&quot;0&quot; /&gt;    &lt;item        android:drawable=&quot;@drawable/draw2&quot;        android:maxLevel=&quot;100&quot;        android:minLevel=&quot;50&quot; /&gt;&lt;/level-list&gt;</code></pre>]]></content>
    
    
    <categories>
      
      <category>View</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android Studioä¸­ä½¿ç”¨CMakeè¿›è¡ŒJNIå¼€å‘</title>
    <link href="undefined2018/07/25/Android-Studio-CMake-JNI/"/>
    <url>2018/07/25/Android-Studio-CMake-JNI/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å®šä¸€ä¸ªå°ç›®æ ‡,æ›¿ä»£RenderScriptæ¥åšä¸€ä¸ªå›¾ç‰‡çš„é«˜æ–¯æ¨¡ç³Š,å› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€ƒéªŒæ€§èƒ½çš„æ“ä½œ,æ‰€ä»¥æˆ‘æ‰“ç®—ç”¨Cæ¥åšè¿™ä¸ªæ“ä½œ(ä¸»è¦åŸå› æ˜¯æˆ‘è‡ªå·±ä¸ä¼šå†™C++,åˆšå¥½çœ‹åˆ°æœ‰è¿™ä¸ªå¼€æºç®—æ³•â€¦)</p><h3 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h3><blockquote><p>new -&gt; new Module -&gt; Android Library </p></blockquote><p>å½“é¡¹ç›®åˆ›å»ºå¥½ä¹‹å,è¿™åªæ˜¯ä¸€ä¸ªå•çº¯çš„Library,å¹¶ä¸èƒ½ä½¿ç”¨JNIå¼€å‘</p><p>ä¸‹é¢,æˆ‘ä»¬æŠŠå®ƒæ”¹é€ ä¸€ä¸‹(ä¸‹å›¾æ˜¯æ”¹é€ å®Œæˆçš„ç›®å½•ç»“æ„):</p><a id="more"></a><p><img src="/images/jni_folder.png" srcset="/img/loading.gif" alt="file"></p><h4 id="æ·»åŠ CMakeLists-txt"><a href="#æ·»åŠ CMakeLists-txt" class="headerlink" title="æ·»åŠ CMakeLists.txt"></a>æ·»åŠ CMakeLists.txt</h4><blockquote><p>é€‰ä¸­lib_blur - new File - CMakeLists.txt</p></blockquote><pre><code class="java">cmake_minimum_required(VERSION 3.4.1)#è®¾ç½®ç”Ÿæˆçš„soåŠ¨æ€åº“æœ€åè¾“å‡ºçš„è·¯å¾„#set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/src/main/jniLibs/${ANDROID_ABI})add_library( # åº“å             sample             # è¯¥åº“ç”ŸæˆåŠ¨æ€å‡½æ•°             SHARED             # ä¾èµ–çš„æ–‡ä»¶             src/main/cpp/samplelib.cpp)find_library( # è®¾ç½®Pathå˜é‡çš„åç§°              log-lib              # æŒ‡å®šè¦æŸ¥è¯¢çš„åº“åå­—              # åœ¨ndkä¸­æŸ¥æ‰¾ liblog.so å‡½æ•°åº“              log )target_link_libraries( # ç›®æ ‡åº“                       sample                       # è¦é“¾æ¥çš„åº“                       android                       # Links the target library to the log library                       # included in the NDK.                       ${log-lib} )</code></pre><h4 id="ä¿®æ”¹build-grade"><a href="#ä¿®æ”¹build-grade" class="headerlink" title="ä¿®æ”¹build.grade"></a>ä¿®æ”¹build.grade</h4><pre><code class="groovy">android {    defaultConfig {        //...        ndk {            // è®¾ç½®æ”¯æŒçš„SOåº“æ¶æ„            abiFilters &#39;armeabi-v7a&#39;, &#39;x86&#39;        }        externalNativeBuild {            cmake {                cppFlags &quot;-std=c++14&quot;, &quot;-frtti&quot;, &quot;-fexceptions&quot;            }        }        }    //...    externalNativeBuild {        cmake {            path &quot;CMakeLists.txt&quot;        }    }}</code></pre><h4 id="ç¼–å†™C-æ–‡ä»¶"><a href="#ç¼–å†™C-æ–‡ä»¶" class="headerlink" title="ç¼–å†™C++æ–‡ä»¶"></a>ç¼–å†™C++æ–‡ä»¶</h4><p>æˆ‘ä»¬çš„Cæ–‡ä»¶éƒ½åœ¨<code>src/main/cpp</code>æ–‡ä»¶å¤¹ä¸‹,æ¯ä¸€ä¸ªCæ–‡ä»¶éƒ½éœ€è¦åœ¨<code>CMakeLists.txt</code>æ–‡ä»¶ä¸­æŒ‡å®š</p><pre><code class="groovy"> # ä¾èµ–çš„æ–‡ä»¶ src/main/cpp/samplelib.cpp</code></pre><p>samplelib.cpp</p><pre><code class="c++">#include &lt;jni.h&gt;#include &lt;stdlib.h&gt;#include &lt;string&gt;#include &lt;android/log.h&gt;#define TAG    &quot;JNI_LOG&quot;#define LOGE(...)  __android_log_print(ANDROID_LOG_ERROR,TAG ,__VA_ARGS__)using namespace std;#ifdef __cplusplusextern &quot;C&quot; {#endif//å®šä¹‰æˆ‘Javaæ–‡ä»¶çš„ä½ç½®,æ³¨æ„æ˜¯&#39;/&#39;åˆ†å¼€static const char *className = &quot;com/wangzhumo/app/commonlib/jni/JniManager&quot;;//è¿”å›ä¸€ä¸ªstringjstring stringFromJNI(JNIEnv *env,jclass clz) {    std::string hello = &quot;Hello from C++&quot;;    return env-&gt;NewStringUTF(hello.c_str());}//è¿”å›ä¸€ä¸ªstring å¹¶æŠŠè¿™å¥è¯æ‰“å°åˆ°logcatä¸­å»jstring sayHello(JNIEnv* env,jclass clz) {    std::string hello = &quot;Say Hello from C++&quot;;    LOGE(&quot;Say Hello and value&quot;);    return env-&gt;NewStringUTF(hello.c_str());}//è·å–æ‰€æœ‰æ–¹æ³•åstatic JNINativeMethod gJniMethods[] = {        {&quot;sayHello&quot;, &quot;()Ljava/lang/String;&quot;, (void*)sayHello},        {&quot;stringFromJNI&quot;, &quot;()Ljava/lang/String;&quot;, (void*)stringFromJNI},};//å…¶ä¸­{&quot;MethodName&quot;,&quot;(å…¥å‚)è¿”å›å€¼&quot;,()Method}//åŠ¨æ€æ³¨å†Œæœ¬åœ°æ–¹æ³•static int jniRegisterNativeMethods(JNIEnv* env, const char* className,                                    const JNINativeMethod* gMethods, int numMethods) {    jclass clazz;    clazz = (env)-&gt;FindClass( className);    if (clazz == NULL) {        return -1;    }    int result = 0;    if ((env)-&gt;RegisterNatives(clazz, gMethods, numMethods) &lt; 0) {        result = -1;    }    (env)-&gt;DeleteLocalRef(clazz);    return result;}//JNI_OnLoadå›è°ƒJNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* vm, void* reserved){    JNIEnv* env = NULL;    jint result = -1;    if (vm-&gt;GetEnv((void**) &amp;env, JNI_VERSION_1_6) != JNI_OK) {        return result;    }    jniRegisterNativeMethods(env, className, gJniMethods, sizeof(gJniMethods) / sizeof(JNINativeMethod));    return JNI_VERSION_1_6;}#ifdef __cplusplus}#endif</code></pre><h4 id="ç¼–å†™Javaæ–‡ä»¶"><a href="#ç¼–å†™Javaæ–‡ä»¶" class="headerlink" title="ç¼–å†™Javaæ–‡ä»¶"></a>ç¼–å†™Javaæ–‡ä»¶</h4><pre><code class="java">public class JniManager {    static{        System.loadLibrary(&quot;sample&quot;);    }    public static native String sayHello();    public static native String stringFromJNI();}</code></pre><h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><blockquote><p> Build -&gt; Make Project</p></blockquote><p>ç¼–è¯‘å®Œæˆ,å¦‚æœæˆåŠŸåˆ™ build -&gt; intermediates -&gt; cmake  ä¸‹å°±æœ‰ .soæ–‡ä»¶</p><p>å¦‚å›¾æ‰€ç¤º:</p><p><img src="/images/jni_so_file.png" srcset="/img/loading.gif" alt="so"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,ç”Ÿæˆäº† armeabi-v7a,  x86ä¸¤ç§ç±»å‹çš„.soæ–‡ä»¶,å¦‚æœä¸åœ¨build.gradleä¸­å£°æ˜:</p><pre><code class="groovy">ndk {    // è®¾ç½®æ”¯æŒçš„SOåº“æ¶æ„    abiFilters &#39;armeabi-v7a&#39;, &#39;x86&#39;}</code></pre><h3 id="è°ƒç”¨"><a href="#è°ƒç”¨" class="headerlink" title="è°ƒç”¨"></a>è°ƒç”¨</h3><pre><code class="kotlin">class MainActivity : AppCompatActivity() {    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_main)    }    override fun onResume() {        super.onResume()        Log.e(&quot;JNI&quot;,JniManager.sayHello())        Log.e(&quot;JNI&quot;,JniManager.stringFromJNI())    }}</code></pre><p>ç»“æœ:</p><pre><code class="shell">07-26 17:42:41.420 6685-6685/com.wangzhumo.playground E/JNI_LOG: Say Hello and value07-26 17:42:41.420 6685-6685/com.wangzhumo.playground E/JNI: Say Hello from C++07-26 17:42:41.420 6685-6685/com.wangzhumo.playground E/JNI: Hello from C++</code></pre><p>å…¶ä¸­<code>JNI_LOG</code>æ˜¯ç”± cpp ä¸­çš„æ–¹æ³•æ‰“å°åˆ°Androidçš„æ§åˆ¶å°çš„</p><p><code>JNI</code>æ˜¯æˆ‘ä»¬åœ¨MainActivityä¸­è°ƒç”¨çš„</p><pre><code class="kotlin"> Log.e(&quot;JNI&quot;,JniManager.sayHello()) Log.e(&quot;JNI&quot;,JniManager.stringFromJNI())</code></pre><h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>ä»¥ä¸Šè¯´æ˜æˆ‘çš„JNIç®—æ˜¯åˆæ­¥å®Œæˆäº†è°ƒç”¨</p><blockquote><p><a href="http://zhixinliu.com/2015/07/01/2015-07-01-jni-register/" target="_blank" rel="noopener">http://zhixinliu.com/2015/07/01/2015-07-01-jni-register/</a></p><p><a href="https://developer.android.com/ndk/guides/" target="_blank" rel="noopener">https://developer.android.com/ndk/guides/</a></p></blockquote><p>å‰è¨€ä¸­çš„FlagçœŸæ˜¯ç«‹çš„å¥½,C++ä¸æ˜¯å¾ˆä¼š,æ‰€ä»¥åªèƒ½å¾€ç®€å•äº†å†™,çœŸæ˜¯å¯æ€œçš„æˆ‘</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„-ä¸‹ç¬”è®°</title>
    <link href="undefined2018/07/22/Data-Structure-Note-1/"/>
    <url>2018/07/22/Data-Structure-Note-1/</url>
    
    <content type="html"><![CDATA[<p>ç®—æ³•</p><ul><li>è¾“å…¥,å¾…å¤„ç†çš„ä¿¡æ¯</li><li>è¾“å‡º,ç»å¤„ç†çš„ä¿¡æ¯</li><li>æ­£ç¡®æ€§,çš„ç¡®å¯ä»¥è§£å†³é—®é¢˜</li><li>ç¡®å®šæ€§,ä»»æ„ç®—æ³•éƒ½å¯ä»¥æè¿°ä¸ºç”±åŸºæœ¬æ“ä½œ(æ˜ç¡®,ç²¾å¯†çš„)ç»„æˆçš„åºåˆ—</li><li>å¯è¡Œæ€§,æ¯ä¸€åŸºæœ¬æ“ä½œéƒ½å¯ä»¥å®ç°,å¹¶åœ¨å¸¸æ•°æ—¶é—´å†…å®Œæˆ</li><li>æœ‰ç©·æ€§,å¯¹ä»»ä½•è¾“å…¥,ç»æœ‰ç©·æ¬¡åŸºæœ¬æ“ä½œ,éƒ½å¯ä»¥å¾—åˆ°è¾“å‡º</li></ul>]]></content>
    
    
    <categories>
      
      <category>Programme</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Programme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é€’å½’è°ƒç”¨åˆ›å»ºå•é“¾è¡¨</title>
    <link href="undefined2018/07/15/Recursion-Linked-List/"/>
    <url>2018/07/15/Recursion-Linked-List/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å¾ˆå¤šçš„é¢è¯•ä¸­,éƒ½æœ‰è¦æ±‚å®ç°ä¸€ä¸ªå•é“¾è¡¨,è¿™é‡Œå°±æä¸€ä¸ªè¯•è¯•.</p><a id="more"></a><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>Node.kt</p><pre><code class="kotlin">//åˆ›å»ºä¸€ä¸ªNodeclass Node(val value:Int){    var next : Node? = null}</code></pre><ol><li>è¿™ä¸ªNodeæœ‰ä¸€ä¸ª<code>value</code>,å®ƒæ˜¯ä¸€ä¸ªå¿…ä¼ ä¸”ä¸å¯ä¿®æ”¹çš„å‚æ•°,å°±ç›´æ¥æ”¾åœ¨äº†æ„é€ äº†</li><li><code>next</code>æŒ‡å‘äº†ä¸‹ä¸€ä¸ªNode,è¿™æ ·å°±å¯ä»¥å®Œæˆä¸€ä¸ªå•å‘çš„é“¾è¡¨,è®©æˆ‘æƒ³èµ·äº† <code>Message</code>çš„next</li><li><code>next</code>é»˜è®¤æ˜¯null,è¿™æ˜¯å› ä¸ºå•é“¾è¡¨æœ€åä¸€ä¸ª<code>next</code>ä¸­å°±æ˜¯null.</li></ol><p>ListCreated.kt</p><pre><code class="kotlin">class ListCreated {    fun createList(list: List&lt;Int&gt;): Node? {        //1.        if (list.isEmpty()) {            return null        }        //2.        val currentNode = Node(list[0])        println(&quot;before ${currentNode.value}&quot;)        //3.        val nextNode = createList(list.subList(1, list.size))        if (nextNode != null) {            println(&quot;after ${currentNode.value}&quot;)        }        //4.        currentNode.next = nextNode        return currentNode    }}class ListCreated {    fun createList(list: List&lt;Int&gt;): Node? {        //1.        if (list.isEmpty()) {            return null        }        //2.        val currentNode = Node(list[0])        println(&quot;before ${currentNode.value}&quot;)        //3.        val nextNode = createList(list.subList(1, list.size))        if (nextNode != null) {            println(&quot;after ${currentNode.value}&quot;)        }        //4.        currentNode.next = nextNode        return currentNode    }}</code></pre><ol><li>æˆ‘ä»¬éœ€è¦å»åˆ¤æ–­List,å¦‚æœä¸ºç©ºå°±ç›´æ¥è¿”å›nulläº†</li><li>è¿™é‡Œå°±æ˜¯å½“å‰çš„è¿™ä¸ªNode,ä¿å­˜äº†å½“å‰çš„value,ä½†æ˜¯nextè¿˜æ˜¯ä¸ºnullçš„</li><li>è¿™é‡Œå°±æ˜¯é€’å½’è°ƒç”¨çš„åœ°æ–¹,ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªsubList,å½“ç„¶æ˜¯å»æ‰äº†ç¬¬ä¸€ä¸ª,å› ä¸ºç¬¬ä¸€ä¸ªå·²ç»æ˜¯currentNodeäº†</li><li>æŠŠcurrentNodeçš„<code>next</code>æŒ‡å‘äº†nextNode,æ„æˆå•å‘</li></ol><p>MainTest.java</p><pre><code class="java">public class MainClass {    public static void main(String[] args){        List&lt;Integer&gt; integerList = Arrays.asList(1,4,6,2);        ListCreated created = new ListCreated();        Node node = created.createList(integerList);        printAll(node);    }    public static void printAll(Node node){        while (node != null){            System.out.print(node.getValue());            System.out.print(&quot; &quot;);            node = node.getNext();        }    }}</code></pre><p>æ‰“å°ç»“æœ:</p><pre><code>before 1before 4before 6before 2after 6after 4after 11 4 6 2</code></pre><p>æˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çŸ¥é“before 1,4,6,2 è€Œæ²¡æœ‰æ‰“å°,è¯´æ˜å‹å…¥äº†æ ˆ,æŒ‡ä»¤æ²¡æœ‰è¿”å›</p><p>afteræœ¬æ¥åº”è¯¥æ˜¯ 2,6,4,1çš„,ä¸ºä»€ä¹ˆ2æ²¡æœ‰æ‰“å°å‡ºæ¥,æ˜¯å› ä¸º</p><pre><code class="java">if (nextNode != null) {     println(&quot;after ${currentNode.value}&quot;)}</code></pre><p>é“¾è¡¨æœ€åä¸€ä¸ªNodeçš„<code>next</code>æ˜¯ä¸ºnullçš„,æ‰€ä»¥æ²¡æœ‰æ‰“å°</p><p>å‡ºæ ˆçš„é¡ºåº,ä¹Ÿæ˜¯æŒ‰ç…§æ ˆçš„è§„åˆ™,å…ˆè¿›åå‡º.</p><p><img src="/images/list_created.gif" srcset="/img/loading.gif" alt=""></p><p>å¯ä»¥çœ‹åˆ°å‡ºå…¥æ ˆçš„é¡ºåº</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-è£…é¥°è€…è®¾è®¡æ¨¡å¼</title>
    <link href="undefined2018/07/14/Design-Pattern-Decoration/"/>
    <url>2018/07/14/Design-Pattern-Decoration/</url>
    
    <content type="html"><![CDATA[<h3 id="è®¤è¯†è£…é¥°è€…æ¨¡å¼"><a href="#è®¤è¯†è£…é¥°è€…æ¨¡å¼" class="headerlink" title="è®¤è¯†è£…é¥°è€…æ¨¡å¼"></a>è®¤è¯†è£…é¥°è€…æ¨¡å¼</h3><p>è£…é¥°è€…æ¨¡å¼ä¸€èˆ¬ç”±ä¸€ä¸‹å‡ éƒ¨åˆ†ç»„æˆ:</p><ul><li>Componentï¼šè£…é¥°è€…å’Œè¢«è£…é¥°è€…çš„å…±åŒçˆ¶ç±»,æ˜¯ä¸€ä¸ªæ¥å£æˆ–è€…æŠ½è±¡ç±»,å®šä¹‰äº†åŸºæœ¬è¡Œä¸º</li><li>ConcreteComponentï¼šå…·ä½“çš„ç»„ä»¶å¯¹è±¡,å®ç°äº†ç»„ä»¶çš„æ¥å£,å®šä¹‰å…·ä½“å¯¹è±¡,é€šå¸¸å°±æ˜¯è¢«è£…é¥°è€…</li><li>Decoratorï¼šæŠ½è±¡è£…é¥°è€…,éœ€è¦ç»§æ‰¿Component,å®ƒå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªæŒ‡å‘Componentå®ä¾‹çš„å¼•ç”¨,å¯¹äºConcreteComponentæ¥è¯´,ä¸éœ€è¦çŸ¥é“Decoratorçš„å­˜åœ¨,å°±å¯ä»¥å®Œæˆå¯¹ConcreteComponentçš„è£…é¥°</li><li>ConcreteDecoratorï¼šå…·ä½“è£…é¥°è€…,æ¥å®Œæˆå…·ä½“çš„è£…é¥°åŠŸèƒ½,æ‰©å±•ConcreteComponent.</li></ul><a id="more"></a> <p>æˆ‘ä»¬çŸ¥é“åœ¨ç¼–ç ä¸­,å€¡å¯¼ä½¿ç”¨ç»„åˆ,è€Œä¸æ˜¯ç»§æ‰¿æ¥æ‰©å±•å’Œå¤ç”¨åŠŸèƒ½,è£…é¥°è€…æ¨¡å¼ä¹Ÿæ˜¯åŸºäºç»„åˆæ¥å®Œæˆçš„.è£…é¥°è€…æ¨¡å¼å¯ä»¥å¾ˆçµæ´»çš„ç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½,ä½œä¸ºä¸€ä¸ªå¤–éƒ¨çš„ç±»ç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½,è€Œä¸ç”¨ç›´æ¥ä¿®æ”¹å¯¹è±¡æœ¬èº«,æˆ–è€…åˆ›å»ºå­ç±».</p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>é‚£æˆ‘ä»¬å°±æŒ‰ç…§ä¸Šé¢çš„ç»“æ„,ä¸€ä¸€æ¥åˆ›å»º</p><p>å°±æ‹¿æˆ‘ä¸‹ç­åè¦å¹²çš„äº‹è¯´èµ·å§,æ¯å¤©ä¸‹ç­æˆ‘å›å®¶å¿…é¡»è¦èƒŒä¸€ä¼šå•è¯,è¿™ä¸ªæ˜¯æˆ‘çš„åŸºæœ¬ä»»åŠ¡</p><p>å¯é€‰çš„ä»»åŠ¡:</p><p>Coding   çœ‹ä¹¦  çœ‹ç”µè§†  ç©æ‰‹æœº</p><h4 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h4><pre><code class="kotlin">abstract class HomeWork{    //å®Œæˆäº†ä½œä¸š    open fun doWork() : String {        return &quot;ä¸‹ç­åä»»åŠ¡&quot;    }    //å®Œæˆä½œä¸šèŠ±è´¹æ—¶é—´    abstract fun costTime() : Int}</code></pre><p>å¯ä»¥çœ‹åˆ°,æˆ‘ä¸‹ç­åçš„ä»»åŠ¡,å®šä¹‰äº†ä¸€ä¸ªä»»åŠ¡,ä¸€ä¸ªè€—è´¹æ—¶é—´</p><p>è¿™ä¸ªComponentå¯ä»¥æ˜¯æ¥å£,ä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡ç±»,æ ¹æ®è‡ªå·±çš„éœ€è¦æ¥å®šå°±è¡Œ</p><h4 id="ConcreteComponent"><a href="#ConcreteComponent" class="headerlink" title="ConcreteComponent"></a>ConcreteComponent</h4><pre><code class="kotlin">class BaseWork : HomeWork(){    override fun doWork(): String {        return &quot;èƒŒå•è¯&quot;    }    override fun costTime() : Int {        return 30    }}</code></pre><h4 id="Decorator"><a href="#Decorator" class="headerlink" title="Decorator"></a>Decorator</h4><pre><code class="kotlin">abstract class Decorator : HomeWork(){    abstract override fun costTime(): Int}</code></pre><h4 id="ConcreteDecorator"><a href="#ConcreteDecorator" class="headerlink" title="ConcreteDecorator"></a>ConcreteDecorator</h4><pre><code class="kotlin">class ProgrammeWork(private val work : HomeWork) : Decorator(){    override fun doWork(): String {        return work.doWork() + &quot;  Coding&quot;    }    override fun costTime(): Int {        return work.costTime() + 45    }}class TelevisionWork(private val work: HomeWork) : Decorator(){    override fun doWork(): String {        return work.doWork() + &quot;  çœ‹ç”µè§†&quot;    }    override fun costTime(): Int {        return work.costTime() + 60    }}</code></pre><h3 id="æ‰§è¡Œç»“æœ"><a href="#æ‰§è¡Œç»“æœ" class="headerlink" title="æ‰§è¡Œç»“æœ"></a>æ‰§è¡Œç»“æœ</h3><pre><code class="java">public static void main(String[] args){        BaseWork work = new BaseWork();        System.out.println(work.doWork() +                String.format(&quot;  è€—è´¹æ—¶é—´ : %d åˆ†é’Ÿ&quot;, work.costTime()));        //å¦‚æœè¯´æˆ‘å¿ƒæƒ…å¥½è¿˜å­¦äº†ä¸€ä¼šä»£ç         ProgrammeWork programmeWork = new ProgrammeWork(work);        System.out.println(programmeWork.doWork() +                String.format(&quot;  è€—è´¹æ—¶é—´ : %d åˆ†é’Ÿ&quot;, programmeWork.costTime()));        //æœ¬æ¥æƒ³ç¡äº†,ä½†æ˜¯åª³å¦‡çœ‹çš„ç”µè§†ç‰¹å¥½çœ‹,æˆ‘åˆå»çœ‹äº†ç”µè§†        TelevisionWork tvWork = new TelevisionWork(programmeWork);        System.out.println(tvWork.doWork() +                String.format(&quot;  è€—è´¹æ—¶é—´ : %d åˆ†é’Ÿ&quot;, tvWork.costTime()));}//Run:èƒŒå•è¯  è€—è´¹æ—¶é—´ : 30 åˆ†é’ŸèƒŒå•è¯  Coding  è€—è´¹æ—¶é—´ : 75 åˆ†é’ŸèƒŒå•è¯  Coding  çœ‹ç”µè§†  è€—è´¹æ—¶é—´ : 135 åˆ†é’ŸProcess finished with exit code 0</code></pre><p>å…¶å®æˆ‘è§‰å¾—è£…é¥°è€…å’Œä»£ç†æ¨¡å¼å¾ˆåƒ,åƒåˆ°æˆ‘æƒ³ä¸åˆ°æœ‰ä»€ä¹ˆæœ¬è´¨çš„å·®å¼‚,å¯èƒ½æ˜¯æˆ‘è‡ªå·±æ²¡æœ‰æ·±åˆ»çš„ç†è§£è¿™ä¸¤ä¸ªè®¾è®¡æ¨¡å¼,æ‰€ä»¥æˆ‘å¸Œæœ›ä¸‹æ¬¡æœ‰æœºä¼šèƒ½ææ˜ç™½.</p><blockquote><p><a href="https://blog.csdn.net/yeguxin/article/details/77337649" target="_blank" rel="noopener">https://blog.csdn.net/yeguxin/article/details/77337649</a></p></blockquote><p>è¿™é‡Œæ˜¯æˆ‘ç°åœ¨è§‰å¾—è®²çš„æœ‰ç‚¹é“ç†çš„.</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨</title>
    <link href="undefined2018/07/14/Design-pattern-State/"/>
    <url>2018/07/14/Design-pattern-State/</url>
    
    <content type="html"><![CDATA[<h3 id="çŠ¶æ€æ¨¡å¼-State"><a href="#çŠ¶æ€æ¨¡å¼-State" class="headerlink" title="çŠ¶æ€æ¨¡å¼(State)"></a>çŠ¶æ€æ¨¡å¼(State)</h3><h4 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h4><p>å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸º,å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»,çŠ¶æ€æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨ç¼–ç çš„è¿‡ç¨‹ä¸­,æœ‰ä»€ä¹ˆåœ°æ–¹ä¼šé‡åˆ°è¿™æ ·çš„çŠ¶å†µé‚£?</p><a id="more"></a><h4 id="ç»„æˆ"><a href="#ç»„æˆ" class="headerlink" title="ç»„æˆ"></a>ç»„æˆ</h4><p>ç¯å¢ƒç±»(Context) :  å®ƒå†…éƒ¨ç»´æŠ¤ä¸€ä¸ªStateå­ç±»çš„å®ä¾‹,è¿™ä¸ªå®ä¾‹å®šä¹‰çš„æ˜¯å½“å‰çŠ¶æ€.</p><p>æŠ½è±¡çŠ¶æ€ç±»(State) : å®šä¹‰ä¸€ä¸ªæ¥å£,å…¶ä¸­å°è£…Contextçš„ä¸€ä¸ªç‰¹å®šçŠ¶æ€çš„ç›¸å…³è¡Œä¸º.</p><p>å…·ä½“çŠ¶æ€ç±»(ConcreteState): å®ç°ä¸€ä¸ªä¸Contextçš„ä¸€ä¸ªçŠ¶æ€ç›¸å…³çš„è¡Œä¸º.</p><h4 id="ä½¿ç”¨æƒ…å†µ"><a href="#ä½¿ç”¨æƒ…å†µ" class="headerlink" title="ä½¿ç”¨æƒ…å†µ"></a>ä½¿ç”¨æƒ…å†µ</h4><ol><li>å¦‚æœä¸€ä¸ªå¯¹è±¡,å®ƒçš„è¡Œä¸ºå®Œå…¨å–å†³äºå®ƒçš„æŸä¸€ç§çŠ¶æ€,è€Œä¸”è¿™ä¸ªçŠ¶æ€æ˜¯åŠ¨æ€å˜åŒ–çš„.</li><li>ä»£ç ä¸­åŒ…å«å¤§é‡ä¸å¯¹è±¡çŠ¶æ€æœ‰å…³çš„æ¡ä»¶è¯­å¥</li></ol><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p>ç°åœ¨æœ‰è¿™ä¹ˆä¸€ä¸ªéœ€æ±‚,ç”¨æˆ·åˆ†ä¸ºä¸åŒçš„ç­‰çº§,æ¯ä¸ªç­‰çº§æ‰€è¿›è¡Œçš„æ“ä½œæ˜¯ä¸ä¸€æ ·çš„.</p><p>State</p><pre><code class="kotlin">interface UserState{  //æ¥æ”¶ä¸€ä¸ªä»·æ ¼,å†è¿”å›ä¸€ä¸ªå¤„ç†åçš„ä»·æ ¼    fun pay (level:Double) : Double}</code></pre><p>ConcreteState</p><pre><code class="kotlin">class NormalState :UserState{    override fun pay(level: Double): Double {        val result = level * 1.0        println(&quot;${javaClass.simpleName} éœ€è¦æ”¯ä»˜ : $result&quot;)        return result    }}class BossState : UserState{    override fun pay(level: Double): Double {        val result = 0        println(&quot;${javaClass.simpleName} éœ€è¦æ”¯ä»˜ : $result&quot;)        return 0.0    }}class VIPState : UserState{    override fun pay(level: Double): Double {        //ä¼šå‘˜95%        val result = level * 0.95        println(&quot;${javaClass.simpleName} éœ€è¦æ”¯ä»˜ : $result&quot;)        return result    }}</code></pre><p>Context</p><pre><code class="kotlin">class UserContext{    //ä¿å­˜çŠ¶æ€    private var mState : UserState = NormalState()    fun setUser(state: UserState){        this.mState = state    }    fun pay(price:Double){        mState.pay(price)    }}</code></pre><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><pre><code class="java">public class MainClass {    public static void main(String[] args){        UserContext userContext  = new UserContext();        userContext.pay(1000);        userContext.setUser(new VIPState());        userContext.pay(1000);        userContext.setUser(new BossState());        userContext.pay(1000);    }}//result:NormalState éœ€è¦æ”¯ä»˜ : 1000.0VIPState éœ€è¦æ”¯ä»˜ : 950.0BossState éœ€è¦æ”¯ä»˜ : 0Process finished with exit code 0</code></pre><h3 id="StateMachineå¤æ‚çš„çŠ¶æ€æœº"><a href="#StateMachineå¤æ‚çš„çŠ¶æ€æœº" class="headerlink" title="StateMachineå¤æ‚çš„çŠ¶æ€æœº"></a>StateMachineå¤æ‚çš„çŠ¶æ€æœº</h3><p>çœ‹ç€æ˜¯æ²¡å•¥ç”¨çš„ä¸œè¥¿,æ˜æ˜å¯ä»¥ç”¨if else æå®šçš„,ä¸ºä»€ä¹ˆä¸€å®šè¦ä½¿ç”¨è®¾è®¡æ¨¡å¼,è€Œä¸”è¿˜å¤šäº†å¥½å‡ ä¸ªç±»</p><p>åªæ˜¯æˆ‘è¿™é‡Œå†™çš„ä¾‹å­å¤ªç®€å•,ä½†è¿˜æ˜¯æŠŠstate å’Œ è¡Œä¸ºæ‹‰äº†å‡ºæ¥,å¦‚æœåé¢è¦åŠ çŠ¶æ€å†æ·»åŠ å®ç°ç±»å³å¯</p><p>BUTè¿™åªæ˜¯æœ€ç®€å•çš„å®ç°,æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ç³»ç»Ÿä¸­æœ‰ä»€ä¹ˆé«˜çº§çš„ä¸œè¥¿</p><p><code>com/android/internal/util/StateMachine.java</code></p><p>å½“æˆ‘çœ‹åˆ°è¿™ä¸ªç±»,æˆ‘ä¸€ä¸‹å°±æ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨çŠ¶æ€æ¨¡å¼</p><p>æˆ‘ä»¬ç°åœ¨çš„ç»“æ„,éå¸¸ç®€å•,ç¡®å®å¯ä»¥è¢«if elseæ›¿æ¢,åªæ˜¯ä¸é‚£ä¹ˆä¼˜é›…</p><p><img src="/images/state_simple.png" srcset="/img/loading.gif" alt=""></p><p>ä½†æ˜¯å¦‚æœ,ä½ çš„Stateæ˜¯è¿™æ ·çš„é‚£?</p><p><img src="/images/state_level.png" srcset="/img/loading.gif" alt=""></p><p>ä½ è¿˜å¯ä»¥ç”¨if - elseä¹ˆ?è¿™æ—¶å€™ç»™ä½ åŠ ä¸€ä¸ªstate,ä¸è¯´æ”¹ä»£ç ,èµ·ç è¦ç†ä¸€ä¼šæ‰è¡Œ</p><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><pre><code class="java">SmHandle sm;//æ·»åŠ çŠ¶æ€sm.addState(S0,null);//S1 S2æ·»åŠ ä¸ºS0çš„å­ç±»sm.addState(S1,S0);sm.addState(S2,S0);//S3 S3æ·»åŠ ä¸ºS1çš„å­ç±»sm.addState(S3,S1);sm.addState(S4,S1);//S5 S6 S7æ·»åŠ ä¸ºS2çš„å­ç±»sm.addState(S5,S2);sm.addState(S6,S2);sm.addState(S7,S2);//è®¾ç½®åˆå§‹çŠ¶æ€setInitialState(S4);</code></pre><p>è¿™æ ·ä¼šæ„é€ æˆ</p><p><img src="/images/state_demo.png" srcset="/img/loading.gif" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RecyclerViewä¸­notifyItemRangeChangedæ— æ•ˆçš„BUG</title>
    <link href="undefined2018/07/13/RecyclerView-unuseful-notifyItemRangeChanged/"/>
    <url>2018/07/13/RecyclerView-unuseful-notifyItemRangeChanged/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>RecyclerViewæ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç”¨çš„æœ€é¢‘ç¹çš„å‡ ä¸ªæ§ä»¶ä¹‹ä¸€,å¯ä»¥è¯´ä¸€ä¸ªAppæ²¡æœ‰RecyclerViewçš„å‚ä¸,å¯èƒ½æ ¹æœ¬å°±åšä¸å‡ºæ¥.ç„¶è€ŒåŒæ—¶,RecyclerViewå°½ç®¡æœ‰å¤ç”¨æœºåˆ¶,æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™,è¿˜æ˜¯åº”è¯¥å°½é‡çš„èŠ‚çœå†…å­˜,æé«˜æ€§èƒ½.</p><p>æ‰€ä»¥,å¯¹äºRecyclerViewä¸­çš„Item,å°½é‡å°‘åˆ·æ–°,è¶Šå°‘è¶Šå¥½.</p><a id="more"></a><p><code>notifyItemRangeChanged</code>æ˜¯ä¸»è¦çš„ä¸€ä¸ªæ–¹æ³•,å…¶ä»–çš„<code>notifyItemChanged</code>ç­‰å‡ ä¸ªä¸åŒå…¥å‚çš„æ–¹æ³•,å…¶å®æœ€åéƒ½æ˜¯è°ƒç”¨notifyItemRangeChanged:</p><pre><code class="java">android.support.v7.widget.RecyclerView.Adapter#notifyItemRangeChanged(int positionStart, int itemCount, @Nullable Object payload)</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒçš„å‡ ä¸ªå‚æ•°</p><blockquote><p>positionStart   å¼€å§‹çš„ä½ç½®</p><p>itemCount       éœ€è¦åˆ·æ–°å‡ ä¸ªItem</p><p>payload            è¿™ä¸ªå‚æ•°æ¯”è¾ƒé‡è¦,å¦‚æœå®ƒä¸ºnull,åˆ™å›è°ƒä¸­ä¼šåˆ·æ–°æ•´ä¸ªViewè€Œä¸æ˜¯å±€éƒ¨åˆ·æ–°</p></blockquote><p>å¥½äº†,æˆ‘ä»¬æ¥è¯´è¯´è¿™ä¸ªBUG</p><p><img src="/images/yhcs_zan.png" srcset="/img/loading.gif" alt=""></p><p>çœ‹åˆ°èµ,è¯„è®ºä¸¤ä¸ªå­—æ®µäº†ä¹ˆ?  ç°åœ¨çš„éœ€æ±‚æ˜¯è¦åŠ ä¸€ä¸ªé˜…è¯»é‡çš„,å¦‚å›¾ä¸­çš„çº¢è‰²å­—</p><p>è¿™ä¸ªé˜…è¯»é‡æœ¬åœ°å…ˆåšä¸€ä¸ªç‚¹å‡»å°±åŠ ä¸€çš„ä¸œè¥¿,è€Œä¸å»è¯·æ±‚ç½‘ç»œæ¥åˆ·æ–°.</p><p>å…¶å®æ€ä¹ˆåˆ·è¿™ä¸ªèµéƒ½è¡Œ,æˆ‘ä»¬éƒ½éœ€è¦å…ˆæä¾›ä¸€ä¸ªä¿®æ”¹è¿™ä¸€ä¸ª   é˜…è¯»é‡View  çš„åŠŸèƒ½</p><p>æ‰€ä»¥æˆ‘ç†æ‰€å½“ç„¶çš„ç”¨<code>notifyItemRangeChanged</code>æ¥åšäº†ä¸€é.</p><h3 id="BUGå†ç°"><a href="#BUGå†ç°" class="headerlink" title="BUGå†ç°"></a>BUGå†ç°</h3><p>å½“æˆ‘ä¿¡å¿ƒæ»¡æ»¡çš„æŠŠè¿™ä¸ªè¿è¡Œåˆ°çœŸæœºä¸Šæµ‹è¯•çš„æ—¶å€™,æˆ‘æ˜¯æ‹’ç»çš„,è¿™ä¸ªé˜…è¯»é‡çš„æ•°å­—,ä¸€ç›´ä¿æŒ0</p><p>ä¸€åŠ¨ä¹Ÿä¸åŠ¨,äºæ˜¯æˆ‘å°±å¼€å§‹äº†ä¸€æ­¥æ­¥çš„æ’é™¤ä¹‹æ—….å±‹æ¼åé€¢è¿å¤œé›¨,æˆ‘çš„æ•°æ®çº¿å¥½åƒæœ‰ç‚¹æ¥è§¦ä¸è‰¯,åªå¾—å¼€å¯äº†WIFI ADBç”¨æ¥è°ƒè¯•App,ä½†æ˜¯è¿™å°±æ„å‘³ç€æˆ‘ä¸èƒ½ debugäº†,é‚£ä¹ˆæˆ‘åªèƒ½ä½¿å‡º Log å¤§æ³•.</p><p>å…ˆè´´ä¸Šæˆ‘å½“æ—¶çš„ä»£ç :</p><pre><code class="java">    @Override    protected void onBindViewHolder(@NonNull ViewHolder holder, @NonNull MediaItem item, @NonNull List&lt;Object&gt; payloads) {        Log.d(&quot;Adapter&quot;,&quot;onBindViewHolder&quot; + payloads.isEmpty());        if (payloads.isEmpty()){            onBindViewHolder(holder, item);        }else{            holder.mTvPvNum.setText(payloads.get(0).toString());        }    }    @Override    protected void onBindViewHolder(@NonNull ViewHolder holder, @NonNull MediaItem item) {        holder.mTvMediaAuthor.setText(item.getSourceName());        holder.mTvMediaTime.setText(DateFormatUtil.getDataStringForNews(item.getPublishTimeBO()));        //   çœç•¥å…¶ä»–ä¸ç›¸å…³ä»£ç ...        holder.itemView.setOnClickListener(v -&gt; {            if (onNewsClickListener != null) {                Log.d(&quot;Adapter&quot;,&quot;onBindViewHolder&quot; + item.getFormatPvNum());               getAdapter().notifyItemChanged(holder.getAdapterPosition(),item.addPvNum().getFormatPvNum());                onNewsClickListener.onArticleClick(item);            }        });    }</code></pre><h4 id="ä½¿ç”¨notifyItemChanged"><a href="#ä½¿ç”¨notifyItemChanged" class="headerlink" title="ä½¿ç”¨notifyItemChanged"></a>ä½¿ç”¨notifyItemChanged</h4><ol><li>è°ƒç”¨<code>notifyItemXXX</code>ç³»åˆ—æ–¹æ³•</li><li>åœ¨<code>onBindViewHolder(ViewHolder,MediaItem item,List&lt;Object&gt; payloads)</code>æ–¹æ³•ä¸­åˆ¤æ–­<code>List&lt;Object&gt; payloads</code>çš„å€¼<ul><li>å¦‚æœpayloadså€¼ä¸ºç©º,åˆ™åˆ·æ–°å…¨éƒ¨,æˆ‘è¿™é‡Œç›´æ¥è°ƒç”¨äº†<code>onBindViewHolder(holder, item);</code>æ¥è¿›è¡Œæ•´ä¸ªItemçš„æ›´æ–°</li><li>å¦‚æœpayloadsçš„å€¼ä¸ä¸ºç©º,åˆ™è¿›è¡Œå±€éƒ¨æ›´æ–°å³å¯</li></ul></li></ol><h4 id="é¢„æœŸæ•ˆæœ"><a href="#é¢„æœŸæ•ˆæœ" class="headerlink" title="é¢„æœŸæ•ˆæœ"></a>é¢„æœŸæ•ˆæœ</h4><p>åœ¨ç‚¹å‡»æ•´ä¸ªItemæ—¶è°ƒç”¨ä¹‹å‰å‡†å¤‡çš„å›è°ƒæ–¹æ³•,å¹¶ä¸”</p><pre><code class="java">getAdapter().notifyItemChanged(postion,item.addPvNum().getFormatPvNum());</code></pre><p>é‚£ä¹ˆå¯¹åº”postionä½ç½®çš„Itemåº”è¯¥ä¼šåˆ·æ–°å®ƒçš„  <strong>é˜…è¯»é‡</strong> </p><h4 id="BUGå‘ç”ŸåŸå› æ¢ç´¢"><a href="#BUGå‘ç”ŸåŸå› æ¢ç´¢" class="headerlink" title="BUGå‘ç”ŸåŸå› æ¢ç´¢"></a>BUGå‘ç”ŸåŸå› æ¢ç´¢</h4><h5 id="å·²çŸ¥æ¡ä»¶-é€šè¿‡Logå¯çŸ¥"><a href="#å·²çŸ¥æ¡ä»¶-é€šè¿‡Logå¯çŸ¥" class="headerlink" title="å·²çŸ¥æ¡ä»¶(é€šè¿‡Logå¯çŸ¥)"></a>å·²çŸ¥æ¡ä»¶(é€šè¿‡Logå¯çŸ¥)</h5><ol><li>è°ƒç”¨<code>notifyItemChanged</code>æˆåŠŸäº†</li><li><code>onBindViewHolder(ViewHolder, item,List&lt;Object&gt; payloads)</code>æ–¹æ³•æ²¡æœ‰è¢«æˆåŠŸè°ƒèµ·</li></ol><h5 id="æ¨æµ‹åŸå› "><a href="#æ¨æµ‹åŸå› " class="headerlink" title="æ¨æµ‹åŸå› "></a>æ¨æµ‹åŸå› </h5><p>å¦‚æœè¯´æˆ‘å½“å‰çš„è¿™ä¸ªAdapterç¡®å®è°ƒç”¨äº†<code>notifyItemChanged</code>,å¹¶ä¸”å‚æ•°æ— è¯¯,ä½†æ˜¯å´æ— æ³•æ‹‰èµ·å›è°ƒ</p><p>åªèƒ½æ˜¯å›è°ƒæ–¹æ³•æ²¡æœ‰è¢«è°ƒèµ·,æˆ‘è®°èµ·æ¥äº†ä¸€äº›å½“æ—¶çœ‹è¿‡çš„RecyclerViewæºç </p><p>æ…¢æ…¢è¯´èµ·:</p><pre><code class="java">public void setAdapter(Adapter adapter) {        // bail out if layout is frozen        setLayoutFrozen(false);        setAdapterInternal(adapter, false, true);        processDataSetCompletelyChanged(false);        requestLayout();    }</code></pre><p>RecyclerViewä¸­çš„<code>setAdapter</code>,æˆ‘ä»¬åªéœ€è¦å…³æ³¨å…¶ä¸­çš„<code>setAdapterInternal(adapter, false, true);</code></p><p>æš‚æ—¶ä¸ç”¨å»äº†è§£å…¶ä»–å‡ ä¸ªæ–¹æ³•,è¿™4ä¸ªæ–¹æ³•ä¸­åªæœ‰è¿™ä¸€ä¸ªæ–¹æ³•å‚æ•°ä¸­å¸¦äº†<code>adapter</code>,è¯´æ˜å°±æ˜¯è¿™ä¸ªæ–¹æ³•æŠŠRecyclerViewå’ŒAdapterå…³è”äº†èµ·æ¥.</p><pre><code class="java">private void setAdapterInternal(Adapter adapter, boolean compatibleWithPrevious,            boolean removeAndRecycleViews) {        if (mAdapter != null) {            mAdapter.unregisterAdapterDataObserver(mObserver);            mAdapter.onDetachedFromRecyclerView(this);        }        if (!compatibleWithPrevious || removeAndRecycleViews) {            removeAndRecycleViews();        }        mAdapterHelper.reset();        final Adapter oldAdapter = mAdapter;        mAdapter = adapter;        if (adapter != null) {            adapter.registerAdapterDataObserver(mObserver);            adapter.onAttachedToRecyclerView(this);        }        if (mLayout != null) {            mLayout.onAdapterChanged(oldAdapter, mAdapter);        }        mRecycler.onAdapterChanged(oldAdapter, mAdapter, compatibleWithPrevious);        mState.mStructureChanged = true;}</code></pre><p>çœ‹èµ·æ¥,æ˜¯æŠŠè€çš„Adapteræ¸…é™¤,å¹¶è®¾ç½®ä¼ å…¥çš„adapterä¸ºAdapterçš„å€¼</p><pre><code class="java">if (adapter != null) {      adapter.registerAdapterDataObserver(mObserver);      adapter.onAttachedToRecyclerView(this);}</code></pre><p>é‡ç‚¹åœ¨è¿™å¥è¯<code>adapter.registerAdapterDataObserver(mObserver);</code></p><p>å¾ˆæ˜æ˜¾,è¿™æ˜¯å¯¹æ•°æ®å˜åŒ–æ³¨å†Œæˆä¸ºä¸€ä¸ªè§‚å¯Ÿè€…,æŸ¥çœ‹æºç å‘ç°æœ€åæ˜¯æ”¾åˆ°äº† <code>mObservable</code> ä¸­</p><p>å¤§æ¦‚å·²ç»çŸ¥é“æ˜¯æ€ä¹ˆå›äº‹äº†,å¯èƒ½æˆ‘ä»¬å½“å‰çš„Adapteræ²¡æœ‰æ³¨å†Œä¸Šè§‚å¯Ÿè€…,æ‰€ä»¥æ²¡æœ‰å›è°ƒè¿‡æ¥å§.</p><p>ä¸ºäº†è¯å®æˆ‘çš„çŒœæµ‹,æˆ‘å€Ÿäº†åŒäº‹çš„æµ‹è¯•æœºå’Œçº¿</p><h5 id="è¯å®çŒœæƒ³"><a href="#è¯å®çŒœæƒ³" class="headerlink" title="è¯å®çŒœæƒ³"></a>è¯å®çŒœæƒ³</h5><p>å¼€å¯DEBUGä¸€æ­¥ä¸€æ­¥è·Ÿè¿‡æ¥.</p><pre><code>android.support.v7.widget.RecyclerView.AdapterDataObserver#onItemRangeChanged(int, int)</code></pre><p>æœ€å,è·‘åˆ°äº†è¿™é‡Œæ¥.ä¸€ä¸ªçœŸçœŸæ­£æ­£çš„ç©ºæ–¹æ³•</p><p>äºæ˜¯æŸ¥çœ‹äº†ä¸€ä¸‹<code>mObservable</code>,åªæœ‰ä¸€ä¸ªå€¼<code>RefreshAndLoadMoreHelper</code>,è€Œæˆ‘è‡ªå·±çš„Adapteræ˜æ˜æ˜¯å«åš<code>MultiTypeAdapter</code></p><p>çœ‹åˆ°è¿™é‡Œ,æˆ‘çš„çŒœæƒ³å·²ç»è¯å®,<code>RefreshAndLoadMoreHelper</code>æ˜¯æˆ‘è‡ªå·±å°è£…,ç”¨æ¥æ”¯æŒä¸Šæ‹‰åŠ è½½,ä¸‹æ‹‰åˆ·æ–°çš„å·¥å…·ç±»,å…¶å®å®ƒè‡ªå·±ä¹Ÿç»§æ‰¿äº†RecyclerView.Adapter,å¹¶ä¸”åœ¨<code>RefreshAndLoadMoreHelper</code>çš„æ„é€ æ–¹æ³•ä¸­,è°ƒç”¨äº†</p><p><code>recyclerView.setAdapter(mHeaderFooterAdapter);</code>,è¿™å°±æ˜¯è¯´,æˆ‘è‡ªå·±è®¾ç½®çš„Adapteræ°¸è¿œä¼šè¢«å®ƒè¦†ç›–.</p><h3 id="è§£å†³BUG"><a href="#è§£å†³BUG" class="headerlink" title="è§£å†³BUG"></a>è§£å†³BUG</h3><p>å·²ç»çŸ¥é“äº†åŸå› ,æ˜¯ç”±äºæˆ‘è‡ªå·±çš„å·¥å…·ç±»,æ›¿ä»£äº†æœ¬æ¥è®¾ç½®çš„Adapter,,ç°åœ¨çš„<code>mHeaderFooterAdapter</code>æ˜¯ä¸å½“å‰RecyclerViewå…³è”çš„,ä½†æ˜¯æˆ‘ä»¬åœ¨ä»£ç ä¸­</p><p>è°ƒç”¨çš„æ˜¯(å¼€å¤´çš„ä»£ç ):</p><pre><code class="java">getAdapter().notifyItemChanged(holder.getAdapterPosition(),item.addPvNum().getFormatPvNum());</code></pre><p>getAdapter()è¿”å›çš„æ˜¯Adapterè€Œä¸æ˜¯å…³è”RecyclerViewçš„<code>mHeaderFooterAdapter</code></p><p>æ‰€ä»¥,æˆ‘ä»¬åªè¦æƒ³åŠæ³•,åœ¨Adapterä¸­è°ƒç”¨äº†æ–¹æ³•å,é€šçŸ¥<code>mHeaderFooterAdapter</code>ä¸€å£°,è®©å®ƒå»å®Œæˆæ“ä½œå³å¯</p><p><strong>ä»£ç å¦‚ä¸‹:</strong></p><pre><code class="java">Adapter.registerAdapterDataObserver(new RecyclerView.AdapterDataObserver() {            @Override            public void onChanged() {                mHeaderFooterAdapter.notifyDataSetChanged();            }            @Override            public void onItemRangeChanged(int positionStart, int itemCount, @Nullable Object payload) {                mHeaderFooterAdapter.notifyItemRangeChanged(positionStart, itemCount, payload);            }        });</code></pre><p><code>Adapter</code>æ˜¯æˆ‘è‡ªå·±åŸæ¥è®¾ç½®çš„</p><p><code>mHeaderFooterAdapter</code>æ˜¯å·¥å…·ç±»</p><p>è¿™é‡Œé¢çš„æ„æ€å°±æ˜¯,ç»™æˆ‘è‡ªå·±çš„Adapteræ³¨å†Œäº†ä¸€ä¸ªè§‚å¯Ÿè€…,æ¯å½“æˆ‘åœ¨Adapterä¸­è°ƒç”¨äº†æ–¹æ³•,å°±ä¼šå›è°ƒè¿™é‡Œ,åœ¨è¿™é‡Œæœ¬æ¥æ˜¯é€šçŸ¥RecyclerViewæ¥å¤„ç†çš„,ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦ç›´æ¥æ¥å¤„ç†,å§”æ‰˜ç»™<code>mHeaderFooterAdapter</code>å³å¯,æ‰€ä»¥æˆ‘åœ¨å›è°ƒä¸­ç›´æ¥è°ƒç”¨äº†,<code>mHeaderFooterAdapter.notifyItemRangeChanged</code>è¿™æ ·å°±OKäº†.</p>]]></content>
    
    
    <categories>
      
      <category>Bug</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Bug</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ConstraintLayoutä½¿ç”¨æŒ‡å—-åŸºç¡€çš„çº¦æŸ</title>
    <link href="undefined2018/07/12/ConstraintLayout-Basic/"/>
    <url>2018/07/12/ConstraintLayout-Basic/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ConstraintLayoutç°åœ¨å·²ç»æ˜¯æ–°å»ºå¸ƒå±€çš„é»˜è®¤è·Ÿå¸ƒå±€äº†,å†µä¸”ç¡®å®å¥½ç”¨,æœ‰å¿…è¦å­¦ä¹ ä¸€æ³¢</p><p> <a href="https://developer.android.google.cn/reference/android/support/constraint/ConstraintLayout#Chains" target="_blank" rel="noopener">ConstraintLayout</a>,æ¥è‡ªå®˜ç½‘çš„æ–‡æ¡£,è§‰å¾—ä¸æ˜¯å¾ˆç›´è§‚,äºæ˜¯æˆ‘æƒ³æŠŠå®ƒåšæˆGIFå›¾</p><pre><code class="java">compile &#39;com.android.support.constraint:constraint-layout:1.1.2&#39;</code></pre><p>æˆªæ­¢æˆ‘å†™ä¸‹è¿™ç¯‡ç¬”è®°çš„æ—¶å€™,å·²ç»æ˜¯1.1.2ç‰ˆæœ¬äº†,ä¸‹é¢æ‰€æœ‰çš„ä»£ç éƒ½æ˜¯åŸºäº1.1.2ç‰ˆæœ¬.</p><a id="more"></a><h3 id="é¢æ¿"><a href="#é¢æ¿" class="headerlink" title="é¢æ¿"></a>é¢æ¿</h3><p><img src="/images/cons_broad.png" srcset="/img/loading.gif" alt="é¢æ¿"></p><p>é¦–å…ˆåº”è¯¥æ˜ç™½ä¸»è¦çš„ä¸¤ä¸ªé¢æ¿</p><p>è“è‰²çš„åŒºåŸŸ,æˆ‘ä»¬æˆä¸ºè®¾è®¡è“å›¾,ä¸‹æ–‡ç§°è“å›¾é¢æ¿</p><p>å³è¾¹çš„æ˜¯å±æ€§é¢æ¿,ä¸‹æ–‡ç§°å±æ€§é¢æ¿,å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œç²¾ç»†è°ƒæ•´</p><h3 id="å•ä¸ªæ§ä»¶çš„çº¦æŸ"><a href="#å•ä¸ªæ§ä»¶çš„çº¦æŸ" class="headerlink" title="å•ä¸ªæ§ä»¶çš„çº¦æŸ"></a>å•ä¸ªæ§ä»¶çš„çº¦æŸ</h3><p>å†æ¼”ç¤ºä¹‹å‰,å»ºè®®å¤§å®¶éƒ½ä½¿ç”¨Android Studio æä¾›çš„<code>Design</code> æ¨¡å¼æ¥åˆ›å»ºå’Œä¿®æ”¹çº¦æŸå¸ƒå±€,æ–¹ä¾¿è€Œä¸”ç›´è§‚</p><p>æˆ‘çš„Android Studio ç‰ˆæœ¬æ˜¯3.1.3,å¦‚æœæœ‰å’Œæˆ‘æ“ä½œç•Œé¢ä¸ä¸€è‡´çš„,è¯·è‡ªè¡Œå¯¹åº”</p><h4 id="marginæ•ˆæœ"><a href="#marginæ•ˆæœ" class="headerlink" title="marginæ•ˆæœ"></a>marginæ•ˆæœ</h4><p><img src="/images/cons_default_move.gif" srcset="/img/loading.gif" alt="single_move"></p><p>å¦‚æœæˆ‘åªç»™å·¦è¾¹å’Œä¸Šè¾¹åŠ ä¸Šçº¦æŸ,é‚£ä¹ˆå°±ä¼šæ˜¯<code>margin</code>çš„æ•ˆæœ,ä»£ç è¡¨ç°å¦‚ä¸‹:</p><pre><code class="xml"> &lt;Button        android:id=&quot;@+id/button&quot;        android:layout_width=&quot;wrap_content&quot;        android:text=&quot;Button&quot;        android:layout_height=&quot;wrap_content&quot;        android:layout_marginStart=&quot;28dp&quot;        android:layout_marginTop=&quot;28dp&quot;        app:layout_constraintStart_toStartOf=&quot;parent&quot;        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;</code></pre><p>å¦‚æœä½ æƒ³è°ƒèŠ‚è¿™ä¸ª<code>margin</code>,å³å¯ä»¥æ‹–åŠ¨,ä¹Ÿå¯ä»¥å»å±æ€§é¢æ¿è°ƒæ•´,ä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­ä¿®æ”¹</p><h4 id="å±…ä¸­-åç§»æ•ˆæœ"><a href="#å±…ä¸­-åç§»æ•ˆæœ" class="headerlink" title="å±…ä¸­/åç§»æ•ˆæœ"></a>å±…ä¸­/åç§»æ•ˆæœ</h4><p><img src="/images/cons_single_center.gif" srcset="/img/loading.gif" alt="å¼¹æ€§"></p><p>å¯ä»¥çœ‹åˆ°,æˆ‘åœ¨å·¦è¾¹å’Œä¸Šè¾¹å·²ç»æœ‰<code>margin</code>çš„æƒ…å†µä¸‹,ç»™å³è¾¹å’Œä¸‹è¾¹ä¹ŸåŠ ä¸Šäº†çº¦æŸ,ç°åœ¨<code>BUTTON</code>å¤§ä½“ä¸Šæ˜¯å±…ä¸­æ•ˆæœ</p><p>ä¸ºä»€ä¹ˆæ˜¯â€å¤§ä½“â€å±…ä¸­é‚£? çœ‹ç®­å¤´é™„è¿‘çš„ 28 28 8 8 ,è¿™æ˜¯åœ¨<code>margin</code>çš„åŸºç¡€ä¸Šå±…ä¸­çš„,å»æ‰<code>margin</code>å°±æ˜¯ç»å¯¹å±…ä¸­çš„äº†</p><p>ç°åœ¨æˆ‘ä»¬çœ‹å±æ€§é¢æ¿:</p><p><img src="/images/cons_attr_2.png" srcset="/img/loading.gif" alt=""></p><p>ç•¥å°çš„çº¢æ¡†ä¸­,å°±æ˜¯margin,è¿™æ ·çš„è°ƒèŠ‚æ¡†è¿˜æœ‰3ä¸ª</p><p>çœ‹åˆ°é‚£ä¸ªå¯ä»¥æ»‘åŠ¨çš„è½´äº†ä¹ˆ? ä¸­é—´è¿˜æœ‰ä¸ª50çš„æ•°å­—,è¿™ä¸ªæ˜¯è°ƒèŠ‚<code>BUTTON</code>åœ¨å‚ç›´æ–¹å‘çš„åç§»</p><p>å…¶ä»–å‡ ä¸ªæ“ä½œæ¡†åŒç†å¯æ¨å…¶ä½œç”¨</p><p>æ¯”å¦‚æˆ‘éœ€è¦ä¸€ä¸ª<code>ç™»å½•</code>åœ¨å‚ç›´æ–¹å‘çš„0.75å¤„,ä¹Ÿå°±æ˜¯åœ¨æ•´ä¸ªé¡µé¢çš„3/4å¤„</p><p>å¯ä»¥ç›´æ¥æ‹‰åŠ¨è¿™ä¸ªæ§åˆ¶ç‚¹,ä½¿ä»–çš„æ•°å€¼å˜ä¸º<code>75</code>,ä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­ä¿®æ”¹,ä»£ç è¡¨ç°å¦‚ä¸‹:</p><pre><code class="xml">    &lt;Button        android:id=&quot;@+id/button&quot;        android:layout_width=&quot;wrap_content&quot;        android:layout_height=&quot;wrap_content&quot;        android:text=&quot;ç™»å½•&quot;        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;        app:layout_constraintStart_toStartOf=&quot;parent&quot;        app:layout_constraintTop_toTopOf=&quot;parent&quot;        app:layout_constraintVertical_bias=&quot;0.75&quot; /&gt;</code></pre><p>æ­¤æ—¶çš„<code>BUTTON</code>å°±ä¼šå¤„åœ¨æ•´ä¸ªå¸ƒå±€çš„3/4å¤„,å°±ä¸æ”¾å›¾äº†</p><h4 id="çºµæ¨ªæ¯”"><a href="#çºµæ¨ªæ¯”" class="headerlink" title="çºµæ¨ªæ¯”"></a>çºµæ¨ªæ¯”</h4><p><img src="/images/cons_ratio.gif" srcset="/img/loading.gif" alt="çºµæ¨ªæ¯”"></p><p>ä»£ç è¡¨ç°å¦‚ä¸‹:</p><pre><code class="xml">    &lt;ImageView        android:layout_width=&quot;0dp&quot;        android:layout_height=&quot;0dp&quot;        android:src=&quot;@mipmap/login_bg&quot;        android:scaleType=&quot;fitXY&quot;        app:layout_constraintDimensionRatio=&quot;h,16:9&quot;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;        app:layout_constraintStart_toStartOf=&quot;parent&quot;        app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;</code></pre><h3 id="å¤šä¸ªæ§ä»¶çš„çº¦æŸ"><a href="#å¤šä¸ªæ§ä»¶çš„çº¦æŸ" class="headerlink" title="å¤šä¸ªæ§ä»¶çš„çº¦æŸ"></a>å¤šä¸ªæ§ä»¶çš„çº¦æŸ</h3>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVMçš„åƒåœ¾å›æ”¶Garbage Collection</title>
    <link href="undefined2018/07/11/JVM-Garbage-Collection/"/>
    <url>2018/07/11/JVM-Garbage-Collection/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æˆ‘ä»¬çŸ¥é“åœ¨çº¿ç¨‹åˆ›å»ºæ—¶,ç¨‹åºè®¡æ•°å™¨,æœ¬åœ°æ–¹æ³•æ ˆ,è™šæ‹Ÿæœºæ ˆéšä¹‹åˆ›å»º,çº¿ç¨‹é”€æ¯æ—¶éšä¹‹é”€æ¯</p><p>å¹¶ä¸”æ ˆä¸­çš„æ ˆå¸§ä¹Ÿéšç€æ–¹æ³•çš„è¿›å…¥ä¸é€€å‡ºæ‰§è¡Œå‡ºå…¥æ ˆæ“ä½œ,æœ€é‡è¦çš„æ˜¯æ¯ä¸€ä¸ªæ ˆå¸§æ¶ˆè€—çš„å†…å­˜åŸºæœ¬ä¸Šåœ¨ç±»ç»“æ„ç¡®å®šæ—¶å°±å·²ç»çŸ¥é“,è¿™å‡ ä¸ªåŒºåŸŸçš„å†…å­˜åˆ†é…ä¸å›æ”¶éƒ½æ˜¯ç¡®å®šçš„,ä¸éœ€è¦è¿‡å¤šè€ƒè™‘å›æ”¶.</p><p>ä½†æ˜¯è¿›ç¨‹ä¸­çš„ å †(heap) ä»¥åŠ æ–¹æ³•åŒºä¸ä¸Šé¢çš„å‡ ä¸ªæ ˆæ˜¯ä¸åŒçš„,å½“ç¨‹åºå¤„äºè¿è¡Œæ—¶æœŸæ‰èƒ½ç¡®å®š,å®ƒä»¬çš„å†…å­˜åˆ†é…ä¸å›æ”¶éƒ½æ˜¯åŠ¨æ€çš„.</p><p>åƒåœ¾æ”¶é›†ä¸»è¦å°±æ˜¯è¿™éƒ¨åˆ†.</p><a id="more"></a><h3 id="å†…å­˜ä¸­å¯¹è±¡å¼•ç”¨çŠ¶æ€"><a href="#å†…å­˜ä¸­å¯¹è±¡å¼•ç”¨çŠ¶æ€" class="headerlink" title="å†…å­˜ä¸­å¯¹è±¡å¼•ç”¨çŠ¶æ€"></a>å†…å­˜ä¸­å¯¹è±¡å¼•ç”¨çŠ¶æ€</h3><p>è¦è¿›è¡Œåƒåœ¾æ”¶é›†,ç¬¬ä¸€ä»¶è¦ç¡®å®šçš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡æ˜¯å¦ä¸è¢«ä»»ä½•æ–¹å¼å¼•ç”¨,å½“ç¡®å®šæ²¡æœ‰ä»»ä½•å¼•ç”¨å°±å¯ä»¥è¿›è¡Œå›æ”¶.</p><p><strong>å¼•ç”¨</strong>ï¼šè¦è¯´å¼•ç”¨çŠ¶æ€å°±è¦æ˜ç™½ä»€ä¹ˆæ˜¯å¼•ç”¨ï¼Œå¦‚æœReferenceç±»å‹çš„æ•°æ®ä¸­å­˜å‚¨çš„æ•°å€¼ä»£è¡¨çš„æ˜¯å¦å¤–ä¸€å—å†…å­˜çš„èµ·å§‹åœ°å€ï¼Œæˆ‘ä»¬å°±è¯´è¿™å—å†…å­˜ä»£è¡¨ç€ä¸€ä¸ªå¼•ç”¨ã€‚</p><p>åœ¨JDK1.2ä¹‹å,JAVAå¯¹å¼•ç”¨çš„æ¦‚å¿µè¿›è¡Œäº†æ‰©å……,å°†å¼•ç”¨åˆ†å¤–4ç§</p><ol><li>å¼ºå¼•ç”¨, val onj = Object() </li><li>è½¯å¼•ç”¨ ,æœ‰ç”¨ä½†æ˜¯éå¿…é¡»çš„å¯¹è±¡</li><li>å¼±å¼•ç”¨,ç”¨æ¥æè¿°éå¿…é¡»å¯¹è±¡</li><li>è™šå¼•ç”¨</li></ol><p>é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­å‘¢?</p><h4 id="å¼•ç”¨è®¡æ•°æ³•"><a href="#å¼•ç”¨è®¡æ•°æ³•" class="headerlink" title="å¼•ç”¨è®¡æ•°æ³•"></a>å¼•ç”¨è®¡æ•°æ³•</h4><p>å³å¯¹è±¡æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨,æ¯è¢«å¼•ç”¨ä¸€æ¬¡å°±åŠ 1,å¼•ç”¨é‡Šæ”¾å°±å‡å»1,å¦‚æœè®¡æ•°å™¨ä¸º0,é‚£å°±è¯´æ˜å¯¹è±¡â€å·²æ­»â€</p><p>ä½†æ˜¯Javaè™šæ‹Ÿæœºå¹¶æ²¡æœ‰é‡‡ç”¨è¿™ç§æ–¹å¼,å› ä¸ºæ²¡æœ‰åŠæ³•è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜</p><p>Aä¸Bå¯¹è±¡,äº’ç›¸æŒæœ‰å¯¹æ–¹çš„å¼•ç”¨,é‚£ä¹ˆå°±ç®—ä»–ä»¬ä¸¤ä¸ªè®¡æ•°å™¨æ°¸è¿œä¸å¯èƒ½ç­‰äº0,å“ªæ€•è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½æ²¡æœ‰ç”¨äº†.</p><h4 id="å¯è¾¾æ€§åˆ†æç®—æ³•"><a href="#å¯è¾¾æ€§åˆ†æç®—æ³•" class="headerlink" title="å¯è¾¾æ€§åˆ†æç®—æ³•"></a>å¯è¾¾æ€§åˆ†æç®—æ³•</h4><p>JVMå°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´».</p><p>è¿™ç§ç®—æ³•,å°±æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„GC Rootså¯¹è±¡ä½œä¸ºèµ·å§‹ç‚¹,ä»è¿™äº›èŠ‚ç‚¹å‘ä¸‹æœç´¢,æœç´¢èµ°è¿‡çš„è·¯å¾„è¢«ç§°ä¸ºå¼•ç”¨é“¾(Reference Chain),å½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ¥çš„è¯,å°±å¯ä»¥åˆ¤æ–­è¿™ä¸ªå¯¹è±¡ä¸å¯ç”¨äº†.</p><p>GC Rootsï¼š</p><ul><li>è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­çš„å¼•ç”¨å¯¹è±¡</li><li>æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨å˜é‡</li><li>æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨å¯¹è±¡</li><li>æœ¬åœ°æ–¹æ³•æ ˆä¸­çš„JNIå¼•ç”¨å¯¹è±¡</li></ul><p><img src="/images/jvm_gcroots.png" srcset="/img/loading.gif" alt="gcroots"></p><h3 id="å›æ”¶å¯¹è±¡"><a href="#å›æ”¶å¯¹è±¡" class="headerlink" title="å›æ”¶å¯¹è±¡"></a>å›æ”¶å¯¹è±¡</h3><p>é€šè¿‡ä¸Šé¢çš„å¯è¾¾æ€§åˆ†æç®—æ³•,æˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­å‡ºé‚£äº›å¯å›æ”¶çš„å¯¹è±¡,ä½†æ˜¯å®é™…ä¸Šä»–ä»¬ä¹Ÿä¸æ˜¯ç«‹å³è¢«å›æ”¶</p><p>ç¬¬ä¸€æ¬¡ä¸å¯è¾¾,æ²¡æœ‰ä¸GC Rootsç›¸è¿æ¥çš„å¼•ç”¨é“¾,ä»–ä¼šè¢«æ ‡è®°ä¸€æ¬¡å¹¶ä¸”è¿›è¡Œä¸€æ¬¡ç­›é€‰,ç­›é€‰æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œ<code>finalize()</code>æ–¹æ³•,å½“å¯¹è±¡æ²¡æœ‰è¦†ç›–<code>finalize()</code>æˆ–è€…æ˜¯è¯¥æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨,éƒ½å°†è§†ä¸ºâ€æ²¡æœ‰å¿…è¦æ‰§è¡Œâ€.</p><p>å¦‚æœä¸€ä¸ªå¯¹è±¡è¢«åˆ¤å®šéœ€è¦æ‰§è¡Œ<code>finalize()</code>æ–¹æ³•,é‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¼šè¢«æ”¾åœ¨<code>F-Queue</code>çš„é˜Ÿåˆ—ä¸­,å¹¶åœ¨ç¨åç”±è™šæ‹Ÿæœºåˆ›å»ºä¸€ä¸ªä½ä¼˜å…ˆçº§çš„<code>Finalizer</code>çº¿ç¨‹å»æ‰§è¡Œå®ƒ,ç¨åGCå°†ä¼šå¯¹<code>F-Queue</code>ä¸­çš„å¯¹è±¡è¿›è¡Œç¬¬äºŒæ¬¡ç­›é€‰,å¦‚æœè¯¥å¯¹è±¡é‡æ–°è¢«å¼•ç”¨äº†,é‚£ä¹ˆå®ƒå°†è¢«ç§»å‡º<code>F-Queue</code>é˜Ÿåˆ—,å®Œæˆè‡ªæ•‘.å¦åˆ™,å°±çœŸçš„è¢«å›æ”¶äº†.</p><h3 id="åƒåœ¾æ”¶é›†ç®—æ³•"><a href="#åƒåœ¾æ”¶é›†ç®—æ³•" class="headerlink" title="åƒåœ¾æ”¶é›†ç®—æ³•"></a>åƒåœ¾æ”¶é›†ç®—æ³•</h3><h4 id="æ ‡è®°-æ¸…é™¤ç®—æ³•"><a href="#æ ‡è®°-æ¸…é™¤ç®—æ³•" class="headerlink" title="æ ‡è®°-æ¸…é™¤ç®—æ³•"></a>æ ‡è®°-æ¸…é™¤ç®—æ³•</h4><p>è¿™ä¸ªç®—æ³•åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†,é¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡    </p><p>è¿™æ ·çš„ç®—æ³•è™½ç„¶å¯ä»¥è¾¾åˆ°ç›®çš„,ä½†æ˜¯æ•ˆç‡ä¸é«˜,è€Œä¸”æ ‡è®°-æ¸…é™¤åä¼šäº§ç”Ÿå¤§é‡çš„ä¸è¿ç»­å†…å­˜ç¢ç‰‡,è¿™ä¼šå¯¼è‡´è¾ƒå¤§çš„å¯¹è±¡åˆ†é…å†…å­˜æ—¶æ— æ³•æ‰¾åˆ°ç¬¦åˆçš„å†…å­˜å—,å¯¼è‡´æå‰è§¦å‘å¦ä¸€æ¬¡åƒåœ¾å›æ”¶.</p><h4 id="å¤åˆ¶ç®—æ³•"><a href="#å¤åˆ¶ç®—æ³•" class="headerlink" title="å¤åˆ¶ç®—æ³•"></a>å¤åˆ¶ç®—æ³•</h4><p>è¿™ç§ç®—æ³•çš„æ€è·¯æ˜¯,æŠŠä¸€å¤§å—å†…å­˜åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†,Aéƒ¨åˆ†æ­£å¸¸ä½¿ç”¨,å½“Aå—å†…å­˜ä½¿ç”¨å®Œ,å°±æŠŠAå†…å­˜ä¸­è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—å†…å­˜ä¸Šå»,ç„¶åä¸€æ¬¡æ€§æ¸…ç†æ‰Aä¸Šæ‰€æœ‰çš„å†…å®¹.</p><p>è¿™æ ·çš„ç®—æ³•,ç®€å•è€Œä¸”é«˜æ•ˆ,è€Œä¸”ä¸ä¼šæœ‰å¤§é‡ä¸è¿ç»­å†…å­˜çš„é—®é¢˜äº§ç”Ÿ,ä½†æ˜¯è¿™æ ·çš„è¯,æ°¸è¿œåªèƒ½ä½¿ç”¨åˆ°å†…å­˜çš„ä¸€åŠç©ºé—´,æœªå…æœ‰äº›æµªè´¹äº†.</p><p>IBMé€šè¿‡ç ”ç©¶,å°†å†…å­˜åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„Edenç©ºé—´å’Œä¸¤å—è¾ƒå°çš„Survivorç©ºé—´,8:1:1 </p><h4 id="æ ‡è®°-æ•´ç†ç®—æ³•"><a href="#æ ‡è®°-æ•´ç†ç®—æ³•" class="headerlink" title="æ ‡è®°-æ•´ç†ç®—æ³•"></a>æ ‡è®°-æ•´ç†ç®—æ³•</h4><p>æ ‡è®°è¿‡ç¨‹ ä»ç„¶ä¸ä¸Šé¢è¯´çš„â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¸€æ ·,ä½†æ˜¯åç»­ä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¸…ç†,è€Œæ˜¯æŠŠå¯å›æ”¶å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨,ç„¶åç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜.</p><h4 id="åˆ†ä»£å›æ”¶ç®—æ³•"><a href="#åˆ†ä»£å›æ”¶ç®—æ³•" class="headerlink" title="åˆ†ä»£å›æ”¶ç®—æ³•"></a>åˆ†ä»£å›æ”¶ç®—æ³•</h4><p>ä¸€èˆ¬æ˜¯æŠŠJavaå † åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨æœ€é€‚å½“çš„æ”¶é›†ç®—æ³•ã€‚</p><p><strong>æ–°ç”Ÿä»£</strong>:åªæœ‰å°‘é‡å­˜æ´»,å°±é€‰ç”¨å¤åˆ¶ç®—æ³•,ä»˜å‡ºå°‘é‡å­˜æ´»å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›†</p><p><strong>è€å¹´ä»£</strong>:å¯¹è±¡å­˜æ´»ç‡é«˜,æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿,å°±è¦ä½¿ç”¨â€œæ ‡è®°â€”æ¸…ç†â€æˆ–è€…â€œæ ‡è®°â€”æ•´ç†â€ç®—æ³•æ¥è¿›è¡Œå›æ”¶</p><h3 id="å®‰å…¨ç‚¹-GCå…¥å£"><a href="#å®‰å…¨ç‚¹-GCå…¥å£" class="headerlink" title="å®‰å…¨ç‚¹(GCå…¥å£)"></a>å®‰å…¨ç‚¹(GCå…¥å£)</h3><p>æˆ‘ä»¬éƒ½çŸ¥é“GCæ˜¯é˜»å¡æ‰€æœ‰çº¿ç¨‹çš„,â€Stop The  Worldâ€è¿™æ ·çš„.</p><p>ç¨‹åºæ‰§è¡Œæ—¶å¹¶éåœ¨æ‰€æœ‰åœ°æ–¹éƒ½ èƒ½åœé¡¿ä¸‹æ¥å¼€å§‹GC,åªæœ‰åœ¨åˆ°è¾¾å®‰å…¨ç‚¹æ—¶æ‰èƒ½æš‚åœ . </p><p>è‡³äºå¯¹å®‰å…¨ç‚¹çš„é€‰å®š,ä¹Ÿæ˜¯å¾ˆå¤æ‚,è¿™é‡Œå°±ä¸äº†è§£äº†.</p><p><strong>æŠ¢å…ˆå¼ä¸­æ–­</strong>:GCå‘ç”Ÿæ—¶,æŠŠæ‰€æœ‰çº¿ç¨‹å…¨éƒ¨ä¸­æ–­,å¦‚æœæœ‰å‘ç°çº¿ç¨‹æ–­çš„åœ°æ–¹ä¸åœ¨å®‰å…¨ç‚¹ä¸Š,å°±æ¢å¤çº¿ç¨‹,ç›´åˆ°å®ƒç»§ç»­æ‰§è¡ŒæŒ‡ä»¤åˆ°è¾¾â€å®‰å…¨ç‚¹â€.</p><p><strong>ä¸»åŠ¨å¼ä¸­æ–­</strong>:GCéœ€è¦ä¸­æ–­æ—¶,è®¾ç½®æ ‡è¯†,è€Œæ¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ä¸»åŠ¨è½®è¯¢è¿™ä¸ªæ ‡å¿—,å‘ç°ä¸­æ–­æ ‡è¯†å°±è‡ªå·±ä¸»åŠ¨æŒ‚èµ·.</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidä¸­çš„è´å¡å°”æ›²çº¿</title>
    <link href="undefined2018/07/05/Android-Bezier/"/>
    <url>2018/07/05/Android-Bezier/</url>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>è´å¡å°”æ›²çº¿(BÃ©zier curve)</p><p>æˆ‘ä»¬åœ¨å¾ˆå¤šAppç§éƒ½èƒ½å‘ç°å®ƒçš„å½±å­,æ¯”å¦‚è¯´</p><pre><code>QQçš„å°çº¢ç‚¹ä¸‹æ‹‰åˆ·æ–°çš„ç²˜è¿æ•ˆæœä¸ªäººåŠ¨æ€ç­‰é¡µé¢çš„æ³¢æµªæ•ˆæœé˜…è¯»è½¯ä»¶çš„ç¿»é¡µæ•ˆæœ</code></pre><p>è´å¡å°”æ›²çº¿æ˜¯ç”¨ä¸€ç³»åˆ—ç‚¹æ¥æ§åˆ¶æ›²çº¿çŠ¶æ€ï¼Œä¸»è¦å°±æ˜¯ï¼šæ•°æ®ç‚¹ã€æ§åˆ¶ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´æ§åˆ¶ç‚¹ï¼Œæ¥ä½¿å¾—è´å¡å°”æ›²çº¿å½¢çŠ¶å˜åŒ–</p><ul><li>æ•°æ®ç‚¹   æŒ‡å®šäº†èµ·å§‹ä½ç½®</li><li>æ§åˆ¶ç‚¹   ä¸€æˆ–å¤šä¸ª,å†³å®šäº†æ›²çº¿çš„è½¨è¿¹</li></ul><a id="more"></a><p>è¿™é‡Œæ”¾ä¸¤ä¸ªåœ¨çº¿æŸ¥çœ‹è´å¡å°”æ›²çº¿çš„é“¾æ¥</p><blockquote><p><a href="http://myst729.github.io/bezier-curve/" target="_blank" rel="noopener">http://myst729.github.io/bezier-curve/</a></p><p><a href="http://cubic-bezier.com/#.17,.67,.83,.67" target="_blank" rel="noopener">http://cubic-bezier.com/#.17,.67,.83,.67</a></p></blockquote><p>è¿™é‡Œæ˜¯ä¸€ä¸ªå¿«é€Ÿç¡®å®šç‚¹ä½ç½®çš„æ•™ç¨‹</p><blockquote><p><a href="https://www.jianshu.com/p/1d766455445b" target="_blank" rel="noopener">https://www.jianshu.com/p/1d766455445b</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GitHubä½¿ç”¨SSHçš„æ–¹å¼å…å¯†ä¸Šä¼ </title>
    <link href="undefined2018/07/05/GitHub-With-SSH/"/>
    <url>2018/07/05/GitHub-With-SSH/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å‰ä¸€æ®µæ—¶é—´æ¢äº†githubè´¦å·,å„ç§è½¬ç§»æ•°æ®,ç´¯æ­»æˆ‘</p><p>è€Œå,æˆ‘é¡ºæ‰‹æ·»åŠ äº†githubçš„ssh-key(æ–°åˆ›å»ºäº†ä¸€ä¸ªrsaçš„Key),ç„¶è€Œå½“æˆ‘:</p><pre><code class="shell"># phyooos @ wangzhumo in ~/develop/hexo [12:10:02] C:2$ hexo dINFO  Deploying: gitINFO  Clearing .deploy_git folder...    #...git@github.com: Permission denied (publickey).fatal: Could not read from remote repository.</code></pre><p>å¾ˆè¿·,å®Œå…¨ä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><a id="more"></a><h3 id="æ’é™¤é—®é¢˜"><a href="#æ’é™¤é—®é¢˜" class="headerlink" title="æ’é™¤é—®é¢˜"></a>æ’é™¤é—®é¢˜</h3><h4 id="æŸ¥çœ‹-sshç›®å½•"><a href="#æŸ¥çœ‹-sshç›®å½•" class="headerlink" title="æŸ¥çœ‹~/.sshç›®å½•"></a>æŸ¥çœ‹~/.sshç›®å½•</h4><pre><code class="shell">-rw-------  1 phyooos  staff   1.6K  6 27  2017 aliyun_rsa-rw-r--r--  1 phyooos  staff   398B  6 27  2017 aliyun_rsa.pub-rw-r--r--  1 phyooos  staff   402B  5 22  2017 authorized_keys-rw-r--r--  1 phyooos  staff   1.1K  6 28 14:48 config-rw-------  1 phyooos  staff   3.2K  6 27 18:05 github_rsa-rw-r--r--  1 phyooos  staff   746B  6 27 18:05 github_rsa.pub-rw-------  1 phyooos  staff   1.6K  5 17  2017 id_rsa-rw-r--r--@ 1 phyooos  staff   402B  5 17  2017 id_rsa.pub-rw-r--r--  1 phyooos  staff   1.3K  7  5 12:33 known_hosts</code></pre><p>å…¶ä¸­</p><pre><code class="shell">-rw-------  1 phyooos  staff   3.2K  6 27 18:05 github_rsa-rw-r--r--  1 phyooos  staff   746B  6 27 18:05 github_rsa.pub</code></pre><p>å°±æ˜¯æˆ‘åˆ›å»ºç”¨æ¥ç»™githubç”¨çš„</p><h4 id="æŸ¥çœ‹-ssh-config"><a href="#æŸ¥çœ‹-ssh-config" class="headerlink" title="æŸ¥çœ‹~/.ssh/config"></a>æŸ¥çœ‹~/.ssh/config</h4><pre><code class="shell"># ---- github------------------Host github    HostName github.com    User git    IdentityFile /Users/phyooos/.ssh/github_rsa# -----------------------------</code></pre><p>ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„,è€Œgithubä¸Šçš„keyä¹Ÿå°±ç¡®å®æ˜¯github_rsa.pub</p><h4 id="Tower"><a href="#Tower" class="headerlink" title="Tower"></a>Tower</h4><p>ä½†æ˜¯æˆ‘çš„Towerä¸Š,ä¹Ÿæœ‰å‡ ä¸ªgithubä¸Šçš„é¡¹ç›®,å´å¯ä»¥æ­£å¸¸çš„ä¸Šä¼ ,</p><p>è€ŒTowerä¸Šçš„ç§é’¥æ˜¯æˆ‘æ‰‹åŠ¨é…ä¸Šå»çš„,æ‰€ä»¥é—®é¢˜åªæœ‰å¯èƒ½æ˜¯ç»ˆç«¯ä¸­æ²¡æœ‰æŒ‰ç…§æˆ‘çš„é…ç½®<code>IdentityFile /Users/phyooos/.ssh/github_rsa</code>æ¥å’Œgithubå»ºç«‹è¿æ¥</p><p>æˆ‘å°è¯•æŠŠ<code>id_rsa.pub</code>å¯†é’¥åŠ å…¥åˆ°githubä¸Š.</p><pre><code class="shell">To github.com:wangzhumo/wangzhumo.github.io.git   c45bbef..6b25311  HEAD -&gt; masterBranch &#39;master&#39; set up to track remote branch &#39;master&#39; from &#39;git@github.com:wangzhumo/wangzhumo.github.io.git&#39;.INFO  Deploy done: git</code></pre><p>ç«Ÿç„¶æˆåŠŸäº†.</p><h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><p><code>~/.ssh/config</code>ä¸­çš„é…ç½®,è«åæ²¡æœ‰ç”Ÿæ•ˆ,æˆ‘è‡³ä»Šä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><p>è¿˜æ˜¯è¯´,githubåœ¨ç»ˆç«¯ä¸­ä¸Šä¼ æ—¶,åªä¼šé»˜è®¤å»æ‹¿id_rsa???</p><p>é‚£å°±å…ˆè¿™ä¹ˆç”¨å§..è¿·</p>]]></content>
    
    
    <categories>
      
      <category>Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Github</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidéé™æ€å†…éƒ¨ç±»ä¸åŒ¿åå†…éƒ¨ç±»å¼•èµ·çš„å†…å­˜æ³„æ¼</title>
    <link href="undefined2018/07/05/Android-inner-class-leak/"/>
    <url>2018/07/05/Android-inner-class-leak/</url>
    
    <content type="html"><![CDATA[<h3 id="å†…å­˜"><a href="#å†…å­˜" class="headerlink" title="å†…å­˜"></a>å†…å­˜</h3><h4 id="å†…å­˜æ³„æ¼"><a href="#å†…å­˜æ³„æ¼" class="headerlink" title="å†…å­˜æ³„æ¼"></a>å†…å­˜æ³„æ¼</h4><p>ç®€å•çš„è¯´ï¼Œå½“æˆ‘ä»¬çš„å¯¹è±¡åˆ›å»ºæ—¶ï¼Œå°±å ç”¨äº†ä¸€éƒ¨åˆ†å†…å­˜ï¼Œè€Œåœ¨è¿™ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨åä¼šè¿›è¡Œå›æ”¶é”€æ¯ï¼Œ</p><p>ä»¥é‡Šæ”¾æ‰å ç”¨çš„å†…å­˜ã€‚ä½†æ˜¯å¦‚æœjvmæ²¡æœ‰æˆåŠŸå›æ”¶è¿™ä¸ªå¯¹è±¡ï¼Œå°±ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚</p><h4 id="å†…å­˜æº¢å‡º"><a href="#å†…å­˜æº¢å‡º" class="headerlink" title="å†…å­˜æº¢å‡º"></a>å†…å­˜æº¢å‡º</h4><p>Androidä¸­çš„OOMï¼Œç³»ç»Ÿä¼šç»™æ¯ä¸€ä¸ªAndroidç¨‹åºåˆ†é…ä¸€å®šçš„å†…å­˜ã€‚æˆ‘çš„çš„Appå¯èƒ½ä¼šå› ä¸ºå¤§é‡çš„å†…å­˜æ³„æ¼è€Œå¯¼è‡´å†…å­˜è€—å°½ï¼Œå¼•å‘OOMå¯¼è‡´æ•´ä¸ªAppçš„å´©æºƒã€‚</p><p>å°±ç®—å†…å­˜æ²¡æœ‰è€—å°½è€Œå´©æºƒï¼Œä¹Ÿä¼šå¯¼è‡´Appå†…å­˜ä¸è¶³ã€‚æ­¤æ—¶æˆ‘ä»¬åˆ›å»ºæ–°çš„å¯¹è±¡æˆ–è€…å…¶ä»–æ–¹å¼éœ€è¦ä½¿ç”¨å†…å­˜æ—¶ï¼ŒGCå°±ä¼šä¸»åŠ¨è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä¸ºä½ çš„æ“ä½œå‡†å¤‡å¥½å†…å­˜ç©ºé—´ï¼Œæ¯æ¬¡GCéƒ½æ˜¯é˜»å¡æ“ä½œï¼Œè¿™å°±ä¼šå¯¼è‡´æˆ‘ä»¬çš„Appå¡é¡¿ã€‚</p><blockquote><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¼˜åŒ–Appå¡é¡¿æ—¶ï¼Œæœ‰ä¸€ç‚¹å°±æ˜¯è¦å…³æ³¨â€œå†…å­˜æŠ–åŠ¨â€ã€‚</p></blockquote><a id="more"></a><h3 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h3><h4 id="handlerçš„å†…éƒ¨ç±»"><a href="#handlerçš„å†…éƒ¨ç±»" class="headerlink" title="handlerçš„å†…éƒ¨ç±»"></a>handlerçš„å†…éƒ¨ç±»</h4><pre><code class="java">public class MainActivity extends Activity {   private final Handler mHandler = new Handler() {     @Override     public void handleMessage(Message msg) {        // do something     }   }    public void test1(){        // å»¶æ—¶60s        mHandler.postDelayed(new Runnable() {               @Override            public void run() {                    //run             }        }, 6000);        finish();    }  }</code></pre><p>æˆ‘ä»¬çŸ¥é“åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºçš„Handlerä¼šè¢«å…³è”åˆ° Looperï¼ˆä¸»çº¿ç¨‹çš„ï¼‰ä¸­å»ï¼Œè€Œä¸»çº¿ç¨‹çš„Looperåœ¨åº”ç”¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å­˜åœ¨ ï¼Œæ­¤æ—¶çš„Messageä¼šæŒæœ‰Handlerå¯¹è±¡ï¼Œç”¨æ¥æœ€åå¤„ç†æ¶ˆæ¯ã€‚</p><p>ä¹Ÿå°±æ˜¯è°ƒç”¨<code>Handler#handleMessage(Message msg)</code></p><p><strong>å½“æˆ‘ä»¬è°ƒç”¨<code>test1()</code>æ–¹æ³•</strong></p><ul><li>å»¶æ—¶60sæ‰§è¡Œï¼ˆä½†å®é™…ä¸Šï¼Œè¿™ä¸ªmessageå·²ç»å‘é€ï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­äº†ï¼Œåªæ˜¯60såæ‰ handleMessageï¼‰</li><li>finish()æ‰è¿™MainActivity</li><li><code>new Runnable</code>æ˜¯ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œä¼šæŒæœ‰éšå¼çš„å¤–éƒ¨ç±»å¼•ç”¨ </li></ul><p>è¿™ä¸‹å°±å¾®å¦™äº†ï¼ŒMainActivityå·²ç»è¢«finishäº†ï¼Œä½†æ˜¯å»¶æ—¶Messageå´è¿˜å­˜åœ¨äºæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°å®ƒè¢«å¤„ç†</p><p>å»¶æ—¶Message æŒæœ‰ MainActivityçš„Handler(ç”¨æ¥å¤„ç†è¿™ä¸ªæ¶ˆæ¯)ï¼Œè€Œæˆ‘ä»¬çŸ¥é“åœ¨Javaä¸­ï¼Œéé™æ€å†…éƒ¨ç±»å’ŒåŒ¿åç±»ä¼šéšå¼æŒæœ‰ä¸€ä¸ªå¤–éƒ¨ç±»çš„å¼•ç”¨ ï¼Œåœ¨è¿™é‡Œå°±æ˜¯Handleréšå¼æŒæœ‰MainActivity</p><p>è¿™ä¸‹å°±å¯¼è‡´ï¼ŒMainActivity æ²¡æœ‰è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ </p><p>è¿˜æœ‰ä¸ªRunnableé‚£â€¦</p><h4 id="è§£å†³æ€è·¯"><a href="#è§£å†³æ€è·¯" class="headerlink" title="è§£å†³æ€è·¯"></a>è§£å†³æ€è·¯</h4><ol><li>å»é™¤éšå¼å¼•ç”¨ï¼Œå¯ä»¥æŠŠéé™æ€å†…éƒ¨ç±»è½¬åŒ–æˆé™æ€çš„</li><li>æ‰‹åŠ¨ç®¡ç†å¤–éƒ¨ç±»ä¾èµ–ï¼Œå¦‚æœä¸€å®šè¦ä½¿ç”¨ï¼Œå¯ä»¥æ‰‹åŠ¨ä¼ å…¥å¤–éƒ¨ç±»ï¼ˆåƒContextè¿™æ ·çš„å®Œå…¨å¯ä»¥ä½¿ç”¨ApplicationContextæ›¿ä»£ï¼‰</li></ol><h4 id="æ¡ˆä¾‹å°ç»“"><a href="#æ¡ˆä¾‹å°ç»“" class="headerlink" title="æ¡ˆä¾‹å°ç»“"></a>æ¡ˆä¾‹å°ç»“</h4><p>éé™æ€çš„å†…éƒ¨ç±»ï¼Œç”±äºå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸èƒ½åŒå¤–éƒ¨ç±»ä¸€è‡´ï¼Œå®ƒçš„ç”Ÿå­˜å‘¨æœŸå·²ç»è¶…è¿‡äº†å®ƒçš„å¤–éƒ¨ç±»ã€‚</p><p>æ‰€ä»¥åœ¨å®ƒçš„å¤–éƒ¨ç±»è¢«å›æ”¶æ—¶ï¼Œè¢«å®ƒæ‰“æ–­äº†è¿™ä¸ªæ“ä½œï¼Œå¯¼è‡´å†…å­˜æ³„æ¼äº§ç”Ÿ</p><h3 id="å†…éƒ¨ç±»"><a href="#å†…éƒ¨ç±»" class="headerlink" title="å†…éƒ¨ç±»"></a>å†…éƒ¨ç±»</h3><p>Javaä¸­å†…éƒ¨ç±»åˆ†ä¸ºå››ç§ </p><ol><li>é™æ€å†…éƒ¨ç±»</li><li>é™æ€åŒ¿åå†…éƒ¨ç±»</li><li>éé™æ€å†…éƒ¨ç±»</li><li>éé™æ€å†…éƒ¨åŒ¿åç±»</li></ol><table><thead><tr><th>è¯´æ˜</th><th>æˆå‘˜å†…éƒ¨ç±»</th><th>é™æ€å†…éƒ¨ç±»</th></tr></thead><tbody><tr><td>é™æ€æˆå‘˜</td><td>é™æ€æˆå‘˜éœ€åŒæ—¶æœ‰finalå…³é”®è¯ä¿®é¥°</td><td>å¯ä»¥</td></tr><tr><td>é™æ€æ–¹æ³•</td><td>ä¸å¯å®šä¹‰</td><td>å¯ä»¥</td></tr><tr><td>è®¿é—®å¤–éƒ¨ç±»éstaticå±æ€§/æ–¹æ³•</td><td>å¤–éƒ¨ç±»å.this.æˆå‘˜æ–¹æ³•/å±æ€§</td><td>ä¸å¯ä»¥</td></tr><tr><td>å¤–éƒ¨ç±»è®¿é—®å†…éƒ¨ç±»</td><td>éœ€è¦é€šè¿‡å†…éƒ¨ç±»çš„ä¸€ä¸ªå®ä¾‹æ¥è®¿é—®</td><td>éœ€è¦é€šè¿‡å†…éƒ¨ç±»çš„ä¸€ä¸ªå®ä¾‹æ¥è®¿é—®</td></tr><tr><td>åˆ›å»ºå®ä¾‹</td><td>å¤–éƒ¨ç±»å.å†…éƒ¨ç±»å å®ä¾‹å = å¤–éƒ¨ç±»å®ä¾‹å.new å†…éƒ¨ç±»æ„é€ æ–¹æ³•(å‚æ•°)</td><td>å¤–éƒ¨ç±»å.å†…éƒ¨ç±»å å®ä¾‹å = new å¤–éƒ¨ç±»å.å†…éƒ¨ç±»å(å‚æ•°)</td></tr><tr><td>ç¼–è¯‘åçš„classæ–‡ä»¶</td><td>å•ç‹¬çš„classæ–‡ä»¶(soå†…éƒ¨ç±»ä¸­çš„æ–¹æ³•å’Œå˜é‡å¯ä»¥è·Ÿçˆ¶ç±»çš„æ–¹æ³•å’Œå˜é‡åŒå)ï¼Œå¤–éƒ¨ç±»$å†…éƒ¨ç±».class</td><td>å•ç‹¬çš„classæ–‡ä»¶(soå†…éƒ¨ç±»ä¸­çš„æ–¹æ³•å’Œå˜é‡å¯ä»¥è·Ÿçˆ¶ç±»çš„æ–¹æ³•å’Œå˜é‡åŒå)ï¼Œå¤–éƒ¨ç±»$å†…éƒ¨ç±».class</td></tr><tr><td>å…¶ä»–</td><td>ä¸å¤–éƒ¨ç±»å¹³çº§çš„ç±»ç»§æ‰¿å†…éƒ¨ç±»æ—¶ï¼Œå…¶æ„é€ æ–¹æ³•ä¸­éœ€è¦ä¼ å…¥çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ã€‚ä¸”åœ¨æ„é€ æ–¹æ³•çš„ç¬¬ä¸€å¥è°ƒç”¨â€œå¤–éƒ¨ç±»å®ä¾‹å.super(å†…éƒ¨ç±»å‚æ•°)â€</td><td>æ— </td></tr></tbody></table><table><thead><tr><th><strong>è¯´æ˜</strong></th><th style="text-align:left"><strong>æˆå‘˜å†…éƒ¨ç±»</strong></th><th><strong>åŒ¿åå†…éƒ¨ç±»</strong></th></tr></thead><tbody><tr><td>é™æ€æˆå‘˜</td><td style="text-align:left">é™æ€æˆå‘˜éœ€åŒæ—¶æœ‰finalå…³é”®è¯ä¿®é¥°</td><td>ä¸å¯å®šä¹‰</td></tr><tr><td>é™æ€æ–¹æ³•</td><td style="text-align:left">ä¸å¯å®šä¹‰</td><td>ä¸å¯å®šä¹‰</td></tr><tr><td>è®¿é—®å¤–éƒ¨ç±»éstaticå±æ€§/æ–¹æ³•</td><td style="text-align:left">å¤–éƒ¨ç±»å.this.æˆå‘˜æ–¹æ³•/å±æ€§</td><td>å¤–éƒ¨ç±»å.this.æˆå‘˜æ–¹æ³•/å±æ€§</td></tr><tr><td>å¤–éƒ¨ç±»è®¿é—®å†…éƒ¨ç±»</td><td style="text-align:left">éœ€è¦é€šè¿‡å†…éƒ¨ç±»çš„ä¸€ä¸ªå®ä¾‹æ¥è®¿é—®</td><td>éœ€è¦é€šè¿‡å†…éƒ¨ç±»çš„ä¸€ä¸ªå®ä¾‹æ¥è®¿é—®</td></tr><tr><td>åˆ›å»ºå®ä¾‹</td><td style="text-align:left">å¤–éƒ¨ç±»å.å†…éƒ¨ç±»å å®ä¾‹å = å¤–éƒ¨ç±»å®ä¾‹å.new å†…éƒ¨ç±»æ„é€ æ–¹æ³•(å‚æ•°)</td><td>å¦‚ä¸Šï¼šçˆ¶ç±» å®ä¾‹å = new çˆ¶ç±»ï¼ˆï¼‰{}</td></tr><tr><td>ç¼–è¯‘åçš„classæ–‡ä»¶</td><td style="text-align:left">å•ç‹¬çš„classæ–‡ä»¶(soå†…éƒ¨ç±»ä¸­çš„æ–¹æ³•å’Œå˜é‡å¯ä»¥è·Ÿçˆ¶ç±»çš„æ–¹æ³•å’Œå˜é‡åŒå)ï¼Œå¤–éƒ¨ç±»$å†…éƒ¨ç±».class</td><td>å•ç‹¬çš„classæ–‡ä»¶ï¼Œä½¿ç”¨ç±»$æ•°å­—.class</td></tr><tr><td>å…¶ä»–</td><td style="text-align:left">ä¸å¤–éƒ¨ç±»å¹³çº§çš„ç±»ç»§æ‰¿å†…éƒ¨ç±»æ—¶ï¼Œå…¶æ„é€ æ–¹æ³•ä¸­éœ€è¦ä¼ å…¥çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ã€‚ä¸”åœ¨æ„é€ æ–¹æ³•çš„ç¬¬ä¸€å¥è°ƒç”¨â€œå¤–éƒ¨ç±»å®ä¾‹å.super(å†…éƒ¨ç±»å‚æ•°)â€</td><td>æ— </td></tr></tbody></table><blockquote><p><a href="https://www.cnblogs.com/dorothychai/p/6007709.html" target="_blank" rel="noopener">https://www.cnblogs.com/dorothychai/p/6007709.html</a></p></blockquote><h3 id="å¯ç¤º"><a href="#å¯ç¤º" class="headerlink" title="å¯ç¤º"></a>å¯ç¤º</h3><ol><li><p>éé™æ€å†…éƒ¨ç±» æ”¹ä¸º é™æ€éåŒ¿åå†…éƒ¨ç±» </p></li><li><p>ä½¿ç”¨å¼±å¼•ç”¨</p></li><li><p>åœ¨é€‚å½“çš„æ—¶æœºæ‰‹åŠ¨é”€æ¯ï¼Œåœ¨onDestoryä¸­æ‰‹åŠ¨é”€æ¯</p><p>å…»æˆè‰¯å¥½çš„ä¹ æƒ¯ï¼ŒContextã€Handlerã€Timerã€Thread  ã€å¹¿æ’­ ã€ IO ç­‰éƒ½è¦æ³¨æ„é”€æ¯</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Git Submodule å­æ¨¡å—çš„ä½¿ç”¨</title>
    <link href="undefined2018/07/02/Git-Submodule/"/>
    <url>2018/07/02/Git-Submodule/</url>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p><em>Git</em>æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ,å¤§å®¶å…¬å¸å¯èƒ½éƒ½æ˜¯ä½¿ç”¨çš„Gitæ¥è¿›è¡Œç‰ˆæœ¬æ§åˆ¶.</p><p>å¯¹äºæˆ‘ä¸ªäºº,æœ¬åœ°é¡¹ç›®ä¹Ÿå–œæ¬¢ä½¿ç”¨git,ä¸‡ä¸€å“ªå¤©æƒ³å›é€€ä¸€ä¸‹,æ²¡æœ‰gitå¯å°±çœŸè´¹åŠ²äº†.</p><p>å¯¹äºgitçš„å¸¸è§„æ“ä½œä¸ç”¨å¤šè¯´,ä»Šå¤©è´´ä¸€ä¸ªsubmoduleçš„çœŸå®ä½¿ç”¨è¿‡ç¨‹</p><a id="more"></a><p><img src="/images/git_all_project.png" srcset="/img/loading.gif" alt="project"></p><p>é¡¹ç›®ç»“æ„å¦‚ä¸Š.</p><p>ä¸ºäº†æ–¹ä¾¿æˆ‘è‡ªå·±ç©,æˆ‘å¼€äº†ä¸€ä¸ªplaygroundçš„é¡¹ç›®</p><p>playground</p><pre><code class="shell">.â”œâ”€â”€ app              #ä¸»é¡¹ç›®â”œâ”€â”€ lib_common         #å­é¡¹ç›®,å…¶ä¸­ä¸»è¦æä¾›ä¸‰æ–¹çš„ä¾èµ–,ä»¥åŠæ•´ä¸ªé¡¹ç›®çš„å…¬å…±ä»£ç éƒ¨åˆ†                     #å› ä¸ºè¿™ä¸ªé¡¹ç›®éœ€è¦åŠæ—¶æ›´æ–°,æ–¹ä¾¿æ¯ä¸ªäººä½¿ç”¨,æ‰€ä»¥æ˜¯ä¸€ä¸ªsubmoduleæ¥ç®¡ç† â”œâ”€â”€ lib_player   â”œâ”€â”€ module_views     #ä»Šå¤©è¦æ¼”ç¤ºçš„å­æ¨¡å—</code></pre><p>å…¶å®Submodule å’ŒAndroidçš„ç»„ä»¶åŒ–æ›´é…å“¦,å±äºå¼ºå¼ºè”åˆ</p><h4 id="åˆ›å»ºmodule-viewsæ¨¡å—"><a href="#åˆ›å»ºmodule-viewsæ¨¡å—" class="headerlink" title="åˆ›å»ºmodule_viewsæ¨¡å—"></a>åˆ›å»ºmodule_viewsæ¨¡å—</h4><h5 id="å»ºç«‹module"><a href="#å»ºç«‹module" class="headerlink" title="å»ºç«‹module"></a>å»ºç«‹module</h5><p>åœ¨æˆ‘ä»¬playgroundçš„é¡¹ç›®ä¸Š,åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—,æ€ä¹ˆæ“ä½œå°±ä¸è¯´äº†</p><h5 id="åœ¨module-viewsä¸­åˆå§‹åŒ–Git"><a href="#åœ¨module-viewsä¸­åˆå§‹åŒ–Git" class="headerlink" title="åœ¨module_viewsä¸­åˆå§‹åŒ–Git"></a>åœ¨module_viewsä¸­åˆå§‹åŒ–Git</h5><blockquote><p>æ³¨æ„,å½“module_viewsè¿™ä¸ªæ¨¡å—åˆ›å»ºæ—¶,ä¸€å®šä¸è¦æ‰‹å¿«æŠŠè¿™ä¸ªæ¨¡å—æ·»åŠ åˆ°playgroundæ•´ä¸ªé¡¹ç›®çš„ç‰ˆæœ¬æ§åˆ¶ä¸­</p><p>è®°å¾—<strong>å¿½ç•¥module_viewsæ•´ä¸ªmodule</strong></p></blockquote><p>ç›´æ¥è´´æ“ä½œäº†</p><pre><code class="shell"># phyooos @ wangzhumo in ~ [16:38:01]$ cd ~/workspace/playground# phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:58:48]$ ll | grep &#39;module_views&#39;drwxr-xr-x  11 phyooos  staff   352B  7  2 16:31 module_views# phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:59:03]$ cd module_views# phyooos @ wangzhumo in ~/workspace/playground/module_views  [16:59:19]$ git initReinitialized existing Git repository in /Users/phyooos/workspace/playground/module_views/.git/</code></pre><p>å› ä¸ºæˆ‘çš„module_viewså·²ç»åˆ›å»ºgitä»“åº“äº†,æ‰€ä»¥æœ€åä¸€æ­¥æç¤º <code>Reinitialized existing Git repository</code></p><h5 id="å…³è”è¿œç¨‹ä»“åº“"><a href="#å…³è”è¿œç¨‹ä»“åº“" class="headerlink" title="å…³è”è¿œç¨‹ä»“åº“"></a>å…³è”è¿œç¨‹ä»“åº“</h5><p>è¿™ä¸€æ­¥éšæ„,æˆ‘æœ¬äººæ˜¯åœ¨githubä¸Šåˆ›å»ºäº†ä¸€ä¸ªåä¸º<a href="https://github.com/wangzhumo/module_views" target="_blank" rel="noopener">module_views</a>çš„åº“</p><p>æ‹¿åˆ°è¿œç¨‹ä»“åº“åœ°å€ git@github.com:wangzhumo/module_views.git</p><pre><code class="shell"># phyooos @ wangzhumo in ~/workspace/playground/module_views  [16:59:30]$ git remote add origin git@github.com:wangzhumo/module_views.git# phyooos @ wangzhumo in ~/workspace/playground/module_views on git:master o [16:59:30]$ git pushEverything up-to-date# phyooos @ wangzhumo in ~/workspace/playground/module_views on git:master o [17:06:51]$ git statusOn branch masterYour branch is up to date with &#39;origin/master&#39;.nothing to commit, working tree clean</code></pre><p>æ·»åŠ è¿œç¨‹ä»“åº“,å¹¶push,æŠŠæœ¬åœ°ä»£ç æäº¤åˆ°githubä¸Šå»,å› ä¸ºæˆ‘è‡ªå·±å·²ç»æäº¤è¿‡äº†,æ‰€ä»¥å¯ä»¥çœ‹åˆ°</p><p><code>Everything up-to-date</code></p><h4 id="æ·»åŠ å­æ¨¡å—åˆ°playgroundä¸­"><a href="#æ·»åŠ å­æ¨¡å—åˆ°playgroundä¸­" class="headerlink" title="æ·»åŠ å­æ¨¡å—åˆ°playgroundä¸­"></a>æ·»åŠ å­æ¨¡å—åˆ°playgroundä¸­</h4><p>è´´æ“ä½œ</p><pre><code class="shell"># phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:38:12]$ git submodule add git@github.com:wangzhumo/module_views.git ./module_viewsThe following path is ignored by one of your .gitignore files:module_viewsUse -f if you really want to add it.# phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:38:59] C:1$ git submodule add -f git@github.com:wangzhumo/module_views.git ./module_viewsAdding existing repo at &#39;module_views&#39; to the index# phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:39:21]$ git submodule 1616423ab118e2154bcf018c825f6ed3a57cf59b lib_common (heads/master) 55ae43eb327207a456624c69e3c01868f8cf43e3 module_views (heads/master)# phyooos @ wangzhumo in ~/workspace/playground on git:master x [16:39:48]$ git submodule foreach git pullEntering &#39;lib_common&#39;Already up to date.Entering &#39;module_views&#39;Already up to date.</code></pre><p>ä¸‹é¢è§£é‡Šæ¯ä¸€æ¡å‘½ä»¤</p><ol><li><p><code>git submodule add git@github.com:wangzhumo/module_views.git ./module_views</code></p><p>æ·»åŠ å­æ¨¡å— <code>git submodule add &lt;repository&gt; &lt;path&gt; æ·»åŠ å­æ¨¡å—</code></p><p>æç¤ºå¦‚ä¸‹:</p><pre><code>The following path is ignored by one of your .gitignore files:module_viewsUse -f if you really want to add it.</code></pre><p>è¯´æˆ‘å·²ç»æŠŠ<code>module_views</code>æ·»åŠ åˆ°å¿½ç•¥æ–‡ä»¶ä¸­äº†,å¦‚æœç¡®å®æƒ³è¿™æ ·æ“ä½œ,åŠ ä¸Š<code>-f</code>å¼ºåˆ¶æ“ä½œ</p></li></ol><ol><li><p><code>git submodule add -f git@github.com:wangzhumo/module_views.git ./module_views</code></p><p>å¯ä»¥çœ‹åˆ°æç¤º,æˆ‘å·²ç»æˆåŠŸçš„æŠŠ<code>module_views</code>ä½œä¸ºå­é¡¹ç›®æ·»åŠ åˆ°<code>playground</code>ä¸­äº†</p></li></ol><ol><li><p><code>git submodule</code></p><p>ä¸€å…±çœ‹åˆ°ä¸¤ä¸ªå­æ¨¡å—,ä¸€ä¸ªæ˜¯åˆšæ·»åŠ çš„<code>module_views</code>,ä¸€ä¸ªæ˜¯æˆ‘ä¹‹å‰æ·»åŠ çš„</p></li></ol><ol><li><p><code>git submodule foreach git pull</code></p><p>æ‹‰å–æœ€æ–°ä»£ç </p></li></ol><h4 id="å…¶ä»–submoduleæ“ä½œ"><a href="#å…¶ä»–submoduleæ“ä½œ" class="headerlink" title="å…¶ä»–submoduleæ“ä½œ"></a>å…¶ä»–submoduleæ“ä½œ</h4><p>æ–‡æ¡£</p>]]></content>
    
    
    <categories>
      
      <category>Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ServiceLoader ä¸ è´£ä»»é“¾è®¾è®¡æ¨¡å¼</title>
    <link href="undefined2018/06/26/serviceloader-zerenlian/"/>
    <url>2018/06/26/serviceloader-zerenlian/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰å› "><a href="#å‰å› " class="headerlink" title="å‰å› "></a>å‰å› </h3><p>æœ€è¿‘åœ¨åšäººè„¸è¯†åˆ«çš„ä¸€äº›ä¸œè¥¿</p><p>ä¸»è¦æ˜¯ä½¿ç”¨ç™¾åº¦çš„SDKæ¥å®Œæˆé‡‡é›†, è¯†åˆ«.</p><p>è¿™ä¸ªåŠŸèƒ½æ˜¯ä½¿ç”¨ç™¾åº¦äº‘çš„Apiæ¥å¯¹äººè„¸è¿›è¡Œåˆ†æ,æ‹¿åˆ°å¹´é¾„ é¢œå€¼ ç­‰ç­‰ä¿¡æ¯</p><a id="more"></a><p><strong>ç¬¬ä¸€ç‰ˆè®¾è®¡ç¨¿:</strong></p><p><img src="/images/face_value.png" srcset="/img/loading.gif" alt="ä¹‹å‰çš„æ•ˆæœ"></p><p>é‚£æˆ‘å°±ç›´æ¥æŠŠè¯·æ±‚åˆ°çš„æ•°æ®å±•ç¤ºäº†ä¸€ä¸‹,ç„¶è€Œ</p><p><strong>ç¬¬äºŒç‰ˆè®¾è®¡ç¨¿:</strong></p><p><img src="/images/face_text.png" srcset="/img/loading.gif" alt="ç¬¬äºŒç‰ˆ"></p><p>è¿™ä¸€ç‰ˆå°±æ˜¯éœ€è¦æŠŠæ‹¿åˆ°çš„æ•°å€¼æŒ‰ç…§åŒºé—´æ¥å±•ç¤ºæˆæ–‡å­—æè¿°</p><p>é‚£ä¹ˆ,åº”è¯¥å°±æ˜¯å„ç§switch    if else </p><p>â€¦.</p><p>æœ¬æ¥ä¹Ÿæ˜¯åšDemo,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é«˜ç‚¹å…¶ä»–çš„ä¸œè¥¿,äºæ˜¯æˆ‘å°±æƒ³èµ·äº†è´£ä»»é“¾æ¨¡å¼,å‹‰å¼ºå¯ä»¥åšåšä¹ˆ</p><h3 id="å®ç°è´£ä»»é“¾"><a href="#å®ç°è´£ä»»é“¾" class="headerlink" title="å®ç°è´£ä»»é“¾"></a>å®ç°è´£ä»»é“¾</h3><h4 id="å®šä¹‰æŠ½è±¡ç±»"><a href="#å®šä¹‰æŠ½è±¡ç±»" class="headerlink" title="å®šä¹‰æŠ½è±¡ç±»"></a>å®šä¹‰æŠ½è±¡ç±»</h4><p>com.baidu.aip.fl.func.service.HandlerFace.java  æ¥å£</p><pre><code class="java">public abstract class HandlerFace {    private HandlerFace nextHandler;    //æ¥æ”¶ä¸€ä¸ªå®ä½“ç±»    public abstract ResultBean process(ResultBean bean);    //è¿”å›ä¸‹ä¸€ä¸ªå¤„ç†ç±»    public HandlerFace nextHandler(){        return nextHandler;    }    //è®¾ç½®ä¸‹ä¸€ä¸ªå¤„ç†ç±»    public void setHandler(HandlerFace handler){        this.nextHandler = handler;    }}</code></pre><h4 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h4><p><code>com.baidu.aip.fl.func.service.AgeHandlerFace.java</code>  å®ç°ç±»,å¤„ç†å¹´é¾„ä¿¡æ¯</p><pre><code class="java">public class AgeHandlerFace extends HandlerFace {    @Override    public ResultBean process(ResultBean bean) {        //1.å¤„ç†è‡ªå·±çš„äº‹æƒ…        if (bean != null &amp;&amp; bean.getIntAge() == 0 ){            bean.setResultAge(&quot;-&quot;);        }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 5){            bean.setResultAge(&quot;å°æœ‹å‹&quot;);        }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 10){            bean.setResultAge(&quot;ä¸­ç­‰æœ‹å‹&quot;);        }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 15){            bean.setResultAge(&quot;å¤§æœ‹å‹&quot;);        }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 20){            bean.setResultAge(&quot;æˆå¹´äºº&quot;);        }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 40){            bean.setResultAge(&quot;ä¸­å¹´äºº&quot;);        }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 60){            bean.setResultAge(&quot;è€å¹´äºº&quot;);        }else if (bean != null &amp;&amp; bean.getIntAge() &lt;= 100){            bean.setResultAge(&quot;å¹´çºªå¥½å¤§&quot;);        }        //2.æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªäººæ¥å¤„ç†        if (nextHandler() != null){            //2.1.å¦‚æœæœ‰ä¸‹ä¸€ä¸ªå¤„ç†ç±»,åˆ™æŠŠä¿¡æ¯äº¤ç»™ä»–ç»§ç»­å¤„ç†            return nextHandler().process(bean);        }        //3.æ²¡æœ‰ä¸‹ä¸€ä¸ªå¤„ç†ç›´æ¥è¿”å›        return bean;    }}</code></pre><p>AgeHandlerFaceç±»åªå¤„ç†å¹´çºªç›¸å…³çš„ä¸œè¥¿</p><p><code>com.baidu.aip.fl.func.service.BeautyHandlerFace.java</code></p><p><code>com.baidu.aip.fl.func.service.GenderHandlerFace.java</code></p><p>åŒæ ·å®ç°HandlerFace,åˆ†åˆ«å¤„ç†é¢œå€¼å’Œæ€§åˆ«</p><h3 id="ServiceLoader"><a href="#ServiceLoader" class="headerlink" title="ServiceLoader"></a>ServiceLoader</h3><p>ä¸Šé¢çš„è´£ä»»é“¾å…¶å®å·²ç»å¯ä»¥ä½¿ç”¨,ä½†æ˜¯éœ€è¦æ‰‹åŠ¨æ¥åˆå§‹åŒ–æ¯ä¸ªå…·ä½“å®ç°ç±»,</p><p>å¹¶ä¸”ä¸€ä¸ªä¸€ä¸ªè®¾ç½® nextHandler ,æœ€åè°ƒç”¨å¤„ç†</p><pre><code class="java">public class RealProcessFace{    //ä¿å­˜HandlerFaceçš„æ¯ä¸€ä¸ªå®ç°ç±»    private static ArrayList&lt;HandlerFace&gt; arraylist;    static {        arraylist = new ArrayList();        //é€šè¿‡ServiceLoaderæ¥åŠ è½½æ‰€æœ‰HandlerFaceçš„å®ç°ç±»        ServiceLoader&lt;HandlerFace&gt; processors = ServiceLoader.load(HandlerFace.class);        Iterator iterator = processors.iterator();        while (iterator.hasNext()) {            //iterator.next() è¿™é‡Œå…·ä½“å®ç°ç±»æ‰çœŸæ­£çš„åˆå§‹åŒ–äº†            arraylist.add((HandlerFace) iterator.next());        }    }    /**     * è·å–ç»„åˆçŸ­è¯­     * @param task äººè„¸ä¿¡æ¯     * @return ç»„åˆçŸ­è¯­     */    public static String process(ResultBean task) {        for (int i = 0; i &lt; arraylist.size() - 1 ; i++) {            //ä¾æ¬¡è®¾ç½®setHandler             //å› ä¸ºæˆ‘å¹¶ä¸éœ€è¦ä»–ä»¬ä¾æ¬¡å¤„ç†,æ‰€ä»¥æˆ‘å¹¶ä¸å…³ç³»ä»–ä»¬å¤„ç†çš„é¡ºåº            //å¦‚æœæ˜¯éœ€è¦é¡ºåºæ‰§è¡Œçš„è¯,å»ºè®®è¿˜æ˜¯æ‰‹åŠ¨å¤„ç†            arraylist.get(i).setHandler(arraylist.get(i+1));        }        //è°ƒç”¨ç¬¬ä¸€ä¸ªå¤„ç†ç±»,å°±ä¼šä¾æ¬¡è°ƒç”¨åé¢çš„å¤„ç†ç±»        ResultBean resultBean = arraylist.get(0).process(task);        //è¿”å›å¤„ç†ç»“æœ        return resultBean.format();    }}</code></pre><h4 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h4><p><img src="/images/service_info.png" srcset="/img/loading.gif" alt="info"></p><p>1.åˆ›å»ºä¸€ä¸ªbaseç±»,å°±æ˜¯æˆ‘ä¸Šé¢å†™è¿‡çš„,å¯ä»¥æ˜¯æ¥å£å’ŒæŠ½è±¡ç±»</p><p><code>com.baidu.aip.fl.func.service.HandlerFace</code></p><p>2.ä¸€ä¸ªæˆ–å¤šä¸ªå®ç°ç±»</p><p><code>com.baidu.aip.fl.func.service.AgeHandlerFace.java</code></p><p><code>com.baidu.aip.fl.func.service.BeautyHandlerFace.java</code></p><p><code>com.baidu.aip.fl.func.service.GenderHandlerFace.java</code></p><p>è¿™é‡Œä¸€å…±æ˜¯3ä¸ª</p><p>3.å®šä¹‰resources/META-INF/ â€¦. æ–‡ä»¶</p><ul><li><p>è¯¥æ–‡ä»¶æ— æ‹“å±•å</p></li><li><p>æ–‡ä»¶åå°±æ˜¯ baseç±» æˆ–è€…æ¥å£ çš„å…¨è·¯å¾„( åŒ…å + Filename )</p></li><li><p>æ–‡ä»¶ä¸­æ¯ä¸€è¡Œå†™ä¸€ä¸ªå®ç°ç±»çš„å…¨è·¯å¾„å( åŒ…å + Filename )</p><p>src/main/resources/META-INF/services/com.baidu.aip.fl.func.service.HandlerFace</p><pre><code>com.baidu.aip.fl.func.service.GenderHandlerFacecom.baidu.aip.fl.func.service.AgeHandlerFacecom.baidu.aip.fl.func.service.BeautyHandlerFace</code></pre></li></ul><p>4.è·å–æ‰€æœ‰å®ç°ç±»</p><pre><code class="java">ServiceLoader&lt;HandlerFace&gt; processors = ServiceLoader.load(HandlerFace.class);//æ³¨æ„æ­¤æ—¶å®ç°ç±»éƒ½æ²¡æœ‰å®ä¾‹åŒ–Iterator iterator = processors.iterator();while (iterator.hasNext()) {    //iterator.next() è¿™é‡Œå…·ä½“å®ç°ç±»æ‰çœŸæ­£çš„åˆå§‹åŒ–äº†    arraylist.add((HandlerFace) iterator.next());}</code></pre><p>è¿™æ ·çš„æ‡’åŠ è½½è¿‡ç¨‹æ˜¯ç”±ServiceLoaderå®ç°çš„</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><h4 id="è´£ä»»é“¾"><a href="#è´£ä»»é“¾" class="headerlink" title="è´£ä»»é“¾"></a>è´£ä»»é“¾</h4><p>è¿™æ ·çš„å½¢å¼,ä¸ºåæœŸçš„æ‰©å±•æä¾›äº†å¾ˆå¤§çš„ä¾¿åˆ©</p><p>AgeHandlerFace ä¸­,æˆ‘å¯ä»¥åˆ†æ›´ç»†çš„ç²’åº¦,ä¹Ÿå¯ä»¥åˆå¹¶.</p><p>eg:  50 ä»¥ä¸‹éƒ½æ˜¯å¹´è½»äºº</p><pre><code>   100 - 50 æ˜¯è€å¹´äºº</code></pre><p>è´£ä»»é“¾è™½ç„¶Androidç«¯æœ€æ˜¾è‘—çš„ç®—æ˜¯ <strong>äº‹ä»¶åˆ†å‘æœºåˆ¶</strong>  ,å¾ˆå¤šæ¡†æ¶ä¸­ä¹Ÿéƒ½æœ‰ä½¿ç”¨,filterè¿™æ ·çš„ä¸œè¥¿</p><h4 id="ServiceLoader-1"><a href="#ServiceLoader-1" class="headerlink" title="ServiceLoader"></a>ServiceLoader</h4><p>è¿™ä¸ªä¸œè¥¿,å¾ˆå¼ºå¤§</p><p>åœ¨æ’ä»¶åŒ–,ä»¥åŠ æœåŠ¡æä¾›ç­‰æ–¹é¢éƒ½æœ‰åº”ç”¨</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidè‡ªå®šä¹‰ä¸€ä¸ªé®ç½©å¼•å¯¼å±‚</title>
    <link href="undefined2018/05/21/Android-Shade/"/>
    <url>2018/05/21/Android-Shade/</url>
    
    <content type="html"><![CDATA[<h4 id="åˆ†æéœ€æ±‚"><a href="#åˆ†æéœ€æ±‚" class="headerlink" title="åˆ†æéœ€æ±‚"></a>åˆ†æéœ€æ±‚</h4><p>é«˜äº®æ˜¾ç¤ºæŒ‡å®šçš„æ§ä»¶(1ä¸ªæˆ–è€…å¤šä¸ª)</p><ul><li>åªæœ‰ä¸€ä¸ªé«˜äº®æ§ä»¶,åˆ™ç›´æ¥ç»˜åˆ¶å³å¯</li><li>å¤šä¸ªé«˜äº®æ§ä»¶,åˆ™åˆ†ä¸¤ç§æ•ˆæœå±•ç¤º<ul><li>é¡ºåºå±•ç¤ºæ¯ä¸€ä¸ªæ§ä»¶</li><li>å±•ç¤ºæ‰€æœ‰æ§ä»¶</li></ul></li><li>é«˜äº®éƒ¨åˆ†çš„å½¢çŠ¶<ul><li>æ–¹å½¢</li><li>åœ†å½¢</li></ul></li></ul><a id="more"></a><p>å±•ç¤ºä¸æ¶ˆå¤±</p><ul><li>è‡ªåŠ¨å±•ç¤º,è‡ªåŠ¨æ¶ˆå¤±</li><li>ç‚¹å‡»æ¶ˆå¤±</li><li>ç‚¹å‡»æŒ‡å®šéƒ¨åˆ†æ¶ˆå¤±</li></ul><h4 id="å®ç°æ–¹å¼"><a href="#å®ç°æ–¹å¼" class="headerlink" title="å®ç°æ–¹å¼"></a>å®ç°æ–¹å¼</h4><h5 id="é®ç½©å±‚"><a href="#é®ç½©å±‚" class="headerlink" title="é®ç½©å±‚"></a>é®ç½©å±‚</h5><ol><li>ç›´æ¥åœ¨æœ¬æ¥çš„é¡µé¢æ˜¯æ·»åŠ ,ä¸ç”¨æ—¶æ¶ˆå¤±</li><li>ä½¿ç”¨DecorViewçš„æ–¹å¼,æ·»åŠ viewå³å¯</li><li>ä½¿ç”¨é€æ˜Activityè¦†ç›–</li></ol><p>é€‰æ‹©ç¬¬äºŒç§æ–¹å¼æ¥å®ç°</p><p>ç¬¬ä¸€ç§æ–¹ä¾¿ä½†æ˜¯è€—æ—¶è€—åŠ›,å¹¶ä¸”ä¸èƒ½é€šç”¨</p><p>ç¬¬äºŒç§æ˜¯å¤§å®¶éƒ½è®¤å¯çš„ä¸€ç§æ–¹å¼,è€Œä¸”æ”¯æŒé…ç½®</p><p>ç¬¬ä¸‰ç§,å¯¹åŸç•Œé¢ç”Ÿå‘½å‘¨æœŸé€ æˆå½±å“,ä¸å¤ªå¥½</p><h5 id="é«˜äº®çš„å®ç°"><a href="#é«˜äº®çš„å®ç°" class="headerlink" title="é«˜äº®çš„å®ç°"></a>é«˜äº®çš„å®ç°</h5><p><strong>PorterDuffXfermode</strong>      :: PorterDuff.Mode.XOR)</p><h4 id="ä»£ç è®¾è®¡"><a href="#ä»£ç è®¾è®¡" class="headerlink" title="ä»£ç è®¾è®¡"></a>ä»£ç è®¾è®¡</h4><ul><li>mask layer View   ç”¨æ¥å®ç°é®ç½©å±‚<ul><li>é«˜äº®æ˜¾ç¤ºç»˜åˆ¶</li><li>æŒ‡ç¤ºè¯­ä½ç½®</li></ul></li><li>mask layer Manager  ç”¨æ¥ç®¡ç†  é®ç½©å±‚ <ul><li>addView</li><li>Show / hide </li><li>DecorView æ“ä½œ</li><li>å…¶ä»–é…ç½®ä¿¡æ¯</li></ul></li><li>mask bean  ç”¨æ¥å­˜æ”¾éœ€è¦é«˜äº®çš„Viewä¿¡æ¯(é«˜åº¦,å®½åº¦..)</li></ul><h4 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h4><p>mask:</p><p>MaskGuideView   é®ç½©å±‚å®¹å™¨</p><p>MaskLayout   é«˜äº®æ§ä»¶ä¸æŒ‡ç¤ºè¯­çš„ä½ç½®,ä»¥åŠæ’åˆ—å±•ç¤º</p><p>MaskManager      åŠ è½½ç®¡ç†æ•´ä¸ªé®ç½©å±‚</p><p>MaskType      é«˜äº®æ§ä»¶çš„å½¢çŠ¶, åœ† æ–¹</p><p>TargetInfo      é«˜äº®æ§ä»¶çš„ä½ç½®ä¿¡æ¯</p><p>TargetInfo.java</p><pre><code class="java">/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/5/21 ä¸‹åˆ7:20 * * é«˜äº®åŒºåŸŸä¿¡æ¯ */public class TargetInfo {    /*     * é«˜äº®åŒºåŸŸèµ·å§‹Xåæ ‡     */    public int startX;    /*     * é«˜äº®åŒºåŸŸèµ·å§‹Yåæ ‡     */    public int startY;    /*     * é«˜äº®åŒºåŸŸå®½åº¦     */    public int width;    /*     * é«˜äº®åŒºåŸŸé«˜åº¦     */    public int height;    /*     * åç§»é‡     */    public int offset = 10;    /**     * è·å–åŠå¾„     */    public int getRadius() {        return Math.max(width, height) / 2;    }}</code></pre><p>MaskType.java</p><pre><code class="java">/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/5/21 ä¸‹åˆ7:18 */public enum MaskType {    Rect,Circle}</code></pre><pre><code class="java">/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * * @author ç‹è¯›é­” 2018/5/21 ä¸‹åˆ11:35 * * è´Ÿè´£ç®¡ç†,å‡†å¤‡,æ“ä½œMaskGuideView */public class MaskManager {    //å±æ€§    private static final String TAG = &quot;MaskManager&quot;;    private final ViewGroup mRootView;    private final MaskGuideView mMaskGuideView;    private final Context mContext;    private List&lt;TargetInfo&gt; mTargetInfoList;    private List&lt;View&gt; mTargetViewList;    private List&lt;MaskLayout&gt; mMaskLayoutList;    private MaskType mMaskType;    private boolean isShowAll;    private int mPadding;    /**     * è®¡ç®—targetInfo     *     * @param targetView view     * @return TargetInfo     */    private TargetInfo generateTargetInfo(View targetView) {        int[] location = new int[2];        //æˆ‘ä»¬éœ€è¦çš„æ˜¯,è¿™ä¸ªtargetViewåœ¨æ•´ä¸ªå±å¹•ä¸Šçš„ä½ç½®        targetView.getLocationOnScreen(location);        TargetInfo targetInfo = new TargetInfo();        //è®¡ç®—startX width ...        switch (mMaskType) {            case Rect:                targetInfo.startX = location[0] - mPadding;                targetInfo.startY = location[1] - mPadding;                targetInfo.width = targetView.getWidth() + 2 * mPadding;                targetInfo.height = targetView.getHeight() + 2 * mPadding;                break;            case Circle:                int diameter = Math.max(targetView.getWidth() + 2 * mPadding, targetView.getHeight() + 2 * mPadding);                targetInfo.startX = location[0] - mPadding;                targetInfo.startY = location[1] - mPadding - (diameter / 2 - targetView.getHeight() / 2 - mPadding);                targetInfo.width = diameter;                targetInfo.height = diameter;                break;        }        Log.e(TAG, &quot;generateTargetInfo: &quot; + targetInfo.toString() );        return targetInfo;    }    /*     * builderæ¨¡å¼     */    public static class Builder {        private ViewGroup mRootView;        private MaskGuideView mMaskGuideView;        private Context mContext;        private List&lt;TargetInfo&gt; mTargetInfoList;        private List&lt;MaskLayout&gt; mMaskLayoutList;        private List&lt;View&gt; mTargetViewList;        private MaskType mMaskType = MaskType.Circle;        private int mPadding = 0;        private int mGravity = Gravity.TOP;        private boolean isShowAll;        ...çœç•¥        public MaskManager build() {            this.mMaskGuideView.setOnClickListener(this.mMaskGuideView);            return new MaskManager(this);        }    }}</code></pre><p>é¢,ä»£ç ä¼ gitå¥½äº†</p>]]></content>
    
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android Binderæœºåˆ¶(ä¸€)</title>
    <link href="undefined2018/05/11/Android-Binder-1/"/>
    <url>2018/05/11/Android-Binder-1/</url>
    
    <content type="html"><![CDATA[<h3 id="ServiceManager"><a href="#ServiceManager" class="headerlink" title="ServiceManager"></a>ServiceManager</h3><p>é¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸‹ServiceManager.</p><p>ServiceManagerçš„åŠŸèƒ½ä¸»è¦å°±æ˜¯æ³¨å†Œ,æŸ¥è¯¢æœåŠ¡,ä½œä¸ºä¸€ä¸ªå¤§ç®¡å®¶çš„è§’è‰²å‡ºç°.</p><ul><li>æ³¨å†ŒæœåŠ¡ï¼šè®°å½•æœåŠ¡åå’Œä¿¡æ¯ï¼Œæ”¾åˆ°æœåŠ¡åˆ—è¡¨</li><li>æŸ¥è¯¢æœåŠ¡ï¼šæ ¹æ®æœåŠ¡åæŸ¥è¯¢ç›¸åº”çš„çš„ä¿¡æ¯</li></ul><p>ServiceManageræ˜¯æœ‰æƒé™æ§åˆ¶çš„ï¼Œåªæœ‰å…·æœ‰ç›¸åº”æƒé™çš„è¿›ç¨‹æ‰èƒ½æ³¨å†Œ,æŸ¥è¯¢æœåŠ¡</p><p><a href="http://gityuan.com/2015/11/08/binder-get-sm/" target="_blank" rel="noopener">http://gityuan.com/2015/11/08/binder-get-sm/</a></p><a id="more"></a><h3 id="Linuxå†…å­˜"><a href="#Linuxå†…å­˜" class="headerlink" title="Linuxå†…å­˜"></a>Linuxå†…å­˜</h3><h4 id="å†…æ ¸ç©ºé—´"><a href="#å†…æ ¸ç©ºé—´" class="headerlink" title="å†…æ ¸ç©ºé—´"></a>å†…æ ¸ç©ºé—´</h4><p>ä¸ºä»€ä¹ˆè¿›ç¨‹é—´ä¸å¯ä»¥ç›´æ¥é€šè®¯é‚£?</p><p>å› ä¸ºæ¯ä¸ªè¿›ç¨‹çš„å†…å­˜ç©ºé—´éƒ½æ˜¯éš”ç¦»èµ·æ¥çš„,ä¸å¯èƒ½éšæ„å»è®¿é—®å…¶ä»–è¿›ç¨‹çš„å†…å­˜.</p><p>åœ¨32ä½ç³»ç»Ÿä¸­,å¯»å€ç©ºé—´æœ€å¤§ä¸º4G,é‚£ä¹ˆè¿™4Gå†…å­˜,ä¸€èˆ¬å°†1Gåˆ†é…ç»™å†…æ ¸ç©ºé—´,3Gç”¨æˆ·ç©ºé—´,Linuxå†…æ ¸ç”±ç³»ç»Ÿå†…çš„æ‰€æœ‰è¿›ç¨‹å…±äº«.</p><p><img src="/images/linux_memory.png" srcset="/img/loading.gif" alt=""></p><p>è¿™ä¹ˆä¸€æ¥,æˆ‘ä»¬å°±å¯ä»¥åœ¨å†…æ ¸ç©ºé—´ä¸ºæ‰€æ¬²ä¸ºäº†,ä¸,å¹¶ä¸èƒ½.ç”¨æˆ·è¿›ç¨‹ä¸èƒ½ç›´æ¥æ“ä½œå†…æ ¸.</p><p>Androidæ˜¯åœ¨Linuxçš„å†…æ ¸ä¸Šè·‘çš„,é‚£ä¹ˆä¸ºä»€ä¹ˆAndroidè¦è‡ªå·±åšä¸€ä¸ªBinderæ¥å®ç°è¿›ç¨‹é—´çš„é€šè®¯é‚£?</p><p>æˆ‘ä»¬éƒ½çŸ¥é“Linuxä¸ŠSocket/ç®¡é“/æ¶ˆæ¯é˜Ÿåˆ—éƒ½å¯ä»¥åšåˆ°è¿›ç¨‹é—´çš„é€šè®¯,ä½†æ˜¯é€šè¿‡è¿™äº›éƒ½éœ€è¦2æ¬¡å†…å­˜æ‹·è´,</p><p>è€ŒBinderåªéœ€è¦ä¸€æ¬¡å°±å¯ä»¥å®Œæˆ,å¤§å¤§çš„æé«˜æ•ˆç‡</p><h4 id="BINDER-MMAP"><a href="#BINDER-MMAP" class="headerlink" title="BINDER_MMAP"></a>BINDER_MMAP</h4><p>mmapå¯ä»¥å°†ä¸€ä¸ªæ–‡ä»¶æˆ–è€…å…¶å®ƒå¯¹è±¡æ˜ å°„è¿›å†…å­˜</p><p>åœ¨Binderä¸­,é€šè¿‡åœ¨ç”¨æˆ·ç©ºé—´(å½“å‰è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´)åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿåœ°å€ç©ºé—´,å¹¶åœ¨å†…æ ¸ç©ºé—´åˆ›å»ºç›¸åŒå¤§å°çš„è™šæ‹Ÿåœ°å€ç©ºé—´.</p><p>æ¥ç€ç”³è¯·ä¸€å—ç‰©ç†å†…å­˜,å°†ç‰©ç†å†…å­˜æ˜ å°„åˆ°å†…æ ¸è™šæ‹Ÿåœ°å€ç©ºé—´å’Œç”¨æˆ·è™šæ‹Ÿå†…å­˜ç©ºé—´,è¿™æ ·å°±å®ç°äº†ç”¨æˆ·æ§ä»¶å’Œå†…æ ¸ç©ºé—´çš„åŒæ­¥.</p><p><img src="/images/binder_physical_memory.jpg" srcset="/img/loading.gif" alt="æ¥è‡ªGityuanå¤§ä½¬"></p><h4 id="å¤§æ¦‚æµç¨‹"><a href="#å¤§æ¦‚æµç¨‹" class="headerlink" title="å¤§æ¦‚æµç¨‹"></a>å¤§æ¦‚æµç¨‹</h4><ol><li>copy_from_user é¦–å…ˆæ˜¯è¦å‘å‡ºæ¶ˆæ¯çš„,é‚£ä¹ˆå…ˆä»ç”¨æˆ·æ§ä»¶from æ‹·è´æ•°æ®</li><li>binder_thread_write ç¬¬äºŒæ­¥å°±æ˜¯æŠŠåˆšæ‰æ‹·è´çš„æ•°æ®å†™å…¥åˆ°å†…æ ¸ç©ºé—´</li><li>binder_thread_read ç¬¬ä¸‰æ­¥å†æ¬¡è¯»å–åˆšæ‰ä»ç”¨æˆ·æ§ä»¶fromè¯»å–å¹¶å†™å…¥å†…æ ¸ç©ºé—´çš„æ•°æ®</li><li>copy_to_user æœ€åå½“ç„¶æ˜¯ä»å†…æ ¸ç©ºé—´æ‹·è´æ•°æ®åˆ°ç”¨æˆ·ç©ºé—´to(å³ç›®æ ‡)</li></ol><p>PS:ä»¥ä¸Šå‡å»ºç«‹åœ¨æ¯ä¸€æ¬¡æ“ä½œéƒ½æˆåŠŸçš„åŸºç¡€ä¸Š</p><p>æ¥è‡ªGityuanå¤§ç¥çš„åˆ†äº«<a href="http://gityuan.com/2015/11/01/binder-driver/" target="_blank" rel="noopener">http://gityuan.com/2015/11/01/binder-driver/</a></p><p><img src="/images/binder_memory_map.jpg" srcset="/img/loading.gif" alt="binder_memory"></p><p>è§£é‡Šè¯´æ˜:</p><p>é¦–å…ˆClientç«¯å‘é€æ¶ˆæ¯,é€šè¿‡copy_from_userä»Clientç«¯<strong>æ‹·è´æ•°æ®</strong>åˆ°å†…æ ¸ç©ºé—´å»</p><p>è€Œåè¿˜è®°å¾—<strong>BINDER_MMAP</strong>ä¸­çš„æ“ä½œä¹ˆ,å†…æ ¸ç©ºé—´çš„åœ°å€ä¸Serveræ˜¯åŒä¸€å—ç‰©ç†å†…å­˜,</p><p>Serverå°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹å¼,ç›´æ¥åŒæ­¥åˆ°Clientå‘é€çš„æ•°æ®.</p><blockquote><ul><li>binder_initï¼šåˆå§‹åŒ–å­—ç¬¦è®¾å¤‡ï¼›</li><li>binder_openï¼šæ‰“å¼€é©±åŠ¨è®¾å¤‡ï¼Œè¿‡ç¨‹éœ€è¦æŒæœ‰binder_main_lockåŒæ­¥é”ï¼›</li><li>binder_mmapï¼šç”³è¯·å†…å­˜ç©ºé—´ï¼Œè¯¥è¿‡ç¨‹éœ€è¦æŒæœ‰binder_mmap_lockåŒæ­¥é”ï¼›</li><li>binder_ioctlï¼šæ‰§è¡Œç›¸åº”çš„ioctlæ“ä½œï¼Œè¯¥è¿‡ç¨‹éœ€è¦æŒæœ‰binder_main_lockåŒæ­¥é”ï¼›<ul><li>å½“å¤„äºbinder_thread_readè¿‡ç¨‹ï¼Œread_bufferæ— æ•°æ®åˆ™é‡Šæ”¾åŒæ­¥é”ï¼Œå¹¶å¤„äºwait_event_freezableè¿‡ç¨‹ï¼Œç­‰æœ‰æ•°æ®åˆ°æ¥åˆ™å”¤é†’å¹¶å°è¯•æŒæœ‰åŒæ­¥é”ã€‚</li></ul></li></ul></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Source Code</tag>
      
      <tag>Binder</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿ç¨‹ä¸è¿›ç¨‹çš„å¼‚åŒä»¥åŠAndroidä¸­çš„IPCæœºåˆ¶</title>
    <link href="undefined2018/05/10/Thread-Process-IPC/"/>
    <url>2018/05/10/Thread-Process-IPC/</url>
    
    <content type="html"><![CDATA[<h3 id="çº¿ç¨‹ä¸è¿›ç¨‹"><a href="#çº¿ç¨‹ä¸è¿›ç¨‹" class="headerlink" title="çº¿ç¨‹ä¸è¿›ç¨‹"></a>çº¿ç¨‹ä¸è¿›ç¨‹</h3><p>Google  Doc (<a href="https://developer.android.com/guide/components/processes-and-threads" target="_blank" rel="noopener">https://developer.android.com/guide/components/processes-and-threads</a>)</p><ul><li><p>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯cpuè°ƒåº¦çš„æœ€å°å•ä½.</p></li><li><p>è¿›ç¨‹æ˜¯åº”ç”¨ç¨‹åºçš„æ‰§è¡Œå®ä¾‹,ä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹,</p><p>è€Œä¸€ä¸ªè¿›ç¨‹çš„åˆ›å»ºåˆ†é…æ˜¯è¦æ¶ˆè€—è¾ƒå¤§çš„æ€§èƒ½çš„,ç›¸æ¯”æ¥è¯´çº¿ç¨‹å°±è¦æ¯”è¿›ç¨‹çš„å¼€é”€å°.</p></li><li><p>å¯¹äºè¿›ç¨‹æ¥è¯´ä¸å…±äº«èµ„æº,å†…å­˜æ˜¯ç‹¬ç«‹çš„.è€Œçº¿ç¨‹å…±äº«å®ƒæ‰€åœ¨çš„çº¿ç¨‹çš„èµ„æº,å†…å­˜.</p></li><li><p>è¿›ç¨‹é—´çš„é€šä¿¡å°±è¦æ›´åŠ éº»çƒ¦,éœ€è¦ä½¿ç”¨IPC( Inter-Proscess Communication)è¿›ç¨‹é—´çš„é€šè®¯</p><p>çº¿ç¨‹æ–¹ä¾¿å¾ˆå¤š,ä½†æ˜¯çº¿ç¨‹é—´çš„åŒæ­¥åˆæ˜¯ä¸€ä¸ªè¾ƒä¸ºå¤§çš„è¯¾é¢˜äº†.</p></li></ul><blockquote><p>æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œçº¿ç¨‹å…³æ³¨çš„æ˜¯ä¸­å¤®å¤„ç†å™¨çš„è¿è¡Œï¼Œè€Œä¸æ˜¯è¿›ç¨‹é‚£æ ·å…³æ³¨å†…å­˜ç­‰èµ„æºçš„ç®¡ç†ã€‚</p></blockquote><a id="more"></a><h3 id="Androidä¸­çš„IPCæœºåˆ¶"><a href="#Androidä¸­çš„IPCæœºåˆ¶" class="headerlink" title="Androidä¸­çš„IPCæœºåˆ¶"></a>Androidä¸­çš„IPCæœºåˆ¶</h3><p>å¦‚ä¸‹å›¾æ‰€ç¤º:(å·²ç»ä¸çŸ¥é“å“ªé‡Œçš„é…å›¾äº†â€¦æ„Ÿè°¢åˆ†äº«)</p><p><img src="/images/android_ipc.png" srcset="/img/loading.gif" alt=""></p><h4 id="IPCç®€ä»‹"><a href="#IPCç®€ä»‹" class="headerlink" title="IPCç®€ä»‹"></a>IPCç®€ä»‹</h4><p>IPC(Inter-Process Communication) è¿›ç¨‹é—´é€šä¿¡</p><p>ä½¿ç”¨åœºæ™¯:</p><p>åœ¨Androidç¨‹åºä¸­ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸€ä¸ªç¨‹åºå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹</p><ol><li><p>Appé—´çš„é€šä¿¡,å¸¸è§çš„å¦‚éœ€è¦ä½¿ç”¨å…¶ä»–Appçš„æ•°æ®</p></li><li><p>ä¸€ä¸ªAppä½¿ç”¨å¤šè¿›ç¨‹,æ¯”å¦‚æŒ‡å®šè¿è¡Œçº¿ç¨‹<code>android:process=&quot;:name&quot;</code></p><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯,å¦‚æœä¸€ä¸ªAppä½¿ç”¨å¤šè¿›ç¨‹,Applicationä¹Ÿä¼šå¤šæ¬¡åˆ›å»º</p></blockquote></li></ol><h4 id="Bundle"><a href="#Bundle" class="headerlink" title="Bundle"></a>Bundle</h4><p>å¸¸è§äºActivity,serviceä¸­ä¼ é€’æ•°æ®</p><p>éœ€è¦æ³¨æ„çš„æ˜¯,bundleä¸­çš„æ•°æ®å¿…é¡»æ”¯æŒåºåˆ—åŒ–(Serializable,Parcelable)</p><h4 id="æ–‡ä»¶å…±äº«"><a href="#æ–‡ä»¶å…±äº«" class="headerlink" title="æ–‡ä»¶å…±äº«"></a>æ–‡ä»¶å…±äº«</h4><p>SharedPreferenceå°±æ˜¯è¿™ç§å®ç°çš„.</p><p>é€‚åˆå¯¹åŒæ­¥è¦æ±‚ä¸é«˜çš„ä½¿ç”¨æ–¹å¼,éœ€è¦æ³¨æ„å¤„ç†å¥½å¹¶å‘çš„é—®é¢˜.</p><h4 id="Messenger"><a href="#Messenger" class="headerlink" title="Messenger"></a>Messenger</h4><p>Messenger å¯¹ AIDL è¿›è¡Œäº†å°è£…ï¼Œå®ƒå®ç°äº†ä¸€ç§åŸºäºæ¶ˆæ¯çš„è¿›ç¨‹é—´é€šä¿¡çš„æ–¹å¼</p><p><code>frameworks/base/core/java/android/os/IMessenger.aidl</code></p><p>å®ƒçš„AIDLæ–‡ä»¶å°±åœ¨è¿™é‡Œä¿å­˜ç€!</p><h4 id="AIDL"><a href="#AIDL" class="headerlink" title="AIDL"></a>AIDL</h4><p>AIDLï¼ˆAndroid Interface definition languageï¼‰ æ˜¯ Android æä¾›çš„ä¸€ç§è¿›ç¨‹é—´é€šä¿¡ (IPC) æœºåˆ¶</p><p>éœ€è¦æ³¨æ„çš„æ˜¯AIDLæ”¯æŒçš„æ•°æ®ç±»å‹ä¸Javaæ¥å£æ”¯æŒçš„æ•°æ®ç±»å‹æœ‰äº›ä¸åŒ:</p><ol><li>æ‰€æœ‰åŸºç¡€ç±»å‹ï¼ˆint, charâ€¦ï¼‰</li><li>Stringï¼ŒListï¼ŒMap</li><li>æ‰€æœ‰Parcelableçš„ç±»</li></ol><p>å¹¶ä¸”è¦æ ¹æ®éœ€è¦æ·»åŠ  in out çš„å…³é”®è¯</p><h4 id="ContentProvider"><a href="#ContentProvider" class="headerlink" title="ContentProvider"></a>ContentProvider</h4><p>ä¸»è¦æ˜¯é’ˆå¯¹æ•°æ®åº“ä½¿ç”¨çš„,æœ€å¸¸è§çš„ä¾‹å­å°±æ˜¯Androidä¸­æœ‰å¾ˆå¤šå·²ç»å®šä¹‰å¥½çš„ContentProvider</p><h4 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h4><p>è¯´åˆ°è¿™é‡Œ,å°±ä¸å¾—ä¸æä¸€ä¸‹<strong>Binder</strong>äº†</p><p><a href="http://www.wangzhumo.com/Source-Code/Android-Binder%E6%9C%BA%E5%88%B6-%E4%B8%80/">http://www.wangzhumo.com/Source-Code/Android-Binder%E6%9C%BA%E5%88%B6-%E4%B8%80/</a></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaä¸­çš„å†…å­˜æ¨¡å‹</title>
    <link href="undefined2018/05/09/Java-memory-module/"/>
    <url>2018/05/09/Java-memory-module/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/java_heap_stack.png" srcset="/img/loading.gif" alt="java_heap_stack"></p><a id="more"></a><h4 id="1-å †"><a href="#1-å †" class="headerlink" title="1. å †"></a>1. å †</h4><p>åœ¨JVMä¸­åªæœ‰ä¸€ä¸ª,javaå›æ”¶æœºåˆ¶ä¸»è¦å°±æ˜¯ä½œç”¨äºè¿™ä¸€å—</p><p>å †ä¸»è¦æ˜¯ç”¨æ¥å­˜æ”¾å­˜å‚¨å¯¹è±¡çš„å†…å®¹åŠå…¶æœ¬èº«çš„.</p><h4 id="2-æ–¹æ³•åŒº"><a href="#2-æ–¹æ³•åŒº" class="headerlink" title="2. æ–¹æ³•åŒº"></a>2. æ–¹æ³•åŒº</h4><p>æ–¹æ³•åŒºä¹Ÿå’Œå †ä¸€æ ·,æ˜¯è¢«çº¿ç¨‹å…±äº«çš„.</p><p>å­˜æ”¾äº†ç±»çš„ä¿¡æ¯(æ–¹æ³•,å­—æ®µ,åç§°),é™æ€å˜é‡,å¸¸é‡</p><p>Java1.7ä¹‹å‰,å­—ç¬¦ä¸²å¸¸é‡æ± ä¹Ÿæ˜¯æ”¾åœ¨è¿™é‡Œçš„,ä½†æ˜¯1.7ä»¥åç§»åŠ¨åˆ°å †é‡Œé¢å»äº†</p><h4 id="3-è™šæ‹Ÿæœºæ ˆ"><a href="#3-è™šæ‹Ÿæœºæ ˆ" class="headerlink" title="3. è™šæ‹Ÿæœºæ ˆ"></a>3. è™šæ‹Ÿæœºæ ˆ</h4><p><img src="/images/java_stack.png" srcset="/img/loading.gif" alt="java_stack"></p><p>æ¯ä¸€ä¸ªæ ˆå¸§çš„å‡ºå…¥æ ˆéƒ½æ˜¯ä¸€ä¸ªæ–¹æ³•è¢«è°ƒèµ·ç›´åˆ°ç»“æŸè¿”å›çš„è¿‡ç¨‹.</p><p>æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰ä¸€ä¸ªè‡ªå·±çš„Javaæ ˆï¼Œæ ˆå¸§ä¸­åŒ…æ‹¬</p><ul><li><p>å±€éƒ¨å˜é‡è¡¨(Local Variables)</p><p>æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡,å‡½æ•°çš„å‚æ•°ç­‰.å¯¹äºåŸºç¡€ç±»å‹çš„å˜é‡ç›´æ¥å­˜å‚¨ä»–çš„å€¼,è€Œå¼•ç”¨ç±»å‹çš„å˜é‡</p><p>åˆ™å­˜å‚¨çš„æ˜¯æŒ‡å‘å¯¹è±¡çš„å¼•ç”¨</p></li><li><p>æ“ä½œæ•°æ ˆ(Operand Stack)</p></li><li><p>æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„å¼•ç”¨(Reference to runtime constant pool)</p><p>ä¿è¯æ–¹æ³•å¯ä»¥ä½¿ç”¨å½“å‰ç±»çš„å¸¸é‡</p></li><li><p>æ–¹æ³•è¿”å›åœ°å€(Return Address)</p><p>æ‰§è¡Œä¸€ä¸ªæ–¹æ³•å®Œæˆåéœ€è¦è¿”å›è°ƒç”¨å®ƒçš„åœ°æ–¹</p></li><li><p>é™„åŠ ä¿¡æ¯</p></li></ul><h4 id="4-ç¨‹åºè®¡æ•°å™¨"><a href="#4-ç¨‹åºè®¡æ•°å™¨" class="headerlink" title="4. ç¨‹åºè®¡æ•°å™¨"></a>4. ç¨‹åºè®¡æ•°å™¨</h4><p>Program Counter Register ä¹Ÿç§°ä½œä¸ºPCå¯„å­˜å™¨,ä¿å­˜çš„æ˜¯ç¨‹åºå½“å‰æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€</p><h4 id="5-æœ¬åœ°æ–¹æ³•æ ˆ"><a href="#5-æœ¬åœ°æ–¹æ³•æ ˆ" class="headerlink" title="5.æœ¬åœ°æ–¹æ³•æ ˆ"></a>5.æœ¬åœ°æ–¹æ³•æ ˆ</h4><p>æœ¬åœ°æ–¹æ³•æ ˆåˆ™æ˜¯ä¸ºæ‰§è¡Œæœ¬åœ°æ–¹æ³•ï¼ˆNative Methodï¼‰æœåŠ¡çš„</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidçš„å¯åŠ¨æµç¨‹</title>
    <link href="undefined2018/05/09/Android-App-Launch/"/>
    <url>2018/05/09/Android-App-Launch/</url>
    
    <content type="html"><![CDATA[<h5 id="ç³»ç»Ÿç»“æ„"><a href="#ç³»ç»Ÿç»“æ„" class="headerlink" title="ç³»ç»Ÿç»“æ„"></a>ç³»ç»Ÿç»“æ„</h5><ul><li><p>åº”ç”¨å±‚</p><p>å³ä¸ºå¼€å‘å‡ºæ¥çš„ä¸€äº›app,å½“ç„¶è¿˜åŒ…æ‹¬äº†ä¸€äº›ç³»ç»ŸApp</p></li><li><p>åº”ç”¨æ¡†æ¶å±‚(Java API Framework)</p><p>è¿™ä¸€å±‚ç”±javaç¼–å†™,æä¾›ç»™æˆ‘ä»¬å¹³æ—¶å¼€å‘ä½¿ç”¨çš„API,ä¸»è¦çš„ä¸€äº›ç»„ä»¶:</p><ul><li><p>Manager</p><p>Activity Manager , Window Manager , Package Manager ,Location Manager </p><p>Notification Manager,Resource Manager,Telephony Manager</p></li><li><p>Content Providers</p></li><li><p>View System</p></li></ul></li><li><p>ç³»ç»Ÿè¿è¡Œåº“å±‚</p><p>C/C++ç¨‹åºåº“å’ŒAndroidè¿è¡Œæ—¶åº“</p></li><li><p>ç¡¬ä»¶æŠ½è±¡å±‚(<strong>HAL</strong>)</p></li><li><p>Linuxå†…æ ¸å±‚</p></li></ul><p><img src="/images/android_boot_process.png" srcset="/img/loading.gif" alt="boot"></p><a id="more"></a><h5 id="Androidçš„å¯åŠ¨ä¸»è¦è¿‡ç¨‹"><a href="#Androidçš„å¯åŠ¨ä¸»è¦è¿‡ç¨‹" class="headerlink" title="Androidçš„å¯åŠ¨ä¸»è¦è¿‡ç¨‹"></a>Androidçš„å¯åŠ¨ä¸»è¦è¿‡ç¨‹</h5><ol><li><p><strong>initè¿›ç¨‹</strong></p><p>initè¿›ç¨‹æ˜¯ç”±å†…æ ¸å¯åŠ¨çš„,æ˜¯ç”¨æˆ·ç©ºé—´çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹,å¯ä»¥è¯´æ˜¯ä¸€ä¸ªrootè¿›ç¨‹</p><ul><li>å½“initè¿›ç¨‹å¯åŠ¨åä¼šåˆ›å»ºæŒ‚è½½ç³»ç»Ÿç›®å½•,è®¾å¤‡èŠ‚ç‚¹,</li><li>è§£æinit.rc å’Œ init.hardware.rc,å¯åŠ¨å±æ€§æœåŠ¡ï¼Œä»¥åŠä¸€ç³»åˆ—çš„æœåŠ¡å’Œè¿›ç¨‹</li></ul></li></ol><ol><li><p><strong>æœ¬åœ°å®ˆæŠ¤è¿›ç¨‹</strong></p><p>å¯åŠ¨</p><blockquote><p>servicemanager  ç®¡ç†binderçš„é€šè®¯</p><p>surfaceflinger  UI</p><p>mediaserver  éŸ³è§†é¢‘,ç›¸æœº</p><p>netd  è“ç‰™ã€wifiã€usbç­‰</p><p>adbd</p><p>rild</p><p>installd </p></blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯è¿™äº›éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„Linuxè¿›ç¨‹</p></li><li><p><strong>Nativeç³»ç»ŸæœåŠ¡</strong></p><p>è¿è¡Œåœ¨æœ¬åœ°å®ˆæŠ¤è¿›ç¨‹ä¸­,æ‰€å±è¿›ç¨‹åˆå§‹åŒ–çš„æ—¶å€™ä¼šå°†Nativeç³»ç»ŸæœåŠ¡æ³¨å†Œåˆ°ServiceManagerä¸­,æ–¹ä¾¿æˆ‘ä»¬é€šè¿‡Binderæœºåˆ¶è°ƒç”¨Nativeç³»ç»ŸæœåŠ¡</p></li><li><p><strong>JavaæœåŠ¡</strong></p><p>å†åˆ›å»ºæœ¬åœ°æœåŠ¡çš„åŒæ—¶,initè¿›ç¨‹è¿˜ä¼šåˆ›å»ºZygoteè¿›ç¨‹</p><p>Zygoteä¹Ÿæ˜¯Androidä¸­ç›¸å½“é‡è¦çš„ä¸€ä¸ªè¿›ç¨‹äº†,Zygoteè¿›ç¨‹ä¼šå»ºç«‹ä¸€ä¸ªDalvik VMå¹¶ä¸”å¯åŠ¨</p><p>System Serverç³»ç»ŸæœåŠ¡</p><p>System Serverå°†å¯åŠ¨Android Service</p><blockquote><p>AccessibilityManagerService æˆªè·ç”¨æˆ·è¾“å…¥ï¼Œå¹¶æ ¹æ®è¾“å…¥ç»™ç”¨æˆ·ä¸€äº›é¢å¤–çš„åé¦ˆï¼Œèµ·åˆ°è¾…åŠ©æ•ˆæœçš„æœåŠ¡<br>AccountManagerService ç®¡ç†è®¾å¤‡ä¸­æ‰€æœ‰è´¦å·çš„æœåŠ¡ï¼ŒåŒ…æ‹¬è´¦å·ã€å¯†ç ã€æˆæƒç®¡ç†åŠŸèƒ½<br>ActivityManagerService ç®¡ç†æ‰€æœ‰ç»„ä»¶çš„æœåŠ¡ï¼Œå®‰å“ç³»ç»Ÿçš„æ ¸å¿ƒæœåŠ¡ AlarmManagerService ç®¡ç†é—¹é’Ÿçš„æœåŠ¡<br>AppWidgetService ç®¡ç†APP widgetsçš„å·¥ä½œï¼ŒåŒ…æ‹¬åŠ è½½ã€åˆ é™¤ã€å¸ƒå±€ç­‰<br>AssetAtlasService å°†ä¸€äº›ç³»ç»Ÿå›¾ç‰‡èµ„æºåˆå¹¶æˆä¸€ä¸ªçº¹ç†å›¾ä¼ ç»™GPUè¾¾åˆ°ç¡¬ä»¶åŠ é€Ÿçš„æ•ˆæœçš„æœåŠ¡<br>AudioService ç®¡ç†éŸ³é¢‘çš„æœåŠ¡<br>BackupManagerService ç®¡ç†å¤‡ä»½å’Œåº”ç”¨æ•°æ®çš„æœåŠ¡<br>BatteryService ç®¡ç†ç”µæ± çš„æœåŠ¡<br>BluetoothManagerService ç®¡ç†ç³»ç»Ÿè“ç‰™çš„æœåŠ¡<br>CertBlacklister æ›´æ–°ç³»ç»ŸSSLè¯ä¹¦çš„å…¬å…±ç§˜é’¥å’Œåºåˆ—å·é»‘åå•çš„æœåŠ¡<br>ClipboardService ç®¡ç†ç³»ç»Ÿå‰ªè´´æ¿çš„æœåŠ¡<br>CommonTimeManagementService ç®¡ç†å…¬å…±æ—¶é—´é…ç½®çš„æœåŠ¡<br>ConnectivityService ç®¡ç†ç½‘ç»œè¿æ¥çš„æœåŠ¡<br>ContentService ç®¡ç†ç³»ç»Ÿæ•°æ®æ›´æ–°é€šçŸ¥çš„æœåŠ¡ï¼Œå’ŒContentProviderå¯†åˆ‡ç›¸å…³<br>CountryDetectorService æ£€æµ‹å½“å‰ç³»ç»Ÿæ‰€å±å›½å®¶çš„æœåŠ¡<br>DevicePolicyManagerService ç®¡ç†ç³»ç»Ÿè®¾å¤‡é…ç½®çš„æœåŠ¡<br>DeviceStorageMonitorService ç®¡ç†ç³»ç»Ÿå­˜å‚¨ç©ºé—´çš„æœåŠ¡ï¼Œå½“å­˜å‚¨ç©ºé—´å°äºæŸä¸ªé˜ˆå€¼æ—¶ï¼Œä¼šå‘å‡ºè­¦å‘Šå¹¿æ’­<br>DiskStateService ç®¡ç†ç³»ç»Ÿå­˜å‚¨ç©ºé—´ç»Ÿè®¡çš„æœåŠ¡<br>DisplayManagerService ç®¡ç†æ˜¾ç¤ºè®¾å¤‡çš„æœåŠ¡<br>DreamManagerService ç®¡ç†å±å¹•ä¿æŠ¤çš„æœåŠ¡<br>DropBoxManagerService ç”Ÿæˆå’Œç®¡ç†ç³»ç»Ÿè¿è¡Œä¸­æ—¥å¿—æ–‡ä»¶çš„æœåŠ¡<br>EntropyMixer åŠ è½½å’Œä¿å­˜éšæœºä¿¡æ¯çš„æœåŠ¡<br>IdleMaintenanceService ç®¡ç†ç³»ç»Ÿåœ¨ç©ºé—²æ—¶æ‰§è¡Œç»´æŠ¤ä»»åŠ¡çš„æœåŠ¡<br>InputManagerService ç®¡ç†è§¦å±è¾“å…¥çš„æœåŠ¡<br>InputMethodManagerService ç®¡ç†ç³»ç»Ÿè¾“å…¥æ³•çš„æœåŠ¡<br>LightsService ç®¡ç†å…‰ä¼ æ„Ÿå™¨çš„æœåŠ¡<br>LocationManagerService ç®¡ç†å®šä½å’Œä½ç½®çš„æœåŠ¡<br>LockSettingsService ç®¡ç†ç³»ç»Ÿé”å±è®¾ç½®çš„æœåŠ¡<br>MountService ç®¡ç†ç³»ç»Ÿå­˜å‚¨è®¾å¤‡æŒ‚è½½å’Œå¸è½½çš„æœåŠ¡<br>NetWorkManagementService ç®¡ç†ç³»ç»Ÿç½‘ç»œçš„æœåŠ¡<br>NetWorkPolicyManagerService ç®¡ç†ç½‘ç»œè¿æ¥ç­–ç•¥çš„æœåŠ¡<br>NetWorkStatsService ç®¡ç†ç½‘ç»œè¿æ¥çŠ¶æ€çš„æœåŠ¡<br>NetWorkTimeUpdateService æ ¹æ®ç½‘ç»œæ—¶é—´æ›´æ–°æœ¬åœ°æ—¶é—´çš„æœåŠ¡<br>NotificationManagerService ç®¡ç†ç³»ç»Ÿé€šçŸ¥çš„æœåŠ¡<br>PackageManagerService ç®¡ç†åº”ç”¨åŒ…çš„æœåŠ¡<br>PowerManagerService ç®¡ç†ç³»ç»Ÿç”µæºçš„æœåŠ¡<br>PrintManagerService ç®¡ç†æ‰“å°çš„æœåŠ¡<br>RecognitionManagerService ç®¡ç†èº«ä»½è¯†åˆ«çš„æœåŠ¡<br>SamplingProfilerService è®°å½•å’Œåˆ†æç³»ç»Ÿå¯åŠ¨æ€§èƒ½çš„æœåŠ¡<br>SchedulingPolicyService ç®¡ç†ç³»ç»Ÿè°ƒåº¦ç­–ç•¥çš„æœåŠ¡<br>SearchManagerServcie ç®¡ç†ç³»ç»Ÿæœç´¢åŠŸèƒ½çš„æœåŠ¡<br>SerialServie ç®¡ç†ç³»ç»Ÿä¸²å£è®¾å¤‡çš„æœåŠ¡<br>StatusBarManagerService ç®¡ç†ç³»ç»ŸçŠ¶æ€æ çš„æœåŠ¡<br>TelephonyRegistry ç›‘å¬å’Œç®¡ç†é€šè¯äº‹ä»¶å’ŒçŠ¶æ€çš„æœåŠ¡<br>TextServicesManagerService æ–‡æœ¬æ‹¼å†™æ£€æŸ¥çš„æœåŠ¡<br>UiModeManagerService è®¾ç½®å’Œç®¡ç†ç³»ç»ŸUIæ¨¡å¼çš„æœåŠ¡<br>UsbService ç®¡ç†USBè¿æ¥çš„æœåŠ¡<br>UserManagerService ç®¡ç†ç³»ç»Ÿç”¨æˆ·èº«ä»½ä¿¡æ¯çš„æœåŠ¡<br>VibratorService ç®¡ç†ç³»ç»ŸæŒ¯åŠ¨å™¨çš„æœåŠ¡<br>ï¼·allpaperManagerService ç®¡ç†ç³»ç»Ÿæ¡Œé¢èƒŒæ™¯å¢™çº¸çš„æœåŠ¡<br>WifiP2pService ç®¡ç†Wifiç‚¹å¯¹ç‚¹è¿æ¥çš„æœåŠ¡<br>WifiService ç®¡ç†ç³»ç»ŸWifiè®¾å¤‡çš„æœåŠ¡<br>WindowManagerService ç®¡ç†çª—å£çš„æœåŠ¡ï¼Œå®‰å“ç³»ç»Ÿçš„æ ¸å¿ƒæœåŠ¡</p></blockquote><p>è¿™äº›æœåŠ¡éƒ½ä¼šæ³¨å†Œåˆ°Service Managerä¸­å»,å®ŒæˆServcieManagerå¯¹æœåŠ¡çš„ç®¡ç†</p><p>éœ€è¦æ³¨æ„çš„æ˜¯,ç”±System Serveråˆ›å»ºçš„è¿™äº›æœåŠ¡,éƒ½æ˜¯å­˜åœ¨äºSystem Serverè¿›ç¨‹ä¸­çš„çº¿ç¨‹</p><p>ä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹</p><blockquote><p>servicemanageræ˜¯initçš„å­è¿›ç¨‹</p><p>Zygoteæ˜¯initçš„å­è¿›ç¨‹ï¼Œforkå‡ºæ¥æ‰€æœ‰çš„è™šæ‹Ÿæœº</p><p>system serveræ˜¯Zygoteçš„å­è¿›ç¨‹</p></blockquote></li></ol><ol><li><p><strong>Homeå¯åŠ¨</strong></p><p>å½“æ‰€æœ‰çš„ä»»åŠ¡å¯åŠ¨å,ä¼šé€šè¿‡ActivityManagerå¯åŠ¨Homeç•Œé¢</p><p>åŒæ—¶å‘é€ACTION_BOOT_COMPLETEDå¹¿æ’­</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>Source Code</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Source Code</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVMè™šæ‹Ÿæœºä¸­çš„ç±»åŠ è½½å™¨</title>
    <link href="undefined2018/03/11/JVM-class-loader/"/>
    <url>2018/03/11/JVM-class-loader/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å‰ä¸€ç¯‡æ¢³ç†äº†ä¸€ä¸‹ç±»åŠ è½½æœºåˆ¶çš„å¤§æ¦‚æµç¨‹,å…¶ä¸­å°±æ¶‰åŠåˆ°ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸œè¥¿<strong>ç±»åŠ è½½å™¨</strong>,åœ¨åŠ è½½é˜¶æ®µâ€é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåè·å–æè¿°æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµâ€</p><blockquote><p>æˆ‘ä»¬çŸ¥é“äºŒçº§åˆ¶å­—èŠ‚æµä¸åªæ˜¯æˆ‘ä»¬ç¼–å†™çš„ä»£ç </p><ol><li>å¯ä»¥ä»ä¸€äº›jar,waråŒ…ç­‰å‹ç¼©æ–‡ä»¶ä¸­è·å–</li><li>å·²ç»å‡‰äº†çš„Applet,ä¹Ÿå°±æ˜¯å¯ä»¥ä»ç½‘ç»œä¸­è·å–</li><li>è¿è¡Œæ—¶ç”Ÿæˆ,å¦‚åŠ¨æ€ä»£ç†,retrofitä¸­ä½¿ç”¨çš„æŠ€æœ¯ä¹‹ä¸€</li><li>å…¶ä»–â€¦</li></ol></blockquote><p>é‚£ä¹ˆä¸‹é¢æˆ‘è¦çŸ¥é“çš„æ˜¯:</p><ol><li>ç±»åŠ è½½å™¨çš„å«ä¹‰å’Œä½œç”¨</li><li>ç±»åŠ è½½å™¨çš„ç±»å‹</li><li>ç±»åŠ è½½å™¨çš„åº”ç”¨</li></ol><a id="more"></a><h3 id="ç±»åŠ è½½å™¨"><a href="#ç±»åŠ è½½å™¨" class="headerlink" title="ç±»åŠ è½½å™¨"></a>ç±»åŠ è½½å™¨</h3><p>ç±»åŠ è½½å™¨æœ€åˆæ˜¯ä¸ºäº†Java Appletçš„éœ€æ±‚è€Œç ”å‘çš„,ä¸ºäº†æ–¹ä¾¿åº”ç”¨ç¨‹åºè‡ªå·±å†³å®šå¦‚ä½•å»è·å–æ‰€éœ€è¦çš„ç±»,è€ŒæŠŠè¿™ä¸ªæ“ä½œæ”¾åˆ°äº†JAVAè™šæ‹Ÿæœºå¤–éƒ¨å»å®ç°.</p><p>å®ç°è¿™ä¸ªåŠ¨ä½œçš„ä»£ç æ¨¡å—è¢«ç§°ä¸º<code>ç±»åŠ è½½å™¨</code></p><p>æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯,åœ¨JVMä¸­,ä»»æ„ä¸€ä¸ªç±»éƒ½éœ€è¦ç”±ç±»åŠ è½½å™¨å’Œå®ƒæœ¬çœå…±åŒç¡®ç«‹å…¶åœ¨JVMä¸­çš„å”¯ä¸€æ€§</p><p>æ¯ä¸€ä¸ªç±»åŠ è½½å™¨éƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç±»å‘½åç©ºé—´.</p><p>å˜ç°ä¸º:</p><blockquote><p> å¦‚æœåŒä¸€ä¸ªç±»,è¢«ä¸åŒçš„ä¸¤ä¸ªç±»åŠ è½½å™¨åŠ è½½,é‚£ä¹ˆå®ƒä»¬å°±å¿…ç„¶ä¸ç›¸ç­‰.</p></blockquote><h3 id="ç±»åŠ è½½å™¨çš„ç±»å‹"><a href="#ç±»åŠ è½½å™¨çš„ç±»å‹" class="headerlink" title="ç±»åŠ è½½å™¨çš„ç±»å‹"></a>ç±»åŠ è½½å™¨çš„ç±»å‹</h3><ul><li>å¯åŠ¨ç±»åŠ è½½å™¨ Bootstrap ClassLoader ,æ˜¯ç”±C++å®ç°çš„,ä½œä¸ºè™šæ‹Ÿæœºçš„ä¸€éƒ¨åˆ†</li><li>å…¶ä»–ç±»åŠ è½½å™¨,è¿™äº›åŠ è½½å™¨éƒ½æ˜¯ç”±JAVAè¯­è¨€å®ç°çš„,ç‹¬ç«‹äºJVMä¹‹å¤–å¹¶ä¸”éƒ½æ˜¯java.lang.ClassLoaderçš„å­ç±»</li></ul><p>ä¸Šé¢çš„åˆ†ç±»æ˜¯å¯¹äºJVMè€Œè¨€çš„åˆ†ç±»,åœ¨æˆ‘ä»¬ç¼–ç çš„è¿‡ç¨‹ä¸­,å¯¹ç±»åŠ è½½å™¨åˆ†ä¸º;</p><ol><li><p>å¯åŠ¨ç±»åŠ è½½å™¨ Bootstrap ClassLoader,</p><p>è´Ÿè´£å°†<java_home>/lib ç›®å½•ä¸­çš„æ–‡ä»¶åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­</java_home></p></li><li><p>æ‰©å±•ç±»åŠ è½½å™¨ Extension ClassLoader</p><p>è´Ÿè´£åŠ è½½<java_home>/lib/ext ç›®å½•ä¸­çš„æ–‡ä»¶,æˆ–è€…è¢« java.ext.dirsç³»ç»Ÿå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­æ–‡ä»¶</java_home></p><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨æ‰©å±•ç±»åŠ è½½å™¨</p></li><li><p>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ Application ClassLoader </p><p>ClassLoader.getSystemClassLoader()æ–¹æ³•å¯ä»¥è¿”å›,ä¸€èˆ¬ç§°ä¸ºç³»ç»Ÿç±»åŠ è½½å™¨</p><p>è´Ÿè´£åŠ è½½ç”¨æˆ·è·¯å¾„ä¸­çš„ç±»åº“,å¦‚æœç¨‹åºä¸­æ²¡æœ‰ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨,åˆ™é»˜è®¤æ˜¯ä½¿ç”¨è¯¥ç±»åŠ è½½å™¨çš„</p></li></ol><h4 id="åŒäº²å§”æ´¾æ¨¡å‹"><a href="#åŒäº²å§”æ´¾æ¨¡å‹" class="headerlink" title="åŒäº²å§”æ´¾æ¨¡å‹"></a>åŒäº²å§”æ´¾æ¨¡å‹</h4><p>#####æ¨¡å‹ç»“æ„</p><p><img src="/images/class_loader.png" srcset="/img/loading.gif" alt="classLoader"></p><p>//æˆ‘ä»¬çœ‹çœ‹ä»£ç ä¸­æ˜¯æ€ä¹ˆç»„ç»‡çš„</p><pre><code class="java">protected Class&lt;?&gt; loadClass(String name, boolean resolve)        throws ClassNotFoundException    {            // First, check if the class has already been loaded            Class&lt;?&gt; c = findLoadedClass(name);            if (c == null) {                try {                    if (parent != null) {                        c = parent.loadClass(name, false);                    } else {                        c = findBootstrapClassOrNull(name);                    }                } catch (ClassNotFoundException e) {                    // ClassNotFoundException thrown if class not found                    // from the non-null parent class loader                }                if (c == null) {                    // If still not found, then invoke findClass in order                    // to find the class.                    c = findClass(name);                }            }            return c;    }</code></pre><p>ä¸Šé¢çš„ä»£ç ,æ€»çš„æ¥è¯´æœ‰</p><ol><li><p><code>findLoadedClass(name)</code></p><p>æŸ¥æ‰¾æ˜¯å¦å·²ç»åŠ è½½è¿‡è¿™ä¸ªclassäº†,å¦‚æœä¸ä¸ºç©ºå°±ç›´æ¥è¿”å›äº†è¿™ä¸ªclass</p></li><li><p>åœ¨çœ‹ä¸‹ä¸€æ­¥</p><pre><code class="java"> try {      if (parent != null) {          c = parent.loadClass(name, false);      } else {          c = findBootstrapClassOrNull(name);      } }</code></pre><p>å¦‚æœçˆ¶åŠ è½½å™¨ <code>parent</code>ä¸ä¸ºç©º,åˆ™åŠ è½½å·¥ä½œäº¤ç»™çˆ¶åŠ è½½å™¨å»æ‰§è¡Œ,</p><p>è€Œè¿™ä¸ªçˆ¶åŠ è½½å™¨ä¹Ÿä¼šæœ‰å®ƒçš„çˆ¶åŠ è½½å™¨</p></li><li><p>æœ€åå¦‚æœè¿™ä¸ªclassè¿˜æ²¡æœ‰åŠ è½½</p><pre><code class="java">if (c == null) {    // If still not found, then invoke findClass in order    // to find the class.    c = findClass(name);}</code></pre><p>æ‰è½®åˆ°è‡ªå·±å»åŠ è½½</p></li></ol><p><img src="/images/class_process.png" srcset="/img/loading.gif" alt="åŠ è½½è¿‡ç¨‹"></p><blockquote><p> è¦æ³¨æ„çš„æ˜¯,è¿™äº›ç±»åŠ è½½å™¨çš„çˆ¶å­å…³ç³»,ä¸æ˜¯ç”±ç»§æ‰¿æ¥å®ç°çš„,è€Œæ˜¯ä½¿ç”¨ç»„åˆ</p></blockquote><h5 id="æ¨¡å‹åŠ è½½æµç¨‹"><a href="#æ¨¡å‹åŠ è½½æµç¨‹" class="headerlink" title="æ¨¡å‹åŠ è½½æµç¨‹"></a>æ¨¡å‹åŠ è½½æµç¨‹</h5><p>ç±»åŠ è½½å™¨æ”¶åˆ°äº†ä¸€ä¸ªç±»åŠ è½½çš„è¯·æ±‚,ä½†æ˜¯ä¸ä¼šç«‹é©¬å»è‡ªå·±åŠ è½½,è€Œæ˜¯å§”æ´¾ç»™çˆ¶åŠ è½½å™¨å»å°è¯•åŠ è½½,ç„¶åå±‚å±‚å§”æ´¾ç›´åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ä¸­.å¦‚æœæ²¡æœ‰æˆåŠŸåŠ è½½,å­åŠ è½½å™¨æ‰ä¼šè‡ªå·±å»åŠ è½½.</p><p>è¿™æ ·åšæ˜¯æœ‰æ˜æ˜¾çš„å¥½å¤„çš„:</p><ol><li>è¿™äº›ç±»åŠ è½½å™¨éƒ½å…·æœ‰äº†ä¼˜å…ˆçº§å…³ç³»</li><li>ä¿è¯äº†æŸäº›ç±»çš„ä¸€è‡´æ€§,å¦‚Object,é€šè¿‡å§”æ´¾,æœ€ç»ˆéƒ½æ˜¯ç”±æœ€é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨å®ŒæˆåŠ è½½çš„.</li></ol><h3 id="ç±»åŠ è½½å™¨çš„åº”ç”¨"><a href="#ç±»åŠ è½½å™¨çš„åº”ç”¨" class="headerlink" title="ç±»åŠ è½½å™¨çš„åº”ç”¨"></a>ç±»åŠ è½½å™¨çš„åº”ç”¨</h3><p>å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­,åŠ æ·±ä¸€ä¸‹ç†è§£</p><pre><code class="java">//ä¸€ä¸ªç±»,éœ€è¦æ”¾åœ¨é¡¹ç›®ç›®å½•å¤–,é¿å…è¢«ç³»ç»Ÿç±»åŠ è½½å™¨åŠ è½½public class TestClassLoader{    public void createBy(){        System.out.println(&quot;I&#39;m Batman , Come from &quot; +                  getClass().getClassLoader().getClass());    }}</code></pre><p>è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨</p><pre><code class="java">import java.io.FileInputStream;//è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨public class MarvelStudios extends ClassLoader {    //å­˜æ”¾çš„æ˜¯TestClassLoader.classçš„ä½ç½®,è®°å¾—å…ˆç¼–è¯‘æˆclasså†ä½¿ç”¨    private final static String CLASS_FILE_PATH =            &quot;/Users/phyooos/workspace/java_workspace/kotlind/soucre/TestClassLoader.class&quot;;    private byte[] loadByte(String name) throws Exception {        FileInputStream fis = new FileInputStream(CLASS_FILE_PATH);        int len = fis.available();        byte[] data = new byte[len];        fis.read(data);        fis.close();        return data;    }    @Override    protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException {        //è¿™é‡Œè·å–æ–‡ä»¶        try {            byte[] data = loadByte(name);            return defineClass(name, data, 0, data.length);        } catch (Exception e) {            e.printStackTrace();            throw new ClassNotFoundException();        }    }}</code></pre><p>æµ‹è¯•ä¸€ä¸‹</p><pre><code class="java">public class MainClass {    public static void main(String[] args){        MarvelStudios classLoader = new MarvelStudios();        Class clazz = null;        try {            clazz = classLoader.loadClass(&quot;TestClassLoader&quot;);            Object obj = clazz.newInstance();            Method createMethod = clazz.getDeclaredMethod(&quot;createBy&quot;,null);            createMethod.invoke(obj, null);        } catch (Exception e) {            e.printStackTrace();        }    }}</code></pre><p>è¿è¡Œç»“æœä¸º</p><pre><code class="java">I&#39;m Batman , Come from class MarvelStudiosProcess finished with exit code 0</code></pre><p>è¿™é‡Œæ˜¾è€Œæ˜“è§,ä½¿ç”¨äº†è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨,ä»ç¡¬ç›˜ä¸ŠåŠ è½½äº†ä¸€ä¸ªclassæ–‡ä»¶,å¦‚æœä½ æƒ³åŠ è½½ä¸€ä¸ªjavaæ–‡ä»¶,ä¹Ÿåªéœ€è¦è°ƒç”¨</p><pre><code class="java">//defineClassæ–¹æ³•å¯ä»¥æŠŠäºŒè¿›åˆ¶æµå­—èŠ‚ç»„æˆçš„æ–‡ä»¶è½¬æ¢ä¸ºä¸€ä¸ªjava.lang.ClassClass&lt;?&gt; c = this.defineClass(name, bytes, 0, bytes.length);</code></pre><p>è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰ç±»åŠ è½½å™¨ä½¿ç”¨,å¯ä»¥ä»ç¡¬ç›˜ä¸ŠåŠ è½½javaä»£ç .</p><p>å…¶ä»–å¦‚:</p><ul><li>ä»£ç åŠ å¯†</li><li>çƒ­éƒ¨ç½²</li><li>çƒ­ä¿®å¤</li></ul>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVMè™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶</title>
    <link href="undefined2018/03/10/JVM-load-class/"/>
    <url>2018/03/10/JVM-load-class/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å…³äºJVMè™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶,å¤§æ¦‚æœ‰å¦‚ä¸‹çš„å‡ ä¸ªé—®é¢˜</p><ol><li>ç±»åŠ è½½æœºåˆ¶æ˜¯ä»€ä¹ˆ?</li><li>ç±»åŠ è½½çš„æµç¨‹</li></ol><a id="more"></a><h3 id="ç±»åŠ è½½æœºåˆ¶"><a href="#ç±»åŠ è½½æœºåˆ¶" class="headerlink" title="ç±»åŠ è½½æœºåˆ¶"></a>ç±»åŠ è½½æœºåˆ¶</h3><p>æˆ‘ä»¬æ‰€å†™çš„Javaä»£ç ,æœ€ç»ˆéƒ½æ˜¯ç¼–è¯‘æˆclasså­—èŠ‚ç æ–‡ä»¶,è¿™äº›å­—èŠ‚ç æ–‡ä»¶æè¿°äº†å„ç§ä¿¡æ¯</p><p>éœ€è¦åŠ è½½åˆ°è™šæ‹Ÿæœºä¸­æ‰èƒ½ä½¿ç”¨è¿è¡Œ</p><p>è€Œè™šæ‹Ÿæœºå•ŠæŠŠæè¿°ç±»çš„æ•°æ®ä»Classæ–‡ä»¶ä¸­åŠ è½½åˆ°å†…å­˜,å¹¶ä¸”å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒ,è½¬æ¢è§£æå’Œåˆå§‹åŒ–,</p><p>æœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„Javaç±»å‹,è¿™å°±æ˜¯è™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶.</p><h3 id="ç±»åŠ è½½æœºåˆ¶çš„æµç¨‹"><a href="#ç±»åŠ è½½æœºåˆ¶çš„æµç¨‹" class="headerlink" title="ç±»åŠ è½½æœºåˆ¶çš„æµç¨‹"></a>ç±»åŠ è½½æœºåˆ¶çš„æµç¨‹</h3><p>è™šæ‹Ÿæœºä¸­ç±»åŠ è½½çš„å…¨è¿‡ç¨‹: åŠ è½½ , éªŒè¯ ,å‡†å¤‡ , è§£æ , åˆå§‹åŒ–è¿™äº”ä¸ªéƒ¨åˆ†</p><h4 id="åŠ è½½"><a href="#åŠ è½½" class="headerlink" title="åŠ è½½"></a>åŠ è½½</h4><p>åœ¨åŠ è½½é˜¶æ®µ,å®Œæˆçš„æ˜¯:</p><ol><li>é€šè¿‡ç±»çš„å…¨é™å®šå(import  <em>*</em> è¿™äº›)æ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ.</li><li>å°†è¿™ä¸ªäºŒè¿›åˆ¶å­—èŠ‚æµçš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„.</li><li>åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡,ä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£.</li></ol><p>å½“æˆ‘ä»¬çš„è™šæ‹Ÿæœºå°†äºŒè¿›åˆ¶å­—èŠ‚æµæ–‡ä»¶åŠ è½½å,ä¼šå­˜æ”¾åœ¨æ–¹æ³•åŒºä¸­,è€Œåå®ä¾‹åŒ–ä¸€ä¸ªClassç±»çš„å¯¹è±¡,(å¯¹äºHotSpotè™šæ‹Ÿæœºè€Œè¨€)ä¼šæ”¾åœ¨æ–¹æ³•åŒºä¸­,è€Œä¸æ˜¯ä¸€èˆ¬å­˜æ”¾å¯¹è±¡,å¼•ç”¨ç±»å‹çš„å †(heap)ä¸­,è¿™ä¸ªClasså¯¹è±¡å°±å¯ä»¥ä½œä¸ºç¨‹åºè®¿é—®æ–¹æ³•åŒºä¸­è¿™äº›ç±»å‹æ•°æ®çš„å¤–éƒ¨æ¥å£.</p><p>PS:åŠ è½½çš„è¿‡ç¨‹ä¸­,ä¹Ÿå¯èƒ½ä¼šä¼´éšç€ è¿æ¥è¿‡ç¨‹(æ£€æŸ¥,å‡†å¤‡,è§£æ),ä½†æ˜¯å¿…ç„¶æ˜¯å…ˆå‘ç”ŸåŠ è½½,è€Œåæ‰å¯èƒ½å‡ºç°è¿æ¥</p><h4 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h4><p>éªŒè¯è¿™ä¸ªé˜¶æ®µéå¸¸çš„é‡è¦</p><p>æˆ‘ä»¬çŸ¥é“åœ¨JAVAä»£ç ä¸­,æ˜¯æ— æ³•è¿›è¡Œä¸€äº›ä¸å®‰å…¨çš„æ“ä½œçš„,ä½†æ˜¯classå­—èŠ‚ç æ–‡ä»¶å´å¯ä»¥åšåˆ°,ç±»ä¼¼æ•°ç»„è¶Šç•Œè®¿é—®,è·³è½¬åˆ°ä¸å­˜åœ¨çš„ä»£ç è¡Œâ€¦.</p><p>é‚£ä¹ˆ,éªŒè¯å°±éå¸¸é‡è¦äº†,ç›´æ¥å†³å®šäº†Javaè™šæ‹Ÿæœºçš„å®‰å…¨æ€§.</p><p>å¤§æ¦‚åŒ…å«:</p><h5 id="æ–‡ä»¶æ ¼å¼éªŒè¯"><a href="#æ–‡ä»¶æ ¼å¼éªŒè¯" class="headerlink" title="æ–‡ä»¶æ ¼å¼éªŒè¯"></a>æ–‡ä»¶æ ¼å¼éªŒè¯</h5><p>åªæœ‰é€šè¿‡äº†æ–‡ä»¶æ ¼å¼éªŒè¯,å­—èŠ‚ç äºŒè¿›åˆ¶æµæ‰ä¼šè¿›å…¥åˆ°æ–¹æ³•åŒºä¸­.</p><p>æ¯”å¦‚: é­”æ•°CAFEBABE ,ä¸»æ¬¡ç‰ˆæœ¬å·,å¸¸é‡æ± ä¸­å¸¸é‡ç±»å‹,ç¼–ç ç­‰ç­‰â€¦</p><p>#####å…ƒæ•°æ®éªŒè¯</p><p>ä¸»è¦ç›®çš„æ˜¯å¯¹ç±»çš„å…ƒæ•°æ®è¿›è¡Œè¯­ä¹‰æ£€éªŒ,ç¡®ä¿æè¿°ä¿¡æ¯ç¬¦åˆJAVAçš„è¯­è¨€è§„èŒƒ</p><p>æ¯”å¦‚:æ˜¯å¦æœ‰çˆ¶ç±»,æ˜¯å¦å®ç°äº†æ‰€ç»§æ‰¿ç±»æˆ–å®ç°æ¥å£çš„å¿…è¦æ–¹æ³•,è¿”å›å€¼ç±»å‹â€¦</p><p>#####å­—èŠ‚ç éªŒè¯</p><p>åœ¨å…ƒæ•°æ®éªŒè¯å¯¹å…ƒæ•°æ®ä¸­çš„æ•°æ®ç±»å‹åšå®Œæ£€æµ‹å,è¿™ä¸ªé˜¶æ®µä¼šå¯¹ç±»çš„æ–¹æ³•ä½“è¿›è¡Œæ ¡éªŒåˆ†æ,ä¿è¯è¢«éªŒè¯çš„ç±»æ–¹æ³•ä¸ä¼šåœ¨è¿è¡Œæ—¶å¯¹è™šæ‹Ÿæœºåšå‡ºä¸å®‰å…¨æ“ä½œ.</p><h5 id="ç¬¦å·å¼•ç”¨éªŒè¯"><a href="#ç¬¦å·å¼•ç”¨éªŒè¯" class="headerlink" title="ç¬¦å·å¼•ç”¨éªŒè¯"></a>ç¬¦å·å¼•ç”¨éªŒè¯</h5><p>å‘ç”Ÿåœ¨è™šæ‹Ÿæœºå°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨çš„æ—¶å€™,è¿™ä¸ªè½¬åŒ–çš„æ“ä½œå°†å‘ç”Ÿåœ¨-è§£æé˜¶æ®µ.</p><blockquote><p><strong>ç¬¦å·å¼•ç”¨</strong>:ç¬¦å·å¼•ç”¨ä»¥ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡ï¼Œç¬¦å·å¯ä»¥æ˜¯ä»»ä½•å½¢å¼çš„å­—é¢é‡ï¼Œåªè¦ä½¿ç”¨æ—¶èƒ½å¤Ÿæ— æ­§ä¹‰çš„å®šä½åˆ°ç›®æ ‡å³å¯ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œjavaç±»å¹¶ä¸çŸ¥é“æ‰€å¼•ç”¨çš„ç±»çš„å®é™…åœ°å€ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨ç¬¦å·å¼•ç”¨æ¥ä»£æ›¿ã€‚</p><p><strong>ç›´æ¥å¼•ç”¨</strong>:å¦‚æœæœ‰äº†ç›´æ¥å¼•ç”¨ï¼Œé‚£å¼•ç”¨çš„ç›®æ ‡å¿…å®šå·²ç»è¢«åŠ è½½å…¥å†…å­˜ä¸­äº†.ç›´æ¥å¼•ç”¨æœ‰:1ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆ</p><p>2.ç›¸å¯¹åç§»é‡3.ä¸€ä¸ªèƒ½é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„</p></blockquote><p>####å‡†å¤‡</p><p>å‡†å¤‡é˜¶æ®µæ˜¯æ­£å¼ä¸ºå˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼çš„é˜¶æ®µ,è¿™äº›å˜é‡çš„å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºè¿›è¡Œåˆ†é….</p><blockquote><p>ç±»å˜é‡:è¢«staticä¿®é¥°çš„å˜é‡,è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„å°±æ˜¯finalä¿®é¥°çš„,è¿™æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µ,ä¼šåœ¨å‡†å¤‡é˜¶æ®µå°±åˆå§‹åŒ–ä¸ºæŒ‡å®šçš„å€¼.(åœ¨å­—æ®µå±æ€§è¡¨ä¸­è¡¨ç°ä¸ºConstantValueå±æ€§)</p><p>è€Œä¸æ˜¯åƒé€šå¸¸æƒ…å†µä¸‹,ä¼šç»™é™æ€å˜é‡èµ‹é›¶å€¼.</p></blockquote><h4 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h4><p>åœ¨ç¬¦å·å¼•ç”¨éªŒè¯ä¸­æåˆ°è¿‡,è¿™ä¸ªé˜¶æ®µæ˜¯è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹.</p><p>è§£æçš„æ“ä½œä¸€èˆ¬é’ˆå¯¹ç±»,æ¥å£,å­—æ®µ,ç±»æ–¹æ³•,æ¥å£æ–¹æ³•,æ–¹æ³•ç±»å‹,æ–¹æ³•å¥æŸ„å’Œè°ƒç”¨ç‚¹é™å®šç¬¦7ç±»ç¬¦å·å¼•ç”¨</p><p>å¤§æ¦‚åˆ†ä¸º: <strong>ç±»æˆ–è€…æ¥å£çš„è§£æ</strong>,<strong>å­—æ®µè§£æ</strong>,<strong>ç±»æ–¹æ³•è§£æ</strong>,<strong>æ¥å£æ–¹æ³•è§£æ</strong></p><h4 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h4><p>åˆå§‹åŒ–æ˜¯ç±»åŠ è½½çš„æœ€åä¸€ä¸ªé˜¶æ®µ,ä¹‹å‰çš„é˜¶æ®µ,é™¤äº†åœ¨åŠ è½½é˜¶æ®µå¯ä»¥é€šè¿‡è‡ªå®šä¹‰ç±»åŠ è½½å™¨å‚ä¸ä¹‹å¤–,å…¶ä»–çš„éƒ½æ˜¯ç”±è™šæ‹Ÿæœºä¸»å¯¼å’Œæ§åˆ¶.è€Œåˆ°äº†åˆå§‹åŒ–é˜¶æ®µ,æ‰çœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„JAVAä»£ç ,è¿™ä¸ªé˜¶æ®µæ ¹æ®ä»£ç ä¸­å®šä¹‰å¥½çš„è®¡åˆ’å»åˆå§‹åŒ–ç±»å˜é‡å’Œå…¶ä»–èµ„æº.</p><p>åˆå§‹åŒ–é˜¶æ®µæ˜¯æ‰§è¡Œç±»æ„é€ å™¨<code>&lt;client&gt;()</code>æ–¹æ³•çš„è¿‡ç¨‹.</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidé€šè®¯æœºåˆ¶åˆ†æ-Handler</title>
    <link href="undefined2018/03/07/Handler-analyze/"/>
    <url>2018/03/07/Handler-analyze/</url>
    
    <content type="html"><![CDATA[<p>Handleråœ¨Androidä¸–ç•Œä¸­çš„åœ°ä½ä¸è¨€è€Œå–».è¿™ç¯‡ç¬”è®°ç®—æ˜¯ç®€å•çš„è®°å½•ä¸€ä¸‹æˆ‘å¯¹äºHandlerçš„ç†è§£.</p><p>å½“æ—¶ç¬¬ä¸€æ¬¡å¯¹Handleräº§ç”Ÿå…´è¶£æ˜¯æˆ‘åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°ä¸€ä¸ªé—®é¢˜:</p><p><strong>Androidä¸­ä¸ºä»€ä¹ˆä¸»çº¿ç¨‹ä¸ä¼šå› ä¸ºLooper.loop()é‡Œçš„æ­»å¾ªç¯å¡æ­»</strong></p><a id="more"></a><h4 id="Handleræ¶ˆæ¯æœºåˆ¶çš„æ„æˆ"><a href="#Handleræ¶ˆæ¯æœºåˆ¶çš„æ„æˆ" class="headerlink" title="Handleræ¶ˆæ¯æœºåˆ¶çš„æ„æˆ"></a>Handleræ¶ˆæ¯æœºåˆ¶çš„æ„æˆ</h4><ul><li><p>Handler</p><p>ä¸»è¦å°±æ˜¯å‘é€å„ç§æ¶ˆæ¯<code>sendMessage</code>ç­‰,ä»¥åŠå¤„ç†æ¶ˆæ¯<code>handleMessage</code></p></li><li><p>Message</p><p>å³æ˜¯ä¼ é€’æ¶ˆæ¯çš„è½½ä½“,æœ‰æ—¶å€™ä¹Ÿä¼šæ‰¿è½½ç¡¬ä»¶å‘å‡ºçš„æ¶ˆæ¯.</p></li><li><p>Looper</p><p>è¿™æ˜¯ä¸€ä¸ªå¾ªç¯<code>Looper.loop</code>,å¹¶è´Ÿè´£å°†æ¶ˆæ¯å‘é€ç»™ç›®æ ‡.</p></li><li><p>MessageQueue</p><p>æ¶ˆæ¯é˜Ÿè´Ÿè´£å°†æ¶ˆæ¯å‘é€éƒ½æ¶ˆæ¯æ± ä»¥åŠåœ¨æ¶ˆæ¯æ± ä¸­æ‹¿èµ°æ¶ˆæ¯</p></li></ul><p><img src="/images/handler_class.png" srcset="/img/loading.gif" alt="handler"></p><h4 id="Messageç±»åˆ†æ"><a href="#Messageç±»åˆ†æ" class="headerlink" title="Messageç±»åˆ†æ"></a>Messageç±»åˆ†æ</h4><p>é¦–å…ˆæˆ‘ä»¬è¦çœ‹åˆ°</p><pre><code>private static Message sPool;// sometimes we store linked lists of these things/*package*/ Message next;</code></pre><p><code>sPool</code>å£°æ˜ä¸ºstatic ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„Messageå®ä¾‹å…±äº«</p><p><code>next</code>åˆ™ä¸ºæ¯ä¸€ä¸ªå®ä¾‹éƒ½æœ‰çš„</p><p>Messageç±»ä¸­,ä¸€ç³»åˆ—çš„obtain,å¦‚ä¸‹:</p><p>obtain(Handler h)</p><p>obtain(Handler h, int what)</p><p>obtain(Handler h, Runnable callback)</p><p>â€¦</p><p>obtain()</p><ul><li><p>å¤ç”¨æœºåˆ¶</p><p>æˆ‘ä»¬æŸ¥çœ‹æºç å¯çŸ¥,ä»–ä»¬æœ€åéƒ½è°ƒç”¨obtain()è·å¾—ä¸€ä¸ªMessageå®ä½“</p></li></ul><pre><code class="java">    android.os.Message#obtain()    /**     * Return a new Message instance from the global pool. Allows us to     * avoid allocating new objects in many cases.     */    public static Message obtain() {        synchronized (sPoolSync) {            if (sPool != null) {                Message m = sPool;                sPool = m.next;                m.next = null;                m.flags = 0; // clear in-use flag                sPoolSize--;                return m;            }        }        return new Message();    }</code></pre><p>å¯ä»¥çœ‹åˆ°,å½“<code>sPool</code>ä¸º<code>null</code>æ—¶æ‰ä¼š<code>new Message();</code></p><p>å¦‚æœä¸ä¸º<code>null</code>åˆ™æŠŠå½“å‰çš„<code>sPool</code>èµ‹å€¼ç»™<code>Message m</code>  è€ŒåæŠŠ<code>sPool</code>èµ‹å€¼ä¸º<code>m.next()</code>(ä¹Ÿå°±æ˜¯sPoolæ²¡æœ‰èµ‹å€¼å‰å®ƒçš„ä¸‹ä¸€ä¸ªMessageå¯¹è±¡)</p><p>æŸ¥çœ‹æºç åˆ†æå¯çŸ¥,æœ‰ä¸€ä¸ªMessageçš„æ¶ˆæ¯æ± ,é‡‡ç”¨çš„æ˜¯å•é“¾è¡¨å¤´æ’æ³•,nextæ°¸è¿œæŒ‡å‘çš„æ˜¯ä¸‹ä¸€ä¸ªå¯å¤ç”¨çš„å®ä¾‹åœ°å€</p><p>æ‰€ä»¥,å¦‚æœæˆ‘ä»¬åœ¨ä»£ç ä¸­è¦ä½¿ç”¨Messageå®ä¾‹,å°±å°½é‡ä½¿ç”¨<code>obtain()</code>è¿™ä¸€ç³»åˆ—æ–¹æ³•,è€Œä¸è¦ç›´æ¥New</p><ul><li><p>åŠ å…¥æ¶ˆæ¯æ± </p><pre><code class="java">    android.os.Message#recycleUnchecked    /**     * Recycles a Message that may be in-use.     * Used internally by the MessageQueue and Looper when disposing of queued Messages.     */    void recycleUnchecked() {        // Mark the message as in use while it remains in the recycled object pool.        // Clear out all other details.        flags = FLAG_IN_USE;        what = 0;        arg1 = 0;        arg2 = 0;        obj = null;        replyTo = null;        sendingUid = -1;        when = 0;        target = null;        callback = null;        data = null;        synchronized (sPoolSync) {            if (sPoolSize &lt; MAX_POOL_SIZE) {                next = sPool;                sPool = this;                sPoolSize++;            }        }    }</code></pre><p>è¿™é‡Œå…¶å®å°±æ˜¯æŠŠæ— ç”¨çš„Messageå®ä¾‹,åŠ å…¥æ¶ˆæ¯æ± çš„åœ°æ–¹.</p><p><code>sPoolSize &lt; MAX_POOL_SIZE</code>åªè¦å½“å‰æ¶ˆæ¯æ± æ²¡æœ‰åˆ°æé™,å°±<code>next = sPool;</code>ä¸”<code>sPool = this;</code></p><p>å¯ä»¥ç®€å•ç†è§£ä¸ºæŠŠä¹‹å‰çš„<code>sPool</code>å¯å¤ç”¨å¯¹è±¡å‘åç§»åŠ¨ä¸€ä½,æŠŠå½“å‰è¿™ä¸ªè¦å›æ”¶çš„Messageç½®ä¸ºç¬¬ä¸€ä¸ªå¯å¤ç”¨å¯¹è±¡</p></li></ul><p><strong>æ‰€ä»¥,Messageä¸»è¦å°±æ˜¯è£…è½½æ•°æ®,å¹¶ä¸”å®ç°äº†Messageçš„å¤ç”¨æœºåˆ¶</strong></p><h4 id="MessageQueueç±»åˆ†æ"><a href="#MessageQueueç±»åˆ†æ" class="headerlink" title="MessageQueueç±»åˆ†æ"></a>MessageQueueç±»åˆ†æ</h4>]]></content>
    
    
    <categories>
      
      <category>Source Code</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Source Code</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RelativeLayoutä¸­Buttonè¦†ç›–å…¶ä»–View</title>
    <link href="undefined2018/03/07/RelativeLayout-Button-over/"/>
    <url>2018/03/07/RelativeLayout-Button-over/</url>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>å¸ƒå±€æ–‡ä»¶ä¸­,RelativeLayoutåŒ…è£¹æ—¶,åœ¨RelativeLayoutä¸­çš„View,åº”è¯¥æ˜¯â€å±‚å±‚å‹ä¸Šâ€çš„.</p><p>è¶Šå¾€åº•ä¸‹å†™çš„Viwe,åœ¨è§†å›¾ä¸Šè¶Šåœ¨ä¸Šå±‚.</p><a id="more"></a><h4 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h4><h5 id="activity-main-xml"><a href="#activity-main-xml" class="headerlink" title="activity_main.xml"></a><em>activity_main.xml</em></h5><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;layout    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;    &lt;data&gt;        &lt;variable            name=&quot;click&quot;            type=&quot;com.wangzhumo.app.single.MainActivity.ClickFunc&quot;/&gt;    &lt;/data&gt;    &lt;RelativeLayout        android:layout_width=&quot;match_parent&quot;        android:layout_height=&quot;match_parent&quot;        tools:context=&quot;com.wangzhumo.app.single.MainActivity&quot;&gt;        &lt;ImageView            android:layout_width=&quot;match_parent&quot;            android:layout_height=&quot;match_parent&quot;            android:layout_marginBottom=&quot;50dp&quot;            tools:background=&quot;@tools:sample/backgrounds/scenic&quot;/&gt;        &lt;Button            android:id=&quot;@+id/button_finsh&quot;            android:layout_width=&quot;wrap_content&quot;            android:layout_height=&quot;wrap_content&quot;            android:layout_alignParentTop=&quot;true&quot;            android:layout_centerHorizontal=&quot;true&quot;            android:onClick=&quot;@{(v) -&gt; click.onFinshAct(v)}&quot;            android:text=&quot;Finsh&quot; /&gt;        &lt;Button            android:id=&quot;@+id/button_dis&quot;            android:layout_width=&quot;wrap_content&quot;            android:layout_height=&quot;wrap_content&quot;            android:layout_alignParentEnd=&quot;true&quot;            android:layout_alignParentTop=&quot;true&quot;            android:onClick=&quot;@{(v) -&gt; click.onStartAct(v)}&quot;            android:text=&quot;Start&quot;            tools:ignore=&quot;MissingConstraints&quot;            tools:layout_editor_absoluteX=&quot;88dp&quot;            tools:layout_editor_absoluteY=&quot;0dp&quot; /&gt;        &lt;Button            android:id=&quot;@+id/button_start&quot;            android:layout_width=&quot;wrap_content&quot;            android:layout_height=&quot;wrap_content&quot;            android:onClick=&quot;@{(v) -&gt; click.onShowDialog(v)}&quot;            android:text=&quot;Dialog&quot;            tools:ignore=&quot;MissingConstraints&quot;            tools:layout_editor_absoluteX=&quot;176dp&quot;            tools:layout_editor_absoluteY=&quot;0dp&quot; /&gt;        &lt;Button            android:id=&quot;@+id/button2&quot;            android:layout_width=&quot;wrap_content&quot;            android:layout_height=&quot;wrap_content&quot;            android:layout_alignParentStart=&quot;true&quot;            android:onClick=&quot;@{(v) -&gt; click.onPxActivity(v)}&quot;            android:layout_below=&quot;@+id/button_start&quot;            android:layout_marginTop=&quot;22dp&quot;            android:text=&quot;Pixe&quot; /&gt;        &lt;Button            android:id=&quot;@+id/button3&quot;            android:layout_width=&quot;wrap_content&quot;            android:layout_height=&quot;wrap_content&quot;            android:onClick=&quot;@{(v) -&gt; click.onTralActivity(v)}&quot;            android:layout_alignStart=&quot;@+id/button_finsh&quot;            android:layout_alignTop=&quot;@+id/button2&quot;            android:text=&quot;Tranl&quot;            tools:text=&quot;@tools:sample/lorem/random&quot;/&gt;        &lt;ImageView            android:layout_marginBottom=&quot;100dp&quot;            android:layout_width=&quot;match_parent&quot;            android:layout_height=&quot;match_parent&quot;            tools:background=&quot;@tools:sample/backgrounds/scenic&quot;/&gt;    &lt;/RelativeLayout&gt;&lt;/layout&gt;</code></pre><h5 id="Viewçš„ç»“æ„å¦‚ä¸‹"><a href="#Viewçš„ç»“æ„å¦‚ä¸‹" class="headerlink" title="Viewçš„ç»“æ„å¦‚ä¸‹:"></a>Viewçš„ç»“æ„å¦‚ä¸‹:</h5><p><img src="/images/button_tree.png" srcset="/img/loading.gif" alt="tree"></p><h5 id="ç„¶è€Œå®é™…æ•ˆæœå¦‚ä¸‹"><a href="#ç„¶è€Œå®é™…æ•ˆæœå¦‚ä¸‹" class="headerlink" title="ç„¶è€Œå®é™…æ•ˆæœå¦‚ä¸‹:"></a>ç„¶è€Œå®é™…æ•ˆæœå¦‚ä¸‹:</h5><p><img src="/images/button_show.png" srcset="/img/loading.gif" alt="views"></p><h5 id="åˆ†æå¦‚ä¸‹"><a href="#åˆ†æå¦‚ä¸‹" class="headerlink" title="åˆ†æå¦‚ä¸‹:"></a>åˆ†æå¦‚ä¸‹:</h5><p>é€ æˆè¿™æ ·æ•ˆæœ,æ˜¯Buttonçš„åŸå› </p><p>åˆ†æ:æ•´ä¸ªé¡µé¢é™¤äº† 2,3,4,5 è¿™5ä¸ªButtonä¹‹å¤–,å…¶ä»–çš„Viewéƒ½ä¾æ—§éµå¾ªRelativeLayoutçš„è§„åˆ™</p><h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p>åœ¨stackoverflowä¸Šæˆ‘æ‰¾åˆ°äº†Buttoné€ æˆè¿™ä¸ªæ•ˆæœçš„åŸå› </p><blockquote><p><a href="https://stackoverflow.com/questions/27080338/android-5-0-androidelevation-works-for-view-but-not-button/27112143#27112143" target="_blank" rel="noopener">https://stackoverflow.com/questions/27080338/android-5-0-androidelevation-works-for-view-but-not-button/27112143#27112143</a></p></blockquote><p>æ˜¯å› ä¸ºAndroid5.0ä¹‹å,Buttoné»˜è®¤æ·»åŠ äº†<a href="https://developer.android.com/reference/android/animation/StateListAnimator.html" target="_blank" rel="noopener">StateListAnimator</a>,å…·ä½“å°±æ˜¯å¯¹</p><p> <code>android:elevation</code> </p><p> <code>android:translationZ</code> </p><p>ä¸¤ä¸ªå±æ€§è¿›è¡Œäº†ä¿®æ”¹,æˆ‘ä»¬å¦‚ä½•å»æ‰è¿™ä¸ªé»˜è®¤çš„æ•ˆæœé‚£?</p><p>##### </p><p><strong>android:stateListAnimatorè®¾ç½®ä¸ºnullå³å¯</strong></p><pre><code>&lt;Button    ...    android:stateListAnimator=&quot;@null&quot; /&gt;</code></pre><p>å¦‚æœä½ éœ€è¦æ·»åŠ stateListAnimatoræ•ˆæœçš„è¯</p><pre><code>&lt;Button    ...    android:stateListAnimator=&quot;@anim/you_animator&quot; /&gt;</code></pre>]]></content>
    
    
    <categories>
      
      <category>Bug</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Bug</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ConfigChangesçš„å±æ€§å€¼</title>
    <link href="undefined2018/03/05/ConfigChanges/"/>
    <url>2018/03/05/ConfigChanges/</url>
    
    <content type="html"><![CDATA[<p><strong>é€šè¿‡è®¾ç½®è¿™ä¸ªå±æ€§å¯ä»¥ä½¿Activityæ•æ‰è®¾å¤‡çŠ¶æ€å˜åŒ–</strong></p><pre><code>&quot;mcc&quot; å›½é™…ç§»åŠ¨ç”¨æˆ·è¯†åˆ«ç æ‰€å±å›½å®¶ä»£å·æ˜¯æ”¹å˜äº†----- simè¢«ä¾¦æµ‹åˆ°äº†ï¼Œå»æ›´æ–°mcc mccæ˜¯ç§»åŠ¨ç”¨æˆ·æ‰€å±å›½å®¶ä»£å·&quot;mnc&quot; å›½é™…ç§»åŠ¨ç”¨æˆ·è¯†åˆ«ç çš„ç§»åŠ¨ç½‘å·ç æ˜¯æ”¹å˜äº†------ simè¢«ä¾¦æµ‹åˆ°äº†ï¼Œå»æ›´æ–°mnc MNCæ˜¯ç§»åŠ¨ç½‘å·ç ï¼Œæœ€å¤šç”±ä¸¤ä½æ•°å­—ç»„æˆï¼Œç”¨äºè¯†åˆ«ç§»åŠ¨ç”¨æˆ·æ‰€å½’å±çš„ç§»åŠ¨é€šä¿¡ç½‘&quot;locale&quot; åœ°å€æ”¹å˜äº†-----ç”¨æˆ·é€‰æ‹©äº†ä¸€ä¸ªæ–°çš„è¯­è¨€ä¼šæ˜¾ç¤ºå‡ºæ¥&quot;touchscreen&quot; è§¦æ‘¸å±æ˜¯æ”¹å˜äº†------é€šå¸¸æ˜¯ä¸ä¼šå‘ç”Ÿçš„&quot;keyboard&quot; é”®ç›˜å‘ç”Ÿäº†æ”¹å˜----ä¾‹å¦‚ç”¨æˆ·ç”¨äº†å¤–éƒ¨çš„é”®ç›˜&quot;keyboardHidden&quot; é”®ç›˜çš„å¯ç”¨æ€§å‘ç”Ÿäº†æ”¹å˜&quot;navigation&quot; å¯¼èˆªå‘ç”Ÿäº†å˜åŒ–-----é€šå¸¸ä¹Ÿä¸ä¼šå‘ç”Ÿ&quot;screenLayout&quot; å±å¹•çš„æ˜¾ç¤ºå‘ç”Ÿäº†å˜åŒ–------ä¸åŒçš„æ˜¾ç¤ºè¢«æ¿€æ´»&quot;fontScale&quot; å­—ä½“æ¯”ä¾‹å‘ç”Ÿäº†å˜åŒ–----é€‰æ‹©äº†ä¸åŒçš„å…¨å±€å­—ä½“&quot;uiMode&quot; ç”¨æˆ·çš„æ¨¡å¼å‘ç”Ÿäº†å˜åŒ–&quot;orientation&quot; å±å¹•æ–¹å‘æ”¹å˜äº†&quot;screenSize&quot; å±å¹•å¤§å°æ”¹å˜äº†&quot;smallestScreenSize&quot; å±å¹•çš„ç‰©ç†å¤§å°æ”¹å˜äº†ï¼Œå¦‚ï¼šè¿æ¥åˆ°ä¸€ä¸ªå¤–éƒ¨çš„å±å¹•ä¸Š</code></pre><blockquote><p><a href="http://www.cnblogs.com/carlo/p/4311010.html" target="_blank" rel="noopener">http://www.cnblogs.com/carlo/p/4311010.html</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Activityä¸Fragmentçš„ç”Ÿå‘½å‘¨æœŸ</title>
    <link href="undefined2018/03/05/Activity-Fragment-life/"/>
    <url>2018/03/05/Activity-Fragment-life/</url>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>åšAndroidå¼€å‘å¥½äº›å¹´äº†,è¿™äº›åŸºç¡€çš„çŸ¥è¯†,å®Œå®Œæ•´æ•´çš„åœ¨åšå®¢ä¸Šå†™ä¸€æ¬¡.</p><h4 id="Activityç”Ÿå‘½å‘¨æœŸ"><a href="#Activityç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Activityç”Ÿå‘½å‘¨æœŸ"></a>Activityç”Ÿå‘½å‘¨æœŸ</h4><p>å¿…ä¸å¯å°‘çš„ä¸€å¼ å›¾,æ¥è‡ªGoogle Android developer çš„æ–‡æ¡£ä¸Š</p><p><img src="/images/activity_lifecycle.png" srcset="/img/loading.gif" alt="activity_liferycle"></p><a id="more"></a><h5 id="å›è°ƒæ–¹æ³•ç®€è¿°"><a href="#å›è°ƒæ–¹æ³•ç®€è¿°" class="headerlink" title="å›è°ƒæ–¹æ³•ç®€è¿°"></a>å›è°ƒæ–¹æ³•ç®€è¿°</h5><ul><li><p>onCreate()  </p><p>å½“Activityåˆ›å»ºæ—¶,ä¼šå›è°ƒè¯¥æ–¹æ³•,å¸¸ç”¨äºåˆå§‹åŒ–View æˆ–å…¶ä»–çš„ä¸€äº›åŠŸèƒ½çš„åˆå§‹åŒ–</p></li><li><p>onStart()</p><p>Activityå·²ç»åˆå§‹åŒ–å®Œæ¯•,æ­¤æ—¶çš„é¡µé¢æ˜¯å¯è§çŠ¶æ€,åˆ™å›è°ƒonStart();æ–¹æ³•</p><p>Activityå¯åŠ¨ï¼šonCreate() -&gt; onStart() -&gt; onResume()</p></li><li><p>onResume()</p><p>å½“Activityå¯è§,å¹¶ä¸”è·å¾—ç„¦ç‚¹,å¯ä»¥ä¸ç”¨æˆ·äº¤äº’æ—¶å›è°ƒ</p><p>åœ¨æˆ‘ä»¬å¤„ç†ä¸€äº›è§†å±æ“ä½œ,æˆ–è€…æ˜¯Fragmentæ‡’åŠ è½½ç­‰éƒ½å¯ä»¥ç”¨åˆ°</p></li><li><p>onPause()</p><p>å½“è°ƒç”¨onPause()æ—¶,è¯´æ˜Activityè¢«é˜»æŒ¡,éƒ¨åˆ†UIå·²ç»ä¸å¯è§äº†,ä½†æ˜¯Activityçš„UIå¹¶æ²¡æœ‰å®Œå…¨æ¶ˆå¤±.</p></li><li><p>onStop()</p><p>å½“Activityå®Œå…¨ä¸å¯è§,ä¸”åˆ°äº†åå°ä¹‹å,å¦‚æœç³»ç»Ÿå†…å­˜ä¸è¶³,ç³»ç»Ÿå¯èƒ½ä¼šæ€æ­»å½“å‰Activity</p><p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¯ä»¥å–æ¶ˆä¸€äº›åŠ¨ç”»æ•ˆæœç­‰</p></li><li><p>onDestory()</p><p>Activityé€€å‡º,é”€æ¯</p><p>å¸¸ç”¨äºé”€æ¯,å›æ”¶èµ„æº</p></li></ul><h5 id="ç»å…¸åœºæ™¯"><a href="#ç»å…¸åœºæ™¯" class="headerlink" title="ç»å…¸åœºæ™¯"></a>ç»å…¸åœºæ™¯</h5><p>1.æ­£å¸¸å¯åŠ¨</p><p>ç³»ç»Ÿè°ƒç”¨onCreateæ–¹æ³• , ç„¶åè°ƒç”¨onStart() , æœ€åè°ƒç”¨ onResume() ,ç”¨æˆ·å¯æ“ä½œ.</p><pre><code>E/MainActivity: ---- onCreate ----E/MainActivity: ---- onStart ----E/MainActivity: ---- onResume ----</code></pre><p>2.æ­£å¸¸é€€å‡º</p><p>Activityå…ˆå¤±å»ç„¦ç‚¹ä¸å¯äº¤äº’</p><pre><code>E/MainActivity: ---- onPause ----E/MainActivity: ---- onStop ----E/MainActivity: ---- onDestroy ----</code></pre><p>2.å¼¹å‡ºDialog</p><p>MainActivityä»€ä¹ˆlogä¹Ÿæ²¡æœ‰æ‰“å°,è¯´æ˜ä¸å¯¹Activityé€ æˆå½±å“</p><p>3.è·³è½¬ä¸€ä¸ªé€æ˜çš„Activityé¡µé¢(1åƒç´ çš„åŒç†)</p><p>MainActivityåªè°ƒç”¨äº†onPause()  å› ä¸ºMainActivityçš„UIè¢«é®æŒ¡äº†</p><pre><code>E/MainActivity: ---- onPause ----</code></pre><p>4.ä»è¢«é®æŒ¡çŠ¶æ€æ¢å¤</p><pre><code>E/MainActivity: ---- onResume ----</code></pre><p>6.é”å±</p><pre><code>E/MainActivity: ---- onPause ----E/MainActivity: ---- onStop ----</code></pre><p>æ­¤æ—¶,MainActivityå·²ç»åœ¨åå°äº†.</p><p>7.ä»é”å±æ¢å¤</p><pre><code>E/MainActivity: ---- onStart ----E/MainActivity: ---- onResume ----</code></pre><p>å¯ä»¥å‘ç°,ä¸ä»…ä»…èµ°äº†onResume() ,è¿˜èµ°äº†ä¸€æ¬¡onStart()</p><p>8.æ¨ªç«–å±åˆ‡æ¢</p><ul><li><p>æ­£å¸¸åˆ‡æ¢</p><pre><code>E/MainActivity: ---- onPause ----E/MainActivity: ---- onStop ----E/MainActivity: ---- onDestroy ----E/MainActivity: ---- onCreate ----E/MainActivity: ---- onStart ----E/MainActivity: ---- onResume ----å¦‚æœä½ ä»€ä¹ˆéƒ½ä¸è®¾ç½®,ç›´æ¥åˆ‡æ¢æ˜¯è¿™æ ·çš„.</code></pre></li></ul><ul><li><p>ä¿ç•™Activityçš„åˆ‡æ¢</p><pre><code> æˆ‘åœ¨manifest.xmlæ–‡ä»¶ä¸­,æ·»åŠ äº† &lt;activity     android:name=&quot;.MainActivity&quot;     android:configChanges=&quot;orientation|screenSize&quot;&gt;     &lt;intent-filter&gt;         &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;        &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;    &lt;/intent-filter&gt; &lt;/activity&gt;</code></pre><p>æ­¤æ—¶:</p><p>Activityä¸ä¼šè¢«é”€æ¯,ä»è€Œé‡æ–°åˆ›å»º,è€Œæ˜¯è°ƒç”¨onConfigurationChanged</p><pre><code>@Override  public void onConfigurationChanged(Configuration newConfig) {     super.onConfigurationChanged(newConfig);     //do somethings}</code></pre></li></ul><h4 id="Fragmentç”Ÿå‘½å‘¨æœŸ"><a href="#Fragmentç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Fragmentç”Ÿå‘½å‘¨æœŸ"></a>Fragmentç”Ÿå‘½å‘¨æœŸ</h4><p>æƒ¯ä¾‹,å¦‚å›¾:</p><p><img src="/images/fragment_lifercycle.png" srcset="/img/loading.gif" alt="fragment_lifecycle"></p><h5 id="å›è°ƒæ–¹æ³•ç®€è¿°-1"><a href="#å›è°ƒæ–¹æ³•ç®€è¿°-1" class="headerlink" title="å›è°ƒæ–¹æ³•ç®€è¿°"></a>å›è°ƒæ–¹æ³•ç®€è¿°</h5><p>å…¶ä¸­onAttach()  onCreateView() onActivityCreated()  onDestroy() onDetach() å’ŒActivityçš„ä¸ä¸€è‡´</p><ul><li><p>onAttach()</p><p>Fragmentä¸å®ƒæ‰€ä¾èµ–çš„Activityå»ºç«‹å…³è”</p></li><li><p>onCreateView()</p><p>è¿™é‡Œæ˜¯ç»™Fragmentåˆ›å»ºè§†å›¾ç”¨çš„,åœ¨onCreate()ä¸­åˆå§‹åŒ–Fragment,ä½†æ˜¯è§†å›¾ç­‰è¿˜æ˜¯æ²¡æœ‰åŠ è½½ä¸Šå»çš„</p></li><li><p>onActivityCreated()</p><p>å¦‚æœè°ƒç”¨è¯¥æ–¹æ³•,è¯´æ˜Fragmentä¾èµ–çš„Activityä¸­onCreate()å·²ç»æ‰§è¡Œå®Œæ¯•</p></li><li><p>onDestroyView()</p><p>Fragmentä¸­çš„å¸ƒå±€é”€æ¯,ç§»é™¤</p><p>è¦æ³¨æ„çš„æ˜¯,æ­¤æ—¶Fragmentä¸å®ƒæ‰€ä¾èµ–çš„Activityè¿˜æ˜¯å…³è”çš„</p></li><li><p>onDestroy()</p><p>æ­¤æ—¶,Fragmentè¢«é”€æ¯</p></li><li><p>onDetach()</p><p>è§£é™¤ä¸Activityçš„å…³è”</p></li></ul><p>PS: Fragmentä¸­çš„onResume()å¹¶ä¸ååˆ†å‡†ç¡®,æ‰€ä»¥å¦‚æœè¦åšæ‡’åŠ è½½,è¦åˆ¤æ–­fragmentä¸èƒ½ä½¿ç”¨onResumeåˆ¤æ–­</p><h5 id="ç»å…¸åœºæ™¯-1"><a href="#ç»å…¸åœºæ™¯-1" class="headerlink" title="ç»å…¸åœºæ™¯"></a>ç»å…¸åœºæ™¯</h5><p>1.æ­£å¸¸å¯åŠ¨</p><p>çœŸçš„æ˜¯è¶…çº§å¤šå•Š</p><pre><code>E/BlankFragment: ---- onAttach ----               å…³è”ActivityE/BlankFragment: ---- onCreate ----                Fragmentåˆå§‹åŒ–E/BlankFragment: ---- onCreateView ----            åˆ›å»ºFragmentçš„å¸ƒå±€E/BlankFragment: ---- onViewCreated ----        onCreateViewæ‰§è¡Œå®Œåè¢«è§¦å‘E/BlankFragment: ---- onActivityCreated ----    å…³è”çš„Activity OnCreate()æ‰§è¡Œå®Œæ¯•åè§¦å‘E/BlankFragment: ---- onStart ----                Fragmentå¯è§E/BlankFragment: ---- onResume ----                Fragmentå¯äº¤äº’,ä¸€èˆ¬ä¸ä½¿ç”¨å®ƒæ¥åˆ¤æ–­</code></pre><p>2.æ­£å¸¸é€€å‡º(æˆ–è€…æ˜¯å®ƒå…³è”çš„Activityè¢«é”€æ¯äº†)</p><pre><code>E/BlankFragment: ---- onPause ----E/BlankFragment: ---- onStop ----E/BlankFragment: ---- onDestroyView ----E/BlankFragment: ---- onDestroy ----E/BlankFragment: ---- onDetach ----</code></pre><p>3.è¿›å…¥åå°</p><pre><code>E/BlankFragment: ---- onPause ----E/BlankFragment: ---- onStop ----</code></pre><p>4.ä»é”å±åˆ°è§£é”</p><pre><code>E/BlankFragment: ---- onPause ----E/BlankFragment: ---- onSaveInstanceState ----E/BlankFragment: ---- onStop ----E/BlankFragment: ---- onStart ----E/BlankFragment: ---- onResume ----</code></pre><p>5.åˆ‡æ¢åˆ°OtherFragment</p><pre><code>E/BlankFragment: ---- onPause ----E/BlankFragment: ---- onStop ----E/BlankFragment: ---- onDestroyView ----</code></pre><p>6.ä»OtherFragmentåˆ‡æ¢å›æœ¬Fragment</p><pre><code>E/BlankFragment: ---- onCreateView ----E/BlankFragment: ---- onActivityCreated ----E/BlankFragment: ---- onStart ----   E/BlankFragment: ---- onResume ----</code></pre>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Fragment</tag>
      
      <tag>Activity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android Studio ä¸­ä½¿ç”¨tools:sample</title>
    <link href="undefined2018/02/26/Android-Studio-tools-sample/"/>
    <url>2018/02/26/Android-Studio-tools-sample/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Google å®˜æ–¹æ–‡æ¡£</p><p><a href="https://developer.android.com/studio/write/tool-attributes.html#toolssample_resources" target="_blank" rel="noopener">https://developer.android.com/studio/write/tool-attributes.html#toolssample_resources</a></p></blockquote><p>ä»–æ‰€èƒ½è¾¾åˆ°çš„æ•ˆæœå°±æ˜¯,æä¾›ç»™ä½ ä¸€äº›æ•°æ®,å¹¶ç›´æ¥åœ¨ Preview æˆ–è€… Designé¢æ¿ä¸­æŸ¥çœ‹æ ·å¼</p><a id="more"></a><h4 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h4><p>ä¸å¦‚æ”¾ä¸€ä¸ªå›¾æ¥çš„ç›´è§‚</p><p>itemä¸­ä½¿ç”¨ sampleèµ„æº</p><p><img src="/images/tools_item.png" srcset="/img/loading.gif" alt="item"></p><p>å°†itemåŠ å…¥åˆ°listä¸­æŸ¥çœ‹æ•ˆæœ</p><p><img src="/images/tools_list.png" srcset="/img/loading.gif" alt="list"></p><h4 id="å‡†å¤‡ä½¿ç”¨tools"><a href="#å‡†å¤‡ä½¿ç”¨tools" class="headerlink" title="å‡†å¤‡ä½¿ç”¨tools"></a>å‡†å¤‡ä½¿ç”¨tools</h4><h5 id="Android-Studio"><a href="#Android-Studio" class="headerlink" title="Android Studio"></a>Android Studio</h5><p>æ³¨æ„è¦ä½¿ç”¨Android Studio 3.0 + çš„ç‰ˆæœ¬</p><h5 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h5><p><code>xmlns:tools=&quot;http://schemas.android.com/tools&quot;</code></p><p>ç„¶åå°±å¯ä»¥ä½¿ç”¨toolsçš„ç›¸å…³å±æ€§äº†</p><p>åœ¨googleæ–‡æ¡£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šå…¶ä»–å¯ç”¨çš„,å…·ä½“ä½¿ç”¨æ•ˆæœè¯·è‡ªè¡ŒæŸ¥é˜…æ–‡æ¡£.</p><p>å¦‚:</p><p><strong>context</strong>   <strong>showIn</strong>  <strong>layout</strong>   <strong>listitem</strong>   <strong>layoutManager</strong>     <strong>itemCount</strong></p><p>ä½¿ç”¨æ–¹å¼ä¸º:</p><pre><code class="xml">&lt;layout    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;    &lt;RelativeLayout        android:layout_width=&quot;match_parent&quot;        android:layout_height=&quot;match_parent&quot;        tools:context=&quot;com.wangzhumo.app.tips.page.NearbyFragment&quot;&gt;        &lt;com.jcodecraeer.xrecyclerview.XRecyclerView            android:id=&quot;@+id/recycleview&quot;            android:layout_width=&quot;match_parent&quot;            android:layout_height=&quot;match_parent&quot;            tools:layoutManager=&quot;GridLayoutManager&quot;            tools:itemCount=&quot;5&quot;            tools:spanCount=&quot;2&quot;            tools:listitem=&quot;@layout/nearby_list_item&quot;&gt;        &lt;/com.jcodecraeer.xrecyclerview.XRecyclerView&gt;    &lt;/RelativeLayout&gt;&lt;/layout&gt;</code></pre><h4 id="å¯ç”¨èµ„æº"><a href="#å¯ç”¨èµ„æº" class="headerlink" title="å¯ç”¨èµ„æº"></a>å¯ç”¨èµ„æº</h4><h5 id="googleå·²æä¾›çš„èµ„æº"><a href="#googleå·²æä¾›çš„èµ„æº" class="headerlink" title="googleå·²æä¾›çš„èµ„æº"></a>googleå·²æä¾›çš„èµ„æº</h5><p><img src="/images/tools_google.png" srcset="/img/loading.gif" alt="google"></p><p>è¿™äº›èµ„æºå¯ä»¥åœ¨xmlä¸­ç›´æ¥ä½¿ç”¨,ä¹Ÿå¯ä»¥åœ¨è‡ªå®šä¹‰çš„èµ„æºä¸­ä½¿ç”¨</p><p>ä½¿ç”¨æ–¹å¼ä¸º:</p><pre><code class="xml">&lt;!-- è¿™é‡Œé¢çš„èµ„æºåœ¨Android Studio/Applications/Android Studio.app/Contents/plugins/android/lib/sampleData/backgrounds/scenic--&gt;&lt;ImageView    ...    tools:src=&quot;@tools:sample/backgrounds/scenic&quot;&gt;&lt;/ImageView&gt;    &lt;!-- è¿™ä¸ªæ˜¯ä¸€æ®µå‡æ–‡ç«  --&gt;&lt;TextView    ...          tools:text=&quot;@tools:sample/lorem/random&quot;/&gt;&lt;/TextView&gt;</code></pre><h5 id="è‡ªå®šä¹‰çš„èµ„æº"><a href="#è‡ªå®šä¹‰çš„èµ„æº" class="headerlink" title="è‡ªå®šä¹‰çš„èµ„æº"></a>è‡ªå®šä¹‰çš„èµ„æº</h5><p><img src="/images/tools_new.png" srcset="/img/loading.gif" alt="new"></p><p>åˆ›å»ºä¸€ä¸ª sampledata æ–‡ä»¶å¤¹</p><p><img src="/images/tools_files.png" srcset="/img/loading.gif" alt="file"></p><ul><li><p><code>sampledata/images</code> æ–‡ä»¶ä¸­éƒ½æ˜¯äº›å›¾ç‰‡èµ„æº</p></li><li><p><code>description</code>æ–‡ä»¶ä¸­æ˜¯æè¿°æ€§æ–‡å­—, æ³¨æ„<strong>æ¯ä¸€è¡Œä¸ºä¸€é¡¹ä¸ªå…ƒç´ </strong></p></li><li><p><code>hotels</code> ä¹Ÿæ˜¯ä¸€äº›æ–‡å­—,ä¸è¿‡æ˜¯ä¸€äº›é…’åº—åå­—</p></li><li><p><code>hotel.json</code></p><pre><code class="json">{  &quot;data&quot;:[    {        &quot;name&quot;:&quot;@sample/hotels&quot;,    //è¿™é‡Œä½¿ç”¨çš„æ˜¯è‡ªå·±å®šä¹‰çš„  hotels æ–‡ä»¶ä¸­çš„å­—æ®µ      &quot;img&quot;:&quot;@tools:sample/backgrounds/scenic&quot;,      &quot;desc&quot;:&quot;@sample/description&quot;   //è¿™é‡Œä½¿ç”¨çš„æ˜¯è‡ªå·±å®šä¹‰çš„  description æ–‡ä»¶ä¸­çš„å­—æ®µ    },    {      &quot;name&quot;:&quot;@sample/hotels&quot;,      &quot;img&quot;:&quot;@tools:sample/backgrounds/scenic&quot;,  //è¿™é‡Œçš„å°±æ˜¯è‡ªå¸¦çš„èµ„æºäº†      &quot;desc&quot;:&quot;@sample/description&quot;    },    {      &quot;name&quot;:&quot;@sample/hotels&quot;,      &quot;img&quot;:&quot;@sample/images&quot;,  //è¿™ç§å°±æ˜¯/images æ–‡ä»¶ä¸­çš„èµ„æº      &quot;desc&quot;:&quot;@sample/description&quot;    },    {      &quot;name&quot;:&quot;@sample/hotels&quot;,      &quot;img&quot;:&quot;@tools:sample/backgrounds/scenic&quot;,      &quot;desc&quot;:&quot;@sample/description&quot;    },    {      &quot;name&quot;:&quot;@sample/hotels&quot;,      &quot;img&quot;:&quot;@tools:sample/backgrounds/scenic&quot;,      &quot;desc&quot;:&quot;@sample/description&quot;    }  ]}</code></pre></li></ul><p>ä½¿ç”¨æ–¹å¼ä¸º:</p><pre><code class="xml">&lt;TextView    ...    tools:text=&quot;@sample/hotels&quot;/&gt;&lt;ImageView    ...    tools:src=&quot;@sample/images&quot;/&gt;</code></pre>]]></content>
    
    
    <categories>
      
      <category>Android Studio</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Android Studio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidé¡¹ç›®ä¸­ä½¿ç”¨Timber + Loggeræ—¥å¿—è¾“å‡º</title>
    <link href="undefined2018/02/07/Android-Timber-Logger/"/>
    <url>2018/02/07/Android-Timber-Logger/</url>
    
    <content type="html"><![CDATA[<p>ä¸å•°å—¦äº†,ç›´æ¥å¼€å§‹.</p><h4 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h4><blockquote><p>Logger   <a href="https://github.com/orhanobut/logger" target="_blank" rel="noopener">orhanobut/Logger</a></p><p>Timber  <a href="https://github.com/JakeWharton/timber" target="_blank" rel="noopener">JakeWharton/timber</a></p></blockquote><pre><code class="groovy">//loggerimplementation &#39;com.orhanobut:logger:2.1.1&#39;//timberimplementation &#39;com.jakewharton.timber:timber:4.6.0&#39;</code></pre><a id="more"></a><h4 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h4><p>æˆ‘æ”¾åœ¨äº†æˆ‘çš„Application.javaä¸­åˆå§‹åŒ–çš„</p><pre><code class="java">    /**     * åˆå§‹åŒ–Timber     */    private void initTimber() {          //é…ç½®Logger        FormatStrategy formatStrategy = PrettyFormatStrategy.newBuilder()                .showThreadInfo(true)                   .methodCount(2)                .methodOffset(7)                .tag(&quot;MY_LOG&quot;)                .build();          //é…ç½®Loggeråœ¨Debugæ—¶ä¸æ‰“å°        Logger.addLogAdapter(new AndroidLogAdapter(formatStrategy){            @Override            public boolean isLoggable(int priority, String tag) {                return BuildConfig.DEBUG;            }        });          //ç»™Timberä¸€ä¸ªæ ‘...å¤§ç¥è¿™ä¹ˆæ‰“æ¯”å–»çš„ ğŸ˜†        Timber.plant(new Timber.DebugTree(){            @Override            protected void log(int priority, String tag,                                @NotNull String message, Throwable t) {                Logger.log(priority,tag,message,t);            }        });    }</code></pre><p><img src="https://github.com/orhanobut/logger/blob/master/art/logger_output.png" srcset="/img/loading.gif" alt="logger"></p><p>å…¶ä¸­:</p><p><code>showThreadInfo(true)</code>  æ˜¯å¦æ˜¾ç¤ºThreadInfo</p><p><code>methodCount(2)</code>        æ—¥å¿—è¾“å‡ºæ—¶æ˜¾ç¤ºå‡ è¡Œ</p><p><code>methodOffset(7)</code>      æ–¹æ³•åç§»é‡,é»˜è®¤æ˜¯5,è¿™ä¸ªè‡ªå·±è°ƒå¤§,è°ƒå°çœ‹çœ‹å°±æ˜ç™½äº†</p><p><code>tag(&quot;MY_LOG&quot;)</code>          è‡ªå®šä¹‰çš„Tag,é»˜è®¤å€¼æ˜¯PRETTY_LOGGER</p><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><pre><code class="java">Timber.e(&quot;ä¸‹è½½çŠ¶æ€å‘ç”Ÿæ”¹å˜ = %s&quot;, downLoadInfo.status )Timber.e(&quot;ä¸‹è½½è¿›åº¦ = %d&quot;, mBindingView.progressBar.progress )</code></pre><p>loggerè´Ÿè´£ç”Ÿæˆmessageçš„æ–¹æ³•</p><pre><code class="Java">  private String createMessage(String message, Object... args) {    return args == null || args.length == 0 ? message : String.format(message, args);  }</code></pre><p><code>String.format(message, args)</code>è¿™å°±èµ‹äºˆäº†æˆ‘ä»¬åœ¨å†™ä¿¡æ¯çš„æ—¶å€™ä½¿ç”¨å ä½ç¬¦.è®°å¾—è¦ç¬¦åˆformatçš„æ ¼å¼å“¦</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>å…¶å®æŒ‰æˆ‘ç°åœ¨çš„éœ€æ±‚,Loggerå®Œå…¨ç¬¦åˆæˆ‘,ä¸ºä»€ä¹ˆåŠ ä¸ŠTimberé‚£?</p><p>Timberå¯ä»¥åšåˆ°åˆ†å‘,åˆ°æ—¶å€™æˆ‘å¯ä»¥åŠ ä¸Š DiskFileTree  â€¦  ä»€ä¹ˆçš„,æ–¹ä¾¿åæœŸæœ‰å˜åŒ–çš„æ—¶å€™ä¿®æ”¹</p><p>ç„¶è€Œ,æˆ‘åœ¨Loggeré‡Œå‘ç°äº†ä¸€ä¸ªç±»</p><p><code>com.orhanobut.logger.DiskLogAdapter</code></p><p>åŸæ¥å®ƒå·²ç»æ”¯æŒå†™åˆ°æœ¬åœ°äº†.. å®å®å¿ƒé‡Œè‹¦</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Jenkinsæ­å»ºAndroidè‡ªåŠ¨æ‰“åŒ…</title>
    <link href="undefined2018/02/05/Jenkins-Android/"/>
    <url>2018/02/05/Jenkins-Android/</url>
    
    <content type="html"><![CDATA[<h4 id="ä¸‹è½½å®‰è£…"><a href="#ä¸‹è½½å®‰è£…" class="headerlink" title="ä¸‹è½½å®‰è£…"></a>ä¸‹è½½å®‰è£…</h4><ul><li><p>Jenkinsçš„ä¸‹è½½ä¸å®‰è£…</p><p><strong>ä¸‹è½½</strong></p><blockquote><p> <a href="https://jenkins.io/download/" target="_blank" rel="noopener">https://jenkins.io/download/</a></p><p> ä¸‹è½½waråŒ…</p><p> <a href="http://mirrors.jenkins.io/war-stable/latest/jenkins.war" target="_blank" rel="noopener">Generic Java package (.war)</a></p></blockquote><p>å› ä¸ºæ‰“ç®—ä½¿ç”¨Tomcatæ¥éƒ¨ç½²,æ‰€ä»¥éœ€è¦ä¸‹è½½waråŒ…,ä¹Ÿå¯ä»¥ç›´æ¥ä¸‹å¯¹åº”ç‰ˆæœ¬çš„å®‰è£…æ–‡ä»¶,ç›´æ¥å®‰è£…</p></li></ul><pre><code>**å®‰è£…**waråŒ…æ”¾åˆ°`./apache-tomcat-7.0.77/webapps`    Tomcatçš„wabappsåŒ…ä¸‹å³å¯</code></pre><ul><li><p>Tomcat (ç•¥)</p><p>è®°å¾—é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡,ç­‰ä¼šæ–¹ä¾¿å¯åŠ¨</p><pre><code class="shell">export TOMCAT_HOME=/Users/phyooos/develop/apache-tomcat-7.0.77export PATH.....:$TOMCAT/bin</code></pre></li></ul><a id="more"></a><h4 id="åˆå§‹åŒ–Jenkins"><a href="#åˆå§‹åŒ–Jenkins" class="headerlink" title="åˆå§‹åŒ–Jenkins"></a>åˆå§‹åŒ–Jenkins</h4><ul><li><p>å¯åŠ¨Jenkins,å³å¯åŠ¨tomcat</p><pre><code class="shell">$ startup.shUsing CATALINA_BASE:   /Users/phyooos/develop/apache-tomcat-7.0.77Using CATALINA_HOME:   /Users/phyooos/develop/apache-tomcat-7.0.77Using CATALINA_TMPDIR: /Users/phyooos/develop/apache-tomcat-7.0.77/tempUsing JRE_HOME:        /Library/Java/JavaVirtualMachines/jdk1.8.0/Contents/HomeUsing CLASSPATH:       /Users/phyooos/develop/apache-tomcat-7.0.77/bin/bootstrap.jar:/Users/phyooos/develop/apache-tomcat-7.0.77/bin/tomcat-juli.jarTomcat started.</code></pre><p>çœ‹åˆ°è¿™ä¸ªå°±è¯´æ˜,å·²ç»æ­£å¸¸å¯åŠ¨</p></li><li><p>è®¿é—®<a href="http://localhost:8080/jenkins/" target="_blank" rel="noopener">http://localhost:8080/jenkins/</a></p><p>æ‰“å¼€åéœ€è¦è¾“å…¥ä¸€ä¸ªå¯†é’¥,macçš„åœ¨<code>jenkins/secrets/initialAdminPassword</code></p><pre><code class="shell">~ âŒš 10:11:03$ cat ~/.jenkins/secrets/initialAdminPassword55ad44431f6d4ebdb53a7c1971d12df4</code></pre><p>è¾“å…¥æ­¤å¯†é’¥å³å¯.</p></li><li><p>åˆ›å»ºç”¨æˆ·</p></li></ul><h4 id="é…ç½®Jenkins"><a href="#é…ç½®Jenkins" class="headerlink" title="é…ç½®Jenkins"></a>é…ç½®Jenkins</h4><h5 id="1-å®‰è£…æ’ä»¶"><a href="#1-å®‰è£…æ’ä»¶" class="headerlink" title="1.å®‰è£…æ’ä»¶"></a>1.å®‰è£…æ’ä»¶</h5><pre><code>Build Timeoutbuild-name-setterCredentials Binding Plugindescription setter pluginDynamic Parameter Plug-in(è¿™ä¸ªæ’ä»¶,æœä¸åˆ°äº†,å› ä¸ºå®‰å…¨é—®é¢˜è¢«å±è”½äº†)Environment Injector PluginGit pluginGitHub Branch Source PluginGitlab Authentication pluginGitLab PluginGradle PluginPipelineSSH Slaves pluginSSH pluginTimestamperUpload to pgyer(ä¸Šä¼ åˆ°è’²å…¬è‹±,æ²¡æœ‰éœ€è¦çš„ä¸ç”¨å®‰è£…)Workspace Cleanup Plugin</code></pre><p>ä»¥ä¸Šæ’ä»¶,æ˜¯å¸¸ç”¨çš„æ’ä»¶,å°½é‡å…¨éƒ¨å®‰è£…</p><h5 id="2-é…ç½®ç¯å¢ƒå˜é‡"><a href="#2-é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2.é…ç½®ç¯å¢ƒå˜é‡"></a>2.é…ç½®ç¯å¢ƒå˜é‡</h5><p><strong>ç³»ç»Ÿç®¡ç† - å…¨å±€å·¥å…·é…ç½®</strong></p><p>éœ€è¦é…ç½®</p><p>Java</p><p><img src="/images/jenkins_java.png" srcset="/img/loading.gif" alt="Java"></p><p>Git</p><p><img src="/images/jenkins_git.png" srcset="/img/loading.gif" alt="Git"></p><p>Gradle</p><p><img src="/images/jenkins_gradle.png" srcset="/img/loading.gif" alt="Gradle"></p><p>é…ç½®å¥½ä¿å­˜å³å¯</p><p><strong>ç³»ç»Ÿç®¡ç† - ç³»ç»Ÿè®¾ç½®</strong></p><p>è®°å¾—é…ç½®gitlabæˆ–è€… githubè´¦å·</p><h5 id="3-åˆå§‹åŒ–é¡¹ç›®"><a href="#3-åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="3.åˆå§‹åŒ–é¡¹ç›®"></a>3.åˆå§‹åŒ–é¡¹ç›®</h5><p>åˆ›å»ºé¡¹ç›®</p><p><img src="/images/jenkins_init.png" srcset="/img/loading.gif" alt="init"></p><hr><p><strong>General</strong></p><p>é€‰æ‹©å‚æ•°åŒ–æ„å»ºè¿‡ç¨‹</p><p>IS_JENKINS  æ˜¯å¦Jenkinsæ‰“åŒ…,è¿™é‡Œè‚¯å®šæ˜¯ä¸€ç›´trueçš„</p><p>PRODUCT_FLAVORS  ç¯å¢ƒ</p><p>BUILD_TYPE  æ„å»ºç‰ˆæœ¬</p><p>VERSION_NAME ç‰ˆæœ¬åå­—</p><p>JENKINS_OUTPUT Apkç”Ÿæˆç›®å½•</p><p>JENKINS_TIME  æ—¶é—´æˆ³</p><p><img src="/images/jenkins_init1.png" srcset="/img/loading.gif" alt="General"></p><p><img src="/images/jenkins_init2.png" srcset="/img/loading.gif" alt="General"></p><p><img src="/images/jenkins_init3.png" srcset="/img/loading.gif" alt="General"></p><p>è¿™äº›å‚æ•°å®šä¹‰å®Œå°±å¯ä»¥ä½¿ç”¨äº† ${å‚æ•°å} çš„å½¢å¼,è¿™äº›å‚æ•°ä¼šå†™å…¥åˆ° Appé¡¹ç›®ä¸­çš„ gradle.propertiesæ–‡ä»¶</p><p>Appé¡¹ç›®ä¸­çš„ gradle.propertiesæ–‡ä»¶</p><pre><code class="java"># When configured, Gradle will run in incubating parallel mode.# This option should only be used with decoupled projects. More details, visit# http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects# org.gradle.parallel=trueorg.gradle.jvmargs=-Xmx4608MVERSION_NAME=1.4.0VERSION_CODE=12IS_JENKINS=falseJENKINS_OUTPUT=&#39;output/&#39;JENKINS_TIME=&#39;201802021231&#39;</code></pre><hr><p>è¿›å…¥ä¸‹ä¸€ä¸ªé…ç½®é¡µé¢,åˆ°<strong>æºç ç®¡ç†</strong>é‚£å—</p><p><img src="/images/jenkins_gitlab.png" srcset="/img/loading.gif" alt="gitlab"></p><p>åªè¦ä½ èƒ½ä¸‹è½½åˆ°æºç å³å¯,æ— æ‰€è°“éè¦å’Œæˆ‘è¿™ä¸ªä¸€è‡´,branch  å°±æ˜¯æŒ‡å®šåˆ†æ”¯äº†,æˆ‘è¿™å„¿æ˜¯  dev åˆ†æ”¯</p><hr><p>ä¸‹ä¸€ä¸ªé…ç½®<strong>æ„å»º</strong></p><p><img src="/images/jenkins_build.png" srcset="/img/loading.gif" alt="build"></p><p>é€‰æ‹© Invoke Gradle </p><p>Tasks é‡Œé¢çš„å‘½ä»¤,æˆ‘æ¥è§£é‡Šä¸€ä¸‹</p><pre><code>#æ¸…ç†clean  #æ‰“åŒ…assemble${PRODUCT_FLAVORS}${BUILD_TYPE}#è¿™é‡Œçš„æ„æ€æ˜¯ æ‰“åŒ…æŒ‡å®šçš„ä¸€ä¸ªFLAVORç‰ˆæœ¬(Release + ç‰ˆæœ¬)#å…³äºassemble ...  çš„,è¯·æœ gradle æ‰“åŒ…å‘½ä»¤#å…¶ä»–å‚æ•°-PVERSION_NAME=${VERSION_NAME}-PVERSION_CODE=${VERSION_CODE}-PJENKINS_OUTPUT=${JENKINS_OUTPUT}-PJENKINS_TIME=${JENKINS_TIME}-PIS_JENKINS=${IS_JENKINS}#-Pæ„å‘³ç€å‚æ•°#-Påé¢æ˜¯å‚æ•°å#=${} åˆ™ä¸ºå‚æ•°å€¼,å°±æ˜¯ä¸Šé¢Generalé‡Œé¢é…ç½®çš„</code></pre><hr><p><strong>æ„å»ºåæ“ä½œ</strong></p><p><img src="/images/jenkins_pgy.png" srcset="/img/loading.gif" alt="pgy"></p><blockquote><p>å‚è€ƒ <a href="https://www.pgyer.com/doc/view/jenkins_plugin" target="_blank" rel="noopener">https://www.pgyer.com/doc/view/jenkins_plugin</a></p></blockquote><p>ä¿å­˜å³å¯</p><h5 id="æ”¹é€ App"><a href="#æ”¹é€ App" class="headerlink" title="æ”¹é€ App"></a>æ”¹é€ App</h5><ul><li>./gradle.propertiesæ–‡ä»¶</li></ul><pre><code>VERSION_NAME=1.4.0VERSION_CODE=12IS_JENKINS=falseJENKINS_OUTPUT=&#39;output/&#39;JENKINS_TIME=&#39;201802021231&#39;</code></pre><p>ä»¥ä¸Šæ–‡ä»¶,å†™å®Œè¯·buildä¸€æ¬¡,ä¾¿äºbuild.gradleä¸­ä½¿ç”¨</p><p>ä½¿ç”¨jenkinsæ—¶,jenkinsä¼šæŠŠå®šä¹‰çš„å€¼æ³¨å…¥åˆ°è¿™é‡Œ,è¦†ç›–è¿™é‡Œå®šä¹‰çš„å€¼</p><ul><li>app/build.gradle</li></ul><pre><code class="groovy">android{    defaultConfig {        ...        //æ­¤å¤„ä½¿ç”¨gradle.propertiesä¸­çš„å€¼   VERSION_CODEå’ŒVERSION_NAME        versionCode VERSION_CODE as Integer        versionName VERSION_NAME    }    //è‡ªå®šä¹‰apkåå­—    android.applicationVariants.all { variant -&gt;        //è·å–æ—¶é—´æˆ³        def timeNow = getDate()        //å¦‚æœæ˜¯IS_JENKINSæ„å»º,åˆ™ä¿®æ”¹æ‰“åŒ…apkçš„ç›®å½•        if (&#39;true&#39;.equals(IS_JENKINS)) {            //ä½¿ç”¨JENKINS_OUTPUTçš„ç›®å½•            def outputFile = JENKINS_OUTPUT            //ä½¿ç”¨JENKINS_TIMEçš„æ—¶é—´æˆ³            timeNow = JENKINS_TIME            //å®šä¹‰apkç›®å½•            variant.getPackageApplication().outputDirectory = new File(outputFile)        }        variant.getPackageApplication().outputScope.apkDatas.forEach { apkData -&gt;            //è¿™ä¸ªä¿®æ”¹è¾“å‡ºAPKçš„æ–‡ä»¶å            apkData.outputFileName = &quot;ä¸€å·è½¦å¸‚_${variant.versionName}_${timeNow}.apk&quot;        }    }    flavorDimensions &#39;env&#39;    productFlavors {        envapp {            dimension &#39;env&#39;            //æ­¤å¤„ä½¿ç”¨jenkinsä¼ çš„VERSION_NAME            versionName VERSION_NAME            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;app&quot;]            buildConfigField &quot;String&quot;, &quot;SERVER_HOST&quot;, &#39;&quot;https://app.wangzhumo.com/&quot;&#39;        }        envtest {            dimension &#39;env&#39;            //ä¸ºäº†æ–¹ä¾¿æµ‹è¯•çœ‹å‡ºå½“å‰appç¯å¢ƒ,å°±ä¸ç”¨VERSION_NAMEäº†            versionName &quot;Test&quot;            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;app&quot;]            buildConfigField &quot;String&quot;, &quot;SERVER_HOST&quot;, &#39;&quot;http://app-test.wangzhumo.com/&quot;&#39;        }        envpre {            dimension &#39;env&#39;            versionName &quot;Pre&quot;            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;app&quot;]            buildConfigField &quot;String&quot;, &quot;SERVER_HOST&quot;, &#39;&quot;https://app-pre.wangzhumo.com/&quot;&#39;        }        envdev {            dimension &#39;env&#39;            versionName &quot;Dev&quot;            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;app&quot;]            buildConfigField &quot;String&quot;, &quot;SERVER_HOST&quot;, &#39;&quot;http://192.168.1.16:8080/app2c/&quot;&#39;        }        //å…¶å®UMENG_CHANNEL_VALUE    SERVER_HOST   ä¹Ÿéƒ½å¯ä»¥ä½¿ç”¨jenkinså®šä¹‰å‚æ•°,å¹¶ä½¿ç”¨    }     //ä¸€ä¸ªè·å–æ—¶é—´æˆ³çš„æ–¹æ³•    static def getDate() {        def date = new Date()        def formattedDate = date.format(&#39;yyyyMMddHHmm&#39;)        return formattedDate    }}</code></pre><p>è®°å¾—æ”¹å®Œapp,ä¸Šä¼ ä»£ç å“¦</p><h4 id="Jenkinsæ‰“åŒ…"><a href="#Jenkinsæ‰“åŒ…" class="headerlink" title="Jenkinsæ‰“åŒ…"></a>Jenkinsæ‰“åŒ…</h4><p><img src="/images/jenkins_go.png" srcset="/img/loading.gif" alt="æ‰“åŒ…"></p><p>OKäº†,å¯ä»¥æ„‰å¿«çš„æ‰“åŒ…äº†,æ‰“åŒ…å®Œå°±ä¼šè‡ªåŠ¨ä¸Šä¼ åˆ°è’²å…¬è‹±.</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Server</tag>
      
      <tag>Jenkins</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaä¸­String.format()çš„ä½¿ç”¨æŒ‡åŒ—</title>
    <link href="undefined2018/02/04/Java-String-format/"/>
    <url>2018/02/04/Java-String-format/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡éåŸåˆ›,æ¥è‡ª<a href="http://blog.csdn.net/lonely_fireworks/article/details/7962171/" target="_blank" rel="noopener">http://blog.csdn.net/lonely_fireworks/article/details/7962171/</a></p><p>è¿™é‡Œåšä¸€ä¸ªå¤‡ä»½,æ–¹ä¾¿éšæ—¶æŸ¥è¯¢</p></blockquote><a id="more"></a><h4 id="å¸¸è§„ç±»å‹çš„æ ¼å¼åŒ–"><a href="#å¸¸è§„ç±»å‹çš„æ ¼å¼åŒ–" class="headerlink" title="å¸¸è§„ç±»å‹çš„æ ¼å¼åŒ–"></a>å¸¸è§„ç±»å‹çš„æ ¼å¼åŒ–</h4><p>Stringç±»çš„format()æ–¹æ³•ç”¨äºåˆ›å»ºæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ä»¥åŠè¿æ¥å¤šä¸ªå­—ç¬¦ä¸²å¯¹è±¡,format()æ–¹æ³•æœ‰ä¸¤ç§é‡è½½å½¢å¼ã€‚</p><ul><li><p>format(String format, Objectâ€¦ args) </p><p>æ–°å­—ç¬¦ä¸²ä½¿ç”¨æœ¬åœ°è¯­è¨€ç¯å¢ƒï¼Œåˆ¶å®šå­—ç¬¦ä¸²æ ¼å¼å’Œå‚æ•°ç”Ÿæˆæ ¼å¼åŒ–çš„æ–°å­—ç¬¦ä¸²ã€‚</p></li><li><p>format(Locale locale, String format, Objectâ€¦ args) </p><p>ä½¿ç”¨æŒ‡å®šçš„è¯­è¨€ç¯å¢ƒï¼Œåˆ¶å®šå­—ç¬¦ä¸²æ ¼å¼å’Œå‚æ•°ç”Ÿæˆæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ã€‚</p></li></ul><h5 id="æ˜¾ç¤ºä¸åŒè½¬æ¢ç¬¦å®ç°ä¸åŒæ•°æ®ç±»å‹åˆ°å­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚"><a href="#æ˜¾ç¤ºä¸åŒè½¬æ¢ç¬¦å®ç°ä¸åŒæ•°æ®ç±»å‹åˆ°å­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚" class="headerlink" title="æ˜¾ç¤ºä¸åŒè½¬æ¢ç¬¦å®ç°ä¸åŒæ•°æ®ç±»å‹åˆ°å­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚"></a>æ˜¾ç¤ºä¸åŒè½¬æ¢ç¬¦å®ç°ä¸åŒæ•°æ®ç±»å‹åˆ°å­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</h5><table><thead><tr><th>è½¬  æ¢  ç¬¦</th><th>è¯´    æ˜</th><th>ç¤º    ä¾‹</th></tr></thead><tbody><tr><td>%s</td><td>å­—ç¬¦ä¸²ç±»å‹</td><td>â€œmingrisoftâ€</td></tr><tr><td>%c</td><td>å­—ç¬¦ç±»å‹</td><td>â€˜mâ€™</td></tr><tr><td>%b</td><td>å¸ƒå°”ç±»å‹</td><td>true</td></tr><tr><td>%d</td><td>æ•´æ•°ç±»å‹ï¼ˆåè¿›åˆ¶ï¼‰</td><td>99</td></tr><tr><td>%x</td><td>æ•´æ•°ç±»å‹ï¼ˆåå…­è¿›åˆ¶ï¼‰</td><td>FF</td></tr><tr><td>%o</td><td>æ•´æ•°ç±»å‹ï¼ˆå…«è¿›åˆ¶ï¼‰</td><td>77</td></tr><tr><td>%f</td><td>æµ®ç‚¹ç±»å‹</td><td>99.99</td></tr><tr><td>%a</td><td>åå…­è¿›åˆ¶æµ®ç‚¹ç±»å‹</td><td>FF.35AE</td></tr><tr><td>%e</td><td>æŒ‡æ•°ç±»å‹</td><td>9.38e+5</td></tr><tr><td>%g</td><td>é€šç”¨æµ®ç‚¹ç±»å‹ï¼ˆfå’Œeç±»å‹ä¸­è¾ƒçŸ­çš„ï¼‰</td><td></td></tr><tr><td>%h</td><td>æ•£åˆ—ç </td><td></td></tr><tr><td>%%</td><td>ç™¾åˆ†æ¯”ç±»å‹</td><td>ï¼…</td></tr><tr><td>%n</td><td>æ¢è¡Œç¬¦</td><td></td></tr><tr><td>%tx</td><td>æ—¥æœŸä¸æ—¶é—´ç±»å‹ï¼ˆxä»£è¡¨ä¸åŒçš„æ—¥æœŸä¸æ—¶é—´è½¬æ¢ç¬¦</td></tr></tbody></table><p>æµ‹è¯•ç”¨ä¾‹</p><pre><code class="java">    public static void main(String[] args) {        String str=null;        str=String.format(&quot;Hi,%s&quot;, &quot;ç‹åŠ›&quot;);        System.out.println(str);        str=String.format(&quot;Hi,%s:%s.%s&quot;, &quot;ç‹å—&quot;,&quot;ç‹åŠ›&quot;,&quot;ç‹å¼ &quot;);                  System.out.println(str);                                 System.out.printf(&quot;å­—æ¯açš„å¤§å†™æ˜¯ï¼š%c %n&quot;, &#39;A&#39;);        System.out.printf(&quot;3&gt;7çš„ç»“æœæ˜¯ï¼š%b %n&quot;, 3&gt;7);        System.out.printf(&quot;100çš„ä¸€åŠæ˜¯ï¼š%d %n&quot;, 100/2);        System.out.printf(&quot;100çš„16è¿›åˆ¶æ•°æ˜¯ï¼š%x %n&quot;, 100);        System.out.printf(&quot;100çš„8è¿›åˆ¶æ•°æ˜¯ï¼š%o %n&quot;, 100);        System.out.printf(&quot;50å…ƒçš„ä¹¦æ‰“8.5æŠ˜æ‰£æ˜¯ï¼š%f å…ƒ%n&quot;, 50*0.85);        System.out.printf(&quot;ä¸Šé¢ä»·æ ¼çš„16è¿›åˆ¶æ•°æ˜¯ï¼š%a %n&quot;, 50*0.85);        System.out.printf(&quot;ä¸Šé¢ä»·æ ¼çš„æŒ‡æ•°è¡¨ç¤ºï¼š%e %n&quot;, 50*0.85);        System.out.printf(&quot;ä¸Šé¢ä»·æ ¼çš„æŒ‡æ•°å’Œæµ®ç‚¹æ•°ç»“æœçš„é•¿åº¦è¾ƒçŸ­çš„æ˜¯ï¼š%g %n&quot;, 50*0.85);        System.out.printf(&quot;ä¸Šé¢çš„æŠ˜æ‰£æ˜¯%d%% %n&quot;, 85);        System.out.printf(&quot;å­—æ¯Açš„æ•£åˆ—ç æ˜¯ï¼š%h %n&quot;, &#39;A&#39;);    }</code></pre><p>è¾“å‡ºç»“æœ</p><pre><code class="java">Hi,ç‹åŠ›Hi,ç‹å—:ç‹åŠ›.ç‹å¼ å­—æ¯açš„å¤§å†™æ˜¯ï¼šA 3&gt;7çš„ç»“æœæ˜¯ï¼šfalse 100çš„ä¸€åŠæ˜¯ï¼š50 100çš„16è¿›åˆ¶æ•°æ˜¯ï¼š64 100çš„8è¿›åˆ¶æ•°æ˜¯ï¼š144 50å…ƒçš„ä¹¦æ‰“8.5æŠ˜æ‰£æ˜¯ï¼š42.500000 å…ƒä¸Šé¢ä»·æ ¼çš„16è¿›åˆ¶æ•°æ˜¯ï¼š0x1.54p5 ä¸Šé¢ä»·æ ¼çš„æŒ‡æ•°è¡¨ç¤ºï¼š4.250000e+01 ä¸Šé¢ä»·æ ¼çš„æŒ‡æ•°å’Œæµ®ç‚¹æ•°ç»“æœçš„é•¿åº¦è¾ƒçŸ­çš„æ˜¯ï¼š42.5000 ä¸Šé¢çš„æŠ˜æ‰£æ˜¯85% å­—æ¯Açš„æ•£åˆ—ç æ˜¯ï¼š41</code></pre><h5 id="æ­é…è½¬æ¢ç¬¦çš„æ ‡å¿—"><a href="#æ­é…è½¬æ¢ç¬¦çš„æ ‡å¿—" class="headerlink" title="æ­é…è½¬æ¢ç¬¦çš„æ ‡å¿—"></a>æ­é…è½¬æ¢ç¬¦çš„æ ‡å¿—</h5><table><thead><tr><th>æ ‡    å¿—</th><th>è¯´    æ˜</th><th>ç¤º    ä¾‹</th><th>ç»“    æœ</th></tr></thead><tbody><tr><td>+</td><td>ä¸ºæ­£æ•°æˆ–è€…è´Ÿæ•°æ·»åŠ ç¬¦å·</td><td>(â€œ%+dâ€,15)</td><td>+15</td></tr><tr><td>âˆ’</td><td>å·¦å¯¹é½</td><td>(â€œ%-5dâ€,15)</td><td>\</td><td>15   \</td><td></td></tr><tr><td>0</td><td>æ•°å­—å‰é¢è¡¥0</td><td>(â€œ%04dâ€, 99)</td><td>0099</td></tr><tr><td>ç©ºæ ¼</td><td>åœ¨æ•´æ•°ä¹‹å‰æ·»åŠ æŒ‡å®šæ•°é‡çš„ç©ºæ ¼</td><td>(â€œ% 4dâ€, 99)</td><td>\</td><td>99\</td><td></td></tr><tr><td>,</td><td>ä»¥â€œ,â€å¯¹æ•°å­—åˆ†ç»„</td><td>(â€œ%,fâ€, 9999.99)</td><td>9,999.990000</td></tr><tr><td>(</td><td>ä½¿ç”¨æ‹¬å·åŒ…å«è´Ÿæ•°</td><td>(â€œ%(fâ€, -99.99)</td><td>(99.990000)</td></tr><tr><td>#</td><td>å¦‚æœæ˜¯æµ®ç‚¹æ•°åˆ™åŒ…å«å°æ•°ç‚¹ï¼Œå¦‚æœæ˜¯16è¿›åˆ¶æˆ–8è¿›åˆ¶åˆ™æ·»åŠ 0xæˆ–0</td><td>(â€œ%#xâ€, 99)(â€œ%#oâ€, 99)</td><td>0x630143</td></tr><tr><td>&lt;</td><td>æ ¼å¼åŒ–å‰ä¸€ä¸ªè½¬æ¢ç¬¦æ‰€æè¿°çš„å‚æ•°</td><td>(â€œ%få’Œ%&lt;3.2fâ€, 99.45)</td><td>99.450000å’Œ99.45</td></tr><tr><td>$</td><td>è¢«æ ¼å¼åŒ–çš„å‚æ•°ç´¢å¼•</td><td>(â€œ%1$d,%2$sâ€, 99,â€abcâ€)</td><td>99,abc</td></tr></tbody></table><p>æµ‹è¯•ç”¨ä¾‹</p><pre><code class="java">public static void main(String[] args) {      String str=null;      //$ä½¿ç”¨      str=String.format(&quot;æ ¼å¼å‚æ•°çš„ä½¿ç”¨ï¼š%1d,%2$s&quot;, 99,&quot;abc&quot;);                 System.out.println(str);                              //+ä½¿ç”¨      System.out.printf(&quot;æ˜¾ç¤ºæ­£è´Ÿæ•°çš„ç¬¦å·ï¼š%+dä¸%d%n&quot;, 99,-99);      //è¡¥Oä½¿ç”¨      System.out.printf(&quot;æœ€ç‰›çš„ç¼–å·æ˜¯ï¼š%03d%n&quot;, 7);      //ç©ºæ ¼ä½¿ç”¨      System.out.printf(&quot;Tabé”®çš„æ•ˆæœæ˜¯ï¼š% 8d%n&quot;, 7);      //.ä½¿ç”¨      System.out.printf(&quot;æ•´æ•°åˆ†ç»„çš„æ•ˆæœæ˜¯ï¼š%,d%n&quot;, 9989997);      //ç©ºæ ¼å’Œå°æ•°ç‚¹åé¢ä¸ªæ•°      System.out.printf(&quot;ä¸€æœ¬ä¹¦çš„ä»·æ ¼æ˜¯ï¼š% 50.5få…ƒ%n&quot;, 49.8);  }</code></pre><p>è¾“å‡ºç»“æœ</p><pre><code class="java">æ ¼å¼å‚æ•°$çš„ä½¿ç”¨ï¼š99,abcæ˜¾ç¤ºæ­£è´Ÿæ•°çš„ç¬¦å·ï¼š+99ä¸-99æœ€ç‰›çš„ç¼–å·æ˜¯ï¼š007Tabé”®çš„æ•ˆæœæ˜¯ï¼š       7æ•´æ•°åˆ†ç»„çš„æ•ˆæœæ˜¯ï¼š9,989,997ä¸€æœ¬ä¹¦çš„ä»·æ ¼æ˜¯ï¼š 49.80000å…ƒ</code></pre><h4 id="æ—¥æœŸå’Œäº‹ä»¶å­—ç¬¦ä¸²æ ¼å¼åŒ–"><a href="#æ—¥æœŸå’Œäº‹ä»¶å­—ç¬¦ä¸²æ ¼å¼åŒ–" class="headerlink" title="æ—¥æœŸå’Œäº‹ä»¶å­—ç¬¦ä¸²æ ¼å¼åŒ–"></a>æ—¥æœŸå’Œäº‹ä»¶å­—ç¬¦ä¸²æ ¼å¼åŒ–</h4><p>å­—ç¬¦ä¸²æ ¼å¼ä¸­è¿˜æœ‰%txè½¬æ¢ç¬¦æ²¡æœ‰è¯¦ç»†ä»‹ç»ï¼Œå®ƒæ˜¯ä¸“é—¨ç”¨æ¥æ ¼å¼åŒ–æ—¥æœŸå’Œæ—¶ é—´çš„ã€‚%txè½¬æ¢ç¬¦ä¸­çš„xä»£è¡¨å¦å¤–çš„å¤„ç†æ—¥æœŸå’Œæ—¶é—´æ ¼å¼çš„è½¬æ¢ç¬¦ï¼Œå®ƒä»¬çš„ç»„åˆèƒ½å¤Ÿå°†æ—¥æœŸå’Œæ—¶é—´æ ¼å¼åŒ–æˆå¤šç§æ ¼å¼ã€‚</p><h5 id="å¸¸è§æ—¥æœŸå’Œæ—¶é—´ç»„åˆçš„æ ¼å¼"><a href="#å¸¸è§æ—¥æœŸå’Œæ—¶é—´ç»„åˆçš„æ ¼å¼" class="headerlink" title="å¸¸è§æ—¥æœŸå’Œæ—¶é—´ç»„åˆçš„æ ¼å¼"></a>å¸¸è§æ—¥æœŸå’Œæ—¶é—´ç»„åˆçš„æ ¼å¼</h5><table><thead><tr><th>è½¬  æ¢  ç¬¦</th><th>è¯´    æ˜</th><th>ç¤º    ä¾‹</th></tr></thead><tbody><tr><td>c</td><td>åŒ…æ‹¬å…¨éƒ¨æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯</td><td>æ˜ŸæœŸå…­ åæœˆ 27 14:21:20 CST 2007</td></tr><tr><td>F</td><td>â€œå¹´-æœˆ-æ—¥â€æ ¼å¼</td><td>2007-10-27</td></tr><tr><td>D</td><td>â€œæœˆ/æ—¥/å¹´â€æ ¼å¼</td><td>10/27/07</td></tr><tr><td>r</td><td>â€œHH:MM:SS PMâ€æ ¼å¼ï¼ˆ12æ—¶åˆ¶ï¼‰</td><td>02:25:51 ä¸‹åˆ</td></tr><tr><td>T</td><td>â€œHH:MM:SSâ€æ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰</td><td>14:28:16</td></tr><tr><td>R</td><td>â€œHH:MMâ€æ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰</td><td>14:28</td></tr></tbody></table><p>æµ‹è¯•ç”¨ä¾‹</p><pre><code class="Java">    public static void main(String[] args) {        Date date=new Date();                                        //cçš„ä½¿ç”¨        System.out.printf(&quot;å…¨éƒ¨æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ï¼š%tc%n&quot;,date);                //fçš„ä½¿ç”¨        System.out.printf(&quot;å¹´-æœˆ-æ—¥æ ¼å¼ï¼š%tF%n&quot;,date);        //dçš„ä½¿ç”¨        System.out.printf(&quot;æœˆ/æ—¥/å¹´æ ¼å¼ï¼š%tD%n&quot;,date);        //rçš„ä½¿ç”¨        System.out.printf(&quot;HH:MM:SS PMæ ¼å¼ï¼ˆ12æ—¶åˆ¶ï¼‰ï¼š%tr%n&quot;,date);        //tçš„ä½¿ç”¨        System.out.printf(&quot;HH:MM:SSæ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ï¼š%tT%n&quot;,date);        //Rçš„ä½¿ç”¨        System.out.printf(&quot;HH:MMæ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ï¼š%tR&quot;,date);    }</code></pre><p>è¾“å‡ºç»“æœ</p><pre><code>å…¨éƒ¨æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ï¼šæ˜ŸæœŸä¸€ ä¹æœˆ 10 10:43:36 CST 2012å¹´-æœˆ-æ—¥æ ¼å¼ï¼š2012-09-10æœˆ/æ—¥/å¹´æ ¼å¼ï¼š09/10/12HH:MM:SS PMæ ¼å¼ï¼ˆ12æ—¶åˆ¶ï¼‰ï¼š10:43:36 ä¸ŠåˆHH:MM:SSæ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ï¼š10:43:36HH:MMæ ¼å¼ï¼ˆ24æ—¶åˆ¶ï¼‰ï¼š10:43</code></pre><p>å®šä¹‰æ—¥æœŸæ ¼å¼çš„è½¬æ¢ç¬¦å¯ä»¥ä½¿æ—¥æœŸé€šè¿‡æŒ‡å®šçš„è½¬æ¢ç¬¦ç”Ÿæˆæ–°å­—ç¬¦ä¸²ã€‚è¿™äº›æ—¥æœŸè½¬æ¢ç¬¦å¦‚å›¾æ‰€ç¤ºã€‚</p><pre><code class="Java">public static void main(String[] args) {  Date date=new Date();                                      //bçš„ä½¿ç”¨ï¼Œæœˆä»½ç®€ç§°  String str=String.format(Locale.US,&quot;è‹±æ–‡æœˆä»½ç®€ç§°ï¼š%tb&quot;,date);       System.out.println(str);                                                                              System.out.printf(&quot;æœ¬åœ°æœˆä»½ç®€ç§°ï¼š%tb%n&quot;,date);  //Bçš„ä½¿ç”¨ï¼Œæœˆä»½å…¨ç§°  str=String.format(Locale.US,&quot;è‹±æ–‡æœˆä»½å…¨ç§°ï¼š%tB&quot;,date);  System.out.println(str);  System.out.printf(&quot;æœ¬åœ°æœˆä»½å…¨ç§°ï¼š%tB%n&quot;,date);  //açš„ä½¿ç”¨ï¼Œæ˜ŸæœŸç®€ç§°  str=String.format(Locale.US,&quot;è‹±æ–‡æ˜ŸæœŸçš„ç®€ç§°ï¼š%ta&quot;,date);  System.out.println(str);  //Açš„ä½¿ç”¨ï¼Œæ˜ŸæœŸå…¨ç§°  System.out.printf(&quot;æœ¬åœ°æ˜ŸæœŸçš„ç®€ç§°ï¼š%tA%n&quot;,date);  //Cçš„ä½¿ç”¨ï¼Œå¹´å‰ä¸¤ä½  System.out.printf(&quot;å¹´çš„å‰ä¸¤ä½æ•°å­—ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š%tC%n&quot;,date);  //yçš„ä½¿ç”¨ï¼Œå¹´åä¸¤ä½  System.out.printf(&quot;å¹´çš„åä¸¤ä½æ•°å­—ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š%ty%n&quot;,date);  //jçš„ä½¿ç”¨ï¼Œä¸€å¹´çš„å¤©æ•°  System.out.printf(&quot;ä¸€å¹´ä¸­çš„å¤©æ•°ï¼ˆå³å¹´çš„ç¬¬å‡ å¤©ï¼‰ï¼š%tj%n&quot;,date);  //mçš„ä½¿ç”¨ï¼Œæœˆä»½  System.out.printf(&quot;ä¸¤ä½æ•°å­—çš„æœˆä»½ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š%tm%n&quot;,date);  //dçš„ä½¿ç”¨ï¼Œæ—¥ï¼ˆäºŒä½ï¼Œä¸å¤Ÿè¡¥é›¶ï¼‰  System.out.printf(&quot;ä¸¤ä½æ•°å­—çš„æ—¥ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š%td%n&quot;,date);  //eçš„ä½¿ç”¨ï¼Œæ—¥ï¼ˆä¸€ä½ä¸è¡¥é›¶ï¼‰  System.out.printf(&quot;æœˆä»½çš„æ—¥ï¼ˆå‰é¢ä¸è¡¥0ï¼‰ï¼š%te&quot;,date);}</code></pre><p>è¾“å‡ºç»“æœ</p><pre><code>è‹±æ–‡æœˆä»½ç®€ç§°ï¼šSepæœ¬åœ°æœˆä»½ç®€ç§°ï¼šä¹æœˆè‹±æ–‡æœˆä»½å…¨ç§°ï¼šSeptemberæœ¬åœ°æœˆä»½å…¨ç§°ï¼šä¹æœˆè‹±æ–‡æ˜ŸæœŸçš„ç®€ç§°ï¼šMonæœ¬åœ°æ˜ŸæœŸçš„ç®€ç§°ï¼šæ˜ŸæœŸä¸€å¹´çš„å‰ä¸¤ä½æ•°å­—ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š20å¹´çš„åä¸¤ä½æ•°å­—ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š12ä¸€å¹´ä¸­çš„å¤©æ•°ï¼ˆå³å¹´çš„ç¬¬å‡ å¤©ï¼‰ï¼š254ä¸¤ä½æ•°å­—çš„æœˆä»½ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š09ä¸¤ä½æ•°å­—çš„æ—¥ï¼ˆä¸è¶³ä¸¤ä½å‰é¢è¡¥0ï¼‰ï¼š10æœˆä»½çš„æ—¥ï¼ˆå‰é¢ä¸è¡¥0ï¼‰ï¼š10</code></pre><h5 id="å’Œæ—¥æœŸæ ¼å¼è½¬æ¢ç¬¦ç›¸æ¯”ï¼Œæ—¶é—´æ ¼å¼çš„è½¬æ¢ç¬¦è¦æ›´å¤šã€æ›´ç²¾ç¡®ã€‚å®ƒå¯ä»¥å°†æ—¶é—´æ ¼å¼åŒ–æˆæ—¶ã€åˆ†ã€ç§’ç”šè‡³æ—¶æ¯«ç§’ç­‰å•ä½ã€‚æ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„è½¬æ¢ç¬¦å¦‚å›¾æ‰€ç¤ºã€‚"><a href="#å’Œæ—¥æœŸæ ¼å¼è½¬æ¢ç¬¦ç›¸æ¯”ï¼Œæ—¶é—´æ ¼å¼çš„è½¬æ¢ç¬¦è¦æ›´å¤šã€æ›´ç²¾ç¡®ã€‚å®ƒå¯ä»¥å°†æ—¶é—´æ ¼å¼åŒ–æˆæ—¶ã€åˆ†ã€ç§’ç”šè‡³æ—¶æ¯«ç§’ç­‰å•ä½ã€‚æ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„è½¬æ¢ç¬¦å¦‚å›¾æ‰€ç¤ºã€‚" class="headerlink" title="å’Œæ—¥æœŸæ ¼å¼è½¬æ¢ç¬¦ç›¸æ¯”ï¼Œæ—¶é—´æ ¼å¼çš„è½¬æ¢ç¬¦è¦æ›´å¤šã€æ›´ç²¾ç¡®ã€‚å®ƒå¯ä»¥å°†æ—¶é—´æ ¼å¼åŒ–æˆæ—¶ã€åˆ†ã€ç§’ç”šè‡³æ—¶æ¯«ç§’ç­‰å•ä½ã€‚æ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„è½¬æ¢ç¬¦å¦‚å›¾æ‰€ç¤ºã€‚"></a>å’Œæ—¥æœŸæ ¼å¼è½¬æ¢ç¬¦ç›¸æ¯”ï¼Œæ—¶é—´æ ¼å¼çš„è½¬æ¢ç¬¦è¦æ›´å¤šã€æ›´ç²¾ç¡®ã€‚å®ƒå¯ä»¥å°†æ—¶é—´æ ¼å¼åŒ–æˆæ—¶ã€åˆ†ã€ç§’ç”šè‡³æ—¶æ¯«ç§’ç­‰å•ä½ã€‚æ ¼å¼åŒ–æ—¶é—´å­—ç¬¦ä¸²çš„è½¬æ¢ç¬¦å¦‚å›¾æ‰€ç¤ºã€‚</h5><table><thead><tr><th>è½¬  æ¢  ç¬¦</th><th>è¯´    æ˜</th><th>ç¤º    ä¾‹</th></tr></thead><tbody><tr><td>H</td><td>2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰</td><td>15</td></tr><tr><td>I</td><td>2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰</td><td>03</td></tr><tr><td>k</td><td>2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰</td><td>15</td></tr><tr><td>l</td><td>2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰</td><td>3</td></tr><tr><td>M</td><td>2ä½æ•°å­—çš„åˆ†é’Ÿï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰</td><td>03</td></tr><tr><td>S</td><td>2ä½æ•°å­—çš„ç§’ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰</td><td>09</td></tr><tr><td>L</td><td>3ä½æ•°å­—çš„æ¯«ç§’ï¼ˆä¸è¶³3ä½å‰é¢è¡¥0ï¼‰</td><td>015</td></tr><tr><td>N</td><td>9ä½æ•°å­—çš„æ¯«ç§’æ•°ï¼ˆä¸è¶³9ä½å‰é¢è¡¥0ï¼‰</td><td>562000000</td></tr><tr><td>p</td><td>å°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®°</td><td>ä¸­ï¼šä¸‹åˆè‹±ï¼špm</td></tr><tr><td>z</td><td>ç›¸å¯¹äºGMTçš„RFC822æ—¶åŒºçš„åç§»é‡</td><td>+0800</td></tr><tr><td>Z</td><td>æ—¶åŒºç¼©å†™å­—ç¬¦ä¸²</td><td>CST</td></tr></tbody></table><table><thead><tr><th>s</th><th>1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•°</th><th>1193468128</th></tr></thead><tbody><tr><td>Q</td><td>1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ¯«ç§’æ•°</td><td>1193468128984</td></tr></tbody></table><p>æµ‹è¯•ä»£ç </p><pre><code class="java">    public static void main(String[] args) {        Date date = new Date();        //Hçš„ä½¿ç”¨        System.out.printf(&quot;2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:%tH%n&quot;, date);        //Içš„ä½¿ç”¨        System.out.printf(&quot;2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:%tI%n&quot;, date);        //kçš„ä½¿ç”¨        System.out.printf(&quot;2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰:%tk%n&quot;, date);        //lçš„ä½¿ç”¨        System.out.printf(&quot;2ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰:%tl%n&quot;, date);        //Mçš„ä½¿ç”¨        System.out.printf(&quot;2ä½æ•°å­—çš„åˆ†é’Ÿï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:%tM%n&quot;, date);        //Sçš„ä½¿ç”¨        System.out.printf(&quot;2ä½æ•°å­—çš„ç§’ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:%tS%n&quot;, date);        //Lçš„ä½¿ç”¨        System.out.printf(&quot;3ä½æ•°å­—çš„æ¯«ç§’ï¼ˆä¸è¶³3ä½å‰é¢è¡¥0ï¼‰:%tL%n&quot;, date);        //Nçš„ä½¿ç”¨        System.out.printf(&quot;9ä½æ•°å­—çš„æ¯«ç§’æ•°ï¼ˆä¸è¶³9ä½å‰é¢è¡¥0ï¼‰:%tN%n&quot;, date);        //pçš„ä½¿ç”¨        String str = String.format(Locale.US, &quot;å°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®°(è‹±)ï¼š%tp&quot;, date);        System.out.println(str);         System.out.printf(&quot;å°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®°ï¼ˆä¸­ï¼‰ï¼š%tp%n&quot;, date);        //zçš„ä½¿ç”¨        System.out.printf(&quot;ç›¸å¯¹äºGMTçš„RFC822æ—¶åŒºçš„åç§»é‡:%tz%n&quot;, date);        //Zçš„ä½¿ç”¨        System.out.printf(&quot;æ—¶åŒºç¼©å†™å­—ç¬¦ä¸²:%tZ%n&quot;, date);        //sçš„ä½¿ç”¨        System.out.printf(&quot;1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•°ï¼š%ts%n&quot;, date);        //Qçš„ä½¿ç”¨        System.out.printf(&quot;1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ï¼š%tQ%n&quot;, date);    }</code></pre><p>è¾“å‡ºç»“æœ</p><pre><code class="java">2ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:112ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:112ä½æ•°å­—24æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰:112ä½æ•°å­—12æ—¶åˆ¶çš„å°æ—¶ï¼ˆå‰é¢ä¸è¡¥0ï¼‰:112ä½æ•°å­—çš„åˆ†é’Ÿï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:032ä½æ•°å­—çš„ç§’ï¼ˆä¸è¶³2ä½å‰é¢è¡¥0ï¼‰:523ä½æ•°å­—çš„æ¯«ç§’ï¼ˆä¸è¶³3ä½å‰é¢è¡¥0ï¼‰:7739ä½æ•°å­—çš„æ¯«ç§’æ•°ï¼ˆä¸è¶³9ä½å‰é¢è¡¥0ï¼‰:773000000å°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®°(è‹±)ï¼šamå°å†™å­—æ¯çš„ä¸Šåˆæˆ–ä¸‹åˆæ ‡è®°ï¼ˆä¸­ï¼‰ï¼šä¸Šåˆç›¸å¯¹äºGMTçš„RFC822æ—¶åŒºçš„åç§»é‡:+0800æ—¶åŒºç¼©å†™å­—ç¬¦ä¸²:CST1970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•°ï¼š13472462321970-1-1 00:00:00 åˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ï¼š1347246232773</code></pre>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Room --AppDatabase_Impl does not existçš„å¼‚å¸¸è§£å†³</title>
    <link href="undefined2018/01/17/Room-AppDatabase-Impl-does-not-exist/"/>
    <url>2018/01/17/Room-AppDatabase-Impl-does-not-exist/</url>
    
    <content type="html"><![CDATA[<p>Bugå¦‚ä¸‹:</p><pre><code>Caused by: java.lang.RuntimeException: cannot find implementation for com.wangzhumo.app.datasource.database.AppDB. AppDB_Impl does not exist</code></pre><a id="more"></a><h4 id="å¯»æ‰¾åŸå› "><a href="#å¯»æ‰¾åŸå› " class="headerlink" title="å¯»æ‰¾åŸå› "></a>å¯»æ‰¾åŸå› </h4><p>debugä¾æ¬¡å‘ç°:</p><ul><li><p>getInstance()ä¸ºç©º</p><pre><code class="java">  public static AppDB getInstance(Context context) {        if (sInstance == null) {            synchronized (AppDB.class) {                if (sInstance == null) {                    //æ­¤å¤„è¿”å›ä¸ºç©º                    sInstance = buildDatabase(context);                    sInstance.updateDatabaseCreated(context);                }            }        }        return sInstance;    }</code></pre></li><li><p>buildDatabase(context) è¿”å›ä¸ºç©º</p><pre><code class="java">/** * Build the database. * creates a new instance of the database. */private static AppDB buildDatabase(final Context appContext) {     AppDB appDB = Room.databaseBuilder(appContext, AppDB.class, DATABASE_NAME)            .addCallback(new Callback() {                @Override                public void onCreate(@NonNull SupportSQLiteDatabase db) {                    super.onCreate(db);                    AppDB database = AppDB.getInstance(appContext);                    database.setDatabaseCreated();                }                @Override                public void onOpen(@NonNull SupportSQLiteDatabase db) {                    super.onOpen(db);                    Log.e(TAG, &quot;onOpen: &quot; + db.getPath());                }            }).build();    return appDB;}</code></pre></li></ul><ul><li>databaseBuilderæ˜¯åˆ›å»ºæ•°æ®åº“çš„æ–¹æ³•,ä½†æ˜¯å®ƒæ„å»ºå¤±è´¥äº†,é‚£ä¹ˆå‰©ä¸‹çš„å°±æ˜¯æºç äº†</li></ul><h4 id="Debugæºç "><a href="#Debugæºç " class="headerlink" title="Debugæºç "></a>Debugæºç </h4><ul><li>databaseBuilder æ–¹æ³•</li></ul><pre><code class="java">@SuppressWarnings(&quot;WeakerAccess&quot;)    @NonNull    public static &lt;T extends RoomDatabase&gt; RoomDatabase.Builder&lt;T&gt; databaseBuilder(            @NonNull Context context, @NonNull Class&lt;T&gt; klass, @NonNull String name) {        //noinspection ConstantConditions        if (name == null || name.trim().length() == 0) {            throw new IllegalArgumentException              (&quot;Cannot build a database with null or empty name.&quot;                    + &quot; If you are trying to create an in memory database, use Room&quot;                    + &quot;.inMemoryDatabaseBuilder&quot;);        }        return new RoomDatabase.Builder&lt;&gt;(context, klass, name);    }</code></pre><p>æˆ‘ä»¬å¯ä»¥æ˜æ˜¾çš„çœ‹å‡º,æ­¤å¤„æŠ›å‡ºçš„å¼‚å¸¸ä¸æ˜¯AppDB_Impl does not exist çš„æç¤º,å¯ä»¥è‚¯å®šå¹¶ä¸æ˜¯æ­¤å¤„çš„é—®é¢˜</p><p>åº”è¯¥æ˜¯æ­£å¸¸è¿”å›çš„ return new RoomDatabase.Builder&lt;&gt;(context, klass, name);</p><p><code>RoomDatabase.Builder</code></p><p>é‚£ä¹ˆå‡ºé—®é¢˜çš„å°±å¯ä»¥è‚¯å®šæ˜¯</p><ul><li><p>build()æ–¹æ³•</p><pre><code>@NonNull        public T build() {            //noinspection ConstantConditions            if (mContext == null) {                throw new IllegalArgumentException                (&quot;Cannot provide null context for the database.&quot;);            }            //noinspection ConstantConditions            if (mDatabaseClass == null) {                throw new IllegalArgumentException                (&quot;Must provide an abstract class that&quot;                        + &quot; extends RoomDatabase&quot;);            }            if (mFactory == null) {                mFactory = new FrameworkSQLiteOpenHelperFactory();            }            DatabaseConfiguration configuration =                    new DatabaseConfiguration(mContext, mName, mFactory, mMigrationContainer,                            mCallbacks, mAllowMainThreadQueries, mRequireMigration);            T db = Room.getGeneratedImplementation(mDatabaseClass, DB_IMPL_SUFFIX);            db.init(configuration);            return db;        }</code></pre><p>æ­¤å¤„,debugå‘ç°,æ˜¯åˆ°</p><p><code>T db = Room.getGeneratedImplementation(mDatabaseClass, DB_IMPL_SUFFIX);</code></p><p>æŠ›å‡ºå¼‚å¸¸çš„.</p></li></ul><h4 id="é”å®šé—®é¢˜"><a href="#é”å®šé—®é¢˜" class="headerlink" title="é”å®šé—®é¢˜"></a>é”å®šé—®é¢˜</h4><p><code>getGeneratedImplementation</code></p><pre><code class="java">@NonNull    static &lt;T, C&gt; T getGeneratedImplementation(Class&lt;C&gt; klass, String suffix) {        final String fullPackage = klass.getPackage().getName();        String name = klass.getCanonicalName();        final String postPackageName = fullPackage.isEmpty()                ? name                : (name.substring(fullPackage.length() + 1));        final String implName = postPackageName.replace(&#39;.&#39;, &#39;_&#39;) + suffix;        //noinspection TryWithIdenticalCatches        try {            @SuppressWarnings(&quot;unchecked&quot;)            final Class&lt;T&gt; aClass = (Class&lt;T&gt;) Class.forName(                    fullPackage.isEmpty() ? implName : fullPackage + &quot;.&quot; + implName);            return aClass.newInstance();        } catch (ClassNotFoundException e) {            //**å¾ˆæ˜æ˜¾,å°±æ˜¯è¿™ä¸ªåœ°æ–¹äº†**            throw new RuntimeException(&quot;cannot find implementation for &quot;                    + klass.getCanonicalName() + &quot;. &quot; + implName + &quot; does not exist&quot;);        } catch (IllegalAccessException e) {            throw new RuntimeException(&quot;Cannot access the constructor&quot;                    + klass.getCanonicalName());        } catch (InstantiationException e) {            throw new RuntimeException(&quot;Failed to create an instance of &quot;                    + klass.getCanonicalName());        }    }</code></pre><p>å…¶å®å°±æ˜¯,ç”Ÿæˆç±»å¤±è´¥äº†</p><p>å…¶ä»–å‚æ•°éƒ½æ­£å¸¸,ååç”Ÿæˆå¤±è´¥,æ‰€ä»¥å°±æ€€ç–‘åˆ° </p><p> Java  -&gt;     <code>apt</code> çš„é—®é¢˜</p><p>Kotlin -&gt;  <code>kapt</code>çš„é—®é¢˜</p><p>è¿™ä¸¤ä¸ªå°±æ˜¯ç”¨æ¥ç”Ÿæˆä»£ç çš„,è¿™é‡Œçš„ç”Ÿæˆå¤±è´¥,æœ‰å¾ˆå¤§æ¦‚ç‡æ˜¯è¿™ä¸ªé—®é¢˜</p><h4 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h4><p>æŸ¥çœ‹é¡¹ç›®çš„ä¾èµ–  <code>lib_opensource  -&gt; build.gradle</code></p><pre><code>    //arch    api deps.archLibs.archExtensions    api deps.archLibs.archLifecycleCommon    api deps.archLibs.archRoomRuntime    kapt deps.archLibs.archRoomCompiler</code></pre><p>æŸ¥çœ‹å‘ç°,æˆ‘å·²ç»æ·»åŠ äº†,é‚£ä¹ˆä»€ä¹ˆé¬¼é—®é¢˜å‘¢?</p><p><strong>æ€€ç–‘æ˜¯libraryçš„é—®é¢˜,æ‰“å¼€æˆ‘ä½¿ç”¨Roomçš„library</strong>    ,æŸ¥çœ‹ <code>lib_datasource -&gt; build.gradle</code></p><pre><code>apply plugin: &#39;com.android.library&#39;...dependencies {    implementation fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;])    api project(&#39;:lib_opensource&#39;)//    kapt deps.archLibs.archRoomCompiler}</code></pre><p>æœç„¶å¿˜äº†åŠ </p><pre><code>apply plugin: &#39;com.android.library&#39;apply plugin: &#39;kotlin-android&#39;apply plugin: &#39;kotlin-kapt&#39;...dependencies {    implementation fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;])    api project(&#39;:lib_opensource&#39;)//    kapt deps.archLibs.archRoomCompiler}</code></pre><p>å°±Okäº†,æˆ‘åˆå¯ä»¥æ„‰å¿«çš„ç©è€äº†</p><h4 id="è®°å¾—-kapt"><a href="#è®°å¾—-kapt" class="headerlink" title="è®°å¾—:  kapt"></a>è®°å¾—:  kapt</h4>]]></content>
    
    
    <categories>
      
      <category>Bug</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Bug</tag>
      
      <tag>Room</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨CharlesæŠ“Httpsçš„æ•°æ®è¯·æ±‚</title>
    <link href="undefined2018/01/11/Charles-Https/"/>
    <url>2018/01/11/Charles-Https/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰çš„æ–‡ç« ä¸­ç»™é¡¹ç›®ä¸­åŠ å…¥äº†Https,æ­¤æ—¶ä½¿ç”¨charlesæŠ“åŒ…å°±æ˜¯ä¸€å †ä¹±ç ,</p><p>ä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦å¸¸å¸¸ä½¿ç”¨Charles,è°ƒè¯•æ¥å£,æŸ¥æ‰¾é—®é¢˜ç­‰,æ‰€ä»¥å°±è¦è®©Charlesä½œä¸ºä¸€ä¸ªä¸­é—´äºº,å¸®æˆ‘ä»¬æ¥æ”¶è½¬å‘è¯·æ±‚</p><p>ä»¥è¾¾åˆ°æŠ“åŒ…çš„æ•ˆæœ,å…¶å®æ­¤æ—¶å·²ç»å®Œå…¨æ˜¯Charlesä¸æœåŠ¡å™¨ä¹‹é—´çš„äº‹äº†.</p><a id="more"></a><h4 id="å¯¼å‡ºè¯ä¹¦"><a href="#å¯¼å‡ºè¯ä¹¦" class="headerlink" title="å¯¼å‡ºè¯ä¹¦"></a>å¯¼å‡ºè¯ä¹¦</h4><p>1.æ‰“å¼€Charles</p><p>2.Help -&gt; SSL Proxying -&gt; Save Charles Root Certificateâ€¦</p><p>3.ä¿å­˜åˆ°~/Downloads/charles-ssl-proxying-certificate.pem</p><h4 id="å®‰è£…è¯ä¹¦åˆ°è®¾å¤‡"><a href="#å®‰è£…è¯ä¹¦åˆ°è®¾å¤‡" class="headerlink" title="å®‰è£…è¯ä¹¦åˆ°è®¾å¤‡"></a>å®‰è£…è¯ä¹¦åˆ°è®¾å¤‡</h4><p>1.æŠŠè¯ä¹¦æ¨é€åˆ°è®¾å¤‡</p><pre><code class="shell">$ adb push charles-ssl-proxying-certificate.pem /sdcard/Download/charles-ssl-proxying-certificate.pem: 1 file pushed. 0.1 MB/s (1921 bytes in 0.012s)</code></pre><p>2.å®‰è£…è¯ä¹¦</p><p>è®¾ç½® -&gt; å®‰å…¨ -&gt; è®¾å¤‡ç®¡ç†ä¸å‡­è¯ -&gt; ä»å­˜å‚¨å®‰è£… -&gt; charles-ssl-proxying-certificate.pemâ€™</p><h4 id="è®¾ç½®Charles"><a href="#è®¾ç½®Charles" class="headerlink" title="è®¾ç½®Charles"></a>è®¾ç½®Charles</h4><p>1.Proxy -&gt; SSL Proxying Settings</p><p>2.æ‰“å¼€æ‰‹æœº,å¼€å§‹è¯·æ±‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Https</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidå¼€å‘ä¸­å¸¸ç”¨çš„Adbå‘½ä»¤</title>
    <link href="undefined2018/01/11/Android-shell-Adb/"/>
    <url>2018/01/11/Android-shell-Adb/</url>
    
    <content type="html"><![CDATA[<p>åœ¨åšè¿™äº›ä¹‹å‰,å…ˆé…ç½®å¥½adbç¯å¢ƒå˜é‡,ä»¥æˆ‘çš„é…ç½®ä¸ºä¾‹</p><pre><code class="shell">$ vim ~/.bash_profileexport ANDROID_HOME=/Users/phyooos/Library/Android/sdk...export PATH={çœç•¥}:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools$ source ~/.bas$ adbAndroid Debug Bridge version 1.0.39Version 0.0.1-4500957Installed as /Users/phyooos/Library/Android/sdk/platform-tools/adb...</code></pre><p>è¡¥å……</p><blockquote><p>adb shell pm list packages   å½“å‰æ‰‹æœºå®‰è£…çš„æ‰€æœ‰appåŒ…å<br>adb shell pm list packages | grep â€˜googleâ€™  åœ¨æ‰€æœ‰åŒ…åä¸­æŸ¥æ‰¾å¸¦â€™googleâ€™çš„</p></blockquote><a id="more"></a><h4 id="è¿æ¥è®¾å¤‡"><a href="#è¿æ¥è®¾å¤‡" class="headerlink" title="è¿æ¥è®¾å¤‡"></a>è¿æ¥è®¾å¤‡</h4><p>æ‰“å¼€å¼€å‘è€… -&gt; æ‰“å¼€è°ƒè¯• -&gt; å…è®¸è°ƒè¯•</p><ul><li><p>é€šè¿‡usbè¿æ¥</p></li><li><p>é€šè¿‡wifiè¿æ¥</p><p>ä¿è¯Androidè®¾å¤‡ä¸ç”µè„‘åœ¨å±€åŸŸç½‘ä¸­,ç½‘æ®µå¥½åƒä¹Ÿè¦ä¸€è‡´ eg:  <code>192.168.2.98 , 192.168.2.111</code></p><pre><code class="shell">~ âŒš 9:44:55$ adb connect 192.168.6.51unable to connect to 192.168.6.51:5555: Connection refused</code></pre><p>æ­¤æ—¶æ˜¯è¿æ¥ä¸ä¸Šçš„,è¦å…ˆtcpip 5555,å¦‚ä¸‹:</p><pre><code class="shell">#ä½¿ç”¨Tcpå¹¶ç›‘å¬ç«¯å£5555adb tcpip 5555#è¿æ¥è®¾å¤‡adb connect 192.168.6.51</code></pre><p>å¦‚æœä½ æƒ³ç”¨usbè°ƒè¯•</p><pre><code class="shell">#ä½¿ç”¨usbè°ƒè¯•  adb usb</code></pre><p>PS:æœ‰çš„è®¾å¤‡ç›´æ¥adb connect  å³å¯,æ‰€ä»¥ä¸å¦¨å…ˆè¯•è¯•</p></li></ul><h4 id="æŸ¥çœ‹è®¾å¤‡"><a href="#æŸ¥çœ‹è®¾å¤‡" class="headerlink" title="æŸ¥çœ‹è®¾å¤‡"></a>æŸ¥çœ‹è®¾å¤‡</h4><ul><li><p>æŸ¥çœ‹æ‰€æœ‰è¿æ¥çš„è®¾å¤‡</p><pre><code class="shell">$ adb devicesList of devices attached3080b82d    device860BCML228J8    device</code></pre></li><li><p>æŒ‡å®šè®¾å¤‡(adb å‘½ä»¤å¿…é¡»æŒ‡å®šä¸€ä¸ªè®¾å¤‡ä½¿ç”¨)</p></li></ul><pre><code class="shell">abd -s ç¼–å· å‘½ä»¤æ¯”å¦‚æˆ‘è¦è¿æ¥3080b82d    device è¿™ä¸ªè®¾å¤‡,å®‰è£…ä¸€ä¸ªapkeg:$ adb -s 3080b82d install Test.apkSuccess</code></pre><h4 id="å®‰è£…-å¸è½½apk"><a href="#å®‰è£…-å¸è½½apk" class="headerlink" title="å®‰è£…,å¸è½½apk"></a>å®‰è£…,å¸è½½apk</h4><ul><li>å®‰è£…<pre><code class="shell">$ adb -s 3080b82d install Users/phyooos/develop/Test.apkSuccess</code></pre>install è·Ÿä¸Šapkçš„pathå³å¯</li></ul><p>install å¯ä»¥æ­é…å‡ ä¸ªå‚æ•°ä½¿ç”¨,æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯</p><p><code>install -r</code>   æ›¿æ¢æ‰åŸæ¥çš„apk.(è¢«ç§°ä¸ºå¼ºåˆ¶å®‰è£…)    è‡³äºå…¶ä»–çš„å‚æ•°å»googleå®˜ç½‘çœ‹å§</p><p><code>install -t</code>  å¯ä»¥å®‰è£…æµ‹è¯•åŒ…</p><ul><li>å¸è½½</li></ul><pre><code class="shell">adb uninstall [è½¯ä»¶åŒ…å]adb uninstall -k [è½¯ä»¶åŒ…å]</code></pre><p>-k å‚æ•°,å¸è½½è½¯ä»¶ä½†æ˜¯ä¿ç•™é…ç½®å’Œç¼“å­˜æ–‡ä»¶.</p><p>åŒ…åä½¿ç”¨æ–‡ç« å¼€å§‹çš„å‘½ä»¤æŸ¥æ‰¾å³å¯(å½“å‰æœ‰ä¸¤ä¸ªæ‰‹æœº,è¿˜è¦æŒ‡å®šè®¾å¤‡)</p><pre><code class="shell">$ adb -s 3080b82d shell pm list packages | grep &#39;miui&#39;package:com.miui.screenrecorderpackage:com.miui.contentextensionpackage:com.miui.powerkeeper...</code></pre><h4 id="æ‹‰å–-æ¨é€æ–‡ä»¶"><a href="#æ‹‰å–-æ¨é€æ–‡ä»¶" class="headerlink" title="æ‹‰å–,æ¨é€æ–‡ä»¶"></a>æ‹‰å–,æ¨é€æ–‡ä»¶</h4><ul><li>å‘é€æ–‡ä»¶åˆ°Androidè®¾å¤‡</li></ul><p>ã€€ã€€<code>adb push [æœ¬åœ°è·¯å¾„] [è¿œç¨‹è·¯å¾„]</code></p><ul><li>ä»Androidè®¾å¤‡ä¸­ä¸‹è½½æ–‡ä»¶</li></ul><p>ã€€ã€€<code>adb pull [è¿œç¨‹è·¯å¾„] [æœ¬åœ°è·¯å¾„]</code></p><h4 id="æˆªå›¾å½•å±"><a href="#æˆªå›¾å½•å±" class="headerlink" title="æˆªå›¾å½•å±"></a>æˆªå›¾å½•å±</h4><ul><li><p>æˆªå›¾<code>adb shell screencap [path]</code></p><pre><code>adb shell screencap /sdcard/screen.png#æˆªå›¾å¹¶ä¿å­˜åˆ°/sdcard/screen.png</code></pre></li><li><p>å½•å±<code>adb shell screenrecord [path]</code></p><pre><code>adb shell screenrecord /sdcard/demo.mp4#å½•å±</code></pre><p>æ³¨æ„:   æŒ‰Ctrl-C ç»“æŸå½•åˆ¶</p><pre><code>adb shell screenrecord --size &lt;WIDTHxHEIGHT&gt;adb shell screenrecord --bit-rate &lt;RATE&gt;adb shell screenrecord --bit-rate 5000000 /sdcard/demo.mp4adb shell screenrecord --time-limit &lt;TIME&gt;adb shell screenrecord --rotateadb shell screenrecord --verbose</code></pre></li></ul><h4 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h4><ul><li><p>æŸ¥çœ‹ç³»ç»Ÿå†…appä¿¡æ¯  <code>adb shell pm list packages</code></p><ul><li><p>æŸ¥çœ‹å½“å‰æ‰€æœ‰åŒ…</p><p><code>adb shell pm list packages</code></p><pre><code class="shell">$ adb shell pm list packagespackage:com.flyme.roamingpaypackage:com.android.cts.priv.ctsshimpackage:com.meizu.ppspackage:com.meizu.net.pedometerpackage:com.android.providers.telephony</code></pre></li><li><p>ç³»ç»Ÿåº”ç”¨</p><p><code>adb shell pm list packages -s</code></p><pre><code class="shell">$ adb shell pm list packages -spackage:com.miui.screenrecorderpackage:com.android.cts.priv.ctsshimpackage:com.qualcomm.qti.auth.sampleextauthservicepackage:com.qualcomm.qti.perfdump...</code></pre></li><li><p>æ™®é€šå¤–æ¥åº”ç”¨</p><p><code>adb shell pm list packages -3</code></p><pre><code class="shell">$ adb shell pm list packages -3package:com.google.android.youtubepackage:com.hpbr.bosszhipinpackage:de.blinkt.openvpnpackage:org.iggymedia.periodtrackerpackage:com.daimajia.gold</code></pre></li><li><p>å…¶ä»–å‚æ•°</p><pre><code class="shell">#See their associated file.adb shell pm list packages -f #Filter to only show disabled packages.adb shell pm list packages -d #Filter to only show enabled packages.adb shell pm list packages -e #See the installer for the packages.adb shell pm list packages -i #Also include uninstalled packages.adb shell pm list packages -u</code></pre></li></ul></li><li><p>é€šè¿‡åŒ…åæŸ¥æ‰¾appä½ç½® <code>adb shell pm path [packagename]</code></p><pre><code>$ adb shell pm path com.miui.screenrecorderpackage:/system/app/MiuiScreenRecorder/MiuiScreenRecorder.apk</code></pre></li><li><p>æ¸…é™¤ç¼“å­˜<code>adb shell pm clear  [packageName]</code></p><p>æ¸…é™¤äº†è¯¥appçš„  data  cache</p><pre><code>$ adb shell pm clear com.yhcs.carmartSuccess</code></pre></li></ul><h4 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h4><p>æˆ‘ä»¬çŸ¥é“androidå…¶å®ç²¾ç®€äº†linuxçš„å‘½ä»¤,æœ‰ä¸€å¤§éƒ¨åˆ†linuxå‘½ä»¤æ²¡æ³•ç”¨çš„</p><pre><code class="shell">$ adb shell#å³å¯è¿›å…¥å¦‚æœè¦rootæƒé™,å›½å†…æ‰‹æœºå¥½åƒä¸ä¸€è‡´,æˆ‘æ˜¯ç”¨è¿‡çš„ä¸º$ adb root$ adb shellæ­¤æ—¶æƒé™å°±æ˜¯rootè¿›å…¥shellå,å°±å¯ä»¥ä¸ºæ‰€æ¬²ä¸º,ä¸€èˆ¬å’Œlinuxä¸€è‡´</code></pre><p>ä¸è¿‡è¿™äº›,è¿˜æ˜¯ç®¡ç”¨çš„</p><pre><code>ls , cd , rm , mkdir , touch , pwd ,cp , mv ,netstat , ping, ip</code></pre><p>ä¸¾ä¸€ä¸ªä¾‹å­,æˆ‘æƒ³æŸ¥çœ‹å½“å‰wifiçš„ipæ˜¯å¤šå°‘.</p><pre><code class="shell">$ adb shellsagit:/ $ ip -f inet addr show wlan023: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 3000    inet 192.168.6.51/23 brd 192.168.7.255 scope global wlan0       valid_lft forever preferred_lft foreversagit:/ $#ip  inet 192.168.6.51  è¿™ä¸ªå°±æ˜¯</code></pre><h4 id="Logcat"><a href="#Logcat" class="headerlink" title="Logcat"></a>Logcat</h4><p><code>adb logcat [option] [filter]</code></p><ul><li><p>æŸ¥çœ‹log <code>adb logcat</code></p><p>é€šè¿‡  control + c  é€€å‡º</p></li></ul><ul><li>æŸ¥çœ‹Debugçš„log <code>adb logcat *:D</code></li></ul><p>Logcat,è¿˜æ˜¯Android studio çœ‹èµ·æ¥æ–¹ä¾¿,æ‰€ä»¥æ²¡æœ‰ç»§ç»­å»çœ‹,ä¹Ÿå°±ä¸è¯´äº†</p><h4 id="dumpsys"><a href="#dumpsys" class="headerlink" title="dumpsys"></a>dumpsys</h4><p>è¿™æ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„å‘½ä»¤</p><ul><li>ç”µé‡ <code>adb shell dumpsys battery</code></li></ul><ul><li><p>æœåŠ¡åˆ—è¡¨ <code>adb shell dumpsys</code></p><p>ä¸‹é¢çš„å‘½ä»¤  <code>| more</code> æ˜¯ä¸ºäº†æ˜¾ç¤ºæ‰€æœ‰çš„æ•°æ® </p><pre><code>$ adb shell dumpsys | moreCurrently running services:  DockObserver  MiuiBackup  MiuiInit  SurfaceFlinger  accessibility  account  activity  alarm  ...</code></pre><p>è¿™ä¸ªCurrently running services   æ‰€æœ‰çš„é¡¹ç›®,éƒ½å¯ä»¥è¯¦ç»†æŸ¥è¯¢</p></li><li><p>æŸ¥è¯¢å•ä¸ªservice  <code>adb shell dumpsys [service name]</code></p><p>æå‡ ä¸ªä¾‹å­çœ‹çœ‹:</p><ul><li>å±å¹•åˆ†è¾¨ç‡<code>adb shell dumpsys window displays</code></li></ul><pre><code>$ adb shell dumpsys window displaysWINDOW MANAGER DISPLAY CONTENTS (dumpsys window displays)  Display: mDisplayId=0    init=1080x1920 480dpi cur=1080x1920 app=1080x1920 rng=1080x1020-1920x1860    deferred=false mLayoutNeeded=false</code></pre><p>å…¶ä¸­:</p><p>init=1080x1920  åˆ†è¾¨ç‡</p><p>480dpi   dpiå€¼</p></li></ul><ul><li><p>activityä¿¡æ¯<code>adb shell dumpsys activity</code></p><p>æ¯”å¦‚æˆ‘æƒ³çœ‹çœ‹æˆ‘activityçš„ä¿¡æ¯<code>adb shell dumpsys activity | grep &#39;com.yhcs.carmart&#39;</code></p><pre><code>$ adb shell dumpsys activity | grep &quot;com.yhcs.carmart&quot;  * com.yhcs.carmart: 2 items    #0: PendingIntentRecord{c526be3 com.yhcs.carmart startService}    #1: PendingIntentRecord{8949e0 com.yhcs.carmart broadcastIntent}      -&gt; 8161:com.yhcs.carmart/u0a460 s1/1 u0/0 +44s372ms      -&gt; 8556:com.yhcs.carmart:channel/u0a460 s1/1 u0/0 +33s684ms      ...  * Recent #0: TaskRecord{6019b81 #14799 A=com.yhcs.carmart U=0 StackId=1 sz=1}   packageName=com.yhcs.carmart processName=com.yhcs.carmart   launchedFromUid=10460 launchedFromPackage=com.yhcs.carmart userId=0   app=ProcessRecord{3c52934 8161:com.yhcs.carmart/u0a460}   Intent { cmp=com.yhcs.carmart/.ui.main.MainActivity }   frontOfTask=true task=TaskRecord{6019b81 #14799 A=com.yhcs.carmart U=0 StackId=1 sz=1}   taskAffinity=com.yhcs.carmart   realActivity=com.yhcs.carmart/.ui.main.MainActivity</code></pre><p>ç°åœ¨æŒ‡å®šæŸ¥çœ‹è¿™ä¸ªactivity</p><pre><code>$ adb shell dumpsys activity com.yhcs.carmart/.ui.main.MainActivityTASK com.yhcs.carmart id=14799 userId=0  ACTIVITY com.yhcs.carmart/.ui.main.MainActivity a99200b pid=8161    Local Activity 90efa41 State:      mResumed=false mStopped=true mFinished=false      mChangingConfigurations=false      mCurrentConfig={1.0 460mcc11mnc [zh_CN] ldltr sw360dp w360dp h620dp 480dpi nrml long port finger -keyb/v/h -nav/h appBounds=Rect(0, 0 - 1080, 1920) s.12 themeChanged=0 themeChangedFlags=0}      ...View Hierarchy:      DecorView@ce71c9e[MainActivity]        android.widget.LinearLayout{6106377 V.E...... ......ID 0,0-1080,1920}      ...Active Fragments       ...</code></pre><p>é‡Œé¢æœ‰å¾ˆå¤šä¿¡æ¯</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OkHttpä¸­æ·»åŠ httpsæ”¯æŒ</title>
    <link href="undefined2018/01/10/OkHttp-support-https/"/>
    <url>2018/01/10/OkHttp-support-https/</url>
    
    <content type="html"><![CDATA[<p><strong>åŸºç¡€çŸ¥è¯†</strong></p><p>æ„Ÿè§‰å°±æ˜¯ä¸€å †æœ‰ä¿¡èª‰çš„æœºæ„,è¯´: æˆ‘ä»¬è¿™äº›æœºæ„çš„å…¬é’¥æ˜¯å¯ä¿¡çš„,æˆ‘ä»¬ä¸‹é¢çš„å°å¼Ÿå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥ä¿¡ä»»çš„å•¦</p><p>ç„¶åå¤§å®¶å°±å»å½“äººå®¶å°å¼Ÿ,å°±æ˜¯å¯ä¿¡çš„äº†â€¦.</p><p>å½“ç„¶è¿™é‡Œé¢æœ‰çš„å¤§ä½¬ä¸é«˜å…´,å°±è‡ªå·±æä¸€å¥—è¯ä¹¦,æ¯”å¦‚12306</p><a id="more"></a><p>Httpsä¸­,å€¼å¾—æ³¨æ„çš„å¯†é’¥æœ‰:</p><ul><li>æœåŠ¡å™¨ç«¯çš„<code>å…¬é’¥</code>å’Œ<code>ç§é’¥</code></li></ul><ul><li>å®¢æˆ·ç«¯çš„<code>éšæœºå¯†é’¥</code></li></ul><p>å€¼å¾—æ³¨æ„çš„æ˜¯ä¸€ä¸ªHTTPSè¯·æ±‚å®é™…ä¸Šå°±æ˜¯ä¸¤æ¬¡HTTPä¼ è¾“.</p><p>1.å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·HTTPSè¯·æ±‚ï¼Œè¿æ¥åˆ°æœåŠ¡å™¨çš„443ç«¯å£ã€‚</p><p>2.æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚,å‘å®¢æˆ·ç«¯å‘é€è‡ªå·±çš„<code>å…¬é’¥</code></p><p>3.å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨å…¬é’¥,å¼€å§‹éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§,æˆ‘ä»¬çŸ¥é“ç³»ç»Ÿå†…ç½®äº†ä¸€äº›è¯ä¹¦,åº”è¯¥æ˜¯å«é¡¶çº§è¯ä¹¦å§</p><p>æˆ‘ä»¬çš„è¯ä¹¦å¹¶ä¸æ˜¯å•¥å¤§æœºæ„å‘çš„,è‚¯å®šä¸åœ¨é‡Œé¢,é‚£ä¹ˆå°±æ²¡æ³•éªŒè¯åˆæ³•.</p><pre><code> åˆæ³• &gt; ç»§ç»­ ä¸åˆæ³• &gt; æ­¤æ¬¡Httpsè¯·æ±‚ç»ˆæ­¢</code></pre><p>4.å®¢æˆ·ç«¯éªŒè¯å…¬é’¥åˆæ ¼å(ä¹Ÿå°±æ˜¯ç»™ä½ å‘æ¶ˆæ¯çš„æœåŠ¡å™¨æ˜¯æ­£ç»æœåŠ¡å™¨)ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯ä¼šç”Ÿæˆä¸€ä¸ª éšæœºå¯†ç ,å®¢æˆ·ç«¯ä¼šæ‹¿ç€è¿™ä¸ªéšæœºå¯†ç å’Œåˆšæ‰æ”¶åˆ°çš„æœåŠ¡å™¨å¯†é’¥åšéå¯¹ç§°åŠ å¯† &gt;&gt; å¾—åˆ°å¯†æ–‡çš„å¯†ç </p><p>â€”â€”â€“ä»¥ä¸Šç¬¬ä¸€æ¬¡httpè¯·æ±‚ç»“æŸäº†â€”â€”â€“</p><p>5.å®¢æˆ·ç«¯ä¼šå‘èµ·HTTPSä¸­çš„ç¬¬äºŒä¸ªHTTPè¯·æ±‚,å‘é€å®¢æˆ·ç«¯å¯†é’¥(å¯†æ–‡)ç»™æœåŠ¡å™¨ã€‚</p><p>6.æœåŠ¡å™¨æ”¶åˆ°å¯†æ–‡ï¼Œä¼šç”¨è‡ªå·±çš„ç§é’¥å¯¹å…¶è¿›è¡Œéå¯¹ç§°è§£å¯†,å¾—åˆ°å®¢æˆ·ç«¯åˆšæ‰ç”Ÿæˆçš„å®¢æˆ·ç«¯éšæœºå¯†ç .</p><p>æ­¤æ—¶æœåŠ¡å™¨ä½¿ç”¨å®¢æˆ·ç«¯éšæœºå¯†ç ,å¯¹æ•°æ®è¿›è¡Œå¯¹ç§°åŠ å¯†</p><p>7.æŠŠå¯¹ç§°åŠ å¯†åçš„æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯,å®¢æˆ·ç«¯å¯¹ç§°è§£å¯†,OK    æ­¤æ¬¡Httpså®Œç¾ç»“æŸ</p><p>â€”â€”â€“æ•´ä¸ªhttpsè¯·æ±‚ç»“æŸäº†â€”â€”â€“</p><p>å…¶ä¸­ , <code>å¯¹ç§°åŠ å¯†</code>å’Œ<code>éå¯¹ç§°åŠ å¯†</code>,  å„å¸å…¶èŒ,å…±åŒå®Œæˆæ•´ä¸ªè¯·æ±‚.</p><p>  å¯¹ç§°åŠ å¯†: æœ€å¿«é€Ÿ,æœ€ç®€å•</p><p>  éå¯¹ç§°åŠ å¯†:é€Ÿåº¦æ…¢,å¾ˆå®‰å…¨,ä¸éœ€è¦æŠŠç§˜é’¥åˆ†å‘,å®¢æˆ·ç«¯åˆ©ç”¨å…¬é’¥åŠ å¯†çš„æ•°æ®,åªèƒ½æ˜¯æ‹¥æœ‰ç§˜é’¥çš„æœåŠ¡å™¨è§£å¯†</p><p>åˆ©ç”¨éå¯¹ç§°åŠ å¯†çš„ç‰¹æ€§ä¼ é€’  å®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºå¯†é’¥ ,è¾¾åˆ°åªæœ‰æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯äº’ç›¸çŸ¥é“çš„å¯†é’¥,ä»è€Œä½¿ç”¨å¯†é’¥è¿›è¡Œ(é«˜é€Ÿç®€å•çš„)å¯¹ç§°åŠ å¯†æ•°æ®.</p><p><strong>ç¬¬ä¸€éƒ¨åˆ†:ä¿¡ä»»æ‰€æœ‰</strong></p><p>è¿™å°±æ˜¯,æˆ‘ä¸ç®¡æ˜¯è°ä¼ é€’çš„æ¶ˆæ¯,ä¸æ˜¯ä½ å®¶æœåŠ¡å™¨ä¼ é€’çš„æ¶ˆæ¯,ä½ ä¹Ÿä¼šä¿¡</p><p><strong>Api.java</strong> (æä¾›okhttpå®ä¾‹,å¹¶åˆ›å»ºRetroitæœåŠ¡)</p><pre><code> OkHttpClient okHttpClient = new OkHttpClient.Builder()                .hostnameVerifier(new HostnameVerifier() {                    @Override                    public boolean verify(String hostname, SSLSession session) {                        return true;                    }                })                .sslSocketFactory(createSSLSocketFactory())                .build(); ... //è¿™é‡Œæ˜¯åˆ›å»ºä¸€ä¸ªSSLSocketFactory,æä¾›ç»™ä¸Šé¢çš„ .sslSocketFactory() private  SSLSocketFactory createSSLSocketFactory() {        SSLSocketFactory ssfFactory = null;        try {            SSLContext sc = SSLContext.getInstance(&quot;TLS&quot;);            sc.init(null, new TrustManager[]{new TrustAllCerts()}, new SecureRandom());            ssfFactory = sc.getSocketFactory();        } catch (Exception e) {        }        return ssfFactory;    }</code></pre><p>å…¶ä¸­æ¶‰åŠåˆ°<strong>TrustAllCerts.java</strong>,å¯ä»¥çœ‹åˆ°åªæ˜¯å®ç°X509TrustManager,æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯é»˜è®¤å®ç°</p><pre><code>/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/8 ä¸‹åˆ2:25 */public class TrustAllCerts implements X509TrustManager {    @Override    public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException {}    @Override    public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException {}    @Override    public X509Certificate[] getAcceptedIssuers() {        return new X509Certificate[0];    }}</code></pre><p>è¿™é‡Œå°±ä»¥åŠå¯ä»¥äº†,ä¿¡ä»»æ‰€æœ‰çš„è¿æ¥</p><hr><p><strong>ç¬¬äºŒéƒ¨åˆ†:(å¼ºéªŒè¯)</strong></p><p>æˆ‘åªä¿¡ä»»è¯ä¹¦åˆæ³•çš„æœåŠ¡å™¨ä¼ é€’çš„æ•°æ®.</p><ul><li>æŸ¥çœ‹Httpsçš„è¯ä¹¦</li></ul><p><img src="images/https_zhengshu.png" srcset="/img/loading.gif" alt="httpsè¯ä¹¦"></p><p>åœ¨æµè§ˆå™¨ä¸Šçœ‹åˆ°è¿™ä¸ª,è¿™ä¸ªå·²ç»æ˜¯æˆ‘æŠŠè¯ä¹¦æ·»åŠ ä¸ºä¿¡ä»»äº†,æ‰€ä»¥ä»–æ˜¯ä¸€ä¸ª <code>å®‰å…¨</code> çš„æ ‡å¿—</p><ul><li>åˆ†æ</li></ul><p><img src="images/https_root.png" srcset="/img/loading.gif" alt="httpsè¯ä¹¦"></p><p>è¿™é‡Œæ˜¯æˆ‘æŸ¥çœ‹å½“å‰ç½‘ç«™è¯ä¹¦çš„ç»“æ„</p><p>æœ€é¡¶â€”æ˜¯æ ¹è¯ä¹¦,åˆ°æœŸæ—¶é—´æ˜¯2028å¹´</p><p>æœ€åº•â€”æ˜¯æˆ‘å¸è¯ä¹¦,åˆ°æœŸæ—¶é—´æ˜¯2018.12.9æ—¥</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°,æˆ‘ä»¬ç½‘ç«™çš„è¯ä¹¦æ˜¯æœ‰æ—¶é—´é™åˆ¶çš„,é‚£ä¹ˆå°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜,åˆ°äº†2018.12.9è¿™ä¸€å¤©æ€ä¹ˆåŠ.</p><blockquote><p>æˆ‘ä¹Ÿä¸çŸ¥é“ä¼šæ€ä¹ˆæ ·,åº”è¯¥æ˜¯ç»­ç­¾å§!é‚£ä¹ˆä¸‡ä¸€è¿™ä¸ªè¯ä¹¦å˜åŒ–äº†æ€ä¹ˆåŠ?</p></blockquote><p>æ‰€ä»¥,æˆ‘ä»¬åº”è¯¥æŠŠæ ¹è¯ä¹¦ç½®ä¸ºä¿¡ä»».</p><ul><li>ä¸‹è½½ä¿å­˜</li></ul><p><img src="images/https_save.png" srcset="/img/loading.gif" alt="httpsè¯ä¹¦"></p><p>Macçš„åœ¨  é’¥åŒ™ä¸²è®¿é—®  ä¸­</p><p>Windows æ²¡æ³•æ”¾å›¾,åœ¨chromeä¸ŠæŸ¥çœ‹è¯ä¹¦çš„æ—¶å€™åº”è¯¥å°±èƒ½ä¿å­˜.</p><p><strong>HttpsUtils.java </strong></p><pre><code>/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/10 ä¸‹åˆ5:07 * æ”¯æŒhttpsçš„å·¥å…·ç±» */public class HttpsUtils {    private static final String TAG = &quot;OkHttp&quot;;    /**     * åˆ›å»ºä¸€ä¸ªç©ºç™½çš„KeyStore     * @return KeyStore     * @throws GeneralSecurityException     */    private static KeyStore createEmptyKeyStore() throws GeneralSecurityException {        try {            KeyStore keystore = KeyStore.getInstance(KeyStore.getDefaultType());            //æ­¤å¤„å¯†ç éšæ„,ä¸ä¼šäº§ç”Ÿé—®é¢˜            keystore.load(null, &quot;password&quot;.toCharArray());            return keystore;        } catch (IOException e) {            return null;        }    }    /**     * TrustManager  ç”Ÿæˆ     * @return     * @throws GeneralSecurityException     */    private static TrustManager[] generateTrustManager() throws GeneralSecurityException {        //åˆ›å»ºä¸€ä¸ªX.509æ ¼å¼çš„CertificateFactory        CertificateFactory certificateFactory = CertificateFactory.getInstance(&quot;X.509&quot;);        Certificate ca;        //è¯ä¹¦å·¥å‚æ ¹æ®è¯ä¹¦æ–‡ä»¶çš„æµç”Ÿæˆè¯ä¹¦Certificate        InputStream assets = App.getContext().getResources().openRawResource(R.raw.rootca);        ca = certificateFactory.generateCertificate(assets);        Log.e(TAG, &quot;trustManager: ca = &quot; + ((X509Certificate) ca).getSubjectDN() );        //åˆ›å»ºKeyStoreï¼Œç”¨æ¥å­˜å‚¨ä¿¡ä»»è¯ä¹¦        KeyStore keyStor = createEmptyKeyStore();        keyStor.setCertificateEntry(&quot;ca&quot;,ca);        //åˆ›å»ºä¸€ä¸ªé»˜è®¤ç±»å‹çš„TrustManagerFactory        String defaultAlgorithm = TrustManagerFactory.getDefaultAlgorithm();        TrustManagerFactory tmf = TrustManagerFactory.getInstance(defaultAlgorithm);        //ç”¨keyStoreå®ä¾‹åˆå§‹åŒ–TrustManagerFactory,æ­¤æ—¶TrustManagerFactoryä¼šä¿¡ä»»æˆ‘ä»¬ä¿å­˜çš„è¯ä¹¦        tmf.init(keyStor);        //é€šè¿‡tmfè·å–TrustManageræ•°ç»„ï¼ŒTrustManagerä¹Ÿä¼šä¿¡ä»»keyStorä¸­çš„è¯ä¹¦        return tmf.getTrustManagers();    }    /**     * æä¾›ä¸€ä¸ªä¸€ä¸ªSSLSocketFactory     * @return SSLSocketFactoryå®ä¾‹     */    public static SSLSocketFactory generateSSLSocketFactory()  {        try {            SSLContext sc = SSLContext.getInstance(&quot;TLS&quot;);            sc.init(null, generateTrustManager(), new SecureRandom());            Log.e(TAG, &quot;generateSSLSocketFactory &quot;);            return sc.getSocketFactory();        } catch (GeneralSecurityException e) {            return null;        }    }}</code></pre><p>æ³¨é‡Šå¾ˆæ¸…æ¥šäº†.</p><p><strong>å…³é”®:</strong></p><p>1.æ‹¿åˆ°å¸§æ•°çš„æµ</p><pre><code>InputStream assets = App.getContext().getResources().openRawResource(R.raw.rootca);</code></pre><p>2.ä¿å­˜åˆ°keystore</p><pre><code>KeyStore keyStor = createEmptyKeyStore();keyStor.setCertificateEntry(&quot;ca&quot;,ca);</code></pre><p>3.åˆå§‹åŒ–å¹¶æ‹¿åˆ°TrustManager[]</p><pre><code>tmf.init(keyStor);tmf.getTrustManagers()</code></pre><p><strong>ä½¿ç”¨å³å¯:</strong></p><pre><code>//è¿™æ ·å°±OkOkHttpClient okHttpClient = new OkHttpClient.Builder()                .hostnameVerifier((hostname, session) -&gt; true)                .sslSocketFactory(HttpsUtils.generateSSLSocketFactory())                .build();</code></pre><blockquote><p>è¶…å¥½çš„ä¸¤ç¯‡</p><p><a href="http://blog.csdn.net/lmj623565791/article/details/48129405" target="_blank" rel="noopener">http://blog.csdn.net/lmj623565791/article/details/48129405</a></p><p><a href="http://blog.csdn.net/iispring/article/details/51615631" target="_blank" rel="noopener">http://blog.csdn.net/iispring/article/details/51615631</a></p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebViewæ’­æ”¾H5è§†å±æ²¡æœ‰ç”»é¢,åªæœ‰å£°éŸ³</title>
    <link href="undefined2018/01/04/webview-video-without-image/"/>
    <url>2018/01/04/webview-video-without-image/</url>
    
    <content type="html"><![CDATA[<p><strong>æè¿°:ç‚¹å‡»æ’­æ”¾æŒ‰é’®å,åªèƒ½å¬åˆ°å£°éŸ³,è€Œç”»é¢æ˜¯ç™½çš„â€¦.ä¸€ç›´ç™½â€¦æƒ³åˆ°åº”è¯¥æ˜¯ç¡¬ä»¶åŠ é€Ÿçš„é—®é¢˜</strong></p><p><strong>1.ç¡®è®¤ç¡¬ä»¶åŠ é€Ÿ(éæ­¤å› ç´ )</strong></p><p>åœ¨WebViewActivity.javaä¸­å‘ç°</p><pre><code>webView.setLayerType(View.LAYER_TYPE_HARDWARE, null);</code></pre><p><strong>2.ç¡®è®¤AndroidManifest.xml(éæ­¤å› ç´ )</strong></p><p>applicationèŠ‚ç‚¹ä¸‹å¹¶æ²¡æœ‰å‘ç°</p><pre><code>android:hardwareAccelerated=&quot;true&quot;</code></pre><p>åœ¨WebViewActivityä¸­,ä¹Ÿæ— è¯¥é…ç½®</p><ul><li>å°è¯•: WebViewActivity.javaä¸­,æ³¨é‡Š</li></ul><pre><code>#webView.setLayerType(View.LAYER_TYPE_HARDWARE, null);</code></pre><p>åœ¨AndroidManifest.xmlèŠ‚ç‚¹ä¸‹åŠ å…¥<code>android:hardwareAccelerated=&quot;true&quot;</code></p><ul><li>ç»“æœâ€¦â€¦æ²¡ç”¨</li></ul><p><strong>3.æ£€æŸ¥activity_web_view.xml</strong></p><pre><code class="xml">        &lt;WebView            android:id=&quot;@+id/webView&quot;            android:layout_width=&quot;match_parent&quot;            android:layout_height=&quot;match_parent&quot;            android:scrollbars=&quot;none&quot;            android:visibility=&quot;@{showError?View.GONE:View.VISIBLE}&quot; /&gt;</code></pre><p>æ²¡é—®é¢˜.</p><p>BUTâ€¦.</p><pre><code class="xml">&lt;LinearLayout    android:layerType=&quot;software&quot;    android:layout_width=&quot;match_parent&quot;    android:layout_height=&quot;match_parent&quot;    android:orientation=&quot;vertical&quot;&gt;    &lt;include layout=&quot;@layout/layout_toolbar&quot; /&gt;    &lt;ProgressBar        android:id=&quot;@+id/web_load_progress&quot;        style=&quot;?android:attr/progressBarStyleHorizontal&quot;        android:layout_width=&quot;match_parent&quot;        android:layout_height=&quot;2dp&quot;        android:indeterminateOnly=&quot;false&quot;        android:max=&quot;100&quot;        android:progress=&quot;@{progress}&quot;        android:progressDrawable=&quot;@drawable/progress_bar_states&quot;        android:visibility=&quot;gone&quot; /&gt;    &lt;WebView        android:id=&quot;@+id/webView&quot;        android:layout_width=&quot;match_parent&quot;        android:layout_height=&quot;match_parent&quot;        android:scrollbars=&quot;none&quot;        android:visibility=&quot;@{showError?View.GONE:View.VISIBLE}&quot; /&gt;&lt;/LinearLayout&gt;</code></pre><p>####çˆ¶å¸ƒå±€ç«Ÿç„¶<code>android:layerType=&quot;software&quot;</code></p><ul><li>è§£å†³,åˆ æ‰è¯¥å±æ€§å³å¯</li></ul>]]></content>
    
    
    <categories>
      
      <category>Bug</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Bug</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Roomä¸­List&lt;&gt;ä½¿ç”¨è¯¦è§£</title>
    <link href="undefined2018/01/03/room-list/"/>
    <url>2018/01/03/room-list/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æ‰‹æ‘¸æ‰‹æ•™ä½ åœ¨Roomä¸­ä½¿ç”¨List<object>.</object></p></blockquote><p>å®é™…é¡¹ç›®æœ‰å¾ˆå¤šè¿™æ ·çš„ç»“æ„:</p><pre><code>{  &quot;id&quot;: &quot;001&quot;,  &quot;name&quot;: &quot;ç‹è¯›é­”&quot;,  &quot;age&quot;: 2018,  &quot;books&quot;: [    {      &quot;bookId&quot;: 10081,      &quot;userId&quot;: 1,      &quot;book&quot;: &quot;æ–­ç½ªå°å­¦&quot;,      &quot;desc&quot;: &quot;æ¼«ç”»è®²è¿°äº†ææ€ç¥ã€ç‹è¯›é­”å’Œåˆ˜æ–©ä»™ä¸‰ä½å°‘å¹´ï¼Œä¸ºäº†åä¸‡å°å­¦ç”Ÿçš„æœªæ¥ã€ä¸ºäº†æ”¹å˜è¢«è¯…å’’çš„å‘½è¿ï¼Œç›¸èšåœ¨ç‹¼ç‰™åŒºé£è™è·¯ç§ç«‹æ–­ç½ªå°å­¦ï¼Œèª“æ­»æ‰“è´¥å››å¹´çº§çš„é­”ç¥èµµæ—¥å¤©çš„æ•…äº‹ã€‚&quot;    },    {      &quot;bookId&quot;: 10088,      &quot;userId&quot;: 1,      &quot;book&quot;: &quot;ç‹‚éœ¸å¤©ä¸‹ä¹‹æ–­ç½ªå­¦å›­&quot;,      &quot;desc&quot;: &quot;ã€Šç‹‚éœ¸å¤©ä¸‹ä¹‹æ–­ç½ªå­¦å›­ã€‹ï¼Œåæ¥å› ä¸ºåå­—å¤ªé•¿ï¼Œè€Œä¸”â€œå­¦å›­â€å’Œâ€œå­¦é™¢â€å®¹æ˜“æ··æ·†çš„åŸå› è€Œæ”¹åã€‚&quot;    }  ]}</code></pre><a id="more"></a><p>ä¹Ÿå°±æ˜¯,ç±»ä¼¼booksè¿™æ ·çš„,List<object>ä½œä¸ºä¸€ä¸ªå…ƒç´ å­˜åœ¨.</object></p><blockquote><p>ä¸‹é¢å°±ä»¥ä¸Šé¢çš„ç»“æ„ä¸ºä¾‹,åšä¸€ä¸ªç®€å•çš„æ¼”ç¤º,æŒ‰ç…§æœ€ç®€ç­”çš„æ–¹æ³•å®ç°.</p></blockquote><p><strong>1.æ·»åŠ ä¾èµ–</strong></p><p><a href="https://developer.android.google.cn/topic/libraries/architecture/adding-components.html" target="_blank" rel="noopener">https://developer.android.google.cn/topic/libraries/architecture/adding-components.html</a></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯,å¦‚æœä½ åœ¨kotlinä¸­ä½¿ç”¨</p><pre><code class="java">apply plugin: &#39;kotlin-kapt&#39;...dependencies{  ...      //è¿™ä¸ªæ— æ³•ç”Ÿæˆä»£ç ,è¦ç”¨ä¸‹é¢çš„é‚£ä¸€æ¡,ä¸è¦ç–å¿½å¿˜æ‰äº†.    //annotationProcessor &quot;android.arch.persistence.room:compiler:1.0.0&quot;    kapt &quot;android.arch.persistence.room:compiler:1.0.0&quot;}</code></pre><p>ä¸€å®šè®°å¾—ä½¿ç”¨kapt,è¦ä¸ç„¶å°±ä¼šé‡åˆ°è¿™ä¸ªBUG.</p><p><strong>2.åˆ›å»ºè¡¨</strong></p><ul><li><p>User.javaè¡¨</p><pre><code class="java">/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/3 ä¸‹åˆ1:31 */@Entity(tableName = &quot;users&quot;)public class User {    @PrimaryKey    public int id;    public String name;    public int age;}</code></pre><p>@Entity ä¸­æŒ‡å®šäº†è¡¨å</p><p>@PrimaryKey ä¸»é”®</p><p>è¿™å¼ è¡¨users ç”¨äºä¿å­˜ç”¨æˆ·æ•°æ®</p></li></ul><ul><li><p>Book.javaè¡¨</p><pre><code class="java">/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/3 ä¸‹åˆ1:30 */@Entity(foreignKeys = {        @ForeignKey(                entity = User.class,                parentColumns ={&quot;id&quot;},                childColumns = {&quot;userId&quot;})},tableName = &quot;books&quot;)public class Book {    @PrimaryKey    public int bookId;    public int userId;//åŒUser.javaä¸­çš„id    public String book;    public String desc;}</code></pre><p>@Entity ä¸­</p><ul><li>foreignKeys = {} ä¸­å¤–é”®,å¯ä»¥æ˜¯å¤šä¸ª,è¿™é‡Œåªå…³è”äº†Userè¡¨</li><li>tableName = â€œbooksâ€ æŒ‡å®šäº†è¡¨å</li></ul><p>@PrimaryKey è¯¥è¡¨ä¸»é”®</p></li></ul><ul><li><p>UserAndBook.javaè¡¨ â€”-UserAndBookåªæ˜¯è¾…åŠ©,ä¸ä½œä¸ºä¸€å¼ è¡¨å­˜åœ¨.</p><pre><code class="Java">/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/3 ä¸‹åˆ1:43 */public class UserAndBook {    @Embedded   //è¯·çœ‹ä¹‹å‰çš„æ–‡ç« ,è¿™æ˜¯æŒ‡æŠŠUserä¸­æ‰€æœ‰å…ƒç´ å¸¦å…¥åˆ°è¿™é‡Œä½œä¸ºå…ƒç´ å­˜åœ¨    public User userEntity;      //@Relation    @Relation(parentColumn = &quot;id&quot;,entityColumn = &quot;userId&quot;,entity = Book.class)    public List&lt;Book&gt; books;}</code></pre><p>@Embedded   è¯·çœ‹å¦ä¸€ç¯‡,æœ‰è§£é‡Š</p></li></ul><p>  @Relation <a href="https://developer.android.google.cn/reference/android/arch/persistence/room/Relation.html" target="_blank" rel="noopener"> ç‚¹è¿™é‡Œå»çœ‹å®˜æ–¹æ–‡æ¡£  </a></p><blockquote><p>A convenience annotation which can be used in a Pojo to automatically fetch relation entities. When the Pojo is returned from a query, all of its relations are also fetched by Room.</p></blockquote><p>  ä¸ªäººä»¥ä¸ºå°±æ˜¯ä¸€æ³¨è§£,æŒ‡æ˜å…³ç³»,å¯ä»¥æŠŠå®ä½“å…³è”èµ·æ¥,ç„¶åè‡ªåŠ¨ç»„è£…èµ·æ¥.   </p><p>  å¹¶ä¸”åœ¨æ–‡æ¡£ä¸­è¿˜å±•ç¤ºäº†ä¸€ç§é«˜ç«¯çš„åŠŸèƒ½,ç”¨ä¸Šé¢åšä¾‹</p><pre><code class="java">  //@Relation      @Relation(parentColumn = &quot;id&quot;,entityColumn = &quot;userId&quot;,                entity = Book.class ,projection = {&quot;book&quot;})      public List&lt;String&gt; bookNames;</code></pre><p>  è§£é‡Šä¸€ä¸‹,projectionæŒ‡å®šäº†è¦å–å‡ºçš„å€¼,å½“å‰æŒ‡æ˜è¦åœ¨ booksè¡¨ä¸­å¯»æ‰¾ç¬¦åˆæ¡ä»¶parentColumn = â€œidâ€,entityColumn = â€œuserIdâ€   çš„é¡¹,æ‰¾åˆ°ä¹‹åä¼šæ‹¿åˆ°bookè¿™ä¸ªå€¼å¹¶è¿”å›.</p><p><strong>3.Daoå®ç°</strong></p><pre><code class="java">/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2018/1/3 ä¸‹åˆ4:20 */@Daopublic abstract class UserAndBookDao {    @Insert(onConflict = OnConflictStrategy.REPLACE)    public abstract void insert(User user);    @Insert(onConflict = OnConflictStrategy.REPLACE)    public abstract void insert(List&lt;Book&gt; books);    @Transaction    public void insert(UserAndBook userAndBook){        insert(userAndBook.userEntity);        insert(userAndBook.books);    }    @Query(&quot;SELECT * FROM users&quot;)    public abstract List&lt;UserAndBook&gt; getAll();}</code></pre><p><code>insert(User user);</code>  ,<code>insert(List&lt;Book&gt; books);</code></p><p>ä¸¤ä¸ªæ–¹æ³•,ä¹Ÿå¯ä»¥ç§æœ‰åŒ–,åªå¯¹å¤–æä¾›<code>insert(UserAndBook userAndBook)</code></p><p>æœ€è¿‘æ¢å…¬å¸é¡¹ç›®çš„æ•°æ®åº“,ç”¨sql,çœŸçš„æœ‰æ„æ€,å¯ä»¥å¾ˆæ–¹ä¾¿çš„å®ç°å¾ˆå¤šåŠŸèƒ½</p><p><strong>4.å»ºç«‹æ•°æ®åº“</strong></p><pre><code class="java">/** * If you have any questions, you can contact by email { wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/24 ä¸Šåˆ10:13 * æ•°æ®åº“ */@Database(entities = {Book.class, User.class},           version = 1, exportSchema = false)public abstract class AppDB extends RoomDatabase {    private static final String TAG = &quot;AppDB&quot;;    /**     * æ•°æ®åº“å®ä¾‹     */    private static AppDB sInstance;    private static String DATABASE_NAME = &quot;developer.db&quot;;    private ObservableBoolean mIsDatabaseCreated = new ObservableBoolean(false);    public abstract UserAndBookDao userbook();    /**     * å•ä¾‹     * @param context     * @return     */    public static AppDB getInstance(Context context) {        if (sInstance == null) {            synchronized (AppDB.class) {                if (sInstance == null) {                    sInstance = buildDatabase(context);                    sInstance.updateDatabaseCreated(context);                }            }        }        return sInstance;    }    /**     * Build the database.     * creates a new instance of the database.     */    private static AppDB buildDatabase(Context appContext) {         AppDB appDB = Room.databaseBuilder(appContext, AppDB.class, DATABASE_NAME)                .addCallback(new Callback() {                    @Override                    public void onCreate(@NonNull SupportSQLiteDatabase db) {                        super.onCreate(db);                        AppDB database = AppDB.getInstance(appContext);                        database.setDatabaseCreated();                    }                    @Override                    public void onOpen(@NonNull SupportSQLiteDatabase db) {                        super.onOpen(db);                        Log.e(TAG, &quot;onOpen: &quot; + db.getPath());                    }                }).build();        return appDB;    }    /**     * Check whether the database already exists and expose it via      */    private void updateDatabaseCreated(final Context context) {        if (context.getDatabasePath(DATABASE_NAME).exists()) {            setDatabaseCreated();        }    }    private void setDatabaseCreated() {        mIsDatabaseCreated.set(true);    }    public ObservableBoolean getDatabaseCreated() {        return mIsDatabaseCreated;    }}</code></pre><p>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨,åœ¨Applicationä¸­æ·»åŠ äº†</p><pre><code class="java">public static AppDB getDatabase() {    return AppDB.getInstance(context);}</code></pre><p><strong>5.ä½¿ç”¨</strong></p><p>è¿™é‡Œçš„ä½¿ç”¨æ–¹å¼,ä¸å»ºè®®ä½¿ç”¨,å¤ªç²—æš´äº†.</p><p>å¯ä»¥å­¦å­¦Demo,Googleå‡ºçš„<a href="https://github.com/googlesamples/android-architecture-components" target="_blank" rel="noopener">googlesamples/android-architecture-components</a></p><pre><code class="java">class RoomActivity : BindingActivity&lt;ActivityRoomBinding, RoomViewModel&gt;() {    val gson = Gson()    override fun getBundle(extras: Bundle) {    }    override fun layoutID(): Int = R.layout.activity_room    override fun initViews(savedInstanceState: Bundle?) {        //ç‚¹å‡»äº‹ä»¶  ADDæŒ‰é’®,æ·»åŠ æ•°æ®åˆ°æ•°æ®åº“        mBindingView.button.setOnClickListener({            val userBook = UserAndBook()            val jsonStr = FileUtils.getJson(this, &quot;data.txt&quot;)            val objectJson = JsonParser().parse(jsonStr).asJsonObject            //è·å–ç”¨æˆ·            val user = objectJson.get(&quot;user&quot;)            userBook.userEntity = gson.fromJson&lt;User&gt;(user, User::class.java)            //ä¿å­˜ç”¨æˆ·            Observable                .empty&lt;Any&gt;()                .observeOn(Schedulers.io())                .subscribe(object : EmptyObserver&lt;Any?&gt;() {                    override fun onComplete() {                        App.getDatabase().userbook().insert(userBook.userEntity)                    }                })            //è·å–ä¹¦ç±            val books = objectJson.get(&quot;books&quot;)            userBook.books = gson.fromJson&lt;ArrayList&lt;Book&gt;&gt;                                (books, object : TypeToken&lt;List&lt;Book&gt;&gt;() {}.type)            //ä¿å­˜ä¹¦ç±            Observable                .empty&lt;Any&gt;()                .observeOn(Schedulers.io())                .subscribe(object : EmptyObserver&lt;Any?&gt;() {                        override fun onComplete() {                        App.getDatabase().userbook().insert(userBook.books)                    }                })        })        //ç‚¹å‡»äº‹ä»¶,æŒ‰é’®QUERY   æŸ¥è¯¢æ•°æ®        mBindingView.button2.setOnClickListener {            Flowable.create(FlowableOnSubscribe&lt;List&lt;UserAndBook&gt;&gt; { e -&gt;                val userBook = App.getDatabase().userbook().all                e.onNext(userBook)                e.onComplete()            }, BackpressureStrategy.DROP)                    .compose(DatabaseTransformer())                    .subscribe(object : DatabaseSubscriber&lt;List&lt;UserAndBook&gt;&gt;() {                        override fun onNext(userAndBooks: List&lt;UserAndBook&gt;) {                            mBindingView.data = userAndBooks[0]                        }                    })        }    }}</code></pre><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;layout    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;    &lt;data&gt;        &lt;import type=&quot;com.wangzhumo.app.data.UserAndBook&quot;/&gt;        &lt;import type=&quot;com.wangzhumo.app.data.User&quot;/&gt;        &lt;import type=&quot;com.wangzhumo.app.data.Book&quot;/&gt;        &lt;variable            name=&quot;data&quot;            type=&quot;com.wangzhumo.app.data.UserAndBook&quot;/&gt;    &lt;/data&gt;    &lt;RelativeLayout        android:layout_width=&quot;match_parent&quot;        android:layout_height=&quot;match_parent&quot;&gt;        &lt;Button            android:id=&quot;@+id/button&quot;            android:layout_width=&quot;wrap_content&quot;            android:layout_height=&quot;wrap_content&quot;            android:layout_alignParentLeft=&quot;true&quot;            android:layout_alignParentStart=&quot;true&quot;            android:layout_alignParentTop=&quot;true&quot;            android:layout_marginLeft=&quot;57dp&quot;            android:layout_marginStart=&quot;57dp&quot;            android:layout_marginTop=&quot;125dp&quot;            android:text=&quot;Add&quot; /&gt;        &lt;Button            android:id=&quot;@+id/button2&quot;            android:layout_width=&quot;wrap_content&quot;            android:layout_height=&quot;wrap_content&quot;            android:layout_alignBaseline=&quot;@+id/button&quot;            android:layout_alignBottom=&quot;@+id/button&quot;            android:layout_alignParentEnd=&quot;true&quot;            android:layout_alignParentRight=&quot;true&quot;            android:layout_marginEnd=&quot;56dp&quot;            android:layout_marginRight=&quot;56dp&quot;            android:text=&quot;Query&quot; /&gt;        &lt;RelativeLayout            android:layout_width=&quot;match_parent&quot;            android:layout_height=&quot;match_parent&quot;            android:layout_alignParentLeft=&quot;true&quot;            android:layout_alignParentStart=&quot;true&quot;            android:layout_below=&quot;@+id/button&quot;            android:layout_marginTop=&quot;68dp&quot;&gt;            &lt;TextView                android:id=&quot;@+id/textView&quot;                android:layout_width=&quot;wrap_content&quot;                android:layout_height=&quot;wrap_content&quot;                android:layout_alignParentLeft=&quot;true&quot;                android:layout_alignParentStart=&quot;true&quot;                android:layout_alignParentTop=&quot;true&quot;                android:layout_marginLeft=&quot;36dp&quot;                android:layout_marginStart=&quot;36dp&quot;                android:layout_marginTop=&quot;32dp&quot;                android:text=&quot;@{data.userEntity.name}&quot; /&gt;            &lt;TextView                android:id=&quot;@+id/textView2&quot;                android:layout_width=&quot;wrap_content&quot;                android:layout_height=&quot;wrap_content&quot;                android:layout_alignLeft=&quot;@+id/textView&quot;                android:layout_alignStart=&quot;@+id/textView&quot;                android:layout_below=&quot;@+id/textView&quot;                android:layout_marginTop=&quot;41dp&quot;                android:text=&quot;@{data.books.get(0).book}&quot; /&gt;            &lt;TextView                android:id=&quot;@+id/textView3&quot;                android:layout_width=&quot;wrap_content&quot;                android:layout_height=&quot;wrap_content&quot;                android:layout_alignLeft=&quot;@+id/textView2&quot;                android:layout_alignStart=&quot;@+id/textView2&quot;                android:layout_centerVertical=&quot;true&quot;                android:text=&quot;@{data.books.get(0).desc}&quot; /&gt;        &lt;/RelativeLayout&gt;    &lt;/RelativeLayout&gt;&lt;/layout&gt;</code></pre><p><img src="images/room_shot.png" srcset="/img/loading.gif" alt="å¦‚å›¾"></p><p>â€‹    </p><p>â€‹     </p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Room</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidå­—ä½“ä¸è·Ÿéšç³»ç»Ÿå˜åŒ–</title>
    <link href="undefined2017/12/28/Android-Font-Size/"/>
    <url>2017/12/28/Android-Font-Size/</url>
    
    <content type="html"><![CDATA[<p>å·²çŸ¥çš„æ–¹æ³•æœ‰ä¸¤ç§:</p><p><strong>ç¬¬ä¸€ç§</strong></p><p>ä¸ä½¿ç”¨sp è€Œä½¿ç”¨ dp</p><p><strong>ç¬¬äºŒç§</strong></p><p>åœ¨Applicationä¸­åŠ å…¥</p><pre><code>@Overridepublic void onConfigurationChanged(Configuration newConfig) {    if (newConfig.fontScale != 1)        getResources();    super.onConfigurationChanged(newConfig);}@Overridepublic Resources getResources() {     Resources res = super.getResources();     if (res.getConfiguration().fontScale != 1) {        Configuration newConfig = new Configuration();        newConfig.setToDefaults();        res.updateConfiguration(newConfig, res.getDisplayMetrics());      }     return res;}</code></pre>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Apk Install çš„å„ç§é—®é¢˜</title>
    <link href="undefined2017/12/28/Apk-Install-Error/"/>
    <url>2017/12/28/Apk-Install-Error/</url>
    
    <content type="html"><![CDATA[<p><strong>[INSTALL_FAILED_TEST_ONLY: installPackageLI]</strong></p><ul><li><p>æ–¹æ³•1ï¼š<br>AndroidManifest.xml åŠ å…¥android:testOnly=â€falseâ€ã€‚</p></li><li><p>æ–¹æ³•2ï¼š<br>adb install -t *.apk</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Bug</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Bug</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android StudioæŠ¥é”™Error Running app: cannot debug application</title>
    <link href="undefined2017/12/26/Android-Studio-Error-Running-app-cannot-debug-application/"/>
    <url>2017/12/26/Android-Studio-Error-Running-app-cannot-debug-application/</url>
    
    <content type="html"><![CDATA[<p>Android StudioæŠ¥é”™Error Running app: cannot debug application</p><a id="more"></a><p>è¿™é‡Œæœ‰ä¸€ä½ä»å…„å¸®å¿™ç¿»è¯‘äº†.</p><blockquote><p><a href="http://blog.csdn.net/yishichangan1/article/details/77451486" target="_blank" rel="noopener">http://blog.csdn.net/yishichangan1/article/details/77451486</a></p></blockquote><pre><code>Cannot debug application xx.xxx.xxx.app on device lge_nexus_5x(æ­¤å¤„è¡¨ç¤ºä½ çš„æ‰‹æœºå‹å·).ä½ çš„xxxappä¸èƒ½åœ¨å‹å·ä¸ºNexus 5xçš„LGEæ‰‹æœºä¸Šè°ƒè¯•ã€‚This application does not have the debuggable attribute enabled in its manifest.è¿™ä¸ªé¡¹ç›®åœ¨æ¸…å•æ–‡ä»¶ï¼ˆAndroidManifest.xmlï¼‰ä¸­æ²¡æœ‰è®¾ç½®å¯ä»¥è°ƒè¯•çš„å‚æ•°ã€‚If you have manually set it in the manifest, then remove it and let the IDE automatically assign it.å¦‚æœä½ å·²ç»æ‰‹åŠ¨åœ¨æ¸…å•æ–‡ä»¶ç§è®¾ç½®äº†è¿™ä¸ªå±æ€§ï¼Œè¯·removeæ‰ï¼Œè®©IDEè‡ªåŠ¨ç”Ÿæˆã€‚If you are using Gradle, make sure that your current variant is debuggable.å¦‚æœä½ ä½¿ç”¨Gradleï¼Œç¡®è®¤ä½ ç°åœ¨çš„å˜ä½“æ˜¯å¯è°ƒè¯•çš„ã€‚</code></pre><p>####æˆ‘å°±çŸ¥é“æ˜¯æˆ‘è‡ªå·±é€‰äº†releaseâ€¦.æœç„¶</p><p><img src="/images/canot_debug.png" srcset="/img/loading.gif" alt="cannotdebug"></p>]]></content>
    
    
    <categories>
      
      <category>Bug</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Bug</tag>
      
      <tag>Android Studio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Centos åˆ›å»ºç”¨æˆ·å¹¶å®ç°å…å¯†ç ç™»å½•</title>
    <link href="undefined2017/12/25/Centos-Login-SSH/"/>
    <url>2017/12/25/Centos-Login-SSH/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æ¯”å¦‚,åˆ›å»ºä¸€ä¸ªåä¸ºwzmçš„è´¦å·</p></blockquote><p>####åˆ›å»ºè´¦å·</p><p>1.åˆ›å»º</p><pre><code>[root@localhost ~]# adduser wzm[root@localhost ~]# passwd wzm#æ­¤æ—¶,è¾“å…¥ä¸¤æ¬¡å¯†ç å³å¯</code></pre><a id="more"></a><p>2.èµ‹äºˆsudo</p><pre><code>#æ‰¾åˆ°sudoers[root@localhost ~]# whereis sudoers#ä¿®æ”¹sudoersçš„è¯»å†™æƒé™[root@localhost ~]# chmod -v u+w /etc/sudoers#åŠ å…¥æ–°ç”¨æˆ·## Allow root to run any commands anywher  root    ALL=(ALL)       ALL  linuxidc  ALL=(ALL)       ALL  #è¿™ä¸ªæ˜¯æ–°å¢çš„ç”¨æˆ·#æŠŠsudoersæƒé™è¿˜ç»™ä»–[root@localhost ~]# chmod -v u-w /etc/sudoers</code></pre><p>3.å°½æƒ…äº«ç”¨å§</p><p>####sshå…å¯†ç ç™»å½•</p><p>1.ä¿®æ”¹é…ç½®æ–‡ä»¶<br><code>sudo vim /etc/ssh/sshd_config</code></p><p>2.é‡å¯sshæœåŠ¡<br><code>service sshd restart</code></p><p>3.ç”Ÿæˆå¯†é’¥</p><pre><code>ssh-keygen -t rsa     é»˜è®¤åœ¨ ~/.sshç›®å½•ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š    id_rsa      ï¼šç§é’¥    id_rsa.pub  ï¼šå…¬é’¥</code></pre><p>4.å¯¼å…¥æœ¬æœº<br><code>cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</code></p><p>5.ä¸‹è½½åˆ°å®¢æˆ·ç«¯å¹¶è®¾ç½®</p><pre><code>scp [-r] ç”¨æˆ·å@ip:æ–‡ä»¶è·¯å¾„ æœ¬åœ°è·¯å¾„#ä¸‹è½½æ–‡ä»¶scp [-r] æœ¬åœ°æ–‡ä»¶ ç”¨æˆ·å@ip:ä¸Šä¼ è·¯å¾„ eg:~/.ssh âŒš 16:27:33$ scp id_rsa.pub root@45.XX.XX.XX:/home/id_rsa.pub</code></pre><p>6.æ”¹æƒé™<br>å¦‚æœå¸Œæœ›sshå…¬é’¥ç”Ÿæ•ˆéœ€æ»¡è¶³è‡³å°‘ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ï¼šã€€ã€€ã€€ã€€ã€€<br>1) .sshç›®å½•çš„æƒé™å¿…é¡»æ˜¯700<br>2) .ssh/authorized_keysæ–‡ä»¶æƒé™å¿…é¡»æ˜¯600</p><p>eg:</p><pre><code>~ âŒš 16:33:21$ ssh wzm@45.XX.XX.XXLast login: Mon Dec 25 16:21:11 2017 from 118.102.XXX.XXX[wzm@wangzhumo ~]$</code></pre>]]></content>
    
    
    <categories>
      
      <category>Server</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Server</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidé¡¹ç›®ä¸­ä½¿ç”¨RxBusè¿›è¡Œé€šè®¯</title>
    <link href="undefined2017/12/25/Android-RxBus/"/>
    <url>2017/12/25/Android-RxBus/</url>
    
    <content type="html"><![CDATA[<p>åŠ å…¥JakeWhartonå¤§ç¥çš„RxRelay</p><p><a href="https://github.com/JakeWharton/RxRelay" target="_blank" rel="noopener">JakeWharton/RxRelay</a></p><pre><code>compile &#39;com.jakewharton.rxrelay2:rxrelay:2.0.0&#39;</code></pre><a id="more"></a><p>RxBus.java</p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/11/30 ä¸‹åˆ6:09 * */public class RxBus {    private Relay&lt;Object&gt; mBus = null;    private static volatile RxBus mDefaultInstance;    public RxBus() {        mBus = PublishRelay.create().toSerialized();    }    public static RxBus getDefault() {        if (mDefaultInstance == null) {            synchronized (RxBus.class) {                if (mDefaultInstance == null) {                    mDefaultInstance = new RxBus();                }            }        }        return mDefaultInstance;    }    /**     * å‘é€äº‹ä»¶     */    public void post(Object event) {        mBus.accept(event);    }    /**     * æ ¹æ®ä¼ é€’çš„ eventType ç±»å‹è¿”å›ç‰¹å®šç±»å‹(eventType)çš„ è¢«è§‚å¯Ÿè€…     */    public &lt;T&gt; Observable&lt;T&gt; toObservable(Class&lt;T&gt; eventType) {        return mBus.ofType(eventType);    }    /**     * åˆ¤æ–­æ˜¯å¦æœ‰è®¢é˜…è€…     */    public boolean hasObservers() {        return mBus.hasObservers();    }    /**     * å–æ¶ˆè®¢é˜…     * @param disposable     */    public void unregister(Disposable disposable) {        if (disposable != null &amp;&amp; !disposable.isDisposed()) {            disposable.dispose();        }    }    public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext) {        return toObservable(eventType).observeOn(scheduler).subscribe(onNext);    }    public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext, Consumer onError,                                   Action onComplete, Consumer onSubscribe) {        return toObservable(eventType).observeOn(scheduler).subscribe(onNext, onError, onComplete, onSubscribe);    }    public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext, Consumer onError,                                   Action onComplete) {        return toObservable(eventType).observeOn(scheduler).subscribe(onNext, onError, onComplete);    }    public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Scheduler scheduler, Consumer&lt;T&gt; onNext, Consumer onError) {        return toObservable(eventType).observeOn(scheduler).subscribe(onNext, onError);    }    public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext) {        return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext);    }    public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete, Consumer onSubscribe) {        return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext, onError, onComplete, onSubscribe);    }    public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext, Consumer onError, Action onComplete) {        return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext, onError, onComplete);    }    public &lt;T&gt; Disposable register(Class&lt;T&gt; eventType, Consumer&lt;T&gt; onNext, Consumer onError) {        return toObservable(eventType).observeOn(AndroidSchedulers.mainThread()).subscribe(onNext, onError);    }}</code></pre><p>è¿˜æœ‰ä¸€ä¸ªé€šç”¨çš„Event.java<br>ä¾æ®è‡ªå·±çš„éœ€è¦åˆ¶å®šå³å¯</p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/19 ä¸‹åˆ5:38 * * å‘é€äº‹ä»¶åŒ…è£…ç±» */public class Event&lt;T&gt; {    public static final int EVENT_CLOSE_ALL_ACTIVITY = 10001;    /**     * reserved data     */    private T data;    /**     * this code distinguish between different events     */    private int eventCode = -1;    public Event(int eventCode) {        this(eventCode, null);    }    public Event(int eventCode, T data) {        this.eventCode = eventCode;        this.data = data;    }    /**     * get event code     *     * @return     */    public int getCode() {        return this.eventCode;    }    /**     * get event reserved data     *     * @return     */    public T getData() {        return this.data;    }}</code></pre><p><strong>RxBusçš„ä½¿ç”¨</strong></p><p><strong>æ³¨å†Œ</strong></p><p>æœ€å¥½æ˜¯å†åŸºç±»ä¸­,åŠ ä¸Š.</p><pre><code>if (useEventBus()) {            //æ³¨å†Œeventbus            Disposable disposable = RxBus.getDefault()                    .register(Event.class, new Consumer&lt;Event&gt;() {                        @Override                        public void accept(Event event)  {                            int eventCode = event.getCode();                            Log.e(&quot;RxBus&quot;, event.toString());                            switch (eventCode) {                                case Event.EVENT_CLOSE_ALL_ACTIVITY:                                    break;                                default:                                    onEvent(event);                                    break;                            }                        }                    });            addDispose(disposable);}</code></pre><p>å…¶ä¸­:</p><ul><li><p>useEventBus()<br>ç”±å­ç±»å®ç°,æ˜¯å¦å¼€å¯RxBus,é¿å…æµªè´¹</p></li><li><p>addDispose(disposable);<br>addDispose æ˜¯åŸºç±»çš„æ–¹æ³•</p></li></ul><pre><code>    /**     * RxJava æ·»åŠ è®¢é˜…     */    protected void addDispose(Disposable disposable) {        if (mDisposables == null) {            mDisposables = new CompositeDisposable();        }        //å°†æ‰€æœ‰disposableæ”¾å…¥,é›†ä¸­å¤„ç†        mDisposables.add(disposable);    }</code></pre><p>ç»Ÿä¸€ç®¡ç†,é”€æ¯æ—¶ä¸€èµ·é”€æ¯,é¿å…çˆ†å†…å­˜</p><ul><li>onEvent(event);<br>æ˜¯ä¸€ä¸ªç©ºæ–¹æ³•,å¦‚æœå­ç±»é‡å†™å°±æŠŠäº‹ä»¶äº¤ç»™å­ç±»å¤„ç†</li></ul><p><strong>å‘é€</strong></p><pre><code>RxBus.getDefault().post(new Event(100,&quot;message&quot;))//codeæœ€å¥½åœ¨Event.javaä¸­ç»Ÿä¸€å®šä¹‰,æ–¹ä¾¿ç®¡ç†</code></pre><p><strong>å¤„ç†</strong></p><pre><code>override fun onEvent(event: Event&lt;*&gt;?) {    super.onEvent(event)}</code></pre><p>è¿™ä¸€éƒ¨åˆ†,å…¶å®åœ¨ <strong>æ³¨å†Œ</strong> ä¸­å·²ç»å®Œæˆ,åªè¦å­ç±»è‡ªå·±é‡å†™æ–¹æ³•,å°±èƒ½å–åˆ°æ•°æ®</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Rxjava</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginxå®‰è£…åŠå…¶ç®€å•é…ç½®</title>
    <link href="undefined2017/12/25/Nginx-install-config/"/>
    <url>2017/12/25/Nginx-install-config/</url>
    
    <content type="html"><![CDATA[<p>ç¯å¢ƒ: centos7</p><p><strong>1.ä¸‹è½½å®‰è£…</strong></p><p>ä¸‹è½½nginx-1.12.0,å®˜ç½‘<br><code>sudo wget http://nginx.org/download/nginx-1.12.0.tar.gz</code></p><p>è§£å‹<br><code>sudo tar -zxvf nginx-1.12.0.tar.gz</code></p><p>å…¶ä»–çš„åº“,nginxä¾èµ–çš„åº“</p><ul><li>å®‰è£…gcc<br><code>yum -y install gcc</code></li><li>å®‰è£…pcre<br><code>yum -y install pcre pcre-devel</code></li><li>å®‰è£…zlib<br><code>yum -y install zlib zlib-devel</code></li><li>å®‰è£…openssl<br><code>yum -y install openssl openssl-devel</code></li></ul><p>å®‰è£…</p><pre><code>sudo ./configuresudo makesudo make install</code></pre><blockquote><p>é»˜è®¤ä½ç½® /usr/local/nginx</p></blockquote><p>å¦‚æœå®‰è£…è¿‡ç¨‹ä¸­å‡ºç°æ–‡ä»¶ç›®å½•æƒé™é—®é¢˜,ç™¾åº¦å³å¯è§£å†³.</p><a id="more"></a><p><strong>2.ç³»ç»Ÿä¸­é…ç½®</strong></p><p>1.åœ¨ç³»ç»ŸæœåŠ¡ç›®å½•é‡Œåˆ›å»ºnginx.serviceæ–‡ä»¶</p><pre><code>vim /lib/systemd/system/nginx.service</code></pre><pre><code>[Unit]Description=nginxAfter=network.target[Service]Type=forkingExecStart=/usr/local/nginx/sbin/nginxExecReload=/usr/local/nginx/sbin/nginx -s reloadExecStop=/usr/local/nginx/sbin/nginx -s quitPrivateTmp=true[Install]WantedBy=multi-user.target</code></pre><p>2.è®¾ç½®å¼€æœºå¯åŠ¨</p><p><code>systemctl enable nginx.service</code></p><p>3.å…¶ä»–å‘½ä»¤</p><p>å¯åŠ¨nginxæœåŠ¡<code>systemctl start nginx.service</code></p><p>è®¾ç½®å¼€æœºè‡ªå¯åŠ¨<code>systemctl enable nginx.service</code></p><p>åœæ­¢å¼€æœºè‡ªå¯åŠ¨<code>systemctl disable nginx.service</code></p><p>æŸ¥çœ‹æœåŠ¡å½“å‰çŠ¶æ€<code>systemctl status nginx.service</code></p><p>é‡æ–°å¯åŠ¨æœåŠ¡<code>systemctl restart nginx.service</code></p><p>æŸ¥çœ‹æ‰€æœ‰å·²å¯åŠ¨çš„æœåŠ¡ <code>systemctl list-units --type=service</code></p><p><strong>3.nginx.confçš„é…ç½®</strong></p><pre><code>[root@wangzhumo hooks]# cd /usr/local/nginx/[root@wangzhumo nginx]# lltotal 96drwx------ 2 root root  4096 Dec 24 20:57 client_body_tempdrwxr-xr-x 3 root root  4096 Dec 24 23:24 confdrwx------ 2 root root  4096 Dec 24 20:57 fastcgi_tempdrwxr-xr-x 2 root root  4096 Dec 23 10:38 htmldrwxr-xr-x 2 root root  4096 Dec 24 22:43 logs-rw-r--r-- 1 root root 53861 Dec 25 13:37 ondrwx------ 2 root root  4096 Dec 24 20:57 proxy_tempdrwxr-xr-x 2 root root  4096 Dec 23 10:38 sbindrwx------ 2 root root  4096 Dec 24 20:57 scgi_tempdrwx------ 2 root root  4096 Dec 24 20:57 uwsgi_temp</code></pre><p>å…¶ä¸­/confå­˜æ”¾é…ç½®æ–‡ä»¶/conf/nginx.conf<br><code>vim /conf/nginx.conf</code></p><p>ä»€ä¹ˆéƒ½ä¸è¦åŠ¨,åœ¨nginx.confç¬¬ä¸€æ¡serveré…ç½®ä¸‹é¢å†™å…¥:<br><code>include vhost/*.conf;</code></p><pre><code> } #æ­¤å¤„æ˜¯ç¬¬ä¸€æ¡å¯ç”¨çš„serverçš„ç»“æŸ    #åŠ å…¥è¿™å¥,å…¶å®æ˜¯æŠŠå…¶ä»–åœ°æ–¹é…ç½®çš„é…ç½®æ–‡ä»¶åŠ è½½åˆ°é‡Œé¢æ¥    #ä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ç®¡ç†,ä¿®æ”¹    include vhost/*.conf;    # another virtual host using mix of IP-, name-, and port-based configuration    #    #server {    #    listen       8000;    #    listen       somename:8080;    #    server_name  somename  alias  another.alias;    #    location / {    #        root   html;    #        index  index.html index.htm;    #    }    #}</code></pre><p><strong>3.1 /vhost/*.confçš„é…ç½®</strong></p><p>å½“å‰ç›®å½•åˆ°<br><code>cd /usr/local/nginx/conf</code></p><p>åˆ›å»ºç›®å½•vhost<br><code>mkdir /usr/local/nginx/conf/vhost</code></p><p>åˆ›å»º.confæ–‡ä»¶(æˆ‘åªç”¨åˆ°hexoçš„é…ç½®,æ‰€ä»¥åªæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶)<br><code>vim /usr/local/nginx/conf/vhost/hexo.conf</code></p><pre><code>server{    listen 80;    #listen [::]:80;    server_name www.phyooos.top phyooos.top;    index index.html index.htm index.php default.html default.htm default.php;    #web root path    root  /home/wzm/hexo;    #error_page   404   /404.html;    location ~ .*\.(ico|gif|jpg|jpeg|png|bmp|swf)$    {        access_log   on;        expires      1d;    }    location ~ .*\.(js|css|txt|xml)?$    {        access_log   on;        expires      12h;    }    location / {        try_files $uri $uri/ =404;    }    access_log  /usr/local/nginx/logs/hexo.log  combined;}</code></pre><p><strong>4.é‡å¯</strong><br><code>systemctl reload nginx</code></p><p>åœ¨å¤–é¢è®¿é—®å³å¯</p>]]></content>
    
    
    <categories>
      
      <category>Server</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Server</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Roomæ•°æ®åº“ä½¿ç”¨æŒ‡åŒ—List&lt;&gt;çš„é—®é¢˜</title>
    <link href="undefined2017/12/25/room-list-object/"/>
    <url>2017/12/25/room-list-object/</url>
    
    <content type="html"><![CDATA[<p>Roomä¾èµ–</p><pre><code>implementation &quot;android.arch.persistence.room:runtime:1.0.0&quot;annotationProcessor &quot;android.arch.persistence.room:compiler:1.0.0&quot;</code></pre><a id="more"></a><p>æŸ¥æ‰¾**</p><ul><li>æŸ¥æ‰¾è¡¨ä¸­æ‰€æœ‰æ•°æ®</li></ul><pre><code>  /**     * æŸ¥æ‰¾user     * @return     */    @Query(&quot;SELECT * FROM banners&quot;)    List&lt;BannerModel&gt; findBanners();</code></pre><ul><li>æŒ‰æ¡ä»¶æŸ¥æ‰¾</li></ul><pre><code>    /**     * filters     * @return     * @param typeSort     */    @Query(&quot;SELECT * FROM filters WHERE type != :typeSort&quot;)    List&lt;FilterItemModel&gt; findFilters(String typeSort);</code></pre><ul><li>é™åˆ¶æ¡æ•°çš„æ¡ä»¶æŸ¥æ‰¾</li></ul><pre><code>    /**     * è·å–æ’åº     * @return     */    @Query(&quot;SELECT * FROM filters WHERE type = :name LIMIT 0,1&quot;)    FilterItemModel findSort(String name);</code></pre><p>ç°åœ¨è·å–çš„æ˜¯ç¬¬ä¸€æ¡æ•°æ®</p><p>//æ–‡æ¡£ä¸­çš„ä¾‹å­</p><pre><code>@Daopublic interface MyDao {    @Query(&quot;SELECT first_name, last_name FROM user WHERE region IN (:regions)&quot;)    public List&lt;NameTuple&gt; loadUsersFromRegions(List&lt;String&gt; regions);}</code></pre><p>åœ¨userè¡¨ä¸­æŸ¥æ‰¾æ»¡è¶³é›†åˆList<string> regionsä¸­æ¡ä»¶çš„å…ƒç´ </string></p><ul><li>è·å–æ€»è¡Œæ•°</li></ul><pre><code>    /**     * è·å–æ•°æ®åº“è¡¨ä¸­æ€»æ¡æ•°     * @return     */    @Query(&quot;SELECT count(*) FROM search_history&quot;)    long findHistoryCount();</code></pre><ul><li>è·å–æŸä¸€åˆ—çš„å’Œ</li></ul><pre><code>    /**     * æ±‚å’Œ     * @return     */    @Query(&quot;SELECT sum(count) FROM status_stock&quot;)    long findStatusStockCount();</code></pre><ul><li>æŒ‰ç…§é™åºæ’åˆ—(ASCå‡åº  DESCé™åº)</li></ul><pre><code>    /**     * æŸ¥æ‰¾user     * @return     */    @Query(&quot;SELECT * FROM search_history ORDER BY time DESC&quot;)    List&lt;SearchHistoryModel&gt; findSearchHistory();</code></pre><hr><p>æ–‡æ¡£ä¸­çš„ä¾‹å­:</p><pre><code>@Daopublic interface MyDao {    //æ­£å¸¸çš„æŸ¥è¯¢    @Query(&quot;SELECT * FROM user WHERE age != :minAge&quot;)    public User[] loadAllUsersOlderThan(int minAge);}@Daopublic interface MyDao {    //åŒºé—´ä¸­çš„å€¼    @Query(&quot;SELECT * FROM user WHERE age BETWEEN :minAge AND :maxAge&quot;)    public User[] loadAllUsersBetweenAges(int minAge, int maxAge);    //æˆ–å…³ç³»çš„æŸ¥è¯¢    @Query(&quot;SELECT * FROM user WHERE first_name LIKE :search &quot;           + &quot;OR last_name LIKE :search&quot;)    public List&lt;User&gt; findUserWithName(String search);}</code></pre><p><strong>å¦‚æœ,ä½ ä¸æƒ³æŸ¥åˆ°è¡¨ è¡Œä¸­æ‰€æœ‰å­—æ®µ,åˆ™</strong><br>1.å®šä¹‰ä¸€ä¸ªå®ä½“</p><pre><code>public class NameTuple {    @ColumnInfo(name=&quot;first_name&quot;)    public String firstName;    @ColumnInfo(name=&quot;last_name&quot;)    public String lastName;}</code></pre><p>2.æŸ¥è¯¢</p><pre><code>@Daopublic interface MyDao {    @Query(&quot;SELECT first_name, last_name FROM user&quot;)    public List&lt;NameTuple&gt; loadFullName();}</code></pre><ul><li>å¤šè¡¨æŸ¥è¯¢Querying multiple tables</li></ul><pre><code>@Daopublic interface MyDao {   @Query(&quot;SELECT user.name AS userName, pet.name AS petName &quot;          + &quot;FROM user, pet &quot;          + &quot;WHERE user.id = pet.user_id&quot;)   public LiveData&lt;List&lt;UserPet&gt;&gt; loadUserAndPetNames();   // You can also define this class in a separate file, as long as you add the   // &quot;public&quot; access modifier.   //æ³¨æ„ public   static class UserPet {       public String userName;       public String petName;   }}</code></pre><p><strong>æ›´æ–°</strong></p><ul><li>æ›´æ–°æŒ‡å®šæ¡ç›®</li></ul><pre><code>    /**     * æ›´æ–°æ—¶é—´     * @param time     */    @Query(&quot;UPDATE search_history SET time = :time WHERE content = :content&quot;)    void updateSearchHistory(String content,long time);</code></pre><p><strong>åˆ é™¤æ•°æ®</strong></p><ul><li>åˆ é™¤æ‰€æœ‰æ•°æ®</li></ul><pre><code>    /**     * åˆ é™¤è¡¨     * @return     */    @Query(&quot;DELETE FROM filters&quot;)    void delectFilters();</code></pre><ul><li>åˆ é™¤æœ€åä¸€æ¡</li></ul><pre><code>    /**     * åˆ é™¤æœ€åä¸€ä¸ª     * @return     */    @Query(&quot;DELETE FROM search_history WHERE time in(SELECT time FROM search_history ORDER BY time ASC LIMIT 1 )&quot;)    void delectLastHistory();</code></pre><ul><li>æŒ‰æ¡ä»¶åˆ é™¤</li></ul><pre><code>    /**     * åˆ é™¤è¡¨by listtype     * @return     */    @Query(&quot;DELETE FROM vehicle_model WHERE listType = :type&quot;)    void delectVehicleByType(String type);</code></pre><p>####è¡¥å……</p><p><strong><code>1.List&lt;String&gt;</code>è¿™æ ·çš„å…ƒç´ </strong></p><pre><code>   private ArrayList&lt;String&gt; tags;</code></pre><p>è¿™æ ·çš„å…ƒç´ ,å¯ä»¥é€šè¿‡Converteræå®š</p><pre><code>    /**    * If you have any questions, you can contact by email { wangzhumoo@gmail.com}    *    * @author ç‹è¯›é­” 2017/12/27 ä¸Šåˆ11:51    */    public class TagsConverter {        @TypeConverter        public static ArrayList&lt;String&gt; fromString(String value) {            Type listType = new TypeToken&lt;ArrayList&lt;String&gt;&gt;() {}.getType();            return new Gson().fromJson(value, listType);        }        @TypeConverter        public static String fromArrayList(ArrayList&lt;String&gt; list) {            Gson gson = new Gson();            String json = gson.toJson(list);            return json;        }    }</code></pre><p>åœ¨dbä¸­,ä¼šå­˜ä¸º </p><pre><code>[&quot;ç²¾é€‰&quot;][&quot;ç²¾é€‰&quot;,&quot;æ€¥å”®&quot;][&quot;å‡†æ–°&quot;,&quot;SUV&quot;]</code></pre><p><strong>3.@Embedded</strong></p><p>ä½œç”¨æ˜¯,æŠŠå·²ç»å†™å¥½çš„æ™®é€šçš„ç±»æ·»åŠ åˆ°æ•°æ®è¡¨ä¸­.<br>ç”¨Roomçš„æ–‡æ¡£åšè¯´æ˜:</p><pre><code>//è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„æ•°æ®è¡¨@Entityclass User {    @PrimaryKey    public int id;    public String firstName;}</code></pre><p>å…¶ä¸­åªæœ‰id , firstName</p><p>è€Œæˆ‘æƒ³æ·»åŠ <br>    street;<br>    state;<br>    city;<br>    postCode;<br>åˆšå¥½ä¹‹å‰å†™äº†ä¸€ä¸ªç±»å«Address</p><pre><code>class Address {    public String street;    public String state;    public String city;    @Ignore    public String nothing;    @ColumnInfo(name = &quot;post_code&quot;)    public int postCode;}</code></pre><p>é‚£ä¹ˆæˆ‘é€šè¿‡ @Embedded</p><pre><code>@Entityclass User {    @PrimaryKey    public int id;    public String firstName;    @Embedded    public Address address;}</code></pre><p>è¡¨ä¸­å°±ä¼šæœ‰:<br><code>names: id, firstName, street, state, city, and post_code</code></p><p>å¦‚æœä½ æƒ³ç»™@Embeddedçš„ç±»ä¸­æ‰€æœ‰å…ƒç´ å‰é¢åŠ ä¸Šç»Ÿä¸€çš„æ ‡å¿—</p><p><code>@Embedded(prefix = &quot;address_&quot;)</code></p><p>è¡¨ä¸­å°±ä¼šæœ‰:</p><p><code>names: id, firstName, address_street, address_state, address_city, and address_post_code</code></p><p><strong>3.<code>List&lt;Object&gt;</code>è¿™æ ·çš„æ•°æ®</strong></p><ul><li>è§£å†³æ–¹æ³•<br><a href="https://developer.android.com/reference/android/arch/persistence/room/Relation.html" target="_blank" rel="noopener">google developer</a></li></ul><p>çœŸçš„ç»™è°·æ­Œè·ªäº†,ä»€ä¹ˆé¬¼æ–‡æ¡£</p><pre><code>@Entitypublic class User {    // è¿™é‡Œæ˜¯ç”¨æˆ·çš„ Id    @PrimaryKey    public int id;    //çœç•¥    ...}@Entitypublic class Book {    //ä¹¦çš„id    @PrimaryKey    public int bookId;    //è¿™é‡Œå°±æ˜¯è¿™æœ¬ä¹¦ä¸ Userçš„å…³ç³»,è¿™é‡Œçš„æ˜¯User.id    public int userId;    public String name;    public String desc;}//æ³¨æ„,ä»€ä¹ˆæ³¨è§£ä¹Ÿä¸è¦åŠ public class UserAndBooks {    //åŠ å…¥æ‰€æœ‰çš„userçš„å±æ€§   @Embedded   public User user;    //è¿™é‡Œå®šä¹‰User å’Œ Bookçš„å…³ç³»   @Relation(parentColumn = &quot;id&quot;, entityColumn = &quot;userId&quot;, entity = Book.class)   public List&lt;Book&gt; books; }//æ–‡æ¡£ä¸Šè¿˜è®²äº†ä¸€ä¸ªæ¯”è¾ƒç‰›é€¼çš„åŠŸèƒ½,è¿™é‡Œä¸è®¨è®ºpublic class UserAndAllPets {   @Embedded   public User user;   @Relation(parentColumn = &quot;id&quot;, entityColumn = &quot;userId&quot;, entity = Book.class,           projection = {&quot;name&quot;})   public List&lt;String&gt; bookNames; }//ç„¶å,daoæ˜¯è¿™æ ·çš„@Daopublic interface UserDao {    @Query(&quot;SELECT * FROM User&quot;)    public List&lt;UserAndBooks&gt; loadUserWithBooks();}PS:å½“ç„¶ä½ å­˜çš„æ—¶å€™,åˆ†è¾¨åˆ«å­˜User  å’Œ Book å³å¯</code></pre>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Room</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Retrofit2 + Okhttp3 + Rxjava2 ç½‘ç»œè¯·æ±‚å°è£…(ä¸‹)</title>
    <link href="undefined2017/12/25/Retrofit2-Okhttp3-Rxjava2-2/"/>
    <url>2017/12/25/Retrofit2-Okhttp3-Rxjava2-2/</url>
    
    <content type="html"><![CDATA[<pre><code>//è¯·æ±‚:RetrofitApis.getNetworkApis().getFriendsCircle(userBean.token, String.valueOf(45),null,lastId)    .compose(new DefaultTransformer&lt;&gt;())    .subscribe(new Defaultubscriber&lt;List&lt;FriendItem&gt;&gt;() {        @Override        protected void onError(ApiException ex) {                //è¯·æ±‚é”™è¯¯,exä¸­å¯ä»¥æ‹¿åˆ°code å’Œ msg  ä¾¿äºå±•ç¤ºç»™ç”¨æˆ·        }        @Override        public void onNext(List&lt;FriendItem&gt; friends) {            //è¯·æ±‚æˆåŠŸ,friendså°±æ˜¯æ•°æ®        }        @Override        public void onComplete() {                    //æ²¡æœ‰é”™è¯¯çš„è¯,æœ€åä¼šèµ°ç€        }});</code></pre><p>compose()  è½¬åŒ–<br>subscribe() è®¢é˜…</p><p>DefaultTransformer.java</p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/11/3 ä¸‹åˆ5:06 * * é»˜è®¤çš„åˆ‡æ¢çº¿ç¨‹,å¹¶è¿”å›å®ä½“ç±» */public class DefaultTransformer&lt;T extends ResultResponse&lt;RP&gt;, RP&gt; implements FlowableTransformer&lt;T, RP&gt; {    @Override    public Publisher&lt;RP&gt; apply(Flowable&lt;T&gt; upstream) {        return upstream                .map(t -&gt; t.getResult())                .subscribeOn(Schedulers.io())                .observeOn(AndroidSchedulers.mainThread());    }}</code></pre><p>1.map å°†è¿”å›çš„ResultResponse&lt;&gt;  è½¬åŒ–,ç›´æ¥å–ResultResponseçš„æ³›å‹å®ä½“</p><pre><code>{&quot;result&quot;:{}&quot;code&quot;:&quot;&quot;,&quot;msg&quot;:&quot;&quot;}</code></pre><p>ä¸­çš„result</p><p>2.subscribeOn(Schedulers.io())  ç½‘ç»œè¯·æ±‚çš„è€—æ—¶æ“ä½œ,æ”¾åœ¨æ–¹ä¾¿ioæ“ä½œçš„çº¿ç¨‹é‡Œé¢<br>3.observeOn(AndroidSchedulers.mainThread())  åé¢çš„æ“ä½œ,éƒ½åœ¨ä¸»çº¿ç¨‹è¿›è¡Œ</p><p>Defaultubscriber.java</p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/24 ä¸Šåˆ10:36 * * ç”¨äºæ²¡æœ‰ç½‘ç»œæ—¶åœæ­¢ç½‘ç»œè¯·æ±‚ */public abstract class Defaultubscriber&lt;T&gt; extends DisposableSubscriber&lt;T&gt; {    @CallSuper    @Override    public void onError(Throwable e) {        if (e instanceof ApiException) {            onError((ApiException) e);        } else {            onError(new ApiException(&quot;&quot;,&quot;&quot;));        }    }    @Override    protected void onStart() {        if (!SystemUtils.isNetworkConnected()) {            onError(new ApiException(Utils.getString(R.string.net_error_title),&quot;999&quot;));            cancel();            return;        }        super.onStart();    }    /**     * é”™è¯¯å›è°ƒ     *     * @param ex å¼‚å¸¸ä¿¡æ¯     */    protected abstract void onError(ApiException ex);}</code></pre><p>1.extends DisposableSubscriber  ä¾¿äºé€šè¿‡CompositeDisposableç®¡ç†è¯·æ±‚,æ­¤å¤„æ²¡æœ‰å±•ç¤º,ä¸ç”¨ç®¡<br>2.onStart()  ä¸­,åˆ¤æ–­æ˜¯å¦æœ‰ç½‘ç»œ</p><ul><li><p>æ²¡æœ‰ç½‘ç»œ</p><p>onError(new ApiException(Utils.getString(R.string.net_error), false));<br>æŠ›å‡ºæ²¡æœ‰ç½‘ç»œçš„é”™è¯¯,ç”±å„ä¸ªé¡µé¢è‡ªè¡Œå¤„ç†</p><p>cancel(); å–æ¶ˆ</p><ul><li>æœ‰ç½‘ç»œåˆ™ç»§ç»­</li></ul></li></ul><p>3.é‡å†™çš„ onError()ä¸­.<br>    æ˜¯ApiExceptionå®ä¾‹çš„,æ˜¯è‡ªå·±æŠ›å‡ºçš„å¼‚å¸¸,å·²ç»å¤„ç†è¿‡äº†,ç›´æ¥onErrorç»™å„ä¸ªé¡µé¢å¤„ç†<br>    ä¸æ˜¯çš„å†å¤„ç†ä¸€æ¬¡,åœ¨åˆ†å‘ç»™å„ä¸ªé¡µé¢å¤„ç†</p><p>####æœªå®Œå¾…ç»­â€¦</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Okhttp</tag>
      
      <tag>Rxjava</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Retrofit2 + Okhttp3 + Rxjava2 ç½‘ç»œè¯·æ±‚å°è£…(ä¸Š)</title>
    <link href="undefined2017/12/25/Retrofit2-Okhttp3-Rxjava2-1/"/>
    <url>2017/12/25/Retrofit2-Okhttp3-Rxjava2-1/</url>
    
    <content type="html"><![CDATA[<p>æœ€ç»ˆç»“æ„</p><pre><code>netâ”œâ”€â”€ RequestBuilder.javaâ”œâ”€â”€ RetrofitApis.javaâ”œâ”€â”€ baseâ”‚   â”œâ”€â”€ ApiException.javaâ”‚   â”œâ”€â”€ CustomGsonConverter.javaâ”‚   â”œâ”€â”€ DefaultSubscriber.javaâ”‚   â””â”€â”€ DefaultTransformer.javaâ””â”€â”€ response    â”œâ”€â”€ BaseResponse.java    â””â”€â”€ ResultResponse.javaNetworkApis.java</code></pre><a id="more"></a><p><strong>1.æ·»åŠ ä¾èµ–</strong></p><pre><code>implementation &quot;io.reactivex.rxjava2:rxjava:2.1.7&quot;implementation &quot;io.reactivex.rxjava2:rxandroid:2.0.1&quot;implementation &quot;com.squareup.okhttp3:okhttp:3.9.0&quot;implementation &quot;com.squareup.okhttp3:logging-interceptor:3.9.0&quot;implementation &quot;com.squareup.retrofit2:retrofit:2.3.0&quot;implementation &quot;com.squareup.retrofit2:converter-gson:2.3.0&quot;implementation &quot;com.squareup.retrofit2:adapter-rxjava2:2.3.0&quot;</code></pre><p><strong>2.è¯·æ±‚æœåŠ¡æ„å»º</strong></p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/11/1 ä¸‹åˆ11:13 * */public class RetrofitApis {    private static OkHttpClient okHttpClient = null;    private static NetworkApis networkApis = null;    private static Gson gson = new Gson();    private static final String TAG = &quot;RetrofitApis&quot;;    /**     * ä¸ºHOSTåˆ›å»ºä¸€ä¸ªè¯·æ±‚å®¢æˆ·ç«¯     * @return     */    public static NetworkApis getNetworkApis() {        initOkhttp();        if (networkApis == null) {            Retrofit retrofit = new Retrofit.Builder()                    .client(okHttpClient)                    .baseUrl(Constants.HOST)                    .addConverterFactory(CustomGsonConverter.create(gson))                    .addCallAdapterFactory(RxJava2CallAdapterFactory.create())                    .build();            networkApis = retrofit.create(NetworkApis.class);        }        return networkApis;    }    /**     * åˆå§‹åŒ–ä¸€ä¸ªOkHttpClient     */    private static void initOkhttp(){        //æ²¡æœ‰åˆ›å»ºå°±å®ä¾‹ä¸€ä¸ª        if(okHttpClient == null){            final OkHttpClient.Builder builder = new OkHttpClient.Builder();            //è®¾ç½®logç­‰çº§            if(BuildConfig.DEBUG){                HttpLoggingInterceptor interceptor = new HttpLoggingInterceptor();                //BODY  åŒ…å«è¯·æ±‚url å‚æ•°  response ,ä¼šæ‰“å°åœ¨logcat                interceptor.setLevel(HttpLoggingInterceptor.Level.BODY);                builder.addInterceptor(interceptor);            }            //æ‰“å¼€ä¸€ä¸ªFileç”¨äºç¼“å­˜            File cacheFile = new File(Constants.PATH_CACHE);            Cache cache = new Cache(cacheFile,1024*1024*50);            //ä¸€ä¸ªæ‹¦æˆªå™¨                Interceptor cacheInterceptor = new Interceptor() {                @Override                public Response intercept(Chain chain) throws IOException {                    Request.Builder builder = chain.request().newBuilder();                    if(SystemUtils.isNetworkConnected()){                        int maxAge = 0 ;                        //æœ‰ç½‘ç»œ,ä¸ç¼“å­˜,æœ€é•¿ä¿å­˜æ—¶é—´ä¸º0                        builder.removeHeader(&quot;Pragma&quot;)                                .header(&quot;Cache-Control&quot;, &quot;public, max-age=&quot; + maxAge)                                .build();                    } else {                        // æ— ç½‘ç»œæ—¶ï¼Œè®¾ç½®è¶…æ—¶ä¸º2å‘¨                        int maxStale = 60 * 60 * 24 * 14;                        builder.removeHeader(&quot;Pragma&quot;)                                .header(&quot;Cache-Control&quot;, &quot;public, only-if-cached, max-stale=&quot; + maxStale)                                .build();                      throw new ApiException(false);                    }                    return chain.proceed(builder.build());                }            };            //è®¾ç½®ç¼“å­˜æ‹¦æˆªå™¨            builder.addInterceptor(cacheInterceptor);            builder.addNetworkInterceptor(cacheInterceptor);            //è¿™é‡Œé€šè¿‡Interceptor å¯ä»¥å®ç°æ·»åŠ å…¬å…±å‚æ•°,ä¸è¯¦ç»†è¯´æ˜äº†            //stetho,å¦‚æœä½¿ç”¨åˆ™éœ€è¦æ·»åŠ             //builder.addNetworkInterceptor(new StethoInterceptor());            builder.cache(cache);            //é”™è¯¯é‡è¿            builder.retryOnConnectionFailure(true);            //è®¾ç½®è¶…æ—¶            builder.connectTimeout(15, TimeUnit.SECONDS);            builder.readTimeout(15, TimeUnit.SECONDS);            builder.writeTimeout(15, TimeUnit.SECONDS);            okHttpClient = builder.build();        }    }}</code></pre><p>ä»¥ä¸Š;</p><p>ä½¿ç”¨ <code>CustomGsonConverter.java / NetworkApis.java</code><br>é€šè¿‡getNetworkApis()æ–¹æ³•,å‘å¤–æä¾›äº†ä¸€ä¸ªè¯·æ±‚æœåŠ¡.<br>å…¶ä¸­ .addConverterFactory(CustomGsonConverter.create(gson))<br>æ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„Converteræ›¿ä»£äº†é»˜è®¤æä¾›çš„</p><p>CustomGsonConverter.java</p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/24 ä¸Šåˆ10:31 * * GsonConverter ç”¨äºåœ¨ä¸è§£æè¿”å›æ­£æ–‡çš„å‰æä¸‹è·å–è¯·æ±‚æˆåŠŸå¤±è´¥å’Œ è¿”å›ä¿¡æ¯ */public class CustomGsonConverter extends Converter.Factory {    private final Gson gson;    private CustomGsonConverter(Gson gson) {        if (gson == null) {            throw new NullPointerException(&quot;gson == null&quot;);        }        this.gson = gson;    }    public static CustomGsonConverter create() {        return create(new Gson());    }    public static CustomGsonConverter create(Gson gson) {        return new CustomGsonConverter(gson);    }    @Override    public Converter&lt;ResponseBody, ?&gt; responseBodyConverter(Type type, Annotation[] annotations, Retrofit retrofit) {        TypeAdapter&lt;?&gt; adapter = gson.getAdapter(TypeToken.get(type));        return new CustomGsonResponseBodyConverter&lt;&gt;(gson, adapter);    }    private class CustomGsonResponseBodyConverter&lt;T&gt; implements Converter&lt;ResponseBody, T&gt; {        private final Gson gson;        private final TypeAdapter&lt;T&gt; adapter;        public CustomGsonResponseBodyConverter(Gson gson, TypeAdapter&lt;T&gt; adapter) {            this.gson = gson;            this.adapter = adapter;        }        @Override        public T convert(ResponseBody value) throws IOException {            String response = value.string();            BaseResponse baseResponse = gson.fromJson(response,BaseResponse.class);            if (!baseResponse.isCodeSuccess()) {                value.close();                throw new ApiException(baseResponse.error);            }            MediaType contentType = value.contentType();            Charset charset = contentType != null ? contentType.charset(UTF_8) : UTF_8;            InputStream inputStream = new ByteArrayInputStream(response.getBytes());            Reader reader = new InputStreamReader(inputStream, charset);            JsonReader jsonReader = gson.newJsonReader(reader);            try {                return adapter.read(jsonReader);            } finally {                value.close();            }        }    }    @Nullable    @Override    public Converter&lt;?, RequestBody&gt; requestBodyConverter(Type type, Annotation[] parameterAnnotations, Annotation[] methodAnnotations, Retrofit retrofit) {        return super.requestBodyConverter(type,parameterAnnotations,methodAnnotations,retrofit);    }}</code></pre><p>requestBodyConverteræ²¡æœ‰é‡å†™,åé¢å‘ç°äº†ä¸€ä¸ªbug,ä¸Šä¼ æ–‡ä»¶+æ–‡å­—å‚æ•°æ—¶,å¯èƒ½ä¼šé€ æˆ Lengthå‡ºé”™.<br>responseBodyConverter é‡å†™,å…ˆæŠŠresponseè§£æ,å¦‚æœæœ‰é—®é¢˜åˆ™<br><code>throw new ApiException(baseResponse.error);</code><br>ä¼šä¸»åŠ¨èµ°RxJavaçš„ onError()</p><p>å¦‚æœæ²¡æœ‰é—®é¢˜,åˆ™ç»§ç»­,å¥½åƒæœ‰ç‚¹å¤šä½™â€¦â€¦</p><p>ApiException.java  å°±æ˜¯ç”¨äºå°è£…å¼‚å¸¸</p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/24 ä¸Šåˆ10:29 * * æ­¤ç±»ä½œä¸ºç½‘ç»œè¯·æ±‚å¼‚å¸¸çš„åŸº */public class ApiException extends IOException {    String code;    String msg;    public ApiException(String code){        this.code = code;    }    public ApiException(String msg, String code){        super(msg);        this.msg = msg;        this.code = code;    }    public boolean getCode() {        return code;    }    @Override    public String getMessage() {        return msg;    }}</code></pre><p><strong>3.Responseè¿”å›æ•°æ®çš„å°è£…</strong></p><blockquote><p>è¿™é‡Œæ ¹æ®åå°è¿”å›æ•°æ®ç»“æ„</p></blockquote><p>æˆ‘ä»¬çš„è¿”å›æ˜¯</p><pre><code>{    &quot;result&quot;:{    },    &quot;msg&quot;:&quot;è¯·æ±‚æˆåŠŸ&quot;,    &quot;code&quot;:&quot;0000&quot;}</code></pre><p>BaseResponse.java</p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/19 ä¸‹åˆ5:41 * */public class BaseResponse{    public String code;    public String msg;    /**     * APIæ˜¯å¦è¯·æ±‚å¤±è´¥     *     * @return å¤±è´¥è¿”å›true, æˆåŠŸè¿”å›false     */    public boolean isCodeSuccess() {        return &quot;0000&quot;.equals(code);    }}</code></pre><p>æ‰€æœ‰çš„è¿”å›æ•°æ®ç±»,éƒ½è¦ç»§æ‰¿å®ƒ,ä¾¿äºCustomGsonConverter ä¸­åˆ¤æ–­è¿”å›æ•°æ®çš„æ­£ç¡®æ€§</p><p>ResultResponse.java</p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/19 ä¸‹åˆ5:37 */public class ResultResponse&lt;T&gt; extends BaseResponse {    private T result;    public T getResult() {        return result;    }}</code></pre><p>é€šè¿‡Tæ³›å‹,æŒ‡å®šè¿”å›resultçš„ç»“æ„,è®©gsonè§£ææˆå®ä½“å¯¹è±¡</p><p>T å¯èƒ½æ˜¯ å®ä½“å¯¹è±¡  å¯èƒ½æ˜¯ List&lt;å®ä½“å¯¹è±¡&gt;  â€¦.</p><p><strong>4.è¯·æ±‚æ•°æ®</strong></p><p>NetworkApis.java</p><pre><code>/** * If you have any questions, you can contact by email {wangzhumoo@gmail.com} * @author ç‹è¯›é­” 2017/10/19 ä¸‹åˆ5:40 * * æ‰€æœ‰ç½‘ç»œè¯·æ±‚ */public interface NetworkApis {    /**     * è·å–æœ‹å‹åœˆåˆ—è¡¨     * @param token     * @return     */    @POST(&quot;QCRL/qcrl?command=getFriendsCircle&quot;)    @FormUrlEncoded    Flowable&lt;ResultResponse&lt;List&lt;FriendItem&gt;&gt;&gt; getFriendsCircle(            @Field(&quot;token&quot;) String token,            @Field(&quot;number&quot;) String number,            @Field(&quot;userId&quot;) String userId,            @Field(&quot;lastDate&quot;) String lastId);    /**     * åˆ é™¤     * @param token     * @param circleId     * @return     */    @POST(&quot;QCRL/qcrl?command=updateFriendsCircle&quot;)    @FormUrlEncoded    Flowable&lt;ResultResponse&lt;String&gt;&gt; updateFriendsCircle(            @Field(&quot;token&quot;) String token,            @Field(&quot;circleId&quot;) String circleId);    /**     * èµ     * @param token     * @param circleId     * @param userId     * @return     */    @POST(&quot;QCRL/qcrl?command=addFavor&quot;)    @FormUrlEncoded    Flowable&lt;ResultResponse&lt;Object&gt;&gt; addFavor(            @Field(&quot;token&quot;) String token,            @Field(&quot;circleId&quot;) String circleId,            @Field(&quot;toId&quot;) String userId);    ...}</code></pre><p>æ ¹æ®è‡ªå·±çš„æ¥å£ç¼–å†™å³å¯<br>@POST() æŒ‡è¯·æ±‚æ–¹å¼ä¸º POST  </p><blockquote><p>æ³¨æ„,æ‹¬å·ä¸­çš„ç½‘å€,å¼€å¤´ä¸å¯ä»¥ä½¿ç”¨/QCRL/â€¦<br>å¦åˆ™ä¼šç›´æ¥æ‹¼åˆ°HOSTåé¢,urlå¯èƒ½ä¼šé”™è¯¯ </p></blockquote><p>@FormUrlEncoded  è¡¨ç¤ºformè¡¨å•æäº¤,ä¼šEncodedç¼–ç å‚æ•°</p><p>@Field æ¯ä¸€ä¸ªå‚æ•°</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Okhttp</tag>
      
      <tag>Rxjava</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidé¡¹ç›®çš„build.gradleé€šç”¨è®¾ç½®</title>
    <link href="undefined2017/12/25/Android-build-gradle-config/"/>
    <url>2017/12/25/Android-build-gradle-config/</url>
    
    <content type="html"><![CDATA[<pre><code>apply plugin: &#39;com.android.application&#39;android {    //å¼€å¯dataBinding    dataBinding{        enabled = true    }    defaultConfig {        //å¼€å¯multiDex        multiDexEnabled true        //ä½¿ç”¨jni        ndk {            //è®¾ç½®æ”¯æŒçš„SOåº“æ¶æ„,è¿™é‡Œçš„æ„æ€æ˜¯åªæ”¯æŒ&#39;armeabi&#39;, &#39;armeabi-v7a&#39;, &#39;x86&#39;            //è¿™ä¸‰ç§æ¶æ„            abiFilters &#39;armeabi&#39;, &#39;armeabi-v7a&#39;, &#39;x86&#39;        }    }    //è®¾ç½®ä¸€ä¸ªç¼–è¯‘çš„é…ç½®    signingConfigs {        //åä¸ºreleaseçš„é…ç½®é¡¹        release {            //ç­¾åæ–‡ä»¶çš„ä½ç½®,å½“å‰ä½ç½®æ˜¯æ ¹ç›®å½•            storeFile file(&quot;/keyfile.jks&quot;)            //storePassword            storePassword &quot;xxxxxxxx&quot;            //keyAlias            keyAlias &quot;wangzhumo&quot;            //keyPassword            keyPassword &quot;xxxxxxxx&quot;            //æ˜¯å¦ä½¿ç”¨v2Signing            v2SigningEnabled false        }    }    //ç¼–è¯‘çš„ç‰ˆæœ¬    buildTypes {        //debugæ—¶çš„é…ç½®        debug {            minifyEnabled false            //è¿™é‡Œä½¿ç”¨ä¸Šé¢é…ç½®çš„ç­¾å,å¯ä»¥åšåˆ°debugæ—¶,ä¹Ÿä½¿ç”¨çš„æ˜¯æ­£å¼ç­¾å,è€Œä¸æ˜¯debugçš„ keystore            signingConfig signingConfigs.release            //buildConfig çš„ä¸€ä¸ªå‚æ•°,æ˜¯å¦å¼€å¯log            buildConfigField &quot;boolean&quot;, &quot;LOG_DEBUG&quot;, &quot;true&quot;            proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;        }        release {            // æ˜¾ç¤ºLog            minifyEnabled false            signingConfig signingConfigs.release            buildConfigField &quot;boolean&quot;, &quot;LOG_DEBUG&quot;, &quot;false&quot;            proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;        }    }    //adbçš„é…ç½®é¡¹    adbOptions {        //è¶…æ—¶æ—¶é—´        timeOutInMs = 5 * 1000        //adb install -r /path..apk        installOptions &#39;-r&#39;    }    flavorDimensions &#39;env&#39;    productFlavors {        //æ­£å¼ç‰ˆæœ¬        envydemo{            dimension &#39;env&#39;            //æ­¤å¤„æ˜¯versionName            versionName &quot;V1.1&quot;            //manifestPlaceholders            //æ˜¯manifestå·²ç»å®šä¹‰çš„å‚æ•°,è¿™é‡Œç»™è¯¥å‚æ•°èµ‹å€¼            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;wangzhumoo&quot;]            //buildConfig çš„å‚æ•°,Appå½“å‰çš„HOSTåœ°å€            buildConfigField &quot;String&quot;,&quot;SERVER_HOST&quot;,&#39;&quot;http://app....com/&quot;&#39;        }        envtest {            dimension &#39;env&#39;            versionName &quot;Test&quot;            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;wangzhumoo&quot;]            buildConfigField &quot;String&quot;,&quot;SERVER_HOST&quot;,&#39;&quot;http://app.test....com/&quot;&#39;        }    }    //è‡ªå®šä¹‰apkåå­—    android.applicationVariants.all { variant -&gt;        variant.outputs.all {            //apkçš„åå­—            outputFileName = &quot;App_${variant.versionName}.apk&quot;        }    }    android {         //æ’é™¤        configurations.all {            resolutionStrategy.force &#39;com.google.code.findbugs:jsr305:1.3.9&#39;        }    }    //ä½¿ç”¨java8     compileOptions {        sourceCompatibility JavaVersion.VERSION_1_8        targetCompatibility JavaVersion.VERSION_1_8    }}</code></pre><p>ä»¥ä¸Šä»£ç ,åˆ é™¤äº†å¸¸è§çš„éƒ¨åˆ†.</p><ul><li>buildConfigField</li></ul><pre><code>/** * å¸¸é‡ç±» */public class Constants {    //å–åˆ°åœ¨productFlavors.envyhcsé…ç½®çš„å‚æ•°    //buildConfigField &quot;String&quot;,&quot;SERVER_HOST&quot;,&#39;&quot;http://app....com/&quot;&#39;    public static final String BASE_URL = BuildConfig.SERVER_HOST;}</code></pre><ul><li>manifestPlaceholders</li></ul><pre><code>&lt;manifest&gt;    &lt;application&gt;        //å–åˆ°åœ¨productFlavors.envyhcsé…ç½®çš„å‚æ•°        //manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;wangzhumo&quot;]        &lt;meta-data            android:name=&quot;UMENG_CHANNEL&quot;            android:value=&quot;${UMENG_CHANNEL_VALUE}&quot; /&gt;    &lt;/application&gt;&lt;/manifest&gt;</code></pre><ul><li>Build Variants<br>åœ¨build.gradleä¸­é…ç½®äº†productFlavors{  envdemo{} , envtest{}}</li></ul><p>å…¶ä¸­dimensionä¸€ä¸ªç»´åº¦<br>å…¶ä¸­buildTypesä¸€ä¸ªç»´åº¦</p><p>debug + evndemo<br>debug + evntest<br>release + evndeme<br>release + evntest</p><p>å…±4ç§,å…¶ä»–çš„å¹¶æ²¡æœ‰ä½¿ç”¨åˆ°,æ‰€ä»¥ä¸åšè¯´æ˜</p><p><img src="/images/build_var.png" srcset="/img/loading.gif" alt="Build Variants"></p><p>å¯ä»¥é€‰æ‹©debugé»˜è®¤çš„ç‰ˆæœ¬â€¦</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android é¡¹ç›®ç»Ÿä¸€ç®¡ç†ä¾èµ–ç‰ˆæœ¬</title>
    <link href="undefined2017/12/25/Android-dependent-config/"/>
    <url>2017/12/25/Android-dependent-config/</url>
    
    <content type="html"><![CDATA[<p>å‡†å¤‡å¼•å…¥Arouter,åšä¸€ä¸ªç»„ä»¶çš„demo,å°±å¼€å§‹æ…¢æ…¢çš„æ”¹é€ é¡¹ç›®</p><pre><code>.|-- app|   |-- build.gradle|   |-- libs|   |-- src|   |   |-- androidTest|   |   |-- main|   |   `-- test||-- opensource|   |-- build.gradle|   |-- libs|   `-- src|       `-- main|-- build.gradle|-- settings.gradle`-- versions.gradle</code></pre><blockquote><p>app ä¸ºä¸»é¡¹ç›®<br>opensource ä½œä¸ºlibraryå­˜åœ¨,å°†æ¥ä¼šæˆä¸ºbaseLibçš„ä¾èµ–,å…¶ä¸­æ˜¯æ‰€æœ‰çš„ä¸‰æ–¹ä¾èµ–,å¼€æºä»£ç ç­‰ç­‰</p></blockquote><a id="more"></a><p><strong>1.æ ¹ç›®å½•åˆ›å»ºversions.gradle</strong></p><p><code>/versions.gradle</code></p><pre><code>ext.deps = [:]    def versions = [:]    versions.arch = &quot;1.0.0&quot;    versions.support = &quot;27.0.1&quot;    versions.dagger = &quot;2.13&quot;    versions.stetho = &quot;1.5.0&quot;    versions.dialogs = &quot;0.9.6.0&quot;    versions.glide = &quot;4.3.1&quot;    versions.gradle = &quot;3.0.1&quot;    versions.rxJava = &quot;2.1.7&quot;    versions.rxAndroid = &quot;2.0.1&quot;    versions.rxRelay = &quot;2.0.0&quot;    versions.rxBinding = &quot;2.0.0&quot;    versions.paging = &quot;1.0.0-alpha3&quot;    versions.okhttp = &quot;3.9.0&quot;    versions.retrofit = &quot;2.3.0&quot;    versions.kotlin = &quot;1.2.0&quot;    versions.kotlinBind = &quot;3.0.1&quot;    versions.gson = &quot;2.8.2&quot;    versions.arouterVersion = &quot;1.2.4&quot;    versions.arouterProcessor = &quot;1.1.4&quot;    versions.atslRunner = &quot;1.0.1&quot;    versions.atslRules = &quot;1.0.1&quot;    versions.hamcrest = &quot;1.3&quot;    versions.timber = &quot;4.5.1&quot;    versions.mockwebserver = &quot;3.8.1&quot;    versions.apache_commons = &quot;2.5&quot;    versions.mockito = &quot;2.7.19&quot;    versions.mockito_all = &quot;1.10.19&quot;    versions.dexmaker = &quot;2.2.0&quot;    versions.constraint = &quot;1.0.2&quot;    versions.junit = &quot;4.12&quot;    versions.espresso = &quot;3.0.1&quot;    def deps = [:]    def rxLib = [:]    rxLib.rxJava = &quot;io.reactivex.rxjava2:rxjava:$versions.rxJava&quot;    rxLib.rxAndroid = &quot;io.reactivex.rxjava2:rxandroid:$versions.rxAndroid&quot;    rxLib.rxBinding = &quot;com.jakewharton.rxbinding2:rxbinding:$versions.rxBinding&quot;    rxLib.rxBingingV4 = &quot;com.jakewharton.rxbinding2:rxbinding-support-v4:$versions.rxBinding&quot;    rxLib.rxBingingRecycler = &quot;com.jakewharton.rxbinding2:rxbinding-recyclerview-v7:$versions.rxBinding&quot;        rxLib.rxBingingV7 = &quot;com.jakewharton.rxbinding2:rxbinding-appcompat-v7:$versions.rxBinding&quot;    rxLib.rxBingingDesign = &quot;com.jakewharton.rxbinding2:rxbinding-design:$versions.rxBinding&quot;    rxLib.rxRelay = &quot;com.jakewharton.rxrelay2:rxrelay:$versions.rxRelay&quot;    deps.rxLibs = rxLib    def support = [:]    support.annotations = &quot;com.android.support:support-annotations:$versions.support&quot;    support.appCompat = &quot;com.android.support:appcompat-v7:$versions.support&quot;    support.recyclerview = &quot;com.android.support:recyclerview-v7:$versions.support&quot;    support.cardview = &quot;com.android.support:cardview-v7:$versions.support&quot;    support.design = &quot;com.android.support:design:$versions.support&quot;    support.v4 = &quot;com.android.support:support-v4:$versions.support&quot;    support.coreUtils = &quot;com.android.support:support-core-utils:$versions.support&quot;    deps.support = support    def archLib = [:]    archLib.archExtensions = &quot;android.arch.lifecycle:extensions:$versions.arch&quot;    archLib.archRoomRuntime = &quot;android.arch.persistence.room:runtime:$versions.arch&quot;    archLib.archRoomCompiler = &quot;android.arch.persistence.room:compiler:$versions.arch&quot;    archLib.archLifecycleCommon = &quot;android.arch.lifecycle:common-java8:$versions.arch&quot;    deps.archLibs = archLib    def glide = [:]    glide.glide = &quot;com.github.bumptech.glide:glide:$versions.glide&quot;    glide.glideCompiler = &quot;com.github.bumptech.glide:compiler:$versions.glide&quot;    deps.glide = glide    def stethos = [:]    stethos.stetho = &quot;com.facebook.stetho:stetho:$versions.stetho&quot;    stethos.stethoHttp = &quot;com.facebook.stetho:stetho-okhttp3:$versions.stetho&quot;    deps.stetho = stethos    def okhttp = [:]    okhttp.okhttp = &quot;com.squareup.okhttp3:okhttp:$versions.okhttp&quot;    okhttp.okhttpLogging = &quot;com.squareup.okhttp3:logging-interceptor:$versions.okhttp&quot;    deps.okhttp = okhttp    def retrofit = [:]    retrofit.retrofit = &quot;com.squareup.retrofit2:retrofit:$versions.retrofit&quot;    retrofit.converterGson = &quot;com.squareup.retrofit2:converter-gson:$versions.retrofit&quot;    retrofit.adapterRxjava = &quot;com.squareup.retrofit2:adapter-rxjava2:$versions.retrofit&quot;    deps.retrofit = retrofit    def arouter = [:]    arouter.runtime = &quot;com.alibaba:arouter-api:$versions.arouterVersion&quot;    arouter.compiler = &quot;com.alibaba:arouter-compiler:$versions.arouterProcessor&quot;    deps.arouter = arouter    def dagger = [:]    dagger.dagger = &quot;com.google.dagger:dagger:$versions.dagger&quot;    dagger.daggerAndroid = &quot;com.google.dagger:dagger-android:$versions.dagger&quot;    dagger.daggerAndroidSupport = &quot;com.google.dagger:dagger-android-support:$versions.dagger&quot;    dagger.daggerCompiler = &quot;com.google.dagger:dagger-compiler:$versions.dagger&quot;    dagger.daggerAndroidCompiler = &quot;com.google.dagger:dagger-android-processor:$versions.dagger&quot;    deps.dagger = dagger    def kotlin = [:]    kotlin.kotlinStdlib = &quot;org.jetbrains.kotlin:kotlin-stdlib-jre8:$versions.kotlin&quot;    kotlin.kotlinPlugin = &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$versions.kotlin&quot;    kotlin.kotlinDatabind = &quot;com.android.databinding:compiler:$versions.kotlinBind&quot;    deps.kotlin = kotlin    def espresso = [:]    espresso.core = &quot;com.android.support.test.espresso:espresso-core:$versions.espresso&quot;    espresso.contrib = &quot;com.android.support.test.espresso:espresso-contrib:$versions.espresso&quot;    espresso.intents = &quot;com.android.support.test.espresso:espresso-intents:$versions.espresso&quot;    deps.espresso = espresso    def atsl = [:]    atsl.runner = &quot;com.android.support.test:runner:$versions.atsl_runner&quot;    atsl.rules = &quot;com.android.support.test:rules:$versions.atsl_runner&quot;    deps.atsl = atsl    deps.multidex = &quot;com.android.support:multidex:1.0.1&quot;    deps.dialog =  &quot;com.afollestad.material-dialogs:core:$versions.dialogs&quot;    deps.gson = &quot;com.google.code.gson:gson:$versions.gson&quot;    deps.paging = &quot;android.arch.paging:runtime:$versions.paging&quot;    deps.dexmaker = &quot;com.linkedin.dexmaker:dexmaker-mockito:$versions.dexmaker&quot;    deps.constraint = &quot;com.android.support.constraint:constraint-layout:$versions.constraint&quot;    deps.timber = &quot;com.jakewharton.timber:timber:$versions.timber&quot;    deps.gradlePlugin = &quot;com.android.tools.build:gradle:$versions.gradle&quot;    deps.kotlinPlugin = &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$versions.kotlin&quot;    ext.deps = deps    def buildVersions = [:]    buildVersions.minSDK = 14    buildVersions.targetSDK = 26    buildVersions.compileSDK = 27    buildVersions.buildTools = &quot;26.0.2&quot;    ext.buildVersion = buildVersions    def addRepos(RepositoryHandler handler) {        handler.google()        handler.jcenter()        handler.mavenCentral()        handler.maven { url &#39;https://oss.jfrog.org/libs-snapshot&#39; }        handler.maven { url &#39;https://jitpack.io&#39; }    }    ext.addRepos = this.&amp;addRepos</code></pre><p>å…¶ä¸­å£°æ˜äº†æ‰€æœ‰å·²ç»ç”¨åˆ°,æˆ–è€…å¯èƒ½ä½¿ç”¨çš„Libç‰ˆæœ¬,ä»¥åŠAndroid sdk tools çš„ç‰ˆæœ¬.</p><p><strong>2.å°†å£°æ˜çš„ç‰ˆæœ¬,æ·»åŠ åˆ°é¡¹ç›®ä¸­,æ–¹ä¾¿å¼•ç”¨</strong></p><p><code>/build.gradle</code></p><p>é¡¹ç›®çš„build.gradleä¸­</p><pre><code>buildscript {    //åŠ å…¥å¼•ç”¨    apply from: &#39;versions.gradle&#39;    //æ·»åŠ rep    addRepos(repositories)    dependencies {        //ç”±versions.gradleç®¡ç†çš„ç‰ˆæœ¬        classpath deps.gradlePlugin        classpath deps.kotlinPlugin        // NOTE: Do not place your application dependencies here; they belong        // in the individual module build.gradle files    }}allprojects {    //æ·»åŠ rep    addRepos(repositories)}</code></pre><p><strong>3.å¯¹Android Tools,SDKç‰ˆæœ¬çš„æ§åˆ¶</strong><br>é¡¹ç›®/app/build.gradle</p><pre><code>android {    //sdkçš„ç‰ˆæœ¬    compileSdkVersion buildVersion.compileSDK    //toolsçš„ç‰ˆæœ¬    buildToolsVersion buildVersion.buildTools    defaultConfig {        //sdkç‰ˆæœ¬        minSdkVersion buildVersion.minSDK        targetSdkVersion buildVersion.targetSDK        versionCode 1  //ä¹Ÿå¯ä»¥ä½¿ç”¨        versionName &quot;1.0&quot;    }//}</code></pre><p><strong>4.å…¶ä»–Libçš„ä¾èµ–</strong><br>æŒ‰ç…§è¿™æ ·çš„æ ¼å¼å³å¯</p><pre><code>dependencies {    //support    api deps.support.appCompat    api deps.support.recyclerview    api deps.support.cardview    api deps.support.design    api deps.multidex    api deps.constraint    //rxjava    api deps.rxLibs.rxJava    api deps.rxLibs.rxAndroid    api deps.rxLibs.rxRelay    //http    api deps.okhttp.okhttp    api deps.okhttp.okhttpLogging    api deps.retrofit.retrofit    api deps.retrofit.converterGson    api deps.retrofit.adapterRxjava    api deps.gson    //arch    api deps.archLibs.archExtensions    api deps.archLibs.archRoomRuntime    api deps.archLibs.archLifecycleCommon    annotationProcessor deps.archLibs.archRoomCompiler    //stetho    api deps.stetho.stetho    api deps.stetho.stethoHttp    //dialog    api deps.dialog    //glide    api deps.glide.glide    annotationProcessor deps.glide.glideCompiler}</code></pre>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Gradle</tag>
      
      <tag>ç»„ä»¶åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸ç”¨çš„Google Chrome æµè§ˆå™¨æ’ä»¶</title>
    <link href="undefined2017/12/25/Google-Chrome-Plug-In/"/>
    <url>2017/12/25/Google-Chrome-Plug-In/</url>
    
    <content type="html"><![CDATA[<p>###å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„Chromeæ’ä»¶</p><p><strong>1.<a href="https://chrome.google.com/webstore/detail/adblock/gighmmpiobklfepjocnamgkkbiglidom" target="_blank" rel="noopener">AdBlock</a></strong></p><p>æœ€å—æ¬¢è¿çš„Chromeæ‰©å±•ï¼Œæ‹¥æœ‰è¶…è¿‡4000ä¸‡ç”¨æˆ·ï¼å±è”½æ•´ä¸ªäº’è”ç½‘ä¸Šçš„å¹¿å‘Šã€‚</p><p><img src="../images/adblock.png" srcset="/img/loading.gif" alt="adblock"></p><p>æ¨è: â˜…â˜…â˜…</p><a id="more"></a><p><strong>2.<a href="https://chrome.google.com/webstore/detail/insightio-for-github/pmhfgjjhhomfplgmbalncpcohgeijonh" target="_blank" rel="noopener">Insight.io for Github</a></strong></p><p>Improve GitHub code browsing experienc.<br>é€šè¿‡æ’ä»¶å¯ä»¥åœ¨githubçš„é¡¹ç›®é¡µé¢ä¸Š,ç»“æ„åŒ–çš„æŸ¥çœ‹ä»£ç ,ç”šè‡³è¿˜æœ‰â€å¼•ç”¨â€,â€æŸ¥æ‰¾â€ç­‰ç­‰åŠŸèƒ½.<br>å°±åƒæ˜¯æŠŠgithubé¡¹ç›®é¡µ,å˜æˆäº†ä¸€ä¸ªåªèƒ½æŸ¥çœ‹çš„ide.<br>å¯¹äº†,è¿˜èƒ½å¾ˆæ–¹ä¾¿çš„ä¸‹è½½å•ä¸ªæ–‡ä»¶</p><p><img src="/images/chrome_insight.io.png" srcset="/img/loading.gif" alt="Insight.io for Github"></p><p>æ¨è: â˜…â˜…â˜…â˜…â˜…</p><p><strong>3.<a href="https://chrome.google.com/webstore/detail/infinity-new-tab/dbfmnekepjoapopniengjbcpnbljalfg" target="_blank" rel="noopener">Infinityæ–°æ ‡ç­¾é¡µ</a></strong></p><p>é‡æ–°å®šä¹‰äº†æ–°æ ‡ç­¾é¡µï¼Œä¸€ä¸ªè¿½æ±‚æç®€ç¾å­¦å’Œä¸€ç«™å¼æœåŠ¡ä½“éªŒæ›´å°‘çš„ä¸œè¥¿ä½“éªŒæ›´å¤šçš„åŠŸèƒ½ã€‚</p><p>ç®€æ´,æ–¹ä¾¿,å®ç”¨</p><p><img src="/images/chrome_infinity.png" srcset="/img/loading.gif" alt="Infinityæ–°æ ‡ç­¾é¡µ"></p><p>æ¨è:â˜…â˜…â˜…â˜…</p><p><strong>4.<a href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop" target="_blank" rel="noopener">Postman</a></strong><br>Postman makes API development faster, easier, and better.</p><p>æ›´å¿«â€¦..å“ˆå“ˆ<br>è¶…çº§æ–¹ä¾¿,æ¨¡æ‹Ÿè¯·æ±‚çš„App,æ”¯æŒpost get,å¯ä»¥æµ‹è¯•æ–‡ä»¶ä¸Šä¼ ç­‰<br>è¿˜æœ‰æ¯”è¾ƒæ–¹ä¾¿çš„ä¸€ç‚¹æ˜¯,å¯ä»¥ç”Ÿæˆå½“å‰è¯·æ±‚çš„okhttpä»£ç ,è™½ç„¶åªèƒ½ä½œå‚è€ƒâ€¦..</p><p>æ¨è:â˜…â˜…â˜…â˜…â˜…</p><blockquote><p>å’Œå®ƒä¸€æ ·çš„è¿˜æœ‰<a href="https://chrome.google.com/webstore/detail/restlet-client-rest-api-t/aejoelaoggembcahagimdiliamlcdmfm" target="_blank" rel="noopener">Restlet Client - REST API Testing</a></p></blockquote><p><strong>5.<a href="https://github.com/acgotaku/BaiduExporter" target="_blank" rel="noopener">BaiduExporter</a></strong><br>å¯ä»¥æ–¹ä¾¿çš„æŠŠç½‘ç›˜çš„ä¸‹è½½åœ°å€å¯¼å‡ºåˆ°aria2/aria2-rpcï¼Œæ”¯æŒYAAWã€‚<br>é…åˆAria2GUI,å¯ä»¥é«˜é€Ÿä¸‹è½½ç™¾åº¦äº‘é™é€Ÿçš„æ–‡ä»¶..</p><p>è™½ç„¶è¿˜èƒ½ç”¨,ä½†æ˜¯ä½œè€…è¯´ä¸ç»´æŠ¤äº†,è¿˜æœ‰æ›¿ä»£å“:<a href="https://chrome.google.com/webstore/detail/aria2c-integration/edcakfpjaobkpdfpicldlccdffkhpbfk?hl=en-US" target="_blank" rel="noopener">Aria2c Integration</a>æ²¡æœ‰ç”¨è¿‡,ä¸çŸ¥é“æ˜¯å¦å¯ç”¨.</p><p><a href="https://aria2.github.io/" target="_blank" rel="noopener">Aria2GUI</a><br>Github : <a href="https://github.com/aria2/aria2" target="_blank" rel="noopener">https://github.com/aria2/aria2</a></p><p>æ¨è:â˜…â˜…â˜…â˜…â˜…</p><p><strong>å…¶ä»–</strong><br>æ¨è:â˜…â˜…â˜…</p><p><a href="https://chrome.google.com/webstore/detail/singlefile/mpiodijhokgodhhofbcjdecpffjipkle" target="_blank" rel="noopener">SingleFile</a><br>Archive a complete page into a single HTML file<br>å¯ä»¥å°†ç½‘é¡µä¿å­˜ä¸ºå•æ–‡ä»¶,æ–¹ä¾¿ä¿å­˜</p><p><a href="https://chrome.google.com/webstore/detail/evernote-web-clipper/pioclpoplcdbaefihamjohnefbikjilc" target="_blank" rel="noopener">å°è±¡ç¬”è®°Â·å‰ªè—</a><br>ä½¿ç”¨å°è±¡ç¬”è®°æ‰©å±•ç¨‹åºä¸€é”®ä¿å­˜ç²¾å½©ç½‘é¡µå†…å®¹åˆ°å°è±¡ç¬”è®°å¸æˆ·ã€‚</p><p><a href="https://github.com/callumlocke/json-formatter" target="_blank" rel="noopener">JSON Formatter</a><br>Chrome extension for printing JSON and JSONP nicely when you visit it â€˜directlyâ€™ in a browser tab.<br>Github : <a href="https://github.com/callumlocke/json-formatter" target="_blank" rel="noopener">https://github.com/callumlocke/json-formatter</a></p>]]></content>
    
    
    <categories>
      
      <category>Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jniä½¿ç”¨æŒ‡å—,å…³äº.soä½ åº”è¯¥çŸ¥é“çš„</title>
    <link href="undefined2017/12/25/jni-with-so/"/>
    <url>2017/12/25/jni-with-so/</url>
    
    <content type="html"><![CDATA[<p><strong>å…¶å®è¿™äº›éƒ½æ˜¯Androidè®¾å¤‡CPUçš„:</strong></p><ul><li><p>armeabi: æ—©æœŸçš„æ‰‹æœºç”¨çš„æ¯”è¾ƒå¤š,é’ˆå¯¹æ™®é€šçš„æˆ–æ—§çš„arm v5 cpu,ã€‚</p></li><li><p>armeabiv-v7a:ç›®å‰ä¸»æµç‰ˆæœ¬ 2011å¹´ä»¥åçš„ç”Ÿäº§çš„å¤§éƒ¨åˆ†è®¾å¤‡,é’ˆå¯¹æœ‰æµ®ç‚¹è¿ç®—æˆ–é«˜çº§æ‰©å±•åŠŸèƒ½çš„arm v7 cpu.</p></li><li>arm64-v8a:  8ä»£ã€64ä½ARMå¤„ç†å™¨ï¼Œ64ä½æ”¯æŒ.</li><li>x86: æˆ‘ä»¬è§åˆ°çš„æ¨¡æ‹Ÿå™¨å¤§å¤šå°±æ˜¯è¿™ä¸ªã€‚</li><li>x86_64: 64ä½çš„å¹³æ¿ã€‚</li></ul><p>ç„¶åç‰¹æ„è¯´ä¸€ä¸‹x86ç³»åˆ—çš„,æ˜¯å…¼å®¹armçš„,ä½†æ˜¯æ€§èƒ½æŸå¤±ç‰¹åˆ«å¤§.</p><a id="more"></a><p><strong>AndroidåŠ è½½.soçš„åŸåˆ™</strong><br>åŒä¸€ç›®å½•ä¸‹è¦ä¹ˆæ‰€æœ‰ä½¿ç”¨jniçš„é¡¹ç›®éƒ½ç»™åŠ ä¸Š.soæ–‡ä»¶,<br>è¦ä¹ˆä½ å°±åˆ«ç»™è¿™ä¸ªç›®å½•,ä¹Ÿå°±æ˜¯åªè¦ä¸é½å…¨å°±éƒ½å¹²æ‰<br>æ¯”å¦‚ä½ çš„libç»“æ„æ˜¯è¿™æ ·çš„</p><pre><code>libs  -armeabi      -aaa.so      -bbb.so  -arm64-v8a      -aaa.so</code></pre><p>å…¶å®è¿™ç§æƒ…å†µå°±æ˜¯å±äºåŒä¸€ç›®å½•ä¸‹,æä¾›çš„.soæ–‡ä»¶ä¸å…¨â€¦ç„¶è€Œå¾ˆå®¹æ˜“å‡ºç°,æ¯•ç«Ÿæœ‰äº›ä¸‰æ–¹å•Šä»€ä¹ˆçš„,æä¾›çš„.soæ–‡ä»¶å¹¶ä¸é½å…¨,è¿™æ ·çš„è¯åŒä¸€ä¸ªæ¶æ„ç›®å½•ä¸‹ä¼šç¼ºå°‘ä¸€ä¸ªæˆ–å¤šä¸ª.soæ–‡ä»¶.</p><p>Androidåœ¨åŠ è½½æŸä¸ªä½¿ç”¨jniçš„åŠŸèƒ½æ—¶,ä½ å¹¶æ²¡æœ‰æä¾›x86çš„.soæ–‡ä»¶,ä½†æ˜¯ä½ æœ‰x86è¿™ä¸ªç›®å½•,é‚£å°±ä¼šå»x86ç›®å½•ä¸‹å»æ‰¾,<strong>æ²¡æœ‰å•Š</strong>ç„¶åå°±å¼‚å¸¸äº†.</p><p><strong>AndroidåŠ è½½.soçš„ç›®å½•</strong><br>1.æˆ‘è‡ªå·±ç”¨çš„æ˜¯</p><p><img src="http://upload-images.jianshu.io/upload_images/2520304-4f36025e8667df85.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" srcset="/img/loading.gif" alt="Snip20170309_1.png"></p><p>ä¹Ÿå°±æ˜¯è‡ªå·±åœ¨app -&gt; src -&gt; main ä¸‹è‡ªå·±å»ºç«‹ä¸€ä¸ªç›®å½•: jniLibs<br>ç„¶åæ”¾è¿›å»å³å¯.</p><p>2.å°±æ˜¯é€šå¸¸æ”¾åœ¨libsç›®å½•ä¸‹äº†<br>åˆ«å¿˜äº†åœ¨build.gradleæ–‡ä»¶ä¸­è®¾ç½®   jniLibs.srcDir </p><p><strong>Androidæ’é™¤æŸæ¶æ„çš„.so</strong></p><pre><code>android {    ...    defaultConfig {            ...        ndk {            // è®¾ç½®æ”¯æŒçš„ SO åº“æ„æ¶            abiFilters &#39;armeabi&#39;, &#39;armeabi-v7a&#39;     // &#39;arm64-v8a&#39;, &#39;x86&#39;, &#39;x86_64&#39;, &#39;mips&#39;, &#39;mips64&#39;        }    }   }</code></pre><p>å¦‚æœç¼–è¯‘æŠ¥</p><pre><code>NDK integration is deprecated in the current plugin.</code></pre><p> gradle.properties æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><pre><code>android.useDeprecatedNdk=true</code></pre><p>åº”è¯¥è¿˜æœ‰å…¶ä»–æ–¹æ³•æ’é™¤,æˆ‘ä¹Ÿå°±çŸ¥é“è¿™ä¸€ç§,å¦‚æœæœ‰çŸ¥é“å…¶ä»–æ–¹æ³•çš„,è¯·å‘ŠçŸ¥ä¸€ä¸‹,è°¢è°¢</p>]]></content>
    
    
    
    <tags>
      
      <tag>JNIï¼ŒAndroid</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>EditTextçš„è¾“å…¥å±æ€§InputTypeä»¥åŠimeOptions</title>
    <link href="undefined2017/12/25/EditText-InputType-imeOptions/"/>
    <url>2017/12/25/EditText-InputType-imeOptions/</url>
    
    <content type="html"><![CDATA[<p><strong>EditTextçš„è¾“å…¥å±æ€§</strong></p><pre><code>android:imeOptions=&quot;flagNoExtractUi&quot;  //ä½¿è½¯é”®ç›˜ä¸å…¨å±æ˜¾ç¤ºï¼Œåªå ç”¨éƒ¨åˆ†å±å¹•android:imeOptions=&quot;actionNone&quot;  //è¾“å…¥æ¡†å³ä¾§ä¸å¸¦ä»»ä½•æç¤ºandroid:imeOptions=&quot;actionGo&quot;    //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;å¼€å§‹&#39;android:imeOptions=&quot;actionSearch&quot;  //å³ä¸‹è§’æŒ‰é”®ä¸ºæœç´¢android:imeOptions=&quot;actionSend&quot;    //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;å‘é€&#39;android:imeOptions=&quot;actionNext&quot;   //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;ä¸‹ä¸€æ­¥&#39;android:imeOptions=&quot;actionDone&quot;  //å³ä¸‹è§’æŒ‰é”®å†…å®¹ä¸º&#39;å®Œæˆ&#39;</code></pre><a id="more"></a><p><strong>EditTextçš„inputTypeå±æ€§</strong></p><pre><code>&lt;EditText    android:inputType=&quot;phone&quot; //ç”µè¯å·ç     android:inputType=&quot;none&quot;     android:inputType=&quot;text&quot;  //æ–‡æœ¬ç±»å‹    android:inputType=&quot;textCapCharacters&quot; //å­—æ¯å¤§å†™     android:inputType=&quot;textCapWords&quot; //é¦–å­—æ¯å¤§å†™     android:inputType=&quot;textCapSentences&quot; //ä»…ç¬¬ä¸€ä¸ªå­—æ¯å¤§å†™     android:inputType=&quot;textAutoCorrect&quot; //è‡ªåŠ¨å®Œæˆ     android:inputType=&quot;textAutoComplete&quot; //è‡ªåŠ¨å®Œæˆ     android:inputType=&quot;textMultiLine&quot; //å¤šè¡Œè¾“å…¥     android:inputType=&quot;textImeMultiLine&quot; //è¾“å…¥æ³•å¤šè¡Œ    android:inputType=&quot;textNoSuggestions&quot; //ä¸æç¤º     android:inputType=&quot;textUri&quot; //ç½‘å€     android:inputType=&quot;textEmailAddress&quot; //ç”µå­é‚®ä»¶åœ°å€     android:inputType=&quot;textEmailSubject&quot; //é‚®ä»¶ä¸»é¢˜     android:inputType=&quot;textShortMessage&quot; //çŸ­è®¯     android:inputType=&quot;textLongMessage&quot; //é•¿ä¿¡æ¯     android:inputType=&quot;textPersonName&quot; //äººå     android:inputType=&quot;textPostalAddress&quot; //åœ°å€    android:inputType=&quot;textPassword&quot; //å¯†ç      android:inputType=&quot;textVisiblePassword&quot; //å¯è§å¯†ç     android:inputType=&quot;textWebEditText&quot; //ä½œä¸ºç½‘é¡µè¡¨å•çš„æ–‡æœ¬     android:inputType=&quot;textFilter&quot; //æ–‡æœ¬ç­›é€‰è¿‡æ»¤     android:inputType=&quot;textPhonetic&quot; //æ‹¼éŸ³è¾“å…¥     android:inputType=&quot;number&quot; //æ•°å­—     android:inputType=&quot;numberSigned&quot; //å¸¦ç¬¦å·æ•°å­—æ ¼å¼     android:inputType=&quot;numberDecimal&quot; //å¸¦å°æ•°ç‚¹çš„æµ®ç‚¹æ ¼å¼     android:inputType=&quot;datetime&quot; //æ—¶é—´æ—¥æœŸ     android:inputType=&quot;date&quot; //æ—¥æœŸé”®ç›˜     android:inputType=&quot;time&quot; //æ—¶é—´é”®ç›˜    /&gt;</code></pre>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TextViewä¸­çš„æ–‡å­—é¢œè‰²,ç‚¹å‡»,æ–œä½“ç­‰å®ç°--SpannableString</title>
    <link href="undefined2017/12/25/textview-span/"/>
    <url>2017/12/25/textview-span/</url>
    
    <content type="html"><![CDATA[<p><strong>ä¸€èˆ¬å®ç°æ–¹å¼å¦‚ä¸‹</strong>:</p><pre><code>String html = &quot;æ–‡å­—&lt;font color=\&quot;red\&quot;&gt;å˜è‰²&lt;/font&gt;çš„æ•ˆæœ&quot;;tvMainShow.setText(Html.fromHtml(html));</code></pre><p>ä½¿ç”¨Htmlçš„æ–¹å¼æ¥å®ç°,ç®€å•çš„è¿˜å¥½,å¤æ‚ä¸€ç‚¹çš„çœŸçš„å¾ˆä¸æ–¹ä¾¿</p><p>Googleæ˜¾ç„¶æ—©å°±å·²ç»æƒ³åˆ°äº†è¿™æ ·çš„é—®é¢˜,æ‰€ä»¥  </p><blockquote><p><a href="https://developer.android.com/reference/android/text/SpannedString.html" target="_blank" rel="noopener">SpannedString</a> &amp; <a href="https://developer.android.com/reference/android/text/SpannableStringBuilder.html" target="_blank" rel="noopener">SpannableStringBuilder</a> å°±æ˜¯å¹²è¿™ä¸ªçš„</p></blockquote><p>ä»–ä»¬éƒ½å®ç°äº† <a href="https://developer.android.com/reference/java/lang/CharSequence.html" target="_blank" rel="noopener">CharSequence</a>,çœ¼ç†Ÿä¹ˆ?  <code>setText(CharSequence text)</code>.ä¹Ÿå°±æ˜¯è¯´,ä½ å¯ä»¥ç›´æ¥èµ‹å€¼ç»™TextView</p><a id="more"></a><p>ä»–ä»¬ä¸¤ä¸ªçš„åŒºåˆ«å°±æ˜¯<br>This is the class for text whose content is immutable but to which markup objects can be attached and detached. For mutable text, see SpannableStringBuilder<br>æ–‡æ¡£è¯´çš„å¾ˆæ¸…æ¥šäº†,å°±æ˜¯CharSequenceæ˜¯å›ºå®šé•¿åº¦çš„,ä¸€æ—¦é€šè¿‡ new SpannableString(â€œè®¾ç½®æ–‡å­—â€);åˆ™ä¸å¯ä»¥æ›´æ”¹æ–‡å­—å†…å®¹,è€ŒSpannableStringBuilderæ˜¯å¯ä»¥çš„,ä¸ªäººç†è§£æ¯”è¾ƒåƒString å’Œ StringBuilder çš„å…³ç³»</p><p>###ä¸å¤šè¯´äº†,å¼€æ:<br><strong>1.è®¾ç½®æ–‡å­—</strong></p><p><code>SpannableString spannableString = new SpannableString(&quot;æ–‡å­—çš„å‰æ™¯è‰²ä¸èƒŒæ™¯è‰²&quot;);</code></p><p><strong>2.é€šè¿‡setSpanæ¥ä¿®æ”¹æ–‡å­—çš„æ ·å¼</strong><br><code>setSpan [Object what, int start, int end, int flags)</code></p><p><img src="http://upload-images.jianshu.io/upload_images/2520304-e821febbebd4f8dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" srcset="/img/loading.gif" alt="å…¥å‚.png"></p><p>flags:<br>Spannable.SPAN_EXCLUSIVE_EXCLUSIVEï¼šå‰åéƒ½ä¸åŒ…æ‹¬<br>Spannable.SPAN_EXCLUSIVE_INCLUSIVE    ï¼šå‰é¢ä¸åŒ…æ‹¬<br>Spannable.SPAN_INCLUSIVE_EXCLUSIVE    ï¼šå‰é¢åŒ…æ‹¬<br>Spannable.SPAN_INCLUSIVE_INCLUSIVE    ï¼šå‰åéƒ½åŒ…æ‹¬</p><p>ä¸ºäº†è¯´æ˜è¿™å››ä¸ªå‚æ•°,æœ‰ä¾‹å­å¦‚ä¸‹:</p><p><img src="http://upload-images.jianshu.io/upload_images/2520304-3784e1b0d6a15d73.gif?imageMogr2/auto-orient/strip" srcset="/img/loading.gif" alt="flags.gif"><br>ä»£ç å¦‚ä¸‹:</p><pre><code>/* * * @author ç‹è¯›é­” 2017/1/21 ä¸Šåˆ11:31 * @e-mail  phyooos@163.com */public class MainActivity extends AppCompatActivity {    @BindView(R.id.edit_show)    EditText etMainShow;    @BindView(R.id.tab_view)    TabLayout tabLayout;    @Override    public void onCreate(@Nullable Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_main);        ButterKnife.bind(this);        showText(Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);        tabLayout.setOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {            @Override            public void onTabSelected(TabLayout.Tab tab) {                switch (tab.getPosition()) {                    case 0:                        showText(Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);                        break;                    case 1:                        showText(Spannable.SPAN_EXCLUSIVE_INCLUSIVE);                        break;                    case 2:                        showText(Spannable.SPAN_INCLUSIVE_EXCLUSIVE);                        break;                    case 3:                        showText(Spannable.SPAN_INCLUSIVE_INCLUSIVE);                        break;                }            }            @Override            public void onTabUnselected(TabLayout.Tab tab) {            }            @Override            public void onTabReselected(TabLayout.Tab tab) {            }        });    }    /**     * å±•ç¤ºæ–‡å­—     */    private void showText(int type) {        //æ„é€ SpannableString        SpannableString spanString = new SpannableString(&quot;è¿™é‡Œæ˜¯ç‹è¯›é­”çš„ç®€ä¹¦æ–‡ç« &quot;);        //å­—ä½“é¢œè‰²çš„Span        ForegroundColorSpan span = new ForegroundColorSpan(Color.RED);        //æŒ‡å®šèŒƒå›´        spanString.setSpan(span, 3, 6, type);        //è®¾ç½®ç»™EditTextæ˜¾ç¤ºå‡ºæ¥        etMainShow.setText(spanString);    }}</code></pre><p>ä¸Šé¢çš„ä»£ç ä¸­:</p><pre><code>//å­—ä½“é¢œè‰²çš„SpanForegroundColorSpan span = new ForegroundColorSpan(Color.RED);ForegroundColorSpanå°±æ˜¯è®¾ç½®çš„æ–‡å­—æ ·å¼,,è¿™ä¸ªæ˜¯å‰æ™¯è‰²,,ä¹Ÿå°±æ˜¯å­—ä½“çš„é¢œè‰²//æŒ‡å®šèŒƒå›´spanString.setSpan(span, 3, 6, type);è¿™é‡Œçš„ä¸‰ä¸ªå‚æ•°å·²ç»åœ¨ä¸Šé¢è¯´è¿‡äº†,é€šè¿‡ä¸Šé¢çš„ä»£ç ä¹Ÿä¼šå‘ç°,å…¶å®3,6  å…¶ä¸­ä¸‹æ ‡3æ˜¯åŒ…å«çš„,è€Œä¸‹æ ‡6å°±ä¸ä¼šæ”¹å˜</code></pre><hr><p><strong>3.è‡³äºSpançš„è¿™äº›ä¸ªæ ·å¼åœ¨å“ªé‡Œæ‰¾,è¯·çœ‹æ–‡æ¡£:</strong><br><strong>å…³é”®è¯:<a href="https://developer.android.com/reference/android/text/style/CharacterStyle.html" target="_blank" rel="noopener">CharacterStyle</a></strong></p><blockquote><p><a href="https://developer.android.com/reference/android/text/style/CharacterStyle.html" target="_blank" rel="noopener">https://developer.android.com/reference/android/text/style/CharacterStyle.html</a></p></blockquote><p><img src="http://upload-images.jianshu.io/upload_images/2520304-50978874ad4c3a7f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" srcset="/img/loading.gif" alt="Spançš„ä¸€äº›ç±»å‹.png"></p><p>è¯´å‡ ä¸ªå¸¸ç”¨çš„å§:</p><ul><li>ForegroundColorSpan  å­—ä½“é¢œè‰²</li><li>BackgroundColorSpan å­—ä½“èƒŒæ™¯è‰²è®¾ç½®</li><li>AbsoluteSizeSpan å­—ä½“å¤§å°</li><li><p>StyleSpan ç²—ä½“ç­‰</p><pre><code>//å­—ä½“ç”±Typefaceæ¥æ§åˆ¶StyleSpan span = new StyleSpan(Typeface.BOLD_ITALIC);</code></pre></li><li><p>UnderlineSpan ä¸‹åˆ’çº¿</p></li><li>ImageSpan å›¾ç‰‡ç½®æ¢</li></ul><p><a href="https://developer.android.com/reference/android/text/style/ImageSpan.html" target="_blank" rel="noopener">ImageSpan https://developer.android.com/reference/android/text/style/ImageSpan.html</a></p><p>è¿™ä¸ªæœ‰ä¸€ç‚¹ä¸åŒ,å®ƒæ˜¯å°†æ–‡å­—ä¸­çš„æŒ‡å®šéƒ¨åˆ†æ›¿æ¢ä¸ºä¸€ä¸ªå›¾ç‰‡,è‡³äºå¦‚ä½•æ„é€ è¯·å‚è€ƒæ–‡æ¡£<br>è®©æˆ‘æƒ³èµ·æ¥äº†é‚£ä¸ªEmojiEditTextçš„åº“,å…¶å®å¯ä»¥ç”¨è¿™ä¸ªImageSpanå®ç°ä¸€ä¸ªç®€å•çš„å¯ä»¥æ˜¾ç¤ºè¡¨æƒ…çš„TextView</p><ul><li>ClickableSpan ç‚¹å‡»</li></ul><pre><code>//è¿™ä¸ªæœ‰äº›ä¸åŒ,éœ€è¦class CustomClickable extends ClickableSpan {    @Override    public void updateDrawState(TextPaint ds) {        //è¿™é‡Œå…¶å®è¿˜å¯ä»¥å¯¹å¯ç‚¹å‡»éƒ¨åˆ†è®¾ç½®ä¸€äº›ä¸œè¥¿    }    @Override    public void onClick(View widget) {          ...do something    }}//å¯¹äº†,åŠ ä¸Šè¿™è¡Œä»£ç TextView.setMovementMethod(LinkMovementMethod.getInstance());//è¦ä¸ç‚¹ä¸åŠ¨å“¦</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/2520304-7ccd2161c4d5f5e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" srcset="/img/loading.gif" alt="2017-04-05_23-36-38.png"></p><ul><li>URLSpan è¿™ä¸ªå®Œå…¨å¯ä»¥ç”¨ClickableSpanå®ç°</li></ul><p><strong>SpannableStringBuilder</strong></p><p>SpannableStringéƒ½è¯´çš„è¿™ä¹ˆæ˜ç™½äº†,SpannableStringBuilderå°±çœäº†</p><p>####End</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter å®‰è£…</title>
    <link href="undefined2017/12/25/Flutter-install-net-error/"/>
    <url>2017/12/25/Flutter-install-net-error/</url>
    
    <content type="html"><![CDATA[<blockquote><p>ä½¿ç”¨ç³»ç»ŸMac OS</p></blockquote><p>å·²ç»æ²¡åŠæ³•ç»™å¤§å®¶çœ‹é—®é¢˜äº†,æˆ‘åœ¨githubä¸Šæäº†é—®é¢˜.</p><p><a href="https://github.com/flutter/flutter/issues/11674" target="_blank" rel="noopener">github issue</a></p><pre><code>ä½¿ç”¨å‘½ä»¤ command`flutter doctor`å¼‚å¸¸:exceptionSocketException: SocketException: Connection failed (OS Error: No route to host, errno = 65), address = android.googlesource.com, port = 443</code></pre><p>æ€»çš„æ¥è¯´å°±æ˜¯ä¸‹è½½ Downloading Gradle Wrapperâ€¦çš„æ—¶å€™è¿æ¥ä¸åˆ°å¤–ç½‘,ä»¥è‡³äºå¤±è´¥</p><a id="more"></a><p>githubä¸Šçš„è¿™ä½å°å“¥æé†’äº†æˆ‘<a href="https://github.com/lishuhao" target="_blank" rel="noopener">@lishuhao</a></p><blockquote><p><a href="https://github.com/eseidelgoogle" target="_blank" rel="noopener">@eseidelGoogle</a>itâ€™s reachable via https from Chrome<br>Maybe his chrome use proxy but terminal not use proxy.</p></blockquote><p>æˆ‘ç¡®å®å¼€äº†ss,ä½†æ˜¯ç»ˆç«¯ç¡®å®è¿æ¥ä¸åˆ°ä»£ç†çš„,ä¸èµ°ä»£ç†,é‚£å½“ç„¶æ— è§£</p><p>##è§£å†³:</p><p>####1.Macä¸‹ä½¿ç”¨Homebrewå®‰è£…</p><pre><code>brew install polipo</code></pre><p>####2.ä¿®æ”¹é…ç½®</p><pre><code>ln -sfv /usr/local/opt/polipo/*.plist ~/Library/LaunchAgents</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/2520304-bfa92bf302955c0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" srcset="/img/loading.gif" alt="image.png"></p><pre><code>vim /usr/local/opt/polipo/homebrew.mxcl.polipo.plist</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/2520304-b14154bf99746494.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" srcset="/img/loading.gif" alt="image.png"></p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ <br><code>&lt;string&gt;socksParentProxy=localhost:1086&lt;/string&gt;</code></p><p>å…¶ä¸­1086è¿™ä¸ªç«¯å£å·,è‡ªå·±å»çœ‹</p><p><img src="http://upload-images.jianshu.io/upload_images/2520304-40564c01c67e3f13.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" srcset="/img/loading.gif" alt="image.png"></p><p>####3.å¯åŠ¨</p><pre><code>launchctl load ~/Library/LaunchAgents/homebrew.mxcl.polipo.plist</code></pre><p>####4.ä½¿ç”¨</p><pre><code>$ http_proxy=http://localhost:8123 curl ip.gsCurrent IP / å½“å‰ IP: 47.90.88.133ISP / è¿è¥å•†:  ALIYUNCity / åŸå¸‚:  Hong KongCountry / å›½å®¶: ChinaIP.GS is now IP.SB, please visit https://ip.sb/ for more IP information, ip.gs will only use for curl purpose. / IP.GS å·²æ›´æ–°è‡³ IP.SB è¯·è®¿é—® https://ip.sb/ è·å–æ›´å¤šä¿¡æ¯, ip.gs åŸŸåä»…ä½œ curl ä½¿ç”¨Please join Telegram group https://t.me/sbfans if you have any issues. / å¦‚æœ‰é—®é¢˜ï¼Œè¯·åŠ å…¥ Telegram ç¾¤ https://t.me/sbfans</code></pre><p>å¯ä»¥çœ‹åˆ°,ç°åœ¨æˆ‘æ˜¯é¦™æ¸¯çš„IPäº†,http_proxy=<a href="http://localhost:8123è¿™ä¸ªæ˜¯æä¾›é»˜è®¤çš„,è‡³äºæ€ä¹ˆä¿®æ”¹æˆ‘æ²¡æœ‰çœ‹,ä¹Ÿä¸çŸ¥é“" target="_blank" rel="noopener">http://localhost:8123è¿™ä¸ªæ˜¯æä¾›é»˜è®¤çš„,è‡³äºæ€ä¹ˆä¿®æ”¹æˆ‘æ²¡æœ‰çœ‹,ä¹Ÿä¸çŸ¥é“</a></p><p><strong>æŠŠä»£ç†è®¾ç½®ä¸ºå…¨å±€çš„</strong></p><pre><code>~ âŒš 11:42:51$ export http_proxy=http://localhost:8123~ âŒš 11:43:02$ export https_proxy=http://localhost:8123~ âŒš 11:43:09$ curl https://www.google.com&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;302 Moved&lt;/H1&gt;The document has moved&lt;A HREF=&quot;https://www.google.com.hk/?gfe_rd=cr&amp;ei=5FaaWZDNOMLU8Af_nriwDw&quot;&gt;here&lt;/A&gt;.&lt;/BODY&gt;&lt;/HTML&gt;~ âŒš 11:43:33$ curl www.google.com&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;&lt;TITLE&gt;302 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;302 Moved&lt;/H1&gt;The document has moved&lt;A HREF=&quot;http://www.google.com.hk/?gfe_rd=cr&amp;ei=6laaWZqEO8_U8AeLlID4CA&quot;&gt;here&lt;/A&gt;.&lt;/BODY&gt;&lt;/HTML&gt;</code></pre><p>####5.End</p><p>##è§è¯å¥‡è¿¹çš„æ—¶åˆ»åˆ°äº†</p><pre><code>~/develop/flutter on î‚  alpha! âŒš 11:44:11$ flutter doctorDownloading Gradle Wrapper...                         1.3s[âœ“] Flutter (on Mac OS X 10.12.6 16G29, locale zh-Hans-CN, channel alpha)    â€¢ Flutter at /Users/phyooos/develop/flutter    â€¢ Framework revision b156a0f054 (9 days ago), 2017-08-11 22:01:40 -0700    â€¢ Engine revision fef7d827d6    â€¢ Tools Dart version 1.25.0-dev.9.0[âœ“] Android toolchain - develop for Android devices (Android SDK 26.0.1)    â€¢ Android SDK at /Users/phyooos/Library/Android/sdk    â€¢ Platform android-26, build-tools 26.0.1    â€¢ ANDROID_HOME = /Users/phyooos/Library/Android/sdk    â€¢ Java binary at: /Applications/Android Studio.app/Contents/jre/jdk/Contents/Home/bin/java    â€¢ Java version OpenJDK Runtime Environment (build 1.8.0_112-release-b06)[-] iOS toolchain - develop for iOS devices    âœ— Xcode installation is incomplete; a full installation is necessary for iOS development.      Download at: https://developer.apple.com/xcode/download/      Or install Xcode via the App Store.      Once installed, run:        sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer    âœ— libimobiledevice and ideviceinstaller are not installed or require updating. To update, run:        brew uninstall --ignore-dependencies libimobiledevice        brew install --HEAD libimobiledevice        brew install ideviceinstaller    âœ— ios-deploy not installed. To install:        brew install ios-deploy    âœ— CocoaPods not installed.        CocoaPods is used to retrieve the iOS platform side&#39;s plugin code that responds to your plugin usage on the Dart side.        Without resolving iOS dependencies with CocoaPods, plugins will not work on iOS.        For more info, see https://flutter.io/platform-plugins      To install:        brew install cocoapods        pod setup[âœ“] Android Studio (version 2.3)    â€¢ Android Studio at /Applications/Android Studio.app/Contents    â€¢ Java version OpenJDK Runtime Environment (build 1.8.0_112-release-b06)[âœ“] IntelliJ IDEA Ultimate Edition (version 2017.1.3)    â€¢ Flutter plugin version 16.0    â€¢ Dart plugin version 171.4424.63[âœ“] Connected devices    â€¢ None</code></pre><p>æˆ‘çš„Flutterå°±okäº†</p>]]></content>
    
    
    <categories>
      
      <category>Flutter</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Flutter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BottomNavigationViewä½¿ç”¨æŒ‡å—</title>
    <link href="undefined2017/12/25/BottomNavigationView/"/>
    <url>2017/12/25/BottomNavigationView/</url>
    
    <content type="html"><![CDATA[<p><strong>æœ€ç»ˆæ•ˆæœ:</strong></p><p><img src="http://upload-images.jianshu.io/upload_images/2520304-f952921225e06fb8.gif?imageMogr2/auto-orient/strip" srcset="/img/loading.gif" alt="æœ€åæ•ˆæœ.gif"></p><p>Android Support Library 25 ä»¥ä¸Šçš„supportåŒ…ä¸­å¢åŠ äº† BottomNavigationView<br>æ‰€ä»¥ä½ å¿…é¡»ä½¿ç”¨<code>com.android.support:design:25.0.0</code>ä»¥ä¸Šçš„ç‰ˆæœ¬æ‰èƒ½ç©</p><a id="more"></a><p>1.åœ¨ build.gradle æ–‡ä»¶ä¸­å¢åŠ ä¾èµ–ï¼š</p><blockquote><p><code>compile &#39;com.android.support:design:25.0.0&#39;</code></p></blockquote><p>2.åœ¨main_activity.xmlä¸­æ·»åŠ :</p><pre><code>&lt;android.support.design.widget.BottomNavigationView        android:id=&quot;@+id/bottom_nav&quot;        android:layout_width=&quot;match_parent&quot;        android:layout_height=&quot;@dimen/title_height&quot;        android:layout_alignParentBottom=&quot;true&quot;        app:menu=&quot;@menu/menu_tab_button&quot;        app:itemIconTint=&quot;@color/nav_color_select&quot;        app:itemTextColor=&quot;@color/nav_color_select&quot;        app:itemBackground=&quot;@color/text_white_color&quot;&gt;    &lt;/android.support.design.widget.BottomNavigationView&gt;</code></pre><ul><li>å…¶ä¸­<code>app:menu=&quot;@menu/menu_tab_button&quot;</code>å†³å®šäº†å±•ç¤ºå‡ ä¸ªitem,éƒ½é•¿ä»€ä¹ˆæ ·</li><li>å…¶ä¸­,åˆ†åˆ«å†³å®š<strong>å›¾æ ‡å’Œæ–‡å­—</strong>é€‰ä¸­å’Œæœªé€‰ä¸­itemçš„çŠ¶æ€,é¢œè‰²</li></ul><pre><code>app:itemIconTint=&quot;@color/nav_color_select&quot;app:itemTextColor=&quot;@color/nav_color_select&quot;</code></pre><ul><li>å…¶ä¸­<code>app:itemBackground=&quot;@color/text_white_color&quot;</code>åˆ™æ˜¯æ•´ä¸ªviewçš„èƒŒæ™¯é¢œè‰²</li></ul><p>3.menu_tab_button.xmlçš„ä»£ç å¦‚ä¸‹:</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&gt;    &lt;item        android:id=&quot;@+id/mian_tab_statistics&quot;        android:enabled=&quot;true&quot;        android:checked=&quot;true&quot;     //é»˜è®¤é€‰ä¸­        android:title=&quot;@string/nav_tongji&quot;        android:icon=&quot;@drawable/tongji&quot;/&gt;    &lt;item android:id=&quot;@+id/mian_tab_paidui&quot;        android:enabled=&quot;true&quot;        android:title=&quot;@string/nav_paidui&quot;   //æ–‡å­—å†…å®¹        android:icon=&quot;@drawable/paidui&quot;/&gt;   //iconå›¾æ ‡    &lt;item android:id=&quot;@+id/mian_tab_find&quot;        android:enabled=&quot;true&quot;        android:title=&quot;@string/nav_faxiang&quot;        android:icon=&quot;@drawable/faxian&quot;/&gt;    &lt;item android:id=&quot;@+id/mian_tab_more&quot;        android:enabled=&quot;true&quot;        android:title=&quot;@string/nav_more&quot;        android:icon=&quot;@drawable/more&quot;/&gt;&lt;/menu&gt;</code></pre><p>###ç„¶è€Œ,ä½ ä»¥ä¸ºä¼šè¿™ä¹ˆç®€å•?? shiftingModeæ•™ä½ åšäºº()</p><p>###è¿™ä¸ªåªä¼šåœ¨itemä¸ªæ•°è¶…è¿‡3ä¸ªæ‰ä¼šå‡ºç°.</p><p><img src="http://upload-images.jianshu.io/upload_images/2520304-464b090fa4c8919c.gif?imageMogr2/auto-orient/strip" srcset="/img/loading.gif" alt="ç‰›é€¼çš„ç‰¹æ•ˆ(shiftingMode).gif"></p><p>4.è¿™è®©æˆ‘å¦‚ä½•æ˜¯å¥½?çœ‹äº†åŠå¤©,åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€ä¸ªæ–¹æ³•.</p><pre><code>/** * ä¸€ä¸ªå…³äºBottomNavigationViewçš„å¸®åŠ©ç±»,ç”¨æ¥å…³é—­shiftingMode * @author ç‹è¯›é­” 2017/2/10 ä¸‹åˆ6:35 * @e-mail phyooos@163.com */public class BNVHelper {    public static void disableShiftMode(BottomNavigationView navigationView) {        BottomNavigationMenuView menuView = (BottomNavigationMenuView) navigationView.getChildAt(0);        try {            Field shiftingMode = menuView.getClass().getDeclaredField(&quot;mShiftingMode&quot;);            shiftingMode.setAccessible(true);            shiftingMode.setBoolean(menuView, false);            shiftingMode.setAccessible(false);            for (int i = 0; i &lt; menuView.getChildCount(); i++) {                BottomNavigationItemView itemView = (BottomNavigationItemView) menuView.getChildAt(i);                itemView.setShiftingMode(false);                itemView.setChecked(itemView.getItemData().isChecked());            }        } catch (NoSuchFieldException e) {            // Log        } catch (IllegalAccessException e) {            // Log        }    }}</code></pre><p>åŸä½œè€…@<a href="http://www.jianshu.com/u/4d132a94e6e8" target="_blank" rel="noopener">ChristmasJason</a>:<a href="http://www.jianshu.com/p/e2a8791e80d6" target="_blank" rel="noopener">http://www.jianshu.com/p/e2a8791e80d6</a></p><p>ç„¶åæˆ‘çœ‹äº†ä¸€ä¸‹æºç <strong>mShiftingMode</strong> è¿™ä¸ªå¸ƒå°”å€¼å†³å®šäº†æ˜¯å¦å¯ç”¨shiftingMode,æ‰€ä»¥ä¸Šé¢çš„æ–¹æ³•å°±æ˜¯shiftingMode.setBoolean(menuView, false);</p><p>ç„¶åå°±å¥½äº†â€¦â€¦</p><p>æç¤º:<br>googleè¯´é€‰ä¸­å›¾æ ‡çš„é¢œè‰²æ˜¯è¿™ä¹ˆæ”¹çš„,ç„¶è€Œéƒ½æ˜¯éª—äººçš„,è¿™ä¸ªåº”è¯¥æ˜¯é»˜è®¤çš„è®¾ç½®,æˆ‘ä¹Ÿå·æ‡’æ²¡æœ‰éªŒè¯</p><p><img src="http://upload-images.jianshu.io/upload_images/2520304-c6c71ad14a9e0106.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" srcset="/img/loading.gif" alt="2017-02-21_17-59-10.png"></p><pre><code>app:itemIconTint=&quot;@color/nav_color_select&quot;app:itemTextColor=&quot;@color/nav_color_select&quot;</code></pre><p>å…¶å®ä½ é…ç½®äº†ä¹‹å,å°±æ˜¯è¿™ä¸ªä¸œè¥¿æ¥å†³å®šçš„,è€Œä¸æ˜¯appâ€™s primary color<br>nav_color_select.xmlè¿™å°±æ˜¯ä¸ªé€‰æ‹©å™¨,ä»£ç å¦‚ä¸‹:</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;    &lt;item android:state_checked=&quot;true&quot;  android:color=&quot;@color/colorPrimary&quot; /&gt;    &lt;item android:state_pressed=&quot;true&quot;  android:color=&quot;@color/colorPrimary&quot; /&gt;    &lt;item android:color=&quot;@color/gray_light&quot; /&gt;&lt;/selector&gt;</code></pre><p>####End,åˆ°è¿™é‡Œä½ çš„å¯¼èˆªæ¡ä¹Ÿåº”è¯¥okäº†</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>View</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android Studio ä½¿ç”¨æ­£å¼ç­¾ådebugè°ƒè¯•</title>
    <link href="undefined2017/12/25/Android-Studio-signature-debug/"/>
    <url>2017/12/25/Android-Studio-signature-debug/</url>
    
    <content type="html"><![CDATA[<p>###è§£å†³é—®é¢˜:</p><blockquote><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä½¿ç”¨ç¬¬ä¸‰æ–¹ç™»å½•ä»€ä¹ˆçš„ä¸œè¥¿,éœ€è¦æˆ‘ä»¬æä¾›æ­£å¼ç­¾å,ä½†æ˜¯æˆ‘ä»¬æ€»æ˜¯éœ€è¦è°ƒè¯•çš„.<br>ä¸€èˆ¬æƒ…å†µ,æˆ‘ä»¬ä¸å¯èƒ½ä¸€æ¬¡æ€§OK,é‚£ä¹ˆæ¯ä¸€æ¬¡è°ƒè¯•éƒ½éœ€è¦æ­£å¼ç­¾åæ‰“åŒ…,å¹¶å®‰è£…,ç„¶åå†è°ƒè¯•,è¿™ä¹Ÿå¤ªéº»çƒ¦äº†,.</p></blockquote><p>æ‰€ä»¥,ç›´æ¥ä¸Šä»£ç :</p><pre><code>signingConfigs {        release {            keyAlias &#39;phyooos&#39;            keyPassword &#39;phyooos&#39;            storeFile file(&#39;phyooos.jks&#39;)            storePassword &#39;phyooos&#39;        }    }    buildTypes {        release {            minifyEnabled false            signingConfig signingConfigs.release            proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;        }        debug{            minifyEnabled false            signingConfig signingConfigs.release            proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;        }    }</code></pre><p><strong>è§£é‡Šä¸€ä¸‹:</strong></p><pre><code>signingConfigs {        release {            keyAlias &#39;phyooos&#39;            keyPassword &#39;phyooos&#39;            storeFile file(&#39;phyooos.jks&#39;)            storePassword &#39;phyooos&#39;        }    }</code></pre><p>è¿™ä¸€æ®µä»£ç å†™åœ¨é¡¹ç›®appç›®å½•ä¸‹&gt;gradleé…ç½®æ–‡ä»¶ä¸­&gt;androidèŠ‚ç‚¹ä¸‹,<br>æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸€ä¸ªé…ç½®</p><ul><li>keyAlias â€˜phyooosâ€™  è¿™æ˜¯ç­¾åæ–‡ä»¶çš„Alias</li><li>keyPassword â€˜phyooosâ€™   è¿™æ˜¯ç­¾åæ–‡ä»¶çš„å¯†ç </li><li>storeFile file(â€˜phyooos.jksâ€™)  è¿™ä¸ªå°±æ˜¯ç­¾åæ–‡ä»¶çš„åœ°å€,æˆ‘æ”¾åœ¨appç›®å½•ä¸‹äº†</li><li>storePassword â€˜phyooosâ€™  è¿™æ˜¯storeå¯†ç </li></ul><hr><pre><code>buildTypes {        release {            minifyEnabled false            signingConfig signingConfigs.release            proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;        }        debug{            minifyEnabled false            signingConfig signingConfigs.release            proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;        }    }</code></pre><p>è¿™ä¸€æ®µçš„æ„æ€å°±æ˜¯debugè°ƒè¯•ä»¥åŠæ­£å¼æ‰“åŒ…éƒ½ä½¿ç”¨ä¸Šé¢è‡ªå®šä¹‰çš„é…ç½®</p><h4 id="The-End-å¥½äº†-æ„‰å¿«çš„ç©è€å§"><a href="#The-End-å¥½äº†-æ„‰å¿«çš„ç©è€å§" class="headerlink" title="The End   å¥½äº†,æ„‰å¿«çš„ç©è€å§"></a>The End   å¥½äº†,æ„‰å¿«çš„ç©è€å§</h4>]]></content>
    
    
    <categories>
      
      <category>Android Studio</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Android Studio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½åŠŸè€—è“ç‰™iBeaconçš„å¼€å‘ç¬”è®°</title>
    <link href="undefined2017/12/25/Bluetooth-iBeacon/"/>
    <url>2017/12/25/Bluetooth-iBeacon/</url>
    
    <content type="html"><![CDATA[<p>###1.æŒ£æ‰çš„å¼€å§‹<br>å„ç§ç™¾åº¦,google,å‘ç°å›½å†…èµ„æ–™å¾ˆå°‘,æœ‰çš„ä¹Ÿæ˜¯å•†ä¸šå…¬å¸æä¾›çš„sdk,è¿™å¹¶ä¸ç¬¦åˆæˆ‘éœ€è¦,<br>googleå€’æ˜¯ä¸å°‘,ç„¶è€Œä»¥æˆ‘çš„è‹±è¯­æ°´å¹³,æœ›æ´‹å…´å¹ç½¢äº†@</p><blockquote><p>é¦–å…ˆä½ éœ€è¦äº†è§£è¿™äº›èµ„æ–™<br>1ã€profile<br> rofileå¯ä»¥ç†è§£ä¸ºä¸€ç§è§„èŒƒï¼Œä¸€ä¸ªæ ‡å‡†çš„é€šä¿¡åè®®ï¼Œå®ƒå­˜åœ¨äºä»æœºä¸­ã€‚è“ç‰™ç»„ç»‡è§„å®šäº†ä¸€äº›æ ‡å‡†çš„profileï¼Œä¾‹å¦‚ HID OVER GATT ï¼Œé˜²ä¸¢å™¨ ï¼Œå¿ƒç‡è®¡ç­‰ã€‚æ¯ä¸ªprofileä¸­ä¼šåŒ…å«å¤šä¸ªserviceï¼Œæ¯ä¸ªserviceä»£è¡¨ä»æœºçš„ä¸€ç§èƒ½åŠ›ã€‚</p><p>2ã€service<br>serviceå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæœåŠ¡ï¼Œåœ¨bleä»æœºä¸­ï¼Œé€šè¿‡æœ‰å¤šä¸ªæœåŠ¡ï¼Œä¾‹å¦‚ç”µé‡ä¿¡æ¯æœåŠ¡ã€ç³»ç»Ÿä¿¡æ¯æœåŠ¡ç­‰ï¼Œæ¯ä¸ªserviceä¸­åˆåŒ…å«å¤šä¸ªcharacteristicç‰¹å¾å€¼ã€‚æ¯ä¸ªå…·ä½“çš„characteristicç‰¹å¾å€¼æ‰æ˜¯bleé€šä¿¡çš„ä¸»é¢˜ã€‚æ¯”å¦‚å½“å‰çš„ç”µé‡æ˜¯80%ï¼Œæ‰€ä»¥ä¼šé€šè¿‡ç”µé‡çš„characteristicç‰¹å¾å€¼å­˜åœ¨ä»æœºçš„profileé‡Œï¼Œè¿™æ ·ä¸»æœºå°±å¯ä»¥é€šè¿‡è¿™ä¸ªcharacteristicæ¥è¯»å–80%è¿™ä¸ªæ•°æ®</p><p>3ã€characteristic<br>characteristicç‰¹å¾å€¼ï¼Œbleä¸»ä»æœºçš„é€šä¿¡å‡æ˜¯é€šè¿‡characteristicæ¥å®ç°ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ ‡ç­¾ï¼Œé€šè¿‡è¿™ä¸ªæ ‡ç­¾å¯ä»¥è·å–æˆ–è€…å†™å…¥æƒ³è¦çš„å†…å®¹ã€‚</p><p>4ã€UUID<br>UUIDï¼Œç»Ÿä¸€è¯†åˆ«ç ï¼Œæˆ‘ä»¬åˆšæ‰æåˆ°çš„serviceå’Œcharacteristicï¼Œéƒ½éœ€è¦ä¸€ä¸ªå”¯ä¸€çš„uuidæ¥æ ‡è¯†<br>S: ç™¾åº¦åˆ°çš„,æˆ‘ä»¥ä¸€ä¸ªè¿‡æ¥äººçš„èº«ä»½ä¿è¯è¿™ä¸ªå¾ˆé‡è¦</p></blockquote><a id="more"></a><p>###2.èµ„æ–™,å‡†å¤‡<br>èµ„æ–™çœ‹è¿™é‡Œ:</p><ul><li>è¿™ä¹Ÿæ˜¯æœ€é‡è¦çš„èµ„æ–™æ¥æº,è°·æ­ŒSDKçš„ä¾‹å­é‡Œé¢æœ‰çš„é¡¹ç›®<br><img src="http://img.blog.csdn.net/20160710190336812" srcset="/img/loading.gif" alt="Android SDK ä¸­çš„docæ–‡æ¡£"></li></ul><ul><li>æ¥ä¸Šæ–‡,è¯´å®Œèµ„æ–™,<blockquote><p>è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„demo<br>sdk\samples\android-22\connectivity\BluetoothLeGatt</p></blockquote></li></ul><p>è¯¥ç›®å½•ä¸‹ä¸ºè°·æ­Œæä¾›çš„demo,æˆ‘çš„åº”ç”¨ä¹Ÿæ˜¯åœ¨å®ƒçš„åŸºç¡€ä¸Šæ”¹è¿›è€Œæˆçš„.<br>ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆ:</p><ol><li><p>ä¸€ä¸ªæœåŠ¡ BluetoothLeService,ä¸»è´Ÿè´£ä¸è“ç‰™è®¾å¤‡è¿›è¡Œæ•°æ®äº¤æ¢</p></li><li><p>ä¸¤ä¸ªactivity:DeviceControlActivity,DeviceScanActivity</p><pre><code>è§åçŸ¥æ„,ä¸€ä¸ªè´Ÿè´£æ‰«æè®¾å¤‡,è€Œä¸¤å¤–ä¸€ä¸ªä¸è®¾å¤‡è¿›è¡Œäº¤äº’</code></pre></li><li><p>ä¸€ä¸ªSampleGattAttributes<br>   ä¸»è¦æ˜¯å­˜å‚¨äº†ä¸€äº›UUID,æˆ‘å¯¹å®ƒè¿›è¡Œäº†åŠ å¼º</p></li></ol><p>###3.BLEè®¾å¤‡çš„ä½¿ç”¨æ­¥éª¤æ¦‚å†µ</p><ol><li>é¦–å…ˆè¦è¯´æ˜çš„ä¸€ç‚¹æ˜¯,è¦æ±‚Androidç‰ˆæœ¬ä¸º4.3åŠå…¶ä»¥ä¸Š<br>  æ¥ç€ç¡®è®¤è®¾å¤‡æ”¯æŒ</li></ol><pre><code>/** * æ”¯æŒBLE *  check to determine whether BLE is supported on the device */public void isSupported(){     if (!getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH_LE)) {            Toast.makeText(this, &quot;è®¾å¤‡ä¸æ”¯æŒBLEåŠŸèƒ½&quot;, Toast.LENGTH_SHORT).show();        }    }</code></pre><ol><li>ç¡®è®¤æ‰‹æœºæ”¯æŒå¹¶æ‰“å¼€è“ç‰™çš„çŠ¶æ€ä¸‹,ä½ å°±å¯ä»¥è¿›è¡Œè®¾å¤‡çš„æœç´¢äº†<br>   æœ‰ä¸¤ç§æ¨¡å¼</li></ol><pre><code>//ç¬¬ä¸€ç§//serviceUuids   æŒ‡å®šè®¾å¤‡çš„UUID//callback       æœç´¢çš„å›è°ƒstartLeScan(final UUID[] serviceUuids, final LeScanCallback callback)//ç¬¬äºŒç§//å…¶å®å°±æ˜¯ä¸ä¼ å…¥serviceUuidsçš„,å°±æ˜¯è¯´æœç´¢èŒƒå›´å†…æ‰€æœ‰è“ç‰™è®¾å¤‡public boolean startLeScan(LeScanCallback callback) {     return startLeScan(null, callback);}</code></pre><ol><li>åŒæ—¶è®°å¾—åœæ­¢æœç´¢,å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸€ç›´æœ<br>PSï¼šå…¶å®æˆ‘è§åˆ°çš„appå¤§éƒ¨åˆ†æ˜¯ä¸åœçš„æœç´¢ï¼Œè¿™æ ·çš„è¯ä¼šæœ‰ä¸€ä¸ªå¹¿æ’­æ•°æ®æŒç»­åˆ·æ–°çš„æ•ˆæœ,é‚£ä¹ˆå¾ˆå¤šçš„è·ç¦»åˆ¤æ–­ä»€ä¹ˆçš„éƒ½æ˜¯é€šè¿‡è¿™ç§ä¸åœæœç´¢çš„å½¢å¼æ¥å·¥ä½œçš„</li></ol><pre><code>//mBluetoothAdapter   è¯·è‡ªè¡ŒæŸ¥çœ‹è°·æ­Œæ–‡æ¡£//mLeScanCallback     è¿™å°±æ˜¯ä¸Šé¢æè¿‡çš„LeScanCallbackçš„å®ä¾‹mBluetoothAdapter.stopLeScan(mLeScanCallback);</code></pre><p>æ¥ç€å°±æ˜¯åœ¨å›è°ƒä¸­æ‹¿åˆ°å„ä¸ªè®¾å¤‡æ•°æ®äº†</p><pre><code>/** * æœç´¢è®¾å¤‡å›è°ƒ  */private BluetoothAdapter.LeScanCallback mLeScanCallback =            new BluetoothAdapter.LeScanCallback() {    @Override    public void onLeScan(final BluetoothDevice device, int rssi,             byte[] scanRecord) {    }};</code></pre><p>è¿™é‡Œæœ‰å‡ ä¸ªå€¼å¾—è¯´ä¸€ä¸‹çš„ä¸œè¥¿</p><ul><li><strong>BluetoothDevice device</strong><br><img src="http://img.blog.csdn.net/20160712000123059" srcset="/img/loading.gif" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"><br>  è¯¥å¯ä»¥çœ‹çš„å¾ˆæ¸…æ¥š,    deviceä¸­åŒ…å«äº†è®¾å¤‡çš„åŸºæœ¬ä¿¡æ¯               </li></ul><ul><li><strong>rssiä¿¡å·è´¨é‡,ä¹Ÿæœ‰äººå‘Šè¯‰æˆ‘æ˜¯è´¨é‡</strong><br>ä¸è¿‡æˆ‘è¿™æ¬¡å¹¶æ²¡æœ‰ä½¿ç”¨åˆ°</li></ul><ul><li><strong>byte[] scanRecord (é‡å¤´æˆ)</strong><br>å¹¿æ’­å“åº”åŒ…æ•°æ®<br>ä¸€èˆ¬åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†,æˆ‘ä½¿ç”¨çš„ä¸»è¦æ˜¯ServiceDataåŸŸ<br><strong>åœ¨è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªéƒ¨åˆ†éƒ½å­˜åœ¨äºå¹¿æ’­æ•°æ®ï¼Œè€Œä¸”å¹¶ä¸æ˜¯ä¸¤éƒ¨åˆ†éƒ½æœ‰ï¼Œæœ‰å¯èƒ½æ˜¯åªæœ‰ä¸€ä¸ªéƒ¨åˆ†ï¼Œæ‰€ä»¥ä¸€å®šè¦çœ‹æƒ…è®¾å¤‡çš„ç¡¬ä»¶è§„èŒƒï¼Œå› ä¸ºè¿™æ¶‰åŠåˆ°åé¢è§£æå¹¿æ’­æ•°æ®</strong></li></ul><p>è¦çŸ¥é“ï¼Œæˆ‘ä»¬éƒ½æ˜¯æ‹¿byte[]æ•°ç»„ä¸­çš„æŸäº›éƒ¨åˆ†å¯¹åº”ç‰¹å®šå€¼,ä¸€æ—¦å¯¹åº”å…³ç³»æ‰“ä¹±ï¼Œé‚£ä¹ˆæ•°æ®è§£æå°±æ²¡ä»€ä¹ˆæ­£ç¡®æ€§å¯è¨€äº†<br>è¿™äº›å¹¿æ’­æ•°æ®éƒ½æ˜¯ä¾æ®ä¸€å®šçš„è§„åˆ™æŒ‡å®š çš„,æ‰€ä»¥è¿™æ—¶å€™ä½ éœ€è¦è®¾å¤‡å‚å•†çš„æ–‡æ¡£æ¥æŸ¥çœ‹å¯¹åº”çš„æ•°æ®,ä»¥åŠå…¶ç»“æ„<br>PS:éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯,è¿™äº›æ•°æ®éƒ½æ˜¯byte[],ä½ éœ€è¦å°†å®ƒä»¬è½¬åŒ–(ä¸€èˆ¬å¸¸ç”¨çš„åšæ³•æ˜¯,å…ˆè½¬åŒ–ä¸º16è¿›åˆ¶çš„å­—ç¬¦ä¸²,è€Œåå†è¿›è¡Œè¯»å–è§£æ)</p><p>###4.è¯»å–è“ç‰™è®¾å¤‡å†…éƒ¨æ•°æ®<br>è¿™é‡Œæ¶‰åŠåˆ°ä¸¤ä¸ªé‡è¦éƒ¨åˆ†<br>service  ä»¥åŠ characteristic</p><p>ä¸€èˆ¬æ¥è¯´<br> ä¸€ä¸ªService  eg: FF01-XXXXXXXXXXX-XXXXX<br> ä¸‹é¢å¯èƒ½æœ‰å¾ˆå¤šçš„characteristic<br>Marjor : FF16 -XXXXXX<br>Power : FF17 - XXX<br>â€¦.ä¸€å †çš„characteristic </p><ul><li><strong>å¦‚æœéœ€è¦ç»™æŒ‡å®šçš„é¡¹ç›®å†™å…¥ä¸€ä¸ªæ•°æ®</strong><br> æ¡ä»¶ï¼š<pre><code>          1.æ­¤ç‰¹å¾åœ¨å“ªä¸ªServiceä¸‹ï¼Œå³è¯¥serviceçš„UUID          2.è¯¥ç‰¹å¾çš„UUID          3.è¯¥ç‰¹å¾çš„å†™å…¥æ ¼å¼ï¼Œ16è¿›åˆ¶è¿˜æ˜¯å…¶ä»–çš„ä¸œè¥¿</code></pre></li></ul><pre><code>//ä»£ç ç‰‡æ®µ1//æ­¤æ–¹æ³•è·å–å¯¹åº”ç‰¹å¾å€¼çš„å¯¹è±¡BluetoothGattCharacteristicçš„å®ä½“    public BluetoothGattCharacteristic getCharacteristic(String service,String charact) {        if (mBluetoothGatt == null) return null;        if(mBluetoothGatt.getService(UUID.fromString(service))==null){return null ;}        return mBluetoothGatt.getService(UUID.fromString(service)).getCharacteristic(UUID.fromString(charact));    }</code></pre><pre><code>//ä»£ç ç‰‡æ®µ2if(!TextUtils.isEmpty(value)){//è¾“å…¥éç©º      byte[] arrayOfByte= new byte[2];//ä¼ å…¥æ•°æ®è§„å®šä¸º2ä¸ªbyte      arrayOfByte[0] = ((byte)Integer.parseInt((value).substring(0, 2), 16));      arrayOfByte[1] = ((byte)Integer.parseInt((value).substring(2, 4), 16));      //ä¸Šé¢æ“ä½œï¼Œå…ˆåˆ‡ï¼Œå†è½¬ä¸º16è¿›åˆ¶      characteristic.setValue(arrayOfByte);      //characteristicå®ä½“å°±æ˜¯ç‰‡æ®µ1ä»£ç è·å–åˆ°çš„      gattServer.writeCharacteristic(characteristic);      //æ‰€æœ‰çš„æ“ä½œéƒ½å°è£…åœ¨ä¸€ä¸ªserviceä¸­ï¼ŒgattServerä¸ºå…¶å®ä½“å¯¹è±¡}</code></pre><pre><code>  //ç‰‡æ®µ3å°±æ˜¯æœåŠ¡ä¸­çš„å†™å…¥æ–¹æ³•  /**     * å†™å…¥ä¸€ä¸ªæ•°æ®     * @param characteristic     */    public void writeCharacteristic(BluetoothGattCharacteristic characteristic) {        mBluetoothGatt.setCharacteristicNotification(characteristic, true);        mBluetoothGatt.writeCharacteristic(characteristic);    }</code></pre><pre><code>//ä»£ç ç‰‡æ®µ4   è¿™æ˜¯å›è°ƒï¼Œ//åœ¨è¿æ¥æ—¶å°±ä½œä¸ºå‚æ•°ä¼ å…¥äº† mBluetoothGatt = device.connectGatt(this, false, mGattCallback);private final BluetoothGattCallback mGattCallback = new BluetoothGattCallback() {        @Override        public void onConnectionStateChange(BluetoothGatt gatt, int status, int newState) {            if (newState == BluetoothProfile.STATE_CONNECTED) {                            Log.e(TAG, &quot;è¿æ¥è‡³ GATT server.&quot;);            } else if (newState == BluetoothProfile.STATE_DISCONNECTED) {                Log.e(TAG, &quot;æ–­å¼€ GATT server.&quot;);                         }        }        @Override        public void onServicesDiscovered(BluetoothGatt gatt, int status) {            if (status == BluetoothGatt.GATT_SUCCESS) {                Log.e(TAG, &quot;å»ºç«‹è¿æ¥æˆåŠŸ&quot;);                          } else {                Log.e(TAG, &quot;è¿æ¥çŠ¶æ€å¼‚å¸¸: &quot; + status);            }        }        @Override        public void onCharacteristicWrite(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, int status) {            if (status == BluetoothGatt.GATT_SUCCESS) {                  Log.e(TAG, &quot;å†™å…¥æ•°æ®æˆåŠŸ&quot;);               }         }        @Override        public void onCharacteristicRead(BluetoothGatt gatt, BluetoothGattCharacteristic                characteristic, int status) {            if (status == BluetoothGatt.GATT_SUCCESS) {               Log.e(TAG, &quot;è¯»å–æ•°æ®æˆåŠŸ&quot;);               }        }        @Override        public void onCharacteristicChanged(BluetoothGatt gatt,                                            BluetoothGattCharacteristic characteristic) {            Log.e(TAG, &quot;è¿æ¥çŠ¶æ€å‘ç”Ÿæ”¹å˜&quot;);              };}</code></pre><blockquote><p>PS:<strong>è¿™é‡Œçš„ä¾‹å­æ˜¯å†™å…¥ï¼Œå…¶å®è¯»å–çš„æ“ä½œä¸æ­¤ç±»ä¼¼ï¼Œæ“ä½œå®Œæˆååœ¨å›è°ƒé‡Œé¢åˆ¤æ–­çŠ¶æ€ä»¥åŠè¯»å–æ•°æ®å³å¯</strong></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android Studio åŸºæœ¬è®¾ç½®</title>
    <link href="undefined2017/12/25/Android-Studio-Config/"/>
    <url>2017/12/25/Android-Studio-Config/</url>
    
    <content type="html"><![CDATA[<p>####1.å¸¸ç”¨çš„å¿«æ·é”®</p><ul><li>ALT + Enter è‡ªåŠ¨æç¤º</li><li><p>ALT + Ins<br><img src="http://img.blog.csdn.net/20160503215809984" srcset="/img/loading.gif" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><blockquote><p>get set æ„é€ æ–¹æ³•  é‡å†™æ–¹æ³•<br>ä»¥åŠä¸€äº›æ’ä»¶å¦‚è¿™é‡Œçš„ GsonFormat ä»¥åŠ Butterknife</p></blockquote></li><li><p>Ctrl + Alt + F  å…¨å±€å˜é‡</p></li><li><p>Ctrl +Shift + Enter   åŠ ; ä»¥åŠif çš„(){}</p></li><li><p>Ctrl + P  ä»¥åŠ  Ctrl + Q  æ–¹æ³•å‚æ•°ä»¥åŠæ–‡æ¡£</p></li><li><p>Ctrl +O ç»§æ‰¿é‡å†™çš„æ–¹æ³•</p></li><li><p>Ctrl + /   Ctrl +Shift + /    æ³¨é‡Š</p></li><li><p>Ctrl + Alt + L æ ¼å¼åŒ–</p></li><li><p>Ctrl + D  Ctrl + Y   å¤åˆ¶ åˆ é™¤è¡Œ</p></li><li><p>Ctrl + Shift + U å¤§å°å†™</p></li><li><p>Shift Shift     Ctrl + F  å…¨å±€  å½“å‰ æœç´¢ </p></li><li><p>Ctrl + U åˆ°çˆ¶ç±»</p></li><li><p>Ctrl + Alt + B æ‰¾åˆ°å­ç±»</p></li><li><p>Ctrl + H     ç±»ç»“æ„</p></li><li><p>Ctrl+Shift + H   æ–¹æ³•å±‚æ¬¡</p></li><li><p>Ctrl + Alt + H   è°ƒç”¨å±‚æ¬¡</p></li><li><p>Alt + F7  find use  éå¸¸å¥½ç”¨çš„åŠŸèƒ½</p></li><li><p>Shift + F6  é‡å‘½å</p></li><li><p>logt + Enter    Tag </p></li><li><p>loge logd â€¦    æ‰“å°log</p></li></ul><hr><p>####2.è‡ªåŠ¨ç”Ÿæˆä»£ç  </p><blockquote><p>Ctrl  + J   </p></blockquote><p><img src="http://img.blog.csdn.net/20160503222913571" srcset="/img/loading.gif" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>é‡Œé¢ç›¸å½“å¤šçš„æ¨¡ç‰ˆä»£ç </p><pre><code>if åˆ¤ç©º     ifnfor å¾ªç¯     for foreach     foreachsetVisibility     gonefindViewById   fbcinstanceof    inst</code></pre><p>è¿™äº›æ¯”è¾ƒå¸¸ç”¨</p><p>####3.è‡ªåŠ¨å¯¼å…¥åŒ…<br>Settings&gt;Editor&gt;General&gt;Auto import<br><img src="http://img.blog.csdn.net/20160503215409545" srcset="/img/loading.gif" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>####4.å…¶ä»–è®¾ç½®å·²ç»å¯¼å‡º</p><blockquote><p>ps : åœ¨ç™¾åº¦äº‘é‡Œæœ‰<br><img src="http://img.blog.csdn.net/20160503223900468" srcset="/img/loading.gif" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Android Studio</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android Studio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android Studio å¯¼å…¥ VitamioåŠæ¨ªç«–å±åˆ‡æ¢</title>
    <link href="undefined2017/12/25/Android-Studio-Vitamio/"/>
    <url>2017/12/25/Android-Studio-Vitamio/</url>
    
    <content type="html"><![CDATA[<p>##å»ºè®®ä¸è¦ä½¿ç”¨Vitamio,å„ç§æ·±å‘</p><blockquote><p><a href="https://github.com/Bilibili/ijkplayerçœ‹çœ‹bilibiliçš„å¼€æºæ’­æ”¾å™¨" target="_blank" rel="noopener">https://github.com/Bilibili/ijkplayerçœ‹çœ‹bilibiliçš„å¼€æºæ’­æ”¾å™¨</a></p></blockquote><p>##Vitamio<br>å®˜æ–¹:<a href="https://www.vitamio.org/" target="_blank" rel="noopener">https://www.vitamio.org/</a><br>GitHub:<a href="https://github.com/yixia/VitamioBundle" target="_blank" rel="noopener">https://github.com/yixia/VitamioBundle</a></p><blockquote><p><a href="https://www.vitamio.org/" target="_blank" rel="noopener">Vitamio</a> èƒ½å¤Ÿæµç•…æ’­æ”¾720Pç”šè‡³1080Pé«˜æ¸…MKVï¼ŒFLVï¼ŒMP4ï¼ŒMOVï¼ŒTSï¼ŒRMVBç­‰å¸¸è§æ ¼å¼çš„è§†é¢‘ï¼Œæ”¯æŒ MMS, RTSP, RTMP, HLS(m3u8) ç­‰å¸¸è§çš„å¤šç§è§†é¢‘æµåª’ä½“åè®®ï¼ŒåŒ…æ‹¬ç‚¹æ’­ä¸ç›´æ’­ã€‚</p></blockquote><a id="more"></a><p>###ä¸‹è½½Vitamio<br>  <img src="http://img.blog.csdn.net/20160408235109325" srcset="/img/loading.gif" alt="å»å®˜ç½‘ä¸‹è½½å³å¯"></p><ul><li>åœ°å€<a href="https://www.vitamio.org/Download/" target="_blank" rel="noopener">https://www.vitamio.org/Download/</a></li></ul><hr><p>###è§£å‹å¹¶å¯¼å…¥Android</p><ul><li><p>æ‰¾åˆ°åˆ°æ–‡ä»¶å¤¹VitamioBundle</p><p><img src="http://img.blog.csdn.net/20160408235743265" srcset="/img/loading.gif" alt="VitamioBundle"></p></li><li><p>File &gt; New &gt; New Module<br><img src="http://img.blog.csdn.net/20160409000630784" srcset="/img/loading.gif" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p></li><li><p>å¯¼å…¥å®Œæˆåæ˜¯è¿™æ ·çš„</p><p><img src="http://img.blog.csdn.net/20160409001321974" srcset="/img/loading.gif" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p></li></ul><p>###å¯¼å…¥åˆ°è‡ªå·±çš„é¡¹ç›®</p><p>(å³ä¸ä½¿ç”¨Vitamioçš„libiary,å¼ºè¿«ç—‡ä¸“å±)</p><p><img src="http://img.blog.csdn.net/20160908231510455" srcset="/img/loading.gif" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>####A.åœ¨è‡ªå·±çš„ç›®å½•ä¸‹å»ºç«‹io.vov.vitamio<br>    å¹¶å¯¼å…¥æ‰€æœ‰çš„ç±»,ä»¥åŠå°†jniLibsç›®å½•æ‹·è´åˆ°mainç›®å½•ä¸‹,è¿˜æœ‰ç›¸å…³çš„èµ„æºæ–‡ä»¶</p><p>####B.åœ¨AndroidManifest.xmlæ–‡ä»¶ä¸­å†™å…¥</p><pre><code>&lt;activity android:name=&quot;io.vov.vitamio.activity.InitActivity&quot;             android:configChanges=&quot;orientation|screenSize|smallestScreenSize|keyboard|keyboardHidden|navigation&quot;android:launchMode=&quot;singleTop&quot;android:theme=&quot;@android:style/Theme.NoTitleBar&quot;android:windowSoftInputMode=&quot;stateAlwaysHidden&quot;/&gt;</code></pre><blockquote><p>å¹¶åŠ å…¥ç›¸åº”çš„æƒé™</p></blockquote><p>####C.åœ¨ä½ å–œæ¬¢çš„åœ°æ–¹åˆå§‹åŒ–Vitamio<br> å¼€ç©ç¬‘çš„,æ”¾åœ¨activityæˆ–è€…æ˜¯Applicationçš„onCreateä¸­</p><blockquote><p>Vitamio.isInitialized(application.getApplicationContext()); </p></blockquote><hr><p>###Vatimioçš„ä½¿ç”¨</p><p>####A.ç•Œé¢çš„æ­å»º<br><img src="http://img.blog.csdn.net/20160908232554310" srcset="/img/loading.gif" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>å¯ä»¥çœ‹åˆ°<br>    æ•´ä¸ªé¡µé¢ä¸»è¦åˆ†ä¸Šä¸‹ä¸¤å±‚,ä¸»è¦æ˜¯ä¸ºäº†è§†å±å…¨å±çš„æ—¶å€™èƒ½æ–¹ä¾¿çš„éšè—æ•´ä¸ªä¸‹é¢çš„å¸ƒå±€</p><p>####B.ä½¿ç”¨<br>åœ¨æ­¤ä¹‹å‰ä¸ºäº†æ–¹ä¾¿çš„ä½¿ç”¨è§†å±å…¨å±æ’­æ”¾,å¯¹MediaController(package io.vov.vitamio.widget)åšä¸€ä¸ªå°å°çš„æ”¹é€ :<br>æ·»åŠ ä¸€ä¸ªæ„é€ :ä¸»è¦ç”¨äºæŠŠè§†å±,è¿›åº¦æ¡ç­‰æ”¾åˆ°ä¸€ä¸ªViewä¸­,ä¾¿äºå…¨å±å±•ç¤º</p><pre><code>//è¿™ä¸ªå…¨å±çš„æ“ä½œå¯æŠŠæˆ‘éš¾åäº†,çœ‹åˆ°è¿™ä¸ªçœŸçš„æ˜¯ä¸ºåŸä½œè€…çš„æœºæ™ºç‚¹èµ  public MediaController(Context context,boolean fromXml,View container) {    super(context);    initController(context);    mFromXml = fromXml;    mRoot = makeControllerView();    //è¿™ä¸ªåœ°æ–¹çš„FrameLayout.LayoutpParamsæ˜¯å› ä¸ºå¸ƒå±€æ–‡ä»¶ä¸­è¦æŠŠMediaControllerçš„è§†å›¾ä½œä¸ºchildViewåŠ åˆ°ä¸€ä¸ªFrameLayoutä¸­å»    LayoutParams p = new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);    //æƒ³æ€æ ·å¸ƒå±€MediaControllerå°±å°½æƒ…çš„å‘æŒ¥è¿™ä¸ªLayoutParamså§    p.gravity = Gravity.BOTTOM;    mRoot.setLayoutParams(p);    ((FrameLayout)container).addView(mRoot);  }</code></pre><p>æ¥ç€ä½ å°±å¯ä»¥æ„‰å¿«çš„ç©è€äº†:<br>åœ¨oncreateä¸­è°ƒç”¨</p><pre><code>  initVitamioView();</code></pre><pre><code>//åˆå§‹åŒ–æ§ä»¶private void initVitamioView() {//VideoViewmVideoView = (VideoView) findViewById(R.id.buffer);//è¿™ä¸ªå°±æ˜¯åŒ…è£¹æ•´ä¸ªè§†å±æ¨¡å—çš„FrameLayoutfl_controller = (FrameLayout) findViewById(R.id.fl_controller);//ç¼“å†²æ—¶å‡ºç°çš„è¿›åº¦æ¡pb = (ProgressBar) findViewById(R.id.probar);//æ’­æ”¾è¿›åº¦,å¹¶å¯ä»¥æ‹–åŠ¨è°ƒèŠ‚è§†å±æ’­æ”¾ä½ç½®downloadRateView = (TextView) findViewById(R.id.download_rate);loadRateView = (TextView) findViewById(R.id.load_rate);//è®¾ç½®è§†å±setVideoURIå¯ä»¥ç¼“å†²å¹¶æ’­æ”¾//setVideoPath()ç¼“å†²å®Œå†æ’­æ”¾mVideoView.setVideoURI(Uri.parse(TextUtils.isEmpty(path)?defaultPath:path));//è¿™é‡Œä½¿ç”¨è‡ªå®šä¹‰çš„é‚£ä¸ªMediaControlleræ„é€ mMediaController= new MediaController(this, true, fl_controller);//è¿™é‡Œçš„ç›‘å¬å…¶å®æ˜¯åœ¨MediaControllerä¸­è‡ªå·±å®šä¹‰çš„,ä¸»è¦å°±æ˜¯å…¨å±çš„åˆ‡æ¢æŒ‰é’®mMediaController.setOnControllerClick(new MediaController.OnControllerClick() {     @Override     public void OnClick(int type) {         if (type == 0) {  //è¡¨ç¤ºç‚¹å‡»åˆ‡æ¢å…¨å±æŒ‰é’®              if (isPortrait) {                  //ä¸æ˜¯å…¨å±,åˆ‡æ¢ä¸ºå…¨å±                 //ä»£ç å—1               } else {                  //æ˜¯å…¨å±,è¿‘æ¥å°±åˆ‡ä¸ºåŸæ¥çš„å¤§å°                 //ä»£ç å—2               }          }          }        });//ç±»ä¼¼ç»‘å®š mVideoView.setMediaController(mMediaController);//éšè—æ§åˆ¶æ¨¡å—mMediaController.setVisibility(View.GONE);mVideoView.requestFocus();//è®¾ç½®å¯¹è§†å±ä¿¡æ¯çš„ç›‘å¬mVideoView.setOnInfoListener(this);//è§†å±ç¼“å†²çš„ç›‘å¬mVideoView.setOnBufferingUpdateListener(this);//è§†å±OKmVideoView.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {     @Override     public void onPrepared(MediaPlayer mediaPlayer) {         //è®¾ç½®æ’­æ”¾é€Ÿåº¦         mediaPlayer.setPlaybackSpeed(1.0f);            }        });    }</code></pre><blockquote><p>è¡¥å……ä»£ç å—1</p><pre><code>RelativeLayout.LayoutParams fl_lp = new RelativeLayout.LayoutParams(displayheight, displayWidth);                        fl_controller.setLayoutParams(fl_lp);//è®¾ç½®æ¨ªå±                        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);  //è¿™æ ·mVideoViewä¼šè‡ªå·±å……æ»¡å…¨å±                        mVideoView.setVideoLayout(VideoView.VIDEO_LAYOUT_SCALE, 0);                        isPortrait = false;</code></pre><p>ä»£ç å—2</p><pre><code>RelativeLayout.LayoutParams fl_lp = new RelativeLayout.LayoutParams(                                LinearLayout.LayoutParams.MATCH_PARENT,                                DensityUtils.dip2px(ClassRoomActivity.this,200)                        );                        fl_controller.setLayoutParams(fl_lp);                        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);                        isPortrait = true;</code></pre></blockquote><pre><code>/* * æ¨ªç«–å±åˆ‡æ¢çš„æ—¶å€™å›èµ°è¿™ä¸ªå›è°ƒ * */@Overridepublic void onConfigurationChanged(Configuration newConfig) {        //å±å¹•åˆ‡æ¢æ—¶ï¼Œè®¾ç½®å…¨å±        if (this.getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) {            //éšè—ä¸‹é¢çš„å¸ƒå±€å’Œæ ‡é¢˜            tLBelow.setVisibility(View.GONE);            mTitlebar.setVisibility(View.GONE);        }        if (this.getResources().getConfiguration().orientation == Configuration.ORIENTATION_PORTRAIT) {             //æ˜¾ç¤ºä¸‹é¢çš„å¸ƒå±€å’Œæ ‡é¢˜            tLBelow.setVisibility(View.VISIBLE);            mTitlebar.setVisibility(View.VISIBLE);        }        super.onConfigurationChanged(newConfig);    }</code></pre><p>####C.ä¸¤ä¸ªé‡è¦çš„ç›‘å¬(ä¸Šé¢å·²ç»æ³¨å†Œè¿‡äº†)</p><pre><code>//ç¼“å†²çš„ç›‘å¬@Override    public void onBufferingUpdate(MediaPlayer mp, int percent) {    //æ˜¾ç¤ºç¼“å†²è¿›åº¦        loadRateView.setText(percent + &quot;%&quot;);    }</code></pre><pre><code>//è§†å±ä¿¡æ¯ç›‘å¬@Override    public boolean onInfo(MediaPlayer mp, int what, int extra) {        switch (what) {        //å¼€å§‹ç¼“å†²            case MediaPlayer.MEDIA_INFO_BUFFERING_START:                if (mVideoView.isPlaying()) {                    mVideoView.pause();                    pb.setVisibility(View.VISIBLE);                    downloadRateView.setText(&quot;&quot;);                    loadRateView.setText(&quot;&quot;);                    downloadRateView.setVisibility(View.VISIBLE);                    loadRateView.setVisibility(View.VISIBLE);                }                break;                //åœæ­¢ç¼“å†²,è¿™é‡Œè‡ªåŠ¨å¼€å§‹æ’­æ”¾            case MediaPlayer.MEDIA_INFO_BUFFERING_END:                mVideoView.start();                pb.setVisibility(View.GONE);                downloadRateView.setVisibility(View.GONE);                loadRateView.setVisibility(View.GONE);                break;            case MediaPlayer.MEDIA_INFO_DOWNLOAD_RATE_CHANGED:                //ç¼“å†²çš„...é‚£ä¸ªå•¥    change                downloadRateView.setText(&quot;&quot; + extra + &quot;kb/s&quot; + &quot;  &quot;);                break;        }        return true;    }</code></pre><p>###4.å°±è¿™æ ·<br>   å¯¹äº†,å®Œäº‹è®°å¾—</p><pre><code>@Override    protected void onDestroy() {            mVideoView.stopPlayback();           super.onDestroy();    }</code></pre><p>åŸºæœ¬å°±æ˜¯è¿™æ ·äº†,å…¶ä»–çš„é—®é¢˜è‡ªå·±è§£å†³ä¸€ä¸‹å°±å¥½äº†â€¦</p>]]></content>
    
    
    <categories>
      
      <category>Android Studio</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Android Studio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux å­¦ä¹ ç¬”è®°</title>
    <link href="undefined2017/12/24/Linux-learn/"/>
    <url>2017/12/24/Linux-learn/</url>
    
    <content type="html"><![CDATA[<ul><li>netstat -an</li></ul><pre><code>æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¿æ¥</code></pre><ul><li>moreå‘½ä»¤</li></ul><pre><code>é€‰é¡¹-num    æŒ‡å®šå±å¹•çš„è¡Œæ•°ï¼ˆä»¥æ•´æ•°è¡¨ç¤ºï¼‰+num    ä»è¡Œå·numå¼€å§‹æ˜¾ç¤º-d    è®©moreç»™ç”¨æˆ·æ˜¾ç¤ºä¿¡æ¯[Press space to continue, &#39;q&#39; to quit.]-f    ä½¿moreè®¡æ•°é€»è¾‘è¡Œï¼Œè€Œä¸æ˜¯å±å¹•è¡Œï¼ˆé•¿è¡Œä¸ä¼šæ–­åˆ°ä¸‹ä¸€è¡Œï¼‰-s   æŠŠé‡å¤çš„ç©ºè¡Œå‹ç¼©æˆä¸€ä¸ªç©ºè¡Œ-u    é˜²æ­¢ä¸‹åˆ’çº¿äº¤äº’åŸºäºVIM</code></pre><a id="more"></a><ul><li>å­—ç¬¦ç•Œé¢</li></ul><p>1.å­—ç¬¦ç•Œé¢å ç”¨èµ„æºå°‘</p><p>2.å‡å°‘äº†å‡ºé”™,è¢«æ”»å‡»çš„å¯èƒ½</p><ul><li>ä¸€åˆ‡çš†æ–‡ä»¶</li></ul><p>ç”¨æˆ·  ç¡¬ä»¶ æ–‡ä»¶â€¦.</p><ul><li>åˆ†åŒº</li><li>swap å†…å­˜çš„ä¸¤å€</li></ul><p>/ æ ¹åˆ†åŒº</p><p>/boot    bootåˆ†åŒº  200må³å¯  (ä½œä¸ºå¯åŠ¨ç›˜ä½¿ç”¨,å¯åŠ¨éœ€è¦ç©ºé—´)</p><p>/home  </p><p>/etc</p><p>â€¦</p><ul><li>å®‰è£…æ—¥å¿—</li></ul><p>/root/install.log     è®°å½•äº†å®‰è£…åœ¨ç³»ç»Ÿä¸­çš„è½¯ä»¶åŒ…å’Œç‰ˆæœ¬ä¿¡æ¯</p><p>/root/install.log.syslog    å®‰è£…è¿‡ç¨‹çš„è®°å½•</p><p>/root/anaconda-ks.cfg    è®°å½•å®‰è£…è¿‡ç¨‹ä¸­çš„é…ç½®ä¿¡æ¯(ç”¨äºç½‘ç»œæ‰¹é‡å®‰è£…)</p><ul><li>linuxèµ·å§‹ç¬¦</li></ul><pre><code class="shell">[root@hadoop ~]#root ç”¨æˆ·åhadoop  å½“å‰ç”¨æˆ·çš„ä¸»æœºå&quot;~&quot; å½“å‰çš„ç›®å½•, &quot;~&quot;è¡¨ç¤ºå®¶ç›®å½•&quot;#&quot; è¶…çº§ç”¨æˆ·çš„æç¤ºç¬¦&quot;$&quot; æ™®é€šç”¨æˆ·çš„æç¤ºç¬¦</code></pre><pre><code></code></pre><ul><li>-rw-râ€“râ€“</li></ul><pre><code class="shell">drwxr-xr-x. 2 wzm wzm 4096 6æœˆ  21 16:19 Desktop#ä¸€å…±10ä½  drwxr-xr-x#dç¬¬ä¸€ä½ æ–‡ä»¶ç±»å‹( -æ–‡ä»¶  dç›®å½• |è½¯é“¾æ¥æ–‡ä»¶   c  b )#rwx r-x r-xåé¢çš„æ¯ä¸‰ä½æ˜¯ä¸€ç»„ç¬¬ä¸€ä¸ªä¸‰ä½   æ‰€å±è€…uç¬¬äºŒä¸ªä¸‰ä½   æ‰€å±ç»„gç¬¬ä¸‰ä¸ªä¸‰ä½   å…¶ä»–äººo#acfæƒé™rè¯»wå†™xæ‰§è¡Œ</code></pre><ul><li>ç›®å½•</li></ul><pre><code class="shell">/        æ ¹ç›®å½•/etc     é…ç½®æ–‡ä»¶ç›®å½•/bin     ç³»ç»Ÿå‘½ä»¤çš„ç›®å½• (æ™®é€šç”¨æˆ·å³å¯è¯»å–)/sbin    ç³»ç»Ÿå‘½ä»¤çš„ç›®å½• (è¶…çº§ç”¨æˆ·å³å¯è¯»å–)/usr/bin ç³»ç»Ÿå‘½ä»¤çš„ç›®å½• (æ™®é€šç”¨æˆ·å³å¯è¯»å–)/usr/sbinç³»ç»Ÿå‘½ä»¤çš„ç›®å½• (è¶…çº§ç”¨æˆ·å³å¯è¯»å–)/home    æ™®é€šç”¨æˆ·çš„å®¶ç›®å½•/root    è¶…çº§ç”¨æˆ·çš„å®¶ç›®å½•/usr     ç³»ç»Ÿè½¯ä»¶èµ„æºç›®å½•/boot    å¯åŠ¨ç›®å½•/var     ç³»ç»Ÿç›¸å…³æ–‡æ¡£/sys     ç›´æ¥å†™å…¥å†…å­˜/proc    ç›´æ¥å†™å…¥å†…å­˜/dev     è®¾å¤‡æ–‡ä»¶ç›®å½•/lib     ç³»ç»Ÿåº“ ä¿å­˜ç›®å½•/mnt     ç³»ç»ŸæŒ‚è½½ç›®å½•/media   æŒ‚è½½ç›®å½•</code></pre><ul><li><p>linux å¸¸ç”¨å‘½ä»¤     control + L  æ¸…å±</p></li><li><p>æ–‡ä»¶å‘½ä»¤</p><ul><li>åŸºæœ¬å‘½ä»¤æ ¼å¼</li></ul><pre><code class="shell">å‘½ä»¤ [é€‰é¡¹] [å‚æ•°]#lsls    -a  æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶   -l  æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯,ç›®å½•ä¸‹æ‰€æœ‰å†…å®¹   -d  æŸ¥çœ‹ç›®å½•å±æ€§,ç›®å½•æœ¬èº«   -h  äººæ€§åŒ–æ˜¾ç¤ºæ–‡ä»¶å¤§å°   -i  æ˜¾ç¤ºinode  æ–‡ä»¶çš„idå·ll ll -l#</code></pre></li></ul><ul><li><p>ç›®å½•æ–‡ä»¶å¤„ç†</p><pre><code class="shell">#mkdir  åˆ›å»ºç›®å½•mkdir -p  é€’å½’åˆ›å»º,åˆ›å»ºå¤šçº§ç›®å½•#cd  åˆ‡æ¢ç›®å½•cd ~  å½“å‰ç”¨æˆ·çš„å®¶ç›®å½•-  è¿›å…¥ä¸Šæ¬¡è¿›å…¥çš„ç›®å½•.. è¿›å…¥ä¸Šçº§ç›®å½•.  è¿›å…¥å½“å‰ç›®å½•#pwdpwd  æ˜¾ç¤ºå½“å‰ç›®å½•å…¨è·¯å¾„#rm -rf [æ–‡ä»¶æˆ–ç›®å½•]rm -f å¼ºåˆ¶åˆ é™¤-r åˆ é™¤ç›®å½•#cpcp-r å¤åˆ¶ç›®å½•-p è¿å¸¦æ–‡ä»¶çš„å±æ€§ä¸€èµ·å¤åˆ¶-d å¦‚æœæ–‡ä»¶ä¸ºé“¾æ¥æ–‡ä»¶,åˆ™å¤åˆ¶é“¾æ¥å±æ€§-a ç›¸å½“äº-pdr#mvmv [æºåœ°å€] [ç›®æ ‡åœ°å€]</code></pre></li></ul><ul><li><p>è½¯é“¾æ¥å‘½ä»¤(æºæ–‡ä»¶ä¸€å®šå†™å·¨ç»å¯¹è·¯å¾„)</p><pre><code class="shell">#ln [æº] [ç›®æ ‡]lnä¸èƒ½è·¨åˆ†åŒº,ä¸èƒ½æ˜¯ä¸€ä¸ªç›®å½•ç›¸å½“äºä¸€ä¸ªæ–‡ä»¶   æ–‡ä»¶idå·ç›¸åŒ-s    è½¯é“¾æ¥   ç±»ä¼¼windowsé‡Œé¢çš„å¿«æ·æ–¹å¼æœ‰è‡ªå·±çš„idå·   å…¶å®æ˜¯å»æŸ¥çœ‹è‡ªå·±çš„å­˜å‚¨ç‚¹,å­˜å‚¨ç‚¹é‡Œé¢æ˜¯æºæ–‡ä»¶çš„idå·,ç„¶ååˆç”¨æºæ–‡ä»¶idå·å»æ‰¾æºæ–‡ä»¶çš„å­˜å‚¨ç‚¹</code></pre></li></ul><ul><li><p>æœç´¢å‘½ä»¤</p><pre><code>locate æ–‡ä»¶æœç´¢å‘½ä»¤whereis ä¸ whichfind æ–‡ä»¶æœç´¢å‘½ä»¤grep å­—ç¬¦ä¸²æœç´¢å‘½ä»¤</code></pre><ul><li><p>locate </p><pre><code class="shell">#locatelocate [æ–‡ä»¶å]åœ¨åå°æ•°æ®åº“ä¸­æŒ‰æ–‡ä»¶åæœç´¢ä½ç½®åœ¨:/var/lib/mlocate#updatedbupdatedb æ›´æ–°æ•°æ®åº“</code></pre></li><li><p>whereis </p><pre><code class="shell">#whereiswhereis [å‘½ä»¤å] -b ä¹‹æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ -m åªæŸ¥æ‰¾å¸®åŠ©æ–‡ä»¶</code></pre></li><li><p>which</p><pre><code class="shell">æŸ¥çœ‹#whichwhich [æ–‡ä»¶å]æœç´¢å‘½ä»¤æ‰€åœ¨ç›®å½•è·¯å¾„å·²ç»åˆ«å</code></pre></li><li><p>find</p><pre><code class="shell">#find#é¿å¤§èŒƒå›´æœç´¢,ä¼šéå¸¸æ¶ˆè€—ç³»ç»Ÿèµ„æº#å¦‚æœä¸ç”¨é€šé…ç¬¦,åˆ™ä¼šæœç´¢ä¸æ–‡ä»¶åå®Œå…¨ä¸€è‡´çš„æ–‡ä»¶find [æœç´ èŒƒå›´] [æœç´¢æ¡ä»¶]find [æœç´ èŒƒå›´]   -name [åå­—]  -iname [åå­—]  ä¸åŒºåˆ†å¤§å°å†™  -user [æ‰€æœ‰è€…]  æŒ‰æ‰€æœ‰è€…æœç´¢  -nouser   æŸ¥æ‰¾æ²¡æœ‰æ‰€æœ‰è€…çš„æ–‡ä»¶   -mtime  [] ä¿®æ”¹æ–‡ä»¶å†…å®¹çš„æ—¶é—´   -atime  [] æ–‡ä»¶è®¿é—®æ—¶é—´  -ctime  [] æ”¹å˜æ–‡ä»¶å±æ€§çš„æ—¶é—´    [-10 10 +10  10å¤©å†…  10å¤©å½“å¤©  +10å¤©å‰]  -size [å¤§å°]  å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾å¤§å°æ˜¯ 25kçš„æ–‡ä»¶    [-25k 25k +25k]    [-2M 2M +2M]  -inum [idå·]    -a   and é€»è¾‘ä¸,åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶   eg find /etc -size +25k -a -size -50k  -o   or  é€»è¾‘æˆ–,ä¸¤ä¸ªæ¡ä»¶æ»¡è¶³ä¸€ä¸ªæ¡ä»¶å³å¯  -exec [ä¸€ä¸ªå‘½ä»¤] {} \;   æœç´¢å‡ºæ¥çš„ç»“æœå†æ‰§è¡Œä¸€æ¬¡å‘½ä»¤   eg find /etc -size +25k -a -size -50k -exec ls -lh {} \;#é€šé…ç¬¦*    åŒ¹é…ä»»ä½•å†…å®¹?    åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦[]   åŒ¹é…ä»»æ„ä¸€ä¸ªä¸­å£å·å†…çš„å­—ç¬¦         eg:  abc  abd     find /home -name ab[cd]</code></pre></li></ul></li></ul><ul><li><p>grep</p><pre><code class="shell">#grepgrep &quot;size&quot; system.loggrepæ˜¯åŒ…å«åŒ¹é…   åœ¨  system.log  ä¸­æŸ¥æ‰¾&quot;size&quot;</code></pre></li></ul><ul><li><p>å¸®åŠ©å‘½ä»¤</p><pre><code class="shell">man [å‘½ä»¤]whatis [å‘½ä»¤] man -f [å‘½ä»¤]   å‘½ä»¤çš„å¸®åŠ©çº§åˆ«man -k [å‘½ä»¤]   æ¨¡ç³ŠåŒ¹é…apropos [å‘½ä»¤]   æ¨¡ç³ŠåŒ¹é…[å‘½ä»¤] --helpå†…æ ¸çš„å‘½ä»¤æŸ¥çœ‹å¸®åŠ©help [å‘½ä»¤]</code></pre></li></ul><ul><li><p>å‹ç¼©ä¸è§£å‹ç¼©</p><pre><code class="shell">å¸¸ç”¨å‹ç¼©æ ¼å¼   .zip  .gz  .bz2   .tar.gz   .tar.bz2</code></pre><ul><li><p>zip</p><pre><code class="shell">zip [å‹ç¼©æ–‡ä»¶åå­—] [æºæ–‡ä»¶]zip -r [å‹ç¼©æ–‡ä»¶åå­—] [æºç›®å½•]#è§£å‹ç¼©unzip [zipæ–‡ä»¶]</code></pre></li><li><p>gz</p><pre><code class="shell">gzip [æºæ–‡ä»¶]   #å‹ç¼©ä¸º.gzæ ¼å¼çš„å‹ç¼©æ–‡ä»¶,æºæ–‡ä»¶ä¼šæ¶ˆå¤±gzip -c [æºæ–‡ä»¶] &gt; å‹ç¼©æ–‡ä»¶#å‹ç¼©ä¸º.gzæ ¼å¼ ,æºæ–‡ä»¶ä¿ç•™gzip -r [æºç›®å½•] #å‹ç¼©ç›®å½•ä¸‹æ‰€æœ‰çš„å­æ–‡ä»¶,ä½†æ˜¯ä¸èƒ½å‹ç¼©ç›®å½•#è§£å‹ç¼©gzip -d [å‹ç¼©æ–‡ä»¶]gunzip [å‹ç¼©æ–‡ä»¶]gzp -d -r [ç›®å½•]   è§£å‹ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶</code></pre></li><li><p>tar </p><pre><code>#tartar -cvf [æ‰“åŒ…æ–‡ä»¶å] [æºæ–‡ä»¶]  -c æ‰“åŒ…  -v æ˜¾ç¤ºè¿‡ç¨‹  -f æŒ‡å®šæ‰“åŒ…åçš„æ–‡ä»¶å     eg tar -cvf jp.tar jp#è§£å‹ç¼©tar -xvf [å‹ç¼©æ–‡ä»¶]</code></pre><ul><li>.tar.gz</li></ul><pre><code>tar -zcvf [å‹ç¼©æ–‡ä»¶å] [æºæ–‡ä»¶]#è§£å‹ç¼©tar -zxvf [å‹ç¼©åŒ…å.tar.gz]</code></pre></li></ul></li><li><p>å…³æœºå’Œé‡å¯</p></li></ul><pre><code>shutdown [é€‰é¡¹] æ—¶é—´ -c   å–æ¶ˆå‰ä¸€ä¸ªå…³æœºå‘½ä»¤ -h   å…³æœº -r   é‡å¯logout é€€å‡ºç™»å½•</code></pre><ul><li>å…¶ä»–çš„å‘½ä»¤</li></ul><pre><code>w  æ˜¾ç¤ºæ‰€æœ‰çš„ç™»å½•ç”¨æˆ·last  æ‰€æœ‰ç™»å½•ä¿¡æ¯lastlog   æ‰€æœ‰ç”¨æˆ·ç™»å½•ä¿¡æ¯</code></pre><ul><li>å…¶ä»–å¿«æ·é”®</li></ul><pre><code>control + c   å¼ºåˆ¶ç»ˆæ­¢å½“å‰å‘½ä»¤control + l   æ¸…å±control + a   å…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦–control + e   å…‰æ ‡ç§»åŠ¨åˆ°è¡Œå°¾control + u   ä»å…‰æ ‡ä½ç½®åˆ é™¤åˆ°è¡Œé¦–control + z   æŠŠå‘½ä»¤æ”¾å…¥åˆ°åå°control + r   åœ¨å†å²è®°å½•ä¸­æœç´¢</code></pre><ul><li>è¾“å‡ºé‡å®šå‘</li></ul><pre><code>#æ ‡å‡†çš„è¾“å‡ºé‡å®šå‘å‘½ä»¤ &gt; æ–‡ä»¶    è¦†ç›–çš„æ–¹å¼å†™å…¥å‘½ä»¤ &gt;&gt; æ–‡ä»¶   è¿½åŠ çš„æ–¹å¼å†™å…¥#é”™è¯¯è¾“å‡ºé‡å®šå‘é”™è¯¯å‘½ä»¤ 2&gt; æ–‡ä»¶  è¦†ç›–çš„æ–¹å¼å†™å…¥é”™è¯¯æç¤ºé”™è¯¯å‘½ä»¤ 2&gt;&gt; æ–‡ä»¶  è¿½åŠ çš„æ–¹å¼å†™å…¥é”™è¯¯æç¤º#æ­£ç¡®å’Œé”™è¯¯çš„åŒæ—¶è¾“å‡ºå‘½ä»¤  &gt;&gt; æ–‡ä»¶ 2&gt;&amp;1å‘½ä»¤  &amp;&gt;&gt; æ–‡ä»¶#æ­£ç¡®é”™è¯¯åˆ†å¼€è¾“å‡ºå‘½ä»¤ &gt;&gt; æ–‡ä»¶ 2&gt;&gt; æ–‡ä»¶</code></pre><p>-è¾“å…¥é‡å®šå‘</p><pre><code>wc [é€‰é¡¹] [æ–‡ä»¶å]    -c ç»Ÿè®¡å­—èŠ‚æ•°    -w ç»Ÿè®¡å•è¯æ•°    -l ç»Ÿè®¡è¡Œæ•°wcåœ¨ç»ˆç«¯è¾“å…¥æ–‡å­—    control + D ç»Ÿè®¡ç»“æœwc [æ–‡ä»¶å]   æ–‡ä»¶å†…å®¹è¾“å…¥åˆ°ç»ˆç«¯</code></pre><ul><li><p>ç®¡é“ç¬¦</p><ul><li><p>å¤šå‘½ä»¤æ‰§è¡Œ(å‰ä¸€æ¡å‘½ä»¤çš„ç»“æœä¸ä¼šä¼ å…¥)</p><pre><code>[å‘½ä»¤1] ; [å‘½ä»¤2]    é¡ºåºæ‰§è¡Œ[å‘½ä»¤1] &amp;&amp; [å‘½ä»¤2]        å‘½ä»¤1æ‰§è¡Œæ­£ç¡®   å‘½ä»¤2æ‰§è¡Œ    å‘½ä»¤1æ‰§è¡Œé”™è¯¯   å‘½ä»¤2ä¸ä¼šæ‰§è¡Œ[å‘½ä»¤1] || [å‘½ä»¤2]      å½“å‘½ä»¤1æ‰§è¡Œä¸æ­£ç¡®   å‘½ä»¤2æ‰§è¡Œ    å‘½ä»¤1æ‰§è¡Œæ­£ç¡®   å‘½ä»¤2å°±ä¸ä¼šæ‰§è¡Œ</code></pre><ul><li>ç®¡é“ç¬¦(å‰ä¸€æ¡å‘½ä»¤çš„ç»“æœä¼ å…¥ä¸‹ä¸€ä¸ªå‘½ä»¤)</li></ul><pre><code># |  [å‘½ä»¤1] | [å‘½ä»¤2]  å‘½ä»¤2ä¼šå»æ“ä½œå‘½ä»¤1æ‰§è¡Œçš„ç»“æœ</code></pre></li></ul></li><li><p>é€šé…ç¬¦</p></li></ul><pre><code>?       ä»»æ„ä¸€ä¸ªå­—ç¬¦*       ä»»æ„å†…å®¹[]      åŒ¹é…æ‹¬å·ä¸­çš„æŸä¸€ä¸ªå­—ç¬¦[-]     åŒ¹é…æ‹¬å·ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ - ä»£è¡¨ä¸€ä¸ªèŒƒå›´ [a-z] [1-3][^]     è¡¨ç¤ºåŒ¹é…ä¸æ˜¯æ‹¬å·ä¸­çš„å­—ç¬¦ æ¯”å¦‚[^0-9] æŒ‡åŒ¹é…ä¸æ˜¯æ•°å­—çš„å­—ç¬¦&#39;&#39;      å•å¼•å·   åœ¨å•å¼•å·ä¸­æ‰€æœ‰å­—ç¬¦éƒ½æ²¡æœ‰ç‰¹æ®Šå«ä¹‰&quot;&quot;      åŒå¼•å· é™¤äº†&quot;$&quot; å’Œ &quot;`&quot; &quot;\&quot; å…¶ä»–å­—ç¬¦éƒ½æ²¡æœ‰ç‰¹æ®Šæ„ä¹‰``      åå¼•å· æ˜¯ç³»ç»Ÿå‘½ä»¤å†…å®¹$()     ç”¨æ¥å¼•ç”¨ç³»ç»Ÿå‘½ä»¤#       shellä¸­è¡¨ç¤ºæ³¨é‡Š$       è°ƒç”¨å˜é‡çš„å€¼\       è½¬ä¹‰ç¬¦</code></pre>]]></content>
    
    
    <categories>
      
      <category>Server</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Serverï¼ŒLinux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Facebook/Stethoâ€”â€”Androidå¼€å‘è°ƒè¯•ç¥å™¨</title>
    <link href="undefined2017/12/24/Facebook-Stetho/"/>
    <url>2017/12/24/Facebook-Stetho/</url>
    
    <content type="html"><![CDATA[<p>####ä¸€ã€ç®€ä»‹</p><p>Stethoæ˜¯ä¸€ä¸ªAndroidåº”ç”¨è°ƒè¯•å·¥å…·ã€‚é›†æˆåï¼Œå¼€å‘äººå‘˜å¯ä»¥é€šè¿‡Chromeçš„å¼€å‘å·¥å…·æŸ¥çœ‹Appç›¸å…³çš„ä¿¡æ¯å’Œè°ƒè¯•ï¼›å¯è§†åŒ–æ“ä½œï¼Œä¸éœ€è¦è‡ªå·±ä½¿ç”¨adbä¹Ÿä¸éœ€è¦rootæƒé™ã€‚</p><a id="more"></a><p>####äºŒã€APPé›†æˆ</p><p>1.ä¸‹è½½æœ€æ–°çš„jarï¼Œæˆ–è€…é€šè¿‡Gradleå¼•å…¥stethoçš„libraay</p><pre><code>compile &#39;com.facebook.stetho:stetho:1.3.1&#39;</code></pre><p>2.åªéœ€è¦åœ¨ Applicationçš„ onCreate æ–¹æ³•ä¸­è°ƒç”¨</p><pre><code>public class MyApplication extends Application {   public void onCreate() {     super.onCreate();     Stetho.initializeWithDefaults(this);   } }</code></pre><p>3.å¦‚æœè¿˜æƒ³æŸ¥çœ‹ç½‘ç»œè¯·æ±‚çš„è¯ï¼Œéœ€è¦å¼•å…¥å¦å¤–çš„Library</p><pre><code> compile &#39;com.facebook.stetho:stetho-okhttp3:1.3.1&#39;</code></pre><p>4.ä½¿ç”¨okhttp è¿˜éœ€è¦æ·»åŠ  StethoInterceptor</p><pre><code>OkHttpClient client = new OkHttpClient.Builder()             .addNetworkInterceptor(new StethoInterceptor())             .build();</code></pre><p>####ä¸‰ã€ä½¿ç”¨<br>é…ç½®å®Œæˆä¹‹åï¼Œåœ¨Chromeåœ°å€æ è¾“å…¥<code>chrome://inspect</code></p><blockquote><p>chrome://inspect/#devices</p></blockquote><p>chromeä¼šæ£€æµ‹åˆ°æˆ‘ä»¬çš„appï¼Œç‚¹å‡» <em>inspect</em> è¿›å…¥æŸ¥çœ‹é¡µé¢</p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>String.formatçš„å‚æ•°è¡¨</title>
    <link href="undefined2017/12/23/string-format/"/>
    <url>2017/12/23/string-format/</url>
    
    <content type="html"><![CDATA[<p>####String.format()</p><pre><code>%s  å­—ç¬¦ä¸²ç±»å‹ &quot;mingrisoft&quot;%c  å­—ç¬¦ç±»å‹    &#39;m&#39;%b  å¸ƒå°”ç±»å‹    true%d  æ•´æ•°ç±»å‹ï¼ˆåè¿›åˆ¶ï¼‰   99%x  æ•´æ•°ç±»å‹ï¼ˆåå…­è¿›åˆ¶ï¼‰  FF%o  æ•´æ•°ç±»å‹ï¼ˆå…«è¿›åˆ¶ï¼‰   77%f  æµ®ç‚¹ç±»å‹    99.99%a  åå…­è¿›åˆ¶æµ®ç‚¹ç±»å‹    FF.35AE%e  æŒ‡æ•°ç±»å‹    9.38e+5%g  é€šç”¨æµ®ç‚¹ç±»å‹ï¼ˆfå’Œeç±»å‹ä¸­è¾ƒçŸ­çš„ï¼‰%h  æ•£åˆ—ç  %%  ç™¾åˆ†æ¯”ç±»å‹   ï¼…%n  æ¢è¡Œç¬¦%tx æ—¥æœŸä¸æ—¶é—´ç±»å‹ï¼ˆxä»£è¡¨ä¸åŒçš„æ—¥æœŸä¸æ—¶é—´è½¬æ¢ç¬¦</code></pre>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é€æ˜åº¦å¯¹ç…§è¡¨</title>
    <link href="undefined2017/12/23/transparency-table/"/>
    <url>2017/12/23/transparency-table/</url>
    
    <content type="html"><![CDATA[<p>####é€æ˜åº¦å¯¹ç…§è¡¨</p><pre><code>100% â€” FF95% â€” F290% â€” E685% â€” D980% â€” CC75% â€” BF70% â€” B365% â€” A660% â€” 9955% â€” 8C50% â€” 8045% â€” 7340% â€” 6635% â€” 5930% â€” 4D25% â€” 4020% â€” 3315% â€” 2610% â€” 1A5% â€” 0D0% â€” 00</code></pre>]]></content>
    
    
    <categories>
      
      <category>Tools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼è®°å½•</title>
    <link href="undefined2017/07/31/Regular-Expression/"/>
    <url>2017/07/31/Regular-Expression/</url>
    
    <content type="html"><![CDATA[<h3 id="å¸¸ç”¨æ­£åˆ™"><a href="#å¸¸ç”¨æ­£åˆ™" class="headerlink" title="å¸¸ç”¨æ­£åˆ™"></a>å¸¸ç”¨æ­£åˆ™</h3><table><thead><tr><th>è¯´æ˜</th><th>æ­£åˆ™è¡¨è¾¾å¼</th></tr></thead><tbody><tr><td>ç½‘å€ï¼ˆURLï¼‰</td><td><code>[a-zA-z]+://[^\s]*</code></td></tr><tr><td>IPåœ°å€(IP Address)</td><td>`((2[0-4]\d</td><td>25[0-5]</td><td>[01]?\d\d?).){3}(2[0-4]\d</td><td>25[0-5]</td><td>[01]?\d\d?)`</td></tr><tr><td>ç”µå­é‚®ä»¶(Email)</td><td><code>\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*</code></td></tr><tr><td>QQå·ç </td><td><code>[1-9]\d{4,}</code></td></tr><tr><td>HTMLæ ‡è®°(åŒ…å«å†…å®¹æˆ–è‡ªé—­åˆ)</td><td>`&lt;(.<em>)(.</em>)&gt;.*&lt;\/\1&gt;</td><td>&lt;(.*) \/&gt;`</td></tr><tr><td>å¯†ç (ç”±æ•°å­—/å¤§å†™å­—æ¯/å°å†™å­—æ¯/æ ‡ç‚¹ç¬¦å·ç»„æˆï¼Œå››ç§éƒ½å¿…æœ‰ï¼Œ8ä½ä»¥ä¸Š)</td><td><code>(?=^.{8,}$)(?=.*\d)(?=.*\W+)(?=.*[A-Z])(?=.*[a-z])(?!.*\n).*$</code></td></tr><tr><td>æ—¥æœŸ(å¹´-æœˆ-æ—¥)</td><td>`(\d{4}</td><td>\d{2})-((1[0-2])</td><td>(0?[1-9]))-(([12][0-9])</td><td>(3[01])</td><td>(0?[1-9]))`</td></tr><tr><td>æ—¥æœŸ(æœˆ/æ—¥/å¹´)</td><td>`((1[0-2])</td><td>(0?[1-9]))/(([12][0-9])</td><td>(3[01])</td><td>(0?[1-9]))/(\d{4}</td><td>\d{2})`</td></tr><tr><td>æ—¶é—´(å°æ—¶:åˆ†é’Ÿ, 24å°æ—¶åˆ¶)</td><td>`((1</td><td>0?)[0-9]</td><td>2[0-3]):([0-5][0-9])`</td></tr><tr><td>æ±‰å­—(å­—ç¬¦)</td><td><code>[\u4e00-\u9fa5]</code></td></tr><tr><td>ä¸­æ–‡åŠå…¨è§’æ ‡ç‚¹ç¬¦å·(å­—ç¬¦)</td><td><code>[\u3000-\u301e\ufe10-\ufe19\ufe30-\ufe44\ufe50-\ufe6b\uff01-\uffee]</code></td></tr><tr><td>ä¸­å›½å¤§é™†å›ºå®šç”µè¯å·ç </td><td>`(\d{4}-</td><td>\d{3}-)?(\d{8}</td><td>\d{7})`</td></tr><tr><td>ä¸­å›½å¤§é™†æ‰‹æœºå·ç </td><td><code>1\d{10}</code></td></tr><tr><td>ä¸­å›½å¤§é™†é‚®æ”¿ç¼–ç </td><td><code>[1-9]\d{5}</code></td></tr><tr><td>ä¸­å›½å¤§é™†èº«ä»½è¯å·(15ä½æˆ–18ä½)</td><td><code>\d{15}(\d\d[0-9xX])?</code></td></tr><tr><td>éè´Ÿæ•´æ•°(æ­£æ•´æ•°æˆ–é›¶)</td><td><code>\d+</code></td></tr><tr><td>æ­£æ•´æ•°</td><td><code>[0-9]*[1-9][0-9]*</code></td></tr><tr><td>è´Ÿæ•´æ•°</td><td><code>-[0-9]*[1-9][0-9]*</code></td></tr><tr><td>æ•´æ•°</td><td><code>-?\d+</code></td></tr><tr><td>å°æ•°</td><td><code>(-?\d+)(\.\d+)?</code></td></tr><tr><td>ä¸åŒ…å«abcçš„å•è¯</td><td><code>\b((?!abc)\w)+\b</code></td></tr></tbody></table><a id="more"></a><h3 id="å­—ç¬¦è½¬ä¹‰"><a href="#å­—ç¬¦è½¬ä¹‰" class="headerlink" title="å­—ç¬¦è½¬ä¹‰"></a>å­—ç¬¦è½¬ä¹‰</h3><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„åæ–œæ å­—ç¬¦ () æŒ‡ç¤ºå…¶åè·Ÿçš„å­—ç¬¦æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼‰ï¼Œæˆ–åº”æŒ‰åŸä¹‰è§£é‡Šè¯¥å­—ç¬¦ã€‚</p><table><thead><tr><th>è½¬ä¹‰å­—ç¬¦</th><th>æè¿°</th><th>æ¨¡å¼</th><th>åŒ¹é…</th></tr></thead><tbody><tr><td>è½¬ä¹‰å­—ç¬¦\a</td><td>æè¿°ä¸æŠ¥è­¦ (bell) ç¬¦ \u0007 åŒ¹é…ã€‚</td><td>æ¨¡å¼\a</td><td>åŒ¹é…â€œError!â€+â€œ\u0007â€ä¸­çš„ â€œ\u0007â€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\b</td><td>æè¿°åœ¨å­—ç¬¦ç±»ä¸­ï¼Œä¸é€€æ ¼é”® \u0008 åŒ¹é…ã€‚</td><td>æ¨¡å¼[\b]{3,}</td><td>åŒ¹é…â€œ\b\b\b\bâ€ä¸­çš„â€œ\b\b\b\bâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\t</td><td>æè¿°ä¸åˆ¶è¡¨ç¬¦ \u0009 åŒ¹é…ã€‚</td><td>æ¨¡å¼(\w+)\t</td><td>åŒ¹é…â€œitem1\titem2\tâ€ä¸­çš„â€œitem1\tâ€å’Œâ€œitem2\tâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\r</td><td>æè¿°ä¸å›è½¦ç¬¦ \u000D åŒ¹é…ã€‚ ï¼ˆ\r ä¸æ¢è¡Œç¬¦ \n ä¸æ˜¯ç­‰æ•ˆçš„ã€‚ï¼‰</td><td>æ¨¡å¼\r\n(\w+)</td><td>åŒ¹é…â€œ\r\nThese are\ntwo lines.â€ä¸­çš„â€œ\r\nTheseâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\v</td><td>æè¿°ä¸å‚ç›´åˆ¶è¡¨ç¬¦ \u000B åŒ¹é…ã€‚</td><td>æ¨¡å¼[\v]{2,}</td><td>åŒ¹é…â€œ\v\v\vâ€ä¸­çš„â€œ\v\v\vâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\f</td><td>æè¿°ä¸æ¢é¡µç¬¦ \u000C åŒ¹é…ã€‚</td><td>æ¨¡å¼[\f]{2,}</td><td>åŒ¹é…â€œ\f\f\fâ€ä¸­çš„â€œ\f\f\fâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\n</td><td>æè¿°ä¸æ¢è¡Œç¬¦ \u000A åŒ¹é…ã€‚</td><td>æ¨¡å¼\r\n(\w+)</td><td>åŒ¹é…â€œ\r\nThese are\ntwo lines.â€ä¸­çš„â€œ\r\nTheseâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\e</td><td>æè¿°ä¸è½¬ä¹‰ç¬¦ \u001B åŒ¹é…ã€‚</td><td>æ¨¡å¼\e</td><td>åŒ¹é…â€œ\x001Bâ€ä¸­çš„â€œ\x001Bâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\nnn</td><td>æè¿°ä½¿ç”¨å…«è¿›åˆ¶è¡¨ç¤ºå½¢å¼æŒ‡å®šå­—ç¬¦ï¼ˆnnn ç”±äºŒä½æˆ–ä¸‰ä½æ•°å­—ç»„æˆï¼‰ã€‚</td><td>æ¨¡å¼\w\040\w</td><td>åŒ¹é…â€œa bc dâ€ä¸­çš„â€œa bâ€å’Œâ€œc dâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\xnn</td><td>æè¿°ä½¿ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼æŒ‡å®šå­—ç¬¦ï¼ˆnn æ°å¥½ç”±ä¸¤ä½æ•°å­—ç»„æˆï¼‰ã€‚</td><td>æ¨¡å¼\w\x20\w</td><td>åŒ¹é…â€œa bc dâ€ä¸­çš„â€œa bâ€å’Œâ€œc dâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\cX\cx</td><td>æè¿°åŒ¹é… X æˆ– x æŒ‡å®šçš„ ASCII æ§ä»¶å­—ç¬¦ï¼Œå…¶ä¸­ X æˆ– x æ˜¯æ§ä»¶å­—ç¬¦çš„å­—æ¯ã€‚</td><td>æ¨¡å¼\cC</td><td>åŒ¹é…â€œ\x0003â€ä¸­çš„â€œ\x0003â€(Ctrl-C)</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\unnnn</td><td>æè¿°ä½¿ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼åŒ¹é… Unicode å­—ç¬¦ï¼ˆç”± nnnn æ­£ç¡®è¡¨ç¤ºçš„å››ä½æ•°ï¼‰ã€‚</td><td>æ¨¡å¼\w\u0020\w</td><td>åŒ¹é…â€œa bc dâ€ä¸­çš„â€œa bâ€å’Œâ€œc dâ€</td></tr><tr><td>è½¬ä¹‰å­—ç¬¦\</td><td>æè¿°åœ¨åé¢å¸¦æœ‰ä¸è¯†åˆ«ä¸ºæœ¬ä¸»é¢˜çš„æ­¤è¡¨å’Œå…¶ä»–è¡¨ä¸­çš„è½¬ä¹‰ç¬¦çš„å­—ç¬¦æ—¶ï¼Œä¸è¯¥å­—ç¬¦åŒ¹é…ã€‚ ä¾‹å¦‚ï¼Œ* ä¸ \x2A ç›¸åŒï¼Œè€Œ . ä¸ \x2E ç›¸åŒã€‚ è¿™å…è®¸æ­£åˆ™è¡¨è¾¾å¼å¼•æ“åŒºåˆ†è¯­è¨€å…ƒç´ ï¼ˆå¦‚ <em> æˆ– ?ï¼‰ å’Œå­—ç¬¦æ–‡æœ¬ï¼ˆç”¨ \</em> æˆ– \? è¡¨ç¤ºï¼‰ã€‚</td><td>æ¨¡å¼\d+[+-x*]\d+</td><td>åŒ¹é…â€œ(2+2) <em> 3</em>9â€ä¸­çš„â€œ2+2â€å’Œâ€œ3*9â€</td></tr></tbody></table><h3 id="å­—ç¬¦ç±»"><a href="#å­—ç¬¦ç±»" class="headerlink" title="å­—ç¬¦ç±»"></a>å­—ç¬¦ç±»</h3><p>å­—ç¬¦ç±»ä¸ä¸€ç»„å­—ç¬¦ä¸­çš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦åŒ¹é…ã€‚ </p><table><thead><tr><th>å­—ç¬¦ç±»</th><th>æè¿°</th><th>æ¨¡å¼</th><th>åŒ¹é…</th></tr></thead><tbody><tr><td>å­—ç¬¦ç±»[character_group]</td><td>æè¿°åŒ¹é… character_group ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ¹é…åŒºåˆ†å¤§å°å†™ã€‚</td><td>æ¨¡å¼[ae]</td><td>åŒ¹é…â€œgrayâ€ä¸­çš„â€œaâ€â€œlaneâ€ä¸­çš„â€œaâ€å’Œâ€œeâ€</td></tr><tr><td><code>å­—ç¬¦ç±»[^character_group]</code></td><td>æè¿°æ±‚åï¼šä¸ä¸åœ¨ character_group ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œcharacter_group ä¸­çš„å­—ç¬¦åŒºåˆ†å¤§å°å†™ã€‚</td><td>æ¨¡å¼[^aei]</td><td>åŒ¹é…â€œreignâ€ä¸­çš„â€œrâ€ã€â€œgâ€å’Œâ€œnâ€</td></tr><tr><td>å­—ç¬¦ç±»[ç¬¬ä¸€ä¸ª-last]</td><td>æè¿°å­—ç¬¦èŒƒå›´ï¼šä¸ä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªçš„èŒƒå›´ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚</td><td>æ¨¡å¼[A-Z]</td><td>åŒ¹é…â€œAB123â€ä¸­çš„â€œAâ€å’Œâ€œBâ€</td></tr><tr><td>å­—ç¬¦ç±».</td><td>æè¿°é€šé…ç¬¦ï¼šä¸é™¤ \n ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚è‹¥è¦åŒ¹é…æ–‡æœ¬å¥ç‚¹å­—ç¬¦ï¼ˆ. æˆ– \u002Eï¼‰ï¼Œä½ å¿…é¡»åœ¨è¯¥å­—ç¬¦å‰é¢åŠ ä¸Šè½¬ä¹‰ç¬¦ (.)ã€‚</td><td>æ¨¡å¼a.e</td><td>åŒ¹é…â€œnaveâ€ä¸­çš„â€œaveâ€â€œwaterâ€ä¸­çš„â€œateâ€</td></tr><tr><td>å­—ç¬¦ç±»\p{name}</td><td>æè¿°ä¸ name æŒ‡å®šçš„ Unicode é€šç”¨ç±»åˆ«æˆ–å‘½åå—ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚</td><td>æ¨¡å¼\p{Lu}\p{IsCyrillic}</td><td>åŒ¹é…â€œCity Lightsâ€ä¸­çš„â€œCâ€å’Œâ€œLâ€â€œĞ”Ğ–emâ€ä¸­çš„â€œĞ”â€å’Œâ€œĞ–â€</td></tr><tr><td>å­—ç¬¦ç±»\P{name}</td><td>æè¿°ä¸ä¸åœ¨ name æŒ‡å®šçš„ Unicode é€šç”¨ç±»åˆ«æˆ–å‘½åå—ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦åŒ¹é…ã€‚</td><td>æ¨¡å¼\P{Lu}\P{IsCyrillic}</td><td>åŒ¹é…â€œCityâ€ä¸­çš„â€œiâ€ã€â€œtâ€å’Œâ€œyâ€â€œĞ”Ğ–emâ€ä¸­çš„â€œeâ€å’Œâ€œmâ€</td></tr><tr><td>å­—ç¬¦ç±»\w</td><td>æè¿°ä¸ä»»ä½•å•è¯å­—ç¬¦åŒ¹é…ã€‚</td><td>æ¨¡å¼\w</td><td>åŒ¹é…â€œID A1.3â€ä¸­çš„â€œIâ€ã€â€œDâ€ã€â€œAâ€ã€â€œ1â€å’Œâ€œ3â€</td></tr><tr><td>å­—ç¬¦ç±»\W</td><td>æè¿°ä¸ä»»ä½•éå•è¯å­—ç¬¦åŒ¹é…ã€‚</td><td>æ¨¡å¼\W</td><td>åŒ¹é…â€œID A1.3â€ä¸­çš„â€œ â€ã€â€œ.â€</td></tr><tr><td>å­—ç¬¦ç±»\s</td><td>æè¿°ä¸ä»»ä½•ç©ºç™½å­—ç¬¦åŒ¹é…ã€‚</td><td>æ¨¡å¼\w\s</td><td>åŒ¹é…â€œID A1.3â€ä¸­çš„â€œDâ€</td></tr><tr><td>å­—ç¬¦ç±»\S</td><td>æè¿°ä¸ä»»ä½•éç©ºç™½å­—ç¬¦åŒ¹é…ã€‚</td><td>æ¨¡å¼\s\S</td><td>åŒ¹é…â€ _â€ in â€œint __ctrâ€</td></tr><tr><td>å­—ç¬¦ç±»\d</td><td>æè¿°ä¸ä»»ä½•åè¿›åˆ¶æ•°å­—åŒ¹é…ã€‚</td><td>æ¨¡å¼\d</td><td>åŒ¹é…â€œ4 = IVâ€ä¸­çš„â€œ4â€</td></tr><tr><td>å­—ç¬¦ç±»\D</td><td>æè¿°åŒ¹é…ä¸æ˜¯åè¿›åˆ¶æ•°çš„ä»»æ„å­—ç¬¦ã€‚</td><td>æ¨¡å¼\D</td><td>åŒ¹é…â€œ4 = IVâ€ä¸­çš„â€œ â€ã€â€œ=â€ã€â€œ â€ã€â€œIâ€å’Œâ€œVâ€</td></tr></tbody></table><h3 id="å®šä½ç‚¹"><a href="#å®šä½ç‚¹" class="headerlink" title="å®šä½ç‚¹"></a>å®šä½ç‚¹</h3><p>å®šä½ç‚¹æˆ–åŸå­é›¶å®½åº¦æ–­è¨€ä¼šä½¿åŒ¹é…æˆåŠŸæˆ–å¤±è´¥ï¼Œå…·ä½“å–å†³äºå­—ç¬¦ä¸²ä¸­çš„å½“å‰ä½ç½®ï¼Œä½†å®ƒä»¬ä¸ä¼šä½¿å¼•æ“åœ¨å­—ç¬¦ä¸²ä¸­å‰è¿›æˆ–ä½¿ç”¨å­—ç¬¦</p><table><thead><tr><th>æ–­è¨€</th><th>æè¿°</th><th>æ¨¡å¼</th><th>åŒ¹é…</th></tr></thead><tbody><tr><td>æ–­è¨€^</td><td>æè¿°åŒ¹é…å¿…é¡»ä»å­—ç¬¦ä¸²æˆ–ä¸€è¡Œçš„å¼€å¤´å¼€å§‹ã€‚</td><td>æ¨¡å¼^\d{3}</td><td>åŒ¹é…â€œ901â€â€œ901-â€</td></tr><tr><td>æ–­è¨€$</td><td>æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨å­—ç¬¦ä¸²çš„æœ«å°¾æˆ–å‡ºç°åœ¨è¡Œæˆ–å­—ç¬¦ä¸²æœ«å°¾çš„ \n ä¹‹å‰ã€‚</td><td>æ¨¡å¼-\d{3}$</td><td>åŒ¹é…â€œ-333â€â€œ-333â€</td></tr><tr><td>æ–­è¨€\A</td><td>æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨å­—ç¬¦ä¸²çš„å¼€å¤´ã€‚</td><td>æ¨¡å¼\A\d{3}</td><td>åŒ¹é…â€œ901â€â€œ901-â€</td></tr><tr><td>æ–­è¨€\Z</td><td>æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨å­—ç¬¦ä¸²çš„æœ«å°¾æˆ–å‡ºç°åœ¨å­—ç¬¦ä¸²æœ«å°¾çš„ \n ä¹‹å‰ã€‚</td><td>æ¨¡å¼-\d{3}\Z</td><td>åŒ¹é…â€œ-333â€â€œ-333â€</td></tr><tr><td>æ–­è¨€\z</td><td>æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨å­—ç¬¦ä¸²çš„æœ«å°¾ã€‚</td><td>æ¨¡å¼-\d{3}\z</td><td>åŒ¹é…â€œ-333â€â€œ-333â€</td></tr><tr><td>æ–­è¨€\G</td><td>æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨ä¸Šä¸€ä¸ªåŒ¹é…ç»“æŸçš„åœ°æ–¹ã€‚</td><td>æ¨¡å¼\G(\d)</td><td>åŒ¹é…â€œ(1)(3)(5)<a href="9">7</a>â€ä¸­çš„â€œ(1)â€ã€â€œ(3)â€ã€â€œ(5)â€</td></tr><tr><td>æ–­è¨€\b</td><td>æè¿°åŒ¹é…å¿…é¡»å‡ºç°åœ¨ \wï¼ˆå­—æ¯æ•°å­—ï¼‰å’Œ \Wï¼ˆéå­—æ¯æ•°å­—ï¼‰å­—ç¬¦ä¹‹é—´çš„è¾¹ç•Œä¸Šã€‚</td><td>æ¨¡å¼\b\w+\s\w+\b</td><td>åŒ¹é…â€œthem theme them themâ€ä¸­çš„â€œthem themeâ€ã€â€œthem themâ€</td></tr><tr><td>æ–­è¨€\B</td><td>æè¿°åŒ¹é…ä¸å¾—å‡ºç°åœ¨ \b è¾¹ç•Œä¸Šã€‚</td><td>æ¨¡å¼\Bend\w*\b</td><td>åŒ¹é…â€œend sends endure lenderâ€ä¸­çš„â€œendsâ€å’Œâ€œenderâ€</td></tr></tbody></table><h3 id="åˆ†ç»„æ„é€ "><a href="#åˆ†ç»„æ„é€ " class="headerlink" title="åˆ†ç»„æ„é€ "></a>åˆ†ç»„æ„é€ </h3><p>åˆ†ç»„æ„é€ æè¿°äº†æ­£åˆ™è¡¨è¾¾å¼çš„å­è¡¨è¾¾å¼ï¼Œé€šå¸¸ç”¨äºæ•è·è¾“å…¥å­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²ã€‚ åˆ†ç»„æ„é€ åŒ…æ‹¬ä¸‹è¡¨ä¸­åˆ—å‡ºçš„è¯­è¨€å…ƒç´ ã€‚ </p><table><thead><tr><th>åˆ†ç»„æ„é€ </th><th>æè¿°</th><th>æ¨¡å¼</th><th>åŒ¹é…</th></tr></thead><tbody><tr><td>åˆ†ç»„æ„é€ (å­è¡¨è¾¾å¼)</td><td>æè¿°æ•è·åŒ¹é…çš„å­è¡¨è¾¾å¼å¹¶å°†å…¶åˆ†é…åˆ°ä¸€ä¸ªä» 1 å¼€å§‹çš„åºå·ä¸­ã€‚</td><td>æ¨¡å¼(\w)\1</td><td>åŒ¹é…â€œdeepâ€ä¸­çš„â€œeeâ€</td></tr><tr><td>åˆ†ç»„æ„é€ (?&lt; åç§° &gt; å­è¡¨è¾¾å¼)</td><td>æè¿°å°†åŒ¹é…çš„å­è¡¨è¾¾å¼æ•è·åˆ°ä¸€ä¸ªå‘½åç»„ä¸­ã€‚</td><td>æ¨¡å¼(?<double>\w)\k<double></double></double></td><td>åŒ¹é…â€œdeepâ€ä¸­çš„â€œeeâ€</td></tr><tr><td>åˆ†ç»„æ„é€ (?&lt; åç§° 1 - åç§° 2 &gt; å­è¡¨è¾¾å¼)</td><td>æè¿°å®šä¹‰å¹³è¡¡ç»„å®šä¹‰ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://msdn.microsoft.com/zh-cn/library/bs2twtah.aspx" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„åˆ†ç»„æ„é€ </a>ä¸­çš„â€œå¹³è¡¡ç»„å®šä¹‰â€éƒ¨åˆ†ã€‚</td><td>æ¨¡å¼(((?â€™Openâ€™()[^()]<em>)+((?â€™Close-Openâ€™))[^()]</em>)+)*(?(Open)(?!))$</td><td>åŒ¹é…â€œ3+2^((1-3)<em>(3-1))â€ä¸­çš„â€œ((1-3)</em>(3-1))â€</td></tr><tr><td>åˆ†ç»„æ„é€ (?: å­è¡¨è¾¾å¼)</td><td>æè¿°å®šä¹‰éæ•è·ç»„ã€‚</td><td>æ¨¡å¼Write(?:Line)?</td><td>åŒ¹é…â€œConsole.WriteLine()â€ä¸­çš„â€œWriteLineâ€â€œConsole.Write(value)â€ä¸­çš„â€œWriteâ€</td></tr><tr><td>åˆ†ç»„æ„é€ (?imnsx-imnsx: å­è¡¨è¾¾å¼)</td><td>æè¿°åº”ç”¨æˆ–ç¦ç”¨å­è¡¨è¾¾å¼ä¸­æŒ‡å®šçš„é€‰é¡¹ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://msdn.microsoft.com/zh-cn/library/yd1hzczs.aspx" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼é€‰é¡¹</a>ã€‚</td><td>æ¨¡å¼A\d{2}(?i:\w+)\b</td><td>åŒ¹é…â€œA12xl A12XL a12xlâ€ä¸­çš„â€œA12xlâ€å’Œâ€œA12XLâ€</td></tr><tr><td>åˆ†ç»„æ„é€ (?= å­è¡¨è¾¾å¼)</td><td>æè¿°é›¶å®½åº¦æ­£é¢„æµ‹å…ˆè¡Œæ–­è¨€ã€‚</td><td>æ¨¡å¼\w+(?=.)</td><td>åŒ¹é…â€œHe is. The dog ran. The sun is out.â€ä¸­çš„â€œisâ€ã€â€œranâ€å’Œâ€œoutâ€</td></tr><tr><td>åˆ†ç»„æ„é€ (?! å­è¡¨è¾¾å¼)</td><td>æè¿°é›¶å®½åº¦è´Ÿé¢„æµ‹å…ˆè¡Œæ–­è¨€ã€‚</td><td>æ¨¡å¼\b(?!un)\w+\b</td><td>åŒ¹é…â€œunsure sure unity usedâ€ä¸­çš„â€œsureâ€å’Œâ€œusedâ€</td></tr><tr><td>åˆ†ç»„æ„é€ (?&lt;= å­è¡¨è¾¾å¼)</td><td>æè¿°é›¶å®½åº¦æ­£å›é¡¾åå‘æ–­è¨€ã€‚</td><td>æ¨¡å¼(?&lt;=19)\d{2}\b</td><td>åŒ¹é…â€œ1851 1999 1950 1905 2003â€ä¸­çš„â€œ99â€ã€â€œ50â€å’Œâ€œ05â€</td></tr><tr><td>åˆ†ç»„æ„é€ (?&lt;! å­è¡¨è¾¾å¼)</td><td>æè¿°é›¶å®½åº¦è´Ÿå›é¡¾åå‘æ–­è¨€ã€‚</td><td>æ¨¡å¼(?&lt;!19)\d{2}\b</td><td>åŒ¹é…â€œ1851 1999 1950 1905 2003â€ä¸­çš„â€œ51â€å’Œâ€œ03â€</td></tr><tr><td>åˆ†ç»„æ„é€ (?&gt; å­è¡¨è¾¾å¼)</td><td>æè¿°éå›æº¯ï¼ˆä¹Ÿç§°ä¸ºâ€œè´ªå©ªâ€ï¼‰å­è¡¨è¾¾å¼ã€‚</td><td>æ¨¡å¼<a href="?&gt;A+B+">13579</a></td><td>åŒ¹é…â€œ1ABB 3ABBC 5AB 5ACâ€ä¸­çš„â€œ1ABBâ€ã€â€œ3ABBâ€å’Œâ€œ5ABâ€</td></tr></tbody></table><h3 id="æ•°é‡è¯"><a href="#æ•°é‡è¯" class="headerlink" title="æ•°é‡è¯"></a>æ•°é‡è¯</h3><table><thead><tr><th>é™å®šç¬¦</th><th>æè¿°</th><th>æ¨¡å¼</th><th>åŒ¹é…</th></tr></thead><tbody><tr><td>é™å®šç¬¦*</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚</td><td>æ¨¡å¼\d*.\d</td><td>åŒ¹é…â€œ.0â€ï¼Œâ€œ19.9â€å’Œâ€œ219.9â€</td></tr><tr><td>é™å®šç¬¦+</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚</td><td>æ¨¡å¼â€be+â€</td><td>åŒ¹é…â€œbeenâ€ä¸­çš„â€œbeeâ€ï¼Œâ€œbentâ€ä¸­çš„â€œbeâ€</td></tr><tr><td>é™å®šç¬¦?</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚</td><td>æ¨¡å¼â€rai?nâ€</td><td>åŒ¹é…â€œranâ€å’Œâ€œrainâ€</td></tr><tr><td>é™å®šç¬¦{n}</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ æ°å¥½ n æ¬¡ã€‚</td><td>æ¨¡å¼â€,\d{3}â€</td><td>åŒ¹é…â€œ1,043.6â€ä¸­çš„â€œ,043â€ï¼Œâ€œ9,876,543,210â€ä¸­çš„â€œ,876â€ã€â€œ,543â€å’Œâ€œ,210â€</td></tr><tr><td>é™å®šç¬¦{n,}</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ è‡³å°‘ n æ¬¡ã€‚</td><td>æ¨¡å¼â€\d{2,}â€</td><td>åŒ¹é…â€œ166â€ï¼Œâ€œ29â€å’Œâ€œ1930â€</td></tr><tr><td>é™å®šç¬¦{n,m}</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ è‡³å°‘ n æ¬¡ï¼Œä½†ä¸å¤šäº m æ¬¡ã€‚</td><td>æ¨¡å¼â€\d{3,5}â€</td><td>åŒ¹é…â€œ166â€ã€â€œ17668â€â€œ193024â€ä¸­çš„â€œ19302â€</td></tr><tr><td>é™å®šç¬¦*?</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ é›¶æ¬¡æˆ–å¤šæ¬¡ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚</td><td>æ¨¡å¼\d*?.\d</td><td>åŒ¹é…â€œ.0â€ï¼Œâ€œ19.9â€å’Œâ€œ219.9â€</td></tr><tr><td>é™å®šç¬¦+?</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚</td><td>æ¨¡å¼â€be+?â€</td><td>åŒ¹é…â€œbeenâ€ä¸­çš„â€œbeâ€ï¼Œâ€œbentâ€ä¸­çš„â€œbeâ€</td></tr><tr><td>é™å®šç¬¦??</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚</td><td>æ¨¡å¼â€rai??nâ€</td><td>åŒ¹é…â€œranâ€å’Œâ€œrainâ€</td></tr><tr><td>é™å®šç¬¦{n}?</td><td>æè¿°åŒ¹é…å‰é¢çš„å…ƒç´ æ°å¥½ n æ¬¡ã€‚</td><td>æ¨¡å¼â€,\d{3}?â€</td><td>åŒ¹é…â€œ1,043.6â€ä¸­çš„â€œ,043â€ï¼Œâ€œ9,876,543,210â€ä¸­çš„â€œ,876â€ã€â€œ,543â€å’Œâ€œ,210â€</td></tr><tr><td>é™å®šç¬¦{n,}?</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ è‡³å°‘ n æ¬¡ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚</td><td>æ¨¡å¼â€\d{2,}?â€</td><td>åŒ¹é…â€œ166â€ï¼Œâ€œ29â€å’Œâ€œ1930â€</td></tr><tr><td>é™å®šç¬¦{n,m}?</td><td>æè¿°åŒ¹é…ä¸Šä¸€ä¸ªå…ƒç´ çš„æ¬¡æ•°ä»‹äº n å’Œ m ä¹‹é—´ï¼Œä½†æ¬¡æ•°å°½å¯èƒ½å°‘ã€‚</td><td>æ¨¡å¼â€\d{3,5}?â€</td><td>åŒ¹é…â€œ166â€ã€â€œ17668â€â€œ193024â€ä¸­çš„â€œ193â€ã€â€œ024â€</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Other</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Regular</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>